begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * "$Id$"  *  *   Main window code for Print plug-in for the GIMP.  *  *   Copyright 1997-2000 Michael Sweet (mike@easysw.com),  *	Robert Krawitz (rlk@alum.mit.edu), Steve Miller (smiller@rni.net)  *      and Michael Natterer (mitch@gimp.org)  *  *   This program is free software; you can redistribute it and/or modify it  *   under the terms of the GNU General Public License as published by the Free  *   Software Foundation; either version 2 of the License, or (at your option)  *   any later version.  *  *   This program is distributed in the hope that it will be useful, but  *   WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY  *   or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License  *   for more details.  *  *   You should have received a copy of the GNU General Public License  *   along with this program; if not, write to the Free Software  *   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|"print_gimp.h"
end_include

begin_ifndef
ifndef|#
directive|ifndef
name|GIMP_1_0
end_ifndef

begin_include
include|#
directive|include
file|<libgimp/gimpui.h>
end_include

begin_include
include|#
directive|include
file|"libgimp/stdplugins-intl.h"
end_include

begin_comment
comment|/*  * Constants for GUI...  */
end_comment

begin_decl_stmt
specifier|extern
name|vars_t
name|vars
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|gint
name|plist_count
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Number of system printers */
end_comment

begin_decl_stmt
specifier|extern
name|gint
name|plist_current
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Current system printer */
end_comment

begin_decl_stmt
specifier|extern
name|plist_t
name|plist
index|[
name|MAX_PLIST
index|]
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* System printers */
end_comment

begin_decl_stmt
specifier|extern
name|gint32
name|image_ID
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|gint
name|image_width
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|gint
name|image_height
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
specifier|const
name|printer_t
modifier|*
name|current_printer
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|gint
name|runme
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|gint
name|saveme
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|GtkWidget
modifier|*
name|gimp_color_adjust_dialog
decl_stmt|;
end_decl_stmt

begin_function_decl
name|void
name|printrc_save
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/*  *  Main window widgets  */
end_comment

begin_decl_stmt
DECL|variable|print_dialog
specifier|static
name|GtkWidget
modifier|*
name|print_dialog
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|print_dialog
comment|/* Print dialog window */
end_comment

begin_decl_stmt
DECL|variable|recenter_button
specifier|static
name|GtkWidget
modifier|*
name|recenter_button
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|left_entry
specifier|static
name|GtkWidget
modifier|*
name|left_entry
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|right_entry
specifier|static
name|GtkWidget
modifier|*
name|right_entry
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|top_entry
specifier|static
name|GtkWidget
modifier|*
name|top_entry
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|bottom_entry
specifier|static
name|GtkWidget
modifier|*
name|bottom_entry
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|media_size
specifier|static
name|GtkWidget
modifier|*
name|media_size
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|media_size
comment|/* Media size option button */
end_comment

begin_decl_stmt
DECL|variable|media_size_menu
specifier|static
name|GtkWidget
modifier|*
name|media_size_menu
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|media_size_menu
comment|/* Media size menu */
end_comment

begin_decl_stmt
DECL|variable|media_type
specifier|static
name|GtkWidget
modifier|*
name|media_type
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|media_type
comment|/* Media type option button */
end_comment

begin_decl_stmt
DECL|variable|media_type_menu
specifier|static
name|GtkWidget
modifier|*
name|media_type_menu
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|media_type_menu
comment|/* Media type menu */
end_comment

begin_decl_stmt
DECL|variable|media_source
specifier|static
name|GtkWidget
modifier|*
name|media_source
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|media_source
comment|/* Media source option button */
end_comment

begin_decl_stmt
DECL|variable|media_source_menu
specifier|static
name|GtkWidget
modifier|*
name|media_source_menu
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|media_source_menu
comment|/* Media source menu */
end_comment

begin_decl_stmt
DECL|variable|resolution
specifier|static
name|GtkWidget
modifier|*
name|resolution
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|resolution
comment|/* Resolution option button */
end_comment

begin_decl_stmt
DECL|variable|resolution_menu
specifier|static
name|GtkWidget
modifier|*
name|resolution_menu
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|resolution_menu
comment|/* Resolution menu */
end_comment

begin_decl_stmt
DECL|variable|scaling_percent
specifier|static
name|GtkWidget
modifier|*
name|scaling_percent
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|scaling_percent
comment|/* Scale by percent */
end_comment

begin_decl_stmt
DECL|variable|scaling_ppi
specifier|static
name|GtkWidget
modifier|*
name|scaling_ppi
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|scaling_ppi
comment|/* Scale by pixels-per-inch */
end_comment

begin_decl_stmt
DECL|variable|scaling_image
specifier|static
name|GtkWidget
modifier|*
name|scaling_image
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|scaling_image
comment|/* Scale to the image */
end_comment

begin_decl_stmt
DECL|variable|output_gray
specifier|static
name|GtkWidget
modifier|*
name|output_gray
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|output_gray
comment|/* Output type toggle, black */
end_comment

begin_decl_stmt
DECL|variable|output_color
specifier|static
name|GtkWidget
modifier|*
name|output_color
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|output_color
comment|/* Output type toggle, color */
end_comment

begin_decl_stmt
DECL|variable|setup_dialog
specifier|static
name|GtkWidget
modifier|*
name|setup_dialog
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|setup_dialog
comment|/* Setup dialog window */
end_comment

begin_decl_stmt
DECL|variable|printer_driver
specifier|static
name|GtkWidget
modifier|*
name|printer_driver
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|printer_driver
comment|/* Printer driver widget */
end_comment

begin_decl_stmt
DECL|variable|ppd_file
specifier|static
name|GtkWidget
modifier|*
name|ppd_file
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|ppd_file
comment|/* PPD file entry */
end_comment

begin_decl_stmt
DECL|variable|ppd_button
specifier|static
name|GtkWidget
modifier|*
name|ppd_button
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|ppd_button
comment|/* PPD file browse button */
end_comment

begin_decl_stmt
DECL|variable|output_cmd
specifier|static
name|GtkWidget
modifier|*
name|output_cmd
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|output_cmd
comment|/* Output command text entry */
end_comment

begin_decl_stmt
DECL|variable|ppd_browser
specifier|static
name|GtkWidget
modifier|*
name|ppd_browser
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|ppd_browser
comment|/* File selection dialog for PPD files */
end_comment

begin_decl_stmt
DECL|variable|file_browser
specifier|static
name|GtkWidget
modifier|*
name|file_browser
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|file_browser
comment|/* FSD for print files */
end_comment

begin_decl_stmt
DECL|variable|printandsave_button
specifier|static
name|GtkWidget
modifier|*
name|printandsave_button
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|adjust_color_button
specifier|static
name|GtkWidget
modifier|*
name|adjust_color_button
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|scaling_adjustment
specifier|static
name|GtkObject
modifier|*
name|scaling_adjustment
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|scaling_adjustment
comment|/* Adjustment object for scaling */
end_comment

begin_decl_stmt
DECL|variable|num_media_sizes
specifier|static
name|gint
name|num_media_sizes
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|num_media_sizes
comment|/* Number of media sizes */
end_comment

begin_decl_stmt
DECL|variable|media_sizes
specifier|static
name|gchar
modifier|*
modifier|*
name|media_sizes
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|media_sizes
comment|/* Media size strings */
end_comment

begin_decl_stmt
DECL|variable|num_media_types
specifier|static
name|gint
name|num_media_types
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|num_media_types
comment|/* Number of media types */
end_comment

begin_decl_stmt
DECL|variable|media_types
specifier|static
name|gchar
modifier|*
modifier|*
name|media_types
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|media_types
comment|/* Media type strings */
end_comment

begin_decl_stmt
DECL|variable|num_media_sources
specifier|static
name|gint
name|num_media_sources
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|num_media_sources
comment|/* Number of media sources */
end_comment

begin_decl_stmt
DECL|variable|media_sources
specifier|static
name|gchar
modifier|*
modifier|*
name|media_sources
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|media_sources
comment|/* Media source strings */
end_comment

begin_decl_stmt
DECL|variable|num_resolutions
specifier|static
name|gint
name|num_resolutions
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|num_resolutions
comment|/* Number of resolutions */
end_comment

begin_decl_stmt
DECL|variable|resolutions
specifier|static
name|gchar
modifier|*
modifier|*
name|resolutions
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|resolutions
comment|/* Resolution strings */
end_comment

begin_decl_stmt
DECL|variable|preview
specifier|static
name|GtkDrawingArea
modifier|*
name|preview
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|preview
comment|/* Preview drawing area widget */
end_comment

begin_decl_stmt
DECL|variable|mouse_x
specifier|static
name|gint
name|mouse_x
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|mouse_x
comment|/* Last mouse X */
end_comment

begin_decl_stmt
DECL|variable|mouse_y
specifier|static
name|gint
name|mouse_y
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|mouse_y
comment|/* Last mouse Y */
end_comment

begin_decl_stmt
DECL|variable|page_left
specifier|static
name|gint
name|page_left
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|page_left
comment|/* Left pixel column of page */
end_comment

begin_decl_stmt
DECL|variable|page_top
specifier|static
name|gint
name|page_top
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|page_top
comment|/* Top pixel row of page */
end_comment

begin_decl_stmt
DECL|variable|page_width
specifier|static
name|gint
name|page_width
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|page_width
comment|/* Width of page on screen */
end_comment

begin_decl_stmt
DECL|variable|page_height
specifier|static
name|gint
name|page_height
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|page_height
comment|/* Height of page on screen */
end_comment

begin_decl_stmt
DECL|variable|print_width
specifier|static
name|gint
name|print_width
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|print_width
comment|/* Printed width of image */
end_comment

begin_decl_stmt
DECL|variable|print_height
specifier|static
name|gint
name|print_height
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|print_height
comment|/* Printed height of image */
end_comment

begin_decl_stmt
specifier|extern
name|GtkObject
modifier|*
name|brightness_adjustment
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Adjustment object for brightness */
end_comment

begin_decl_stmt
specifier|extern
name|GtkObject
modifier|*
name|saturation_adjustment
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Adjustment object for saturation */
end_comment

begin_decl_stmt
specifier|extern
name|GtkObject
modifier|*
name|density_adjustment
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Adjustment object for density */
end_comment

begin_decl_stmt
specifier|extern
name|GtkObject
modifier|*
name|contrast_adjustment
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Adjustment object for contrast */
end_comment

begin_decl_stmt
specifier|extern
name|GtkObject
modifier|*
name|red_adjustment
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Adjustment object for red */
end_comment

begin_decl_stmt
specifier|extern
name|GtkObject
modifier|*
name|green_adjustment
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Adjustment object for green */
end_comment

begin_decl_stmt
specifier|extern
name|GtkObject
modifier|*
name|blue_adjustment
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Adjustment object for blue */
end_comment

begin_decl_stmt
specifier|extern
name|GtkObject
modifier|*
name|gamma_adjustment
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Adjustment object for gamma */
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_scaling_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_scaling_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_plist_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_media_size_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_media_type_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_media_source_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_resolution_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_output_type_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|DO_LINEAR
end_ifdef

begin_function_decl
specifier|static
name|void
name|gimp_linear_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
specifier|static
name|void
name|gimp_orientation_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_printandsave_callback
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_print_callback
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_save_callback
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_setup_open_callback
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_setup_ok_callback
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_ppd_browse_callback
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_ppd_ok_callback
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_print_driver_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_file_ok_callback
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_file_cancel_callback
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_preview_update
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_preview_button_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEventButton
modifier|*
name|bevent
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_preview_motion_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEventMotion
modifier|*
name|mevent
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_position_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|extern
name|void
name|gimp_create_color_adjust_window
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/*  *  gimp_create_main_window()  */
end_comment

begin_function
name|void
DECL|function|gimp_create_main_window (void)
name|gimp_create_main_window
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|dialog
decl_stmt|;
name|GtkWidget
modifier|*
name|main_vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|printer_table
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|GtkWidget
modifier|*
name|menu
decl_stmt|;
name|GtkWidget
modifier|*
name|item
decl_stmt|;
name|GtkWidget
modifier|*
name|option
decl_stmt|;
name|GtkWidget
modifier|*
name|box
decl_stmt|;
name|GSList
modifier|*
name|group
decl_stmt|;
ifdef|#
directive|ifdef
name|DO_LINEAR
name|GSList
modifier|*
name|linear_group
decl_stmt|;
endif|#
directive|endif
name|gint
name|i
decl_stmt|;
name|gchar
name|s
index|[
literal|100
index|]
decl_stmt|;
specifier|const
name|printer_t
modifier|*
name|the_printer
init|=
name|get_printer_by_index
argument_list|(
literal|0
argument_list|)
decl_stmt|;
name|gchar
modifier|*
name|plug_in_name
decl_stmt|;
comment|/*    * Create the main dialog    */
name|plug_in_name
operator|=
name|g_strdup_printf
argument_list|(
name|_
argument_list|(
literal|"Print v%s"
argument_list|)
argument_list|,
name|PLUG_IN_VERSION
argument_list|)
expr_stmt|;
name|print_dialog
operator|=
name|dialog
operator|=
name|gimp_dialog_new
argument_list|(
name|plug_in_name
argument_list|,
literal|"print"
argument_list|,
name|gimp_standard_help_func
argument_list|,
literal|"filters/print.html"
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"Print and\nSave Settings"
argument_list|)
argument_list|,
name|gimp_printandsave_callback
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
operator|&
name|printandsave_button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"Save\nSettings"
argument_list|)
argument_list|,
name|gimp_save_callback
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"Print"
argument_list|)
argument_list|,
name|gimp_print_callback
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"Cancel"
argument_list|)
argument_list|,
name|gtk_widget_destroy
argument_list|,
name|NULL
argument_list|,
literal|1
argument_list|,
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|plug_in_name
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|dialog
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gtk_main_quit
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/*    * Top-level vbox for dialog...    */
name|main_vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|main_vbox
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dialog
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|main_vbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|main_vbox
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|main_vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Preview"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
comment|/*    * Drawing area for page preview...    */
name|preview
operator|=
operator|(
name|GtkDrawingArea
operator|*
operator|)
name|gtk_drawing_area_new
argument_list|()
expr_stmt|;
name|gtk_drawing_area_size
argument_list|(
name|preview
argument_list|,
name|PREVIEW_SIZE_HORIZ
argument_list|,
name|PREVIEW_SIZE_VERT
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|GTK_WIDGET
argument_list|(
name|preview
argument_list|)
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"expose_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_preview_update
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_preview_button_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"button_release_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_preview_button_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"motion_notify_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_preview_motion_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|GTK_WIDGET
argument_list|(
name|preview
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|GTK_WIDGET
argument_list|(
name|preview
argument_list|)
argument_list|,
name|GDK_EXPOSURE_MASK
operator||
name|GDK_BUTTON_MOTION_MASK
operator||
name|GDK_BUTTON_PRESS_MASK
operator||
name|GDK_BUTTON_RELEASE_MASK
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|recenter_button
operator|=
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Center Image"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_padding
argument_list|(
name|GTK_MISC
argument_list|(
name|GTK_BIN
argument_list|(
name|button
argument_list|)
operator|->
name|child
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_position_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|button
argument_list|,
literal|2
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|left_entry
operator|=
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.3f"
argument_list|,
name|fabs
argument_list|(
name|vars
operator|.
name|left
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_position_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|entry
argument_list|,
literal|60
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Left:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|top_entry
operator|=
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.3f"
argument_list|,
name|fabs
argument_list|(
name|vars
operator|.
name|top
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_position_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|entry
argument_list|,
literal|60
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Top:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|right_entry
operator|=
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.3f"
argument_list|,
name|fabs
argument_list|(
name|vars
operator|.
name|left
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_position_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|entry
argument_list|,
literal|60
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Right:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|bottom_entry
operator|=
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.3f"
argument_list|,
name|fabs
argument_list|(
name|vars
operator|.
name|left
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_position_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|entry
argument_list|,
literal|60
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Bottom:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
comment|/*    *  Printer settings frame...    */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Printer Settings"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|table
operator|=
name|printer_table
operator|=
name|gtk_table_new
argument_list|(
literal|8
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
comment|/*    * Media size option menu...    */
name|media_size
operator|=
name|option
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Media Size:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|option
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
comment|/*    * Media type option menu...    */
name|media_type
operator|=
name|option
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Media Type:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|option
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
comment|/*    * Media source option menu...    */
name|media_source
operator|=
name|option
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
name|_
argument_list|(
literal|"Media Source:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|option
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
comment|/*    * Orientation option menu...    */
name|option
operator|=
name|gimp_option_menu_new
argument_list|(
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"Auto"
argument_list|)
argument_list|,
name|gimp_orientation_callback
argument_list|,
operator|(
name|gpointer
operator|)
operator|-
literal|1
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|,
name|_
argument_list|(
literal|"Portrait"
argument_list|)
argument_list|,
name|gimp_orientation_callback
argument_list|,
operator|(
name|gpointer
operator|)
literal|0
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"Landscape"
argument_list|)
argument_list|,
name|gimp_orientation_callback
argument_list|,
operator|(
name|gpointer
operator|)
literal|1
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|,
name|_
argument_list|(
literal|"Orientation:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|option
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
comment|/*    * Resolution option menu...    */
name|resolution
operator|=
name|option
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|6
argument_list|,
name|_
argument_list|(
literal|"Resolution:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|option
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
comment|/*    * Output type toggles...    */
name|box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|7
argument_list|,
name|_
argument_list|(
literal|"Output Type:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.15
argument_list|,
name|box
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|output_gray
operator|=
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|NULL
argument_list|,
name|_
argument_list|(
literal|"B&W"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|output_type
operator|==
literal|0
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_output_type_callback
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|OUTPUT_GRAY
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|output_color
operator|=
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Color"
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|output_type
operator|==
literal|1
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_output_type_callback
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|OUTPUT_COLOR
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DO_LINEAR
name|box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|8
argument_list|,
name|_
argument_list|(
literal|"Output Level:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.15
argument_list|,
name|box
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|linear_off
operator|=
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|NULL
argument_list|,
name|_
argument_list|(
literal|"Normal Scale"
argument_list|)
argument_list|)
expr_stmt|;
name|linear_group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|linear
operator|==
literal|0
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_linear_callback
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|linear_on
operator|=
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|linear_group
argument_list|,
name|_
argument_list|(
literal|"Experimental Linear Scale"
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|linear
operator|==
literal|1
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_linear_callback
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
literal|1
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/*    * Scaling...    */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Scaling and Color Settings"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|main_vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|scaling
operator|<
literal|0.0
condition|)
block|{
name|scaling_adjustment
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Scaling:"
argument_list|)
argument_list|,
literal|200
argument_list|,
literal|0
argument_list|,
operator|-
name|vars
operator|.
name|scaling
argument_list|,
literal|36.0
argument_list|,
literal|1201.0
argument_list|,
literal|1.0
argument_list|,
literal|10.0
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|scaling_adjustment
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Scaling:"
argument_list|)
argument_list|,
literal|200
argument_list|,
literal|75
argument_list|,
name|vars
operator|.
name|scaling
argument_list|,
literal|5.0
argument_list|,
literal|100.0
argument_list|,
literal|1.0
argument_list|,
literal|10.0
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|scaling_adjustment
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_scaling_update
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|box
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|scaling_percent
operator|=
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|NULL
argument_list|,
name|_
argument_list|(
literal|"Percent"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|scaling
operator|>
literal|0.0
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_scaling_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|scaling_ppi
operator|=
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"PPI"
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|scaling
operator|<
literal|0.0
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_scaling_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|scaling_image
operator|=
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Set Image Scale"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_padding
argument_list|(
name|GTK_MISC
argument_list|(
name|GTK_BIN
argument_list|(
name|button
argument_list|)
operator|->
name|child
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_scaling_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
comment|/*    *  Color adjust button    */
name|gimp_create_color_adjust_window
argument_list|()
expr_stmt|;
name|adjust_color_button
operator|=
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Adjust Color"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_padding
argument_list|(
name|GTK_MISC
argument_list|(
name|GTK_BIN
argument_list|(
name|button
argument_list|)
operator|->
name|child
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gtk_widget_show
argument_list|)
argument_list|,
name|GTK_OBJECT
argument_list|(
name|gimp_color_adjust_dialog
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_end
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
comment|/*    * Printer option menu...    */
name|menu
operator|=
name|gtk_menu_new
argument_list|()
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|plist_count
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|plist
index|[
name|i
index|]
operator|.
name|active
condition|)
name|item
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|gettext
argument_list|(
name|plist
index|[
name|i
index|]
operator|.
name|name
argument_list|)
argument_list|)
expr_stmt|;
else|else
block|{
name|gchar
name|buf
index|[
literal|18
index|]
decl_stmt|;
name|buf
index|[
literal|0
index|]
operator|=
literal|'*'
expr_stmt|;
name|memcpy
argument_list|(
name|buf
operator|+
literal|1
argument_list|,
name|plist
index|[
name|i
index|]
operator|.
name|name
argument_list|,
literal|17
argument_list|)
expr_stmt|;
name|item
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|gettext
argument_list|(
name|buf
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_plist_callback
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|i
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
block|}
name|box
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|printer_table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Printer:"
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|,
name|box
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|option
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|option
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|option
argument_list|)
argument_list|,
name|menu
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|option
argument_list|)
argument_list|,
name|plist_current
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|option
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Setup"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_padding
argument_list|(
name|GTK_MISC
argument_list|(
name|GTK_BIN
argument_list|(
name|button
argument_list|)
operator|->
name|child
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_setup_open_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
comment|/*    * Setup dialog window...    */
name|setup_dialog
operator|=
name|dialog
operator|=
name|gimp_dialog_new
argument_list|(
name|_
argument_list|(
literal|"Setup"
argument_list|)
argument_list|,
literal|"print"
argument_list|,
name|gimp_standard_help_func
argument_list|,
literal|"filters/print.html"
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"OK"
argument_list|)
argument_list|,
name|gimp_setup_ok_callback
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"Cancel"
argument_list|)
argument_list|,
name|gtk_widget_hide
argument_list|,
name|NULL
argument_list|,
literal|1
argument_list|,
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/*    * Top-level table for dialog...    */
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dialog
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
comment|/*    * Printer driver option menu...    */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Driver:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|menu
operator|=
name|gtk_menu_new
argument_list|()
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|known_printers
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|the_printer
operator|->
name|long_name
argument_list|,
literal|""
argument_list|)
condition|)
continue|continue;
name|item
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|gettext
argument_list|(
name|the_printer
operator|->
name|long_name
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_print_driver_callback
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|i
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|the_printer
operator|++
expr_stmt|;
block|}
name|printer_driver
operator|=
name|option
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|option
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|option
argument_list|)
argument_list|,
name|menu
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|option
argument_list|)
expr_stmt|;
comment|/*    * PPD file...    */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"PPD File:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|box
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|box
argument_list|)
expr_stmt|;
name|ppd_file
operator|=
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|entry
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|ppd_button
operator|=
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Browse"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_padding
argument_list|(
name|GTK_MISC
argument_list|(
name|GTK_BIN
argument_list|(
name|button
argument_list|)
operator|->
name|child
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_ppd_browse_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
comment|/*    * Print command...    */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Command:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|output_cmd
operator|=
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
comment|/*    * Output file selection dialog...    */
name|file_browser
operator|=
name|gtk_file_selection_new
argument_list|(
name|_
argument_list|(
literal|"Print To File?"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|file_browser
argument_list|)
operator|->
name|ok_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_file_ok_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|file_browser
argument_list|)
operator|->
name|cancel_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_file_cancel_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/*    * PPD file selection dialog...    */
name|ppd_browser
operator|=
name|gtk_file_selection_new
argument_list|(
name|_
argument_list|(
literal|"PPD File?"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_file_selection_hide_fileop_buttons
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|ppd_browser
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|ppd_browser
argument_list|)
operator|->
name|ok_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gimp_ppd_ok_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|ppd_browser
argument_list|)
operator|->
name|cancel_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gtk_widget_hide
argument_list|)
argument_list|,
name|GTK_OBJECT
argument_list|(
name|ppd_browser
argument_list|)
argument_list|)
expr_stmt|;
comment|/*    * Show the main dialog and wait for the user to do something...    */
name|gimp_plist_callback
argument_list|(
name|NULL
argument_list|,
operator|(
name|gpointer
operator|)
name|plist_current
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|print_dialog
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_scaling_update() - Update the scaling scale using the slider.  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_scaling_update (GtkAdjustment * adjustment)
name|gimp_scaling_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|)
block|{
if|if
condition|(
name|vars
operator|.
name|scaling
operator|!=
name|adjustment
operator|->
name|value
condition|)
block|{
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|scaling_ppi
argument_list|)
operator|->
name|active
condition|)
name|vars
operator|.
name|scaling
operator|=
operator|-
name|adjustment
operator|->
name|value
expr_stmt|;
else|else
name|vars
operator|.
name|scaling
operator|=
name|adjustment
operator|->
name|value
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
operator|=
name|vars
operator|.
name|scaling
expr_stmt|;
block|}
name|gimp_preview_update
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_scaling_callback() - Update the scaling scale using radio buttons.  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_scaling_callback (GtkWidget * widget)
name|gimp_scaling_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|)
block|{
if|if
condition|(
name|widget
operator|==
name|scaling_ppi
condition|)
block|{
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|lower
operator|=
literal|36.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|upper
operator|=
literal|1200.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|value
operator|=
literal|72.0
expr_stmt|;
name|vars
operator|.
name|scaling
operator|=
literal|0.0
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
operator|=
name|vars
operator|.
name|scaling
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|widget
operator|==
name|scaling_percent
condition|)
block|{
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|lower
operator|=
literal|5.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|upper
operator|=
literal|100.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|value
operator|=
literal|100.0
expr_stmt|;
name|vars
operator|.
name|scaling
operator|=
literal|0.0
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
operator|=
name|vars
operator|.
name|scaling
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|widget
operator|==
name|scaling_image
condition|)
block|{
name|gdouble
name|xres
decl_stmt|,
name|yres
decl_stmt|;
name|gimp_image_get_resolution
argument_list|(
name|image_ID
argument_list|,
operator|&
name|xres
argument_list|,
operator|&
name|yres
argument_list|)
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|lower
operator|=
literal|36.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|upper
operator|=
literal|1201.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|value
operator|=
name|yres
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|scaling_ppi
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|vars
operator|.
name|scaling
operator|=
literal|0.0
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
operator|=
name|vars
operator|.
name|scaling
expr_stmt|;
block|}
name|gtk_adjustment_changed
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_adjustment_value_changed
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_plist_build_menu ()  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_plist_build_menu (GtkWidget * option,GtkWidget ** menu,gint num_items,gchar ** items,gchar * cur_item,GtkSignalFunc callback)
name|gimp_plist_build_menu
parameter_list|(
name|GtkWidget
modifier|*
name|option
parameter_list|,
name|GtkWidget
modifier|*
modifier|*
name|menu
parameter_list|,
name|gint
name|num_items
parameter_list|,
name|gchar
modifier|*
modifier|*
name|items
parameter_list|,
name|gchar
modifier|*
name|cur_item
parameter_list|,
name|GtkSignalFunc
name|callback
parameter_list|)
block|{
name|gint
name|i
decl_stmt|;
name|GtkWidget
modifier|*
name|item
decl_stmt|;
name|GtkWidget
modifier|*
name|item0
init|=
name|NULL
decl_stmt|;
if|if
condition|(
operator|*
name|menu
operator|!=
name|NULL
condition|)
block|{
name|gtk_widget_destroy
argument_list|(
operator|*
name|menu
argument_list|)
expr_stmt|;
operator|*
name|menu
operator|=
name|NULL
expr_stmt|;
block|}
operator|*
name|menu
operator|=
name|gtk_menu_new
argument_list|()
expr_stmt|;
if|if
condition|(
name|num_items
operator|==
literal|0
condition|)
block|{
name|item
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Standard"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
operator|*
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|option
argument_list|)
argument_list|,
operator|*
name|menu
argument_list|)
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|option
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|option
argument_list|)
expr_stmt|;
return|return;
block|}
else|else
block|{
name|gtk_widget_set_sensitive
argument_list|(
name|option
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_items
condition|;
name|i
operator|++
control|)
block|{
name|item
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|gettext
argument_list|(
name|items
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|i
operator|==
literal|0
condition|)
name|item0
operator|=
name|item
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
operator|*
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
name|callback
argument_list|,
operator|(
name|gpointer
operator|)
name|i
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
block|}
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|option
argument_list|)
argument_list|,
operator|*
name|menu
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DEBUG
name|printf
argument_list|(
literal|"cur_item = \'%s\'\n"
argument_list|,
name|cur_item
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* DEBUG */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_items
condition|;
name|i
operator|++
control|)
block|{
ifdef|#
directive|ifdef
name|DEBUG
name|printf
argument_list|(
literal|"item[%d] = \'%s\'\n"
argument_list|,
name|i
argument_list|,
name|items
index|[
name|i
index|]
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* DEBUG */
if|if
condition|(
name|strcmp
argument_list|(
name|items
index|[
name|i
index|]
argument_list|,
name|cur_item
argument_list|)
operator|==
literal|0
condition|)
block|{
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|option
argument_list|)
argument_list|,
name|i
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|i
operator|==
name|num_items
condition|)
block|{
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|option
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_emit_by_name
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item0
argument_list|)
argument_list|,
literal|"activate"
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  *  gimp_do_misc_updates() - Build an option menu for the given parameters...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_do_misc_updates (void)
name|gimp_do_misc_updates
parameter_list|(
name|void
parameter_list|)
block|{
name|vars
operator|.
name|scaling
operator|=
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
expr_stmt|;
name|vars
operator|.
name|orientation
operator|=
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|orientation
expr_stmt|;
name|vars
operator|.
name|left
operator|=
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|left
expr_stmt|;
name|vars
operator|.
name|top
operator|=
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|top
expr_stmt|;
if|if
condition|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
operator|<
literal|0
condition|)
block|{
name|float
name|tmp
init|=
operator|-
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
decl_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
operator|=
operator|-
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|scaling_ppi
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|lower
operator|=
literal|36.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|upper
operator|=
literal|1201.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|value
operator|=
name|tmp
expr_stmt|;
name|gtk_signal_emit_by_name
argument_list|(
name|scaling_adjustment
argument_list|,
literal|"changed"
argument_list|)
expr_stmt|;
name|gtk_signal_emit_by_name
argument_list|(
name|scaling_adjustment
argument_list|,
literal|"value_changed"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|float
name|tmp
init|=
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|scaling
decl_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|scaling_percent
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|lower
operator|=
literal|5.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|upper
operator|=
literal|101.0
expr_stmt|;
name|GTK_ADJUSTMENT
argument_list|(
name|scaling_adjustment
argument_list|)
operator|->
name|value
operator|=
name|tmp
expr_stmt|;
name|gtk_signal_emit_by_name
argument_list|(
name|scaling_adjustment
argument_list|,
literal|"changed"
argument_list|)
expr_stmt|;
name|gtk_signal_emit_by_name
argument_list|(
name|scaling_adjustment
argument_list|,
literal|"value_changed"
argument_list|)
expr_stmt|;
block|}
name|gtk_adjustment_set_value
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|brightness_adjustment
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|brightness
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|gamma_adjustment
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|gamma
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|contrast_adjustment
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|contrast
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|red_adjustment
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|red
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|green_adjustment
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|green
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|blue_adjustment
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|blue
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|saturation_adjustment
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|saturation
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|density_adjustment
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|density
argument_list|)
expr_stmt|;
if|if
condition|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|output_type
operator|==
name|OUTPUT_GRAY
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|output_gray
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
else|else
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|output_color
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|DO_LINEAR
if|if
condition|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|linear
operator|==
literal|0
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|linear_off
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
else|else
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|linear_on
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|gimp_preview_update
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  * gimp_position_callback() - callback for position entry widgets  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_position_callback (GtkWidget * widget)
name|gimp_position_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|)
block|{
name|gboolean
name|dontcheck
init|=
name|FALSE
decl_stmt|;
if|if
condition|(
name|widget
operator|==
name|top_entry
condition|)
block|{
name|gfloat
name|new_value
init|=
name|atof
argument_list|(
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|widget
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|vars
operator|.
name|top
operator|=
operator|(
name|new_value
operator|+
literal|1.0
operator|/
literal|144
operator|)
operator|*
literal|72
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|widget
operator|==
name|left_entry
condition|)
block|{
name|gfloat
name|new_value
init|=
name|atof
argument_list|(
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|widget
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|vars
operator|.
name|left
operator|=
operator|(
name|new_value
operator|+
literal|1.0
operator|/
literal|144
operator|)
operator|*
literal|72
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|widget
operator|==
name|bottom_entry
condition|)
block|{
name|gfloat
name|new_value
init|=
name|atof
argument_list|(
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|widget
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
name|vars
operator|.
name|scaling
operator|<
literal|0
condition|)
name|vars
operator|.
name|top
operator|=
operator|(
name|new_value
operator|+
literal|1.0
operator|/
literal|144
operator|)
operator|*
literal|72
operator|-
operator|(
name|image_height
operator|*
operator|-
literal|72.0
operator|/
name|vars
operator|.
name|scaling
operator|)
expr_stmt|;
else|else
name|vars
operator|.
name|top
operator|=
operator|(
name|new_value
operator|+
literal|1.0
operator|/
literal|144
operator|)
operator|*
literal|72
operator|-
name|print_height
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|widget
operator|==
name|right_entry
condition|)
block|{
name|gfloat
name|new_value
init|=
name|atof
argument_list|(
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|widget
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
name|vars
operator|.
name|scaling
operator|<
literal|0
condition|)
name|vars
operator|.
name|left
operator|=
operator|(
name|new_value
operator|+
literal|1.0
operator|/
literal|144
operator|)
operator|*
literal|72
operator|-
operator|(
name|image_width
operator|*
operator|-
literal|72.0
operator|/
name|vars
operator|.
name|scaling
operator|)
expr_stmt|;
else|else
name|vars
operator|.
name|left
operator|=
operator|(
name|new_value
operator|+
literal|1.0
operator|/
literal|144
operator|)
operator|*
literal|72
operator|-
name|print_width
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|widget
operator|==
name|recenter_button
condition|)
block|{
name|vars
operator|.
name|left
operator|=
operator|-
literal|1
expr_stmt|;
name|vars
operator|.
name|top
operator|=
operator|-
literal|1
expr_stmt|;
name|dontcheck
operator|=
name|TRUE
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|dontcheck
condition|)
block|{
if|if
condition|(
name|vars
operator|.
name|left
operator|<
literal|0
condition|)
name|vars
operator|.
name|left
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|top
operator|<
literal|0
condition|)
name|vars
operator|.
name|top
operator|=
literal|0
expr_stmt|;
block|}
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|left
operator|=
name|vars
operator|.
name|left
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|top
operator|=
name|vars
operator|.
name|top
expr_stmt|;
name|gimp_preview_update
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_plist_callback() - Update the current system printer...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_plist_callback (GtkWidget * widget,gpointer data)
name|gimp_plist_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gint
name|i
decl_stmt|;
name|plist_t
modifier|*
name|p
decl_stmt|;
name|plist_current
operator|=
operator|(
name|gint
operator|)
name|data
expr_stmt|;
name|p
operator|=
name|plist
operator|+
name|plist_current
expr_stmt|;
if|if
condition|(
name|p
operator|->
name|v
operator|.
name|driver
index|[
literal|0
index|]
operator|!=
literal|'\0'
condition|)
block|{
name|strcpy
argument_list|(
name|vars
operator|.
name|driver
argument_list|,
name|p
operator|->
name|v
operator|.
name|driver
argument_list|)
expr_stmt|;
name|current_printer
operator|=
name|get_printer_by_driver
argument_list|(
name|vars
operator|.
name|driver
argument_list|)
expr_stmt|;
block|}
name|strcpy
argument_list|(
name|vars
operator|.
name|ppd_file
argument_list|,
name|p
operator|->
name|v
operator|.
name|ppd_file
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|vars
operator|.
name|media_size
argument_list|,
name|p
operator|->
name|v
operator|.
name|media_size
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|vars
operator|.
name|media_type
argument_list|,
name|p
operator|->
name|v
operator|.
name|media_type
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|vars
operator|.
name|media_source
argument_list|,
name|p
operator|->
name|v
operator|.
name|media_source
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|vars
operator|.
name|resolution
argument_list|,
name|p
operator|->
name|v
operator|.
name|resolution
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|vars
operator|.
name|output_to
argument_list|,
name|p
operator|->
name|v
operator|.
name|output_to
argument_list|)
expr_stmt|;
name|gimp_do_misc_updates
argument_list|()
expr_stmt|;
comment|/*    * Now get option parameters...    */
if|if
condition|(
name|num_media_sizes
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_media_sizes
condition|;
name|i
operator|++
control|)
name|free
argument_list|(
name|media_sizes
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|media_sizes
argument_list|)
expr_stmt|;
block|}
name|media_sizes
operator|=
operator|(
operator|*
operator|(
name|current_printer
operator|->
name|parameters
operator|)
operator|)
operator|(
name|current_printer
operator|->
name|model
operator|,
name|p
operator|->
name|v
operator|.
name|ppd_file
operator|,
literal|"PageSize"
operator|,
operator|&
name|num_media_sizes
operator|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|media_size
index|[
literal|0
index|]
operator|==
literal|'\0'
condition|)
name|strcpy
argument_list|(
name|vars
operator|.
name|media_size
argument_list|,
name|media_sizes
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|gimp_plist_build_menu
argument_list|(
name|media_size
argument_list|,
operator|&
name|media_size_menu
argument_list|,
name|num_media_sizes
argument_list|,
name|media_sizes
argument_list|,
name|p
operator|->
name|v
operator|.
name|media_size
argument_list|,
name|gimp_media_size_callback
argument_list|)
expr_stmt|;
if|if
condition|(
name|num_media_types
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_media_types
condition|;
name|i
operator|++
control|)
name|free
argument_list|(
name|media_types
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|media_types
argument_list|)
expr_stmt|;
block|}
name|media_types
operator|=
operator|(
operator|*
operator|(
name|current_printer
operator|->
name|parameters
operator|)
operator|)
operator|(
name|current_printer
operator|->
name|model
operator|,
name|p
operator|->
name|v
operator|.
name|ppd_file
operator|,
literal|"MediaType"
operator|,
operator|&
name|num_media_types
operator|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|media_type
index|[
literal|0
index|]
operator|==
literal|'\0'
operator|&&
name|media_types
operator|!=
name|NULL
condition|)
name|strcpy
argument_list|(
name|vars
operator|.
name|media_type
argument_list|,
name|media_types
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|gimp_plist_build_menu
argument_list|(
name|media_type
argument_list|,
operator|&
name|media_type_menu
argument_list|,
name|num_media_types
argument_list|,
name|media_types
argument_list|,
name|p
operator|->
name|v
operator|.
name|media_type
argument_list|,
name|gimp_media_type_callback
argument_list|)
expr_stmt|;
if|if
condition|(
name|num_media_sources
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_media_sources
condition|;
name|i
operator|++
control|)
name|free
argument_list|(
name|media_sources
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|media_sources
argument_list|)
expr_stmt|;
block|}
name|media_sources
operator|=
operator|(
operator|*
operator|(
name|current_printer
operator|->
name|parameters
operator|)
operator|)
operator|(
name|current_printer
operator|->
name|model
operator|,
name|p
operator|->
name|v
operator|.
name|ppd_file
operator|,
literal|"InputSlot"
operator|,
operator|&
name|num_media_sources
operator|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|media_source
index|[
literal|0
index|]
operator|==
literal|'\0'
operator|&&
name|media_sources
operator|!=
name|NULL
condition|)
name|strcpy
argument_list|(
name|vars
operator|.
name|media_source
argument_list|,
name|media_sources
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|gimp_plist_build_menu
argument_list|(
name|media_source
argument_list|,
operator|&
name|media_source_menu
argument_list|,
name|num_media_sources
argument_list|,
name|media_sources
argument_list|,
name|p
operator|->
name|v
operator|.
name|media_source
argument_list|,
name|gimp_media_source_callback
argument_list|)
expr_stmt|;
if|if
condition|(
name|num_resolutions
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_resolutions
condition|;
name|i
operator|++
control|)
name|free
argument_list|(
name|resolutions
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|free
argument_list|(
name|resolutions
argument_list|)
expr_stmt|;
block|}
name|resolutions
operator|=
operator|(
operator|*
operator|(
name|current_printer
operator|->
name|parameters
operator|)
operator|)
operator|(
name|current_printer
operator|->
name|model
operator|,
name|p
operator|->
name|v
operator|.
name|ppd_file
operator|,
literal|"Resolution"
operator|,
operator|&
name|num_resolutions
operator|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|resolution
index|[
literal|0
index|]
operator|==
literal|'\0'
operator|&&
name|resolutions
operator|!=
name|NULL
condition|)
name|strcpy
argument_list|(
name|vars
operator|.
name|resolution
argument_list|,
name|resolutions
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|gimp_plist_build_menu
argument_list|(
name|resolution
argument_list|,
operator|&
name|resolution_menu
argument_list|,
name|num_resolutions
argument_list|,
name|resolutions
argument_list|,
name|p
operator|->
name|v
operator|.
name|resolution
argument_list|,
name|gimp_resolution_callback
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_media_size_callback() - Update the current media size...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_media_size_callback (GtkWidget * widget,gpointer data)
name|gimp_media_size_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|strcpy
argument_list|(
name|vars
operator|.
name|media_size
argument_list|,
name|media_sizes
index|[
operator|(
name|gint
operator|)
name|data
index|]
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|media_size
argument_list|,
name|media_sizes
index|[
operator|(
name|gint
operator|)
name|data
index|]
argument_list|)
expr_stmt|;
name|vars
operator|.
name|left
operator|=
operator|-
literal|1
expr_stmt|;
name|vars
operator|.
name|top
operator|=
operator|-
literal|1
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|left
operator|=
name|vars
operator|.
name|left
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|top
operator|=
name|vars
operator|.
name|top
expr_stmt|;
name|gimp_preview_update
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_media_type_callback() - Update the current media type...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_media_type_callback (GtkWidget * widget,gpointer data)
name|gimp_media_type_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|strcpy
argument_list|(
name|vars
operator|.
name|media_type
argument_list|,
name|media_types
index|[
operator|(
name|gint
operator|)
name|data
index|]
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|media_type
argument_list|,
name|media_types
index|[
operator|(
name|gint
operator|)
name|data
index|]
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_media_source_callback() - Update the current media source...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_media_source_callback (GtkWidget * widget,gpointer data)
name|gimp_media_source_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|strcpy
argument_list|(
name|vars
operator|.
name|media_source
argument_list|,
name|media_sources
index|[
operator|(
name|gint
operator|)
name|data
index|]
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|media_source
argument_list|,
name|media_sources
index|[
operator|(
name|gint
operator|)
name|data
index|]
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_resolution_callback() - Update the current resolution...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_resolution_callback (GtkWidget * widget,gpointer data)
name|gimp_resolution_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|strcpy
argument_list|(
name|vars
operator|.
name|resolution
argument_list|,
name|resolutions
index|[
operator|(
name|gint
operator|)
name|data
index|]
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|resolution
argument_list|,
name|resolutions
index|[
operator|(
name|gint
operator|)
name|data
index|]
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_orientation_callback() - Update the current media size...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_orientation_callback (GtkWidget * widget,gpointer data)
name|gimp_orientation_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|vars
operator|.
name|orientation
operator|=
operator|(
name|gint
operator|)
name|data
expr_stmt|;
name|vars
operator|.
name|left
operator|=
operator|-
literal|1
expr_stmt|;
name|vars
operator|.
name|top
operator|=
operator|-
literal|1
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|orientation
operator|=
name|vars
operator|.
name|orientation
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|left
operator|=
name|vars
operator|.
name|left
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|top
operator|=
name|vars
operator|.
name|top
expr_stmt|;
name|gimp_preview_update
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_output_type_callback() - Update the current output type...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_output_type_callback (GtkWidget * widget,gpointer data)
name|gimp_output_type_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
condition|)
block|{
name|vars
operator|.
name|output_type
operator|=
operator|(
name|gint
operator|)
name|data
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|output_type
operator|=
operator|(
name|gint
operator|)
name|data
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  *  gimp_linear_callback() - Update the current linear gradient mode...  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|DO_LINEAR
end_ifdef

begin_function
specifier|static
name|void
DECL|function|gimp_linear_callback (GtkWidget * widget,gpointer data)
name|gimp_linear_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
condition|)
block|{
name|vars
operator|.
name|linear
operator|=
operator|(
name|gint
operator|)
name|data
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|linear
operator|=
operator|(
name|gint
operator|)
name|data
expr_stmt|;
block|}
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/*  * 'print_callback()' - Start the print...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_print_callback (void)
name|gimp_print_callback
parameter_list|(
name|void
parameter_list|)
block|{
if|if
condition|(
name|plist_current
operator|>
literal|0
condition|)
block|{
name|runme
operator|=
name|TRUE
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|print_dialog
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gtk_widget_set_sensitive
argument_list|(
name|print_dialog
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|file_browser
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  *  gimp_printandsave_callback() -   */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_printandsave_callback (void)
name|gimp_printandsave_callback
parameter_list|(
name|void
parameter_list|)
block|{
name|saveme
operator|=
name|TRUE
expr_stmt|;
if|if
condition|(
name|plist_current
operator|>
literal|0
condition|)
block|{
name|runme
operator|=
name|TRUE
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|print_dialog
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gtk_widget_set_sensitive
argument_list|(
name|print_dialog
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|file_browser
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  *  gimp_save_callback() - save settings, don't destroy dialog  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_save_callback (void)
name|gimp_save_callback
parameter_list|(
name|void
parameter_list|)
block|{
name|printrc_save
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_setup_open__callback() -   */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_setup_open_callback (void)
name|gimp_setup_open_callback
parameter_list|(
name|void
parameter_list|)
block|{
name|gint
name|idx
decl_stmt|;
name|current_printer
operator|=
name|get_printer_by_driver
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|driver
argument_list|)
expr_stmt|;
name|idx
operator|=
name|get_printer_index_by_driver
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|driver
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|printer_driver
argument_list|)
argument_list|,
name|idx
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|ppd_file
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|ppd_file
argument_list|)
expr_stmt|;
if|if
condition|(
name|strncmp
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|driver
argument_list|,
literal|"ps"
argument_list|,
literal|2
argument_list|)
operator|==
literal|0
condition|)
name|gtk_widget_show
argument_list|(
name|ppd_file
argument_list|)
expr_stmt|;
else|else
name|gtk_widget_show
argument_list|(
name|ppd_file
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|output_cmd
argument_list|)
argument_list|,
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|output_to
argument_list|)
expr_stmt|;
if|if
condition|(
name|plist_current
operator|==
literal|0
condition|)
name|gtk_widget_hide
argument_list|(
name|output_cmd
argument_list|)
expr_stmt|;
else|else
name|gtk_widget_show
argument_list|(
name|output_cmd
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|setup_dialog
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_setup_ok_callback() -   */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_setup_ok_callback (void)
name|gimp_setup_ok_callback
parameter_list|(
name|void
parameter_list|)
block|{
name|strcpy
argument_list|(
name|vars
operator|.
name|driver
argument_list|,
name|current_printer
operator|->
name|driver
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|driver
argument_list|,
name|current_printer
operator|->
name|driver
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|vars
operator|.
name|output_to
argument_list|,
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|output_cmd
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|output_to
argument_list|,
name|vars
operator|.
name|output_to
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|vars
operator|.
name|ppd_file
argument_list|,
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|ppd_file
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|ppd_file
argument_list|,
name|vars
operator|.
name|ppd_file
argument_list|)
expr_stmt|;
name|gimp_plist_callback
argument_list|(
name|NULL
argument_list|,
operator|(
name|gpointer
operator|)
name|plist_current
argument_list|)
expr_stmt|;
name|gtk_widget_hide
argument_list|(
name|setup_dialog
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_print_driver_callback() - Update the current printer driver...  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_print_driver_callback (GtkWidget * widget,gpointer data)
name|gimp_print_driver_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|current_printer
operator|=
name|get_printer_by_index
argument_list|(
operator|(
name|gint
operator|)
name|data
argument_list|)
expr_stmt|;
if|if
condition|(
name|strncmp
argument_list|(
name|current_printer
operator|->
name|driver
argument_list|,
literal|"ps"
argument_list|,
literal|2
argument_list|)
operator|==
literal|0
condition|)
block|{
name|gtk_widget_show
argument_list|(
name|ppd_file
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|ppd_button
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gtk_widget_hide
argument_list|(
name|ppd_file
argument_list|)
expr_stmt|;
name|gtk_widget_hide
argument_list|(
name|ppd_button
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*  *  gimp_ppd_browse_callback() -   */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_ppd_browse_callback (void)
name|gimp_ppd_browse_callback
parameter_list|(
name|void
parameter_list|)
block|{
name|gtk_file_selection_set_filename
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|ppd_browser
argument_list|)
argument_list|,
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|ppd_file
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|ppd_browser
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_ppd_ok_callback() -   */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_ppd_ok_callback (void)
name|gimp_ppd_ok_callback
parameter_list|(
name|void
parameter_list|)
block|{
name|gtk_widget_hide
argument_list|(
name|ppd_browser
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|ppd_file
argument_list|)
argument_list|,
name|gtk_file_selection_get_filename
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|ppd_browser
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_file_ok_callback() - print to file and go away  */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_file_ok_callback (void)
name|gimp_file_ok_callback
parameter_list|(
name|void
parameter_list|)
block|{
name|gtk_widget_hide
argument_list|(
name|file_browser
argument_list|)
expr_stmt|;
name|strcpy
argument_list|(
name|vars
operator|.
name|output_to
argument_list|,
name|gtk_file_selection_get_filename
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|file_browser
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|runme
operator|=
name|TRUE
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|print_dialog
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_file_cancel_callback() -   */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_file_cancel_callback (void)
name|gimp_file_cancel_callback
parameter_list|(
name|void
parameter_list|)
block|{
name|gtk_widget_hide
argument_list|(
name|file_browser
argument_list|)
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|print_dialog
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_preview_update_callback() -   */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_preview_update (void)
name|gimp_preview_update
parameter_list|(
name|void
parameter_list|)
block|{
name|gint
name|temp
decl_stmt|;
name|gint
name|orient
decl_stmt|;
comment|/* True orientation of page */
name|gint
name|tw0
decl_stmt|,
name|tw1
decl_stmt|;
comment|/* Temporary page_widths */
name|gint
name|th0
decl_stmt|,
name|th1
decl_stmt|;
comment|/* Temporary page_heights */
name|gint
name|ta0
init|=
literal|0
decl_stmt|,
name|ta1
init|=
literal|0
decl_stmt|;
comment|/* Temporary areas */
name|gint
name|left
decl_stmt|,
name|right
decl_stmt|;
comment|/* Imageable area */
name|gint
name|top
decl_stmt|,
name|bottom
decl_stmt|;
name|gint
name|width
decl_stmt|,
name|length
decl_stmt|;
comment|/* Physical width */
specifier|static
name|GdkGC
modifier|*
name|gc
init|=
name|NULL
decl_stmt|;
name|gchar
name|s
index|[
literal|255
index|]
decl_stmt|;
if|if
condition|(
name|preview
operator|->
name|widget
operator|.
name|window
operator|==
name|NULL
condition|)
return|return;
name|gdk_window_clear
argument_list|(
name|preview
operator|->
name|widget
operator|.
name|window
argument_list|)
expr_stmt|;
if|if
condition|(
name|gc
operator|==
name|NULL
condition|)
name|gc
operator|=
name|gdk_gc_new
argument_list|(
name|preview
operator|->
name|widget
operator|.
name|window
argument_list|)
expr_stmt|;
call|(
modifier|*
name|current_printer
operator|->
name|imageable_area
call|)
argument_list|(
name|current_printer
operator|->
name|model
argument_list|,
name|vars
operator|.
name|ppd_file
argument_list|,
name|vars
operator|.
name|media_size
argument_list|,
operator|&
name|left
argument_list|,
operator|&
name|right
argument_list|,
operator|&
name|bottom
argument_list|,
operator|&
name|top
argument_list|)
expr_stmt|;
name|page_width
operator|=
name|right
operator|-
name|left
expr_stmt|;
name|page_height
operator|=
name|top
operator|-
name|bottom
expr_stmt|;
call|(
modifier|*
name|current_printer
operator|->
name|media_size
call|)
argument_list|(
name|current_printer
operator|->
name|model
argument_list|,
name|vars
operator|.
name|ppd_file
argument_list|,
name|vars
operator|.
name|media_size
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|length
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|scaling
operator|<
literal|0
condition|)
block|{
name|tw0
operator|=
literal|72
operator|*
operator|-
name|image_width
operator|/
name|vars
operator|.
name|scaling
expr_stmt|;
name|th0
operator|=
name|tw0
operator|*
name|image_height
operator|/
name|image_width
expr_stmt|;
name|tw1
operator|=
name|tw0
expr_stmt|;
name|th1
operator|=
name|th0
expr_stmt|;
block|}
else|else
block|{
comment|/* Portrait */
name|tw0
operator|=
name|page_width
operator|*
name|vars
operator|.
name|scaling
operator|/
literal|100
expr_stmt|;
name|th0
operator|=
name|tw0
operator|*
name|image_height
operator|/
name|image_width
expr_stmt|;
if|if
condition|(
name|th0
operator|>
name|page_height
operator|*
name|vars
operator|.
name|scaling
operator|/
literal|100
condition|)
block|{
name|th0
operator|=
name|page_height
operator|*
name|vars
operator|.
name|scaling
operator|/
literal|100
expr_stmt|;
name|tw0
operator|=
name|th0
operator|*
name|image_width
operator|/
name|image_height
expr_stmt|;
block|}
name|ta0
operator|=
name|tw0
operator|*
name|th0
expr_stmt|;
comment|/* Landscape */
name|tw1
operator|=
name|page_height
operator|*
name|vars
operator|.
name|scaling
operator|/
literal|100
expr_stmt|;
name|th1
operator|=
name|tw1
operator|*
name|image_height
operator|/
name|image_width
expr_stmt|;
if|if
condition|(
name|th1
operator|>
name|page_width
operator|*
name|vars
operator|.
name|scaling
operator|/
literal|100
condition|)
block|{
name|th1
operator|=
name|page_width
operator|*
name|vars
operator|.
name|scaling
operator|/
literal|100
expr_stmt|;
name|tw1
operator|=
name|th1
operator|*
name|image_width
operator|/
name|image_height
expr_stmt|;
block|}
name|ta1
operator|=
name|tw1
operator|*
name|th1
expr_stmt|;
block|}
if|if
condition|(
name|vars
operator|.
name|orientation
operator|==
name|ORIENT_AUTO
condition|)
block|{
if|if
condition|(
name|vars
operator|.
name|scaling
operator|<
literal|0
condition|)
block|{
if|if
condition|(
operator|(
name|page_width
operator|>
name|page_height
operator|&&
name|tw0
operator|>
name|th0
operator|)
operator|||
operator|(
name|page_height
operator|>
name|page_width
operator|&&
name|th0
operator|>
name|tw0
operator|)
condition|)
block|{
name|orient
operator|=
name|ORIENT_PORTRAIT
expr_stmt|;
if|if
condition|(
name|tw0
operator|>
name|page_width
condition|)
block|{
name|vars
operator|.
name|scaling
operator|*=
operator|(
name|double
operator|)
name|page_width
operator|/
operator|(
name|double
operator|)
name|tw0
expr_stmt|;
name|th0
operator|=
name|th0
operator|*
name|page_width
operator|/
name|tw0
expr_stmt|;
block|}
if|if
condition|(
name|th0
operator|>
name|page_height
condition|)
block|{
name|vars
operator|.
name|scaling
operator|*=
operator|(
name|double
operator|)
name|page_height
operator|/
operator|(
name|double
operator|)
name|th0
expr_stmt|;
name|tw0
operator|=
name|tw0
operator|*
name|page_height
operator|/
name|th0
expr_stmt|;
block|}
block|}
else|else
block|{
name|orient
operator|=
name|ORIENT_LANDSCAPE
expr_stmt|;
if|if
condition|(
name|tw1
operator|>
name|page_height
condition|)
block|{
name|vars
operator|.
name|scaling
operator|*=
operator|(
name|double
operator|)
name|page_height
operator|/
operator|(
name|double
operator|)
name|tw1
expr_stmt|;
name|th1
operator|=
name|th1
operator|*
name|page_height
operator|/
name|tw1
expr_stmt|;
block|}
if|if
condition|(
name|th1
operator|>
name|page_width
condition|)
block|{
name|vars
operator|.
name|scaling
operator|*=
operator|(
name|double
operator|)
name|page_width
operator|/
operator|(
name|double
operator|)
name|th1
expr_stmt|;
name|tw1
operator|=
name|tw1
operator|*
name|page_width
operator|/
name|th1
expr_stmt|;
block|}
block|}
block|}
else|else
block|{
if|if
condition|(
name|ta0
operator|>=
name|ta1
condition|)
name|orient
operator|=
name|ORIENT_PORTRAIT
expr_stmt|;
else|else
name|orient
operator|=
name|ORIENT_LANDSCAPE
expr_stmt|;
block|}
block|}
else|else
block|{
name|orient
operator|=
name|vars
operator|.
name|orientation
expr_stmt|;
block|}
if|if
condition|(
name|orient
operator|==
name|ORIENT_LANDSCAPE
condition|)
block|{
name|temp
operator|=
name|page_width
expr_stmt|;
name|page_width
operator|=
name|page_height
expr_stmt|;
name|page_height
operator|=
name|temp
expr_stmt|;
name|temp
operator|=
name|width
expr_stmt|;
name|width
operator|=
name|length
expr_stmt|;
name|length
operator|=
name|temp
expr_stmt|;
name|print_width
operator|=
name|tw1
expr_stmt|;
name|print_height
operator|=
name|th1
expr_stmt|;
block|}
else|else
block|{
name|print_width
operator|=
name|tw0
expr_stmt|;
name|print_height
operator|=
name|th0
expr_stmt|;
block|}
name|page_left
operator|=
operator|(
name|PREVIEW_SIZE_HORIZ
operator|-
literal|10
operator|*
name|page_width
operator|/
literal|72
operator|)
operator|/
literal|2
expr_stmt|;
name|page_top
operator|=
operator|(
name|PREVIEW_SIZE_VERT
operator|-
literal|10
operator|*
name|page_height
operator|/
literal|72
operator|)
operator|/
literal|2
expr_stmt|;
name|gdk_draw_rectangle
argument_list|(
name|preview
operator|->
name|widget
operator|.
name|window
argument_list|,
name|gc
argument_list|,
literal|0
argument_list|,
operator|(
name|PREVIEW_SIZE_HORIZ
operator|-
operator|(
literal|10
operator|*
name|width
operator|/
literal|72
operator|)
operator|)
operator|/
literal|2
argument_list|,
operator|(
name|PREVIEW_SIZE_VERT
operator|-
operator|(
literal|10
operator|*
name|length
operator|/
literal|72
operator|)
operator|)
operator|/
literal|2
argument_list|,
literal|10
operator|*
name|width
operator|/
literal|72
argument_list|,
literal|10
operator|*
name|length
operator|/
literal|72
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|left
operator|<
literal|0
condition|)
name|vars
operator|.
name|left
operator|=
operator|(
name|page_width
operator|-
name|print_width
operator|)
operator|/
literal|2
expr_stmt|;
name|left
operator|=
name|vars
operator|.
name|left
expr_stmt|;
if|if
condition|(
name|left
operator|>
operator|(
name|page_width
operator|-
name|print_width
operator|)
condition|)
block|{
name|left
operator|=
name|page_width
operator|-
name|print_width
expr_stmt|;
name|vars
operator|.
name|left
operator|=
name|left
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|left
operator|=
name|vars
operator|.
name|left
expr_stmt|;
block|}
if|if
condition|(
name|vars
operator|.
name|top
operator|<
literal|0
condition|)
name|vars
operator|.
name|top
operator|=
operator|(
name|page_height
operator|-
name|print_height
operator|)
operator|/
literal|2
expr_stmt|;
name|top
operator|=
name|vars
operator|.
name|top
expr_stmt|;
if|if
condition|(
name|top
operator|>
operator|(
name|page_height
operator|-
name|print_height
operator|)
condition|)
block|{
name|top
operator|=
name|page_height
operator|-
name|print_height
expr_stmt|;
name|vars
operator|.
name|top
operator|=
name|top
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|top
operator|=
name|vars
operator|.
name|top
expr_stmt|;
block|}
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.2f"
argument_list|,
name|vars
operator|.
name|top
operator|/
literal|72.0
argument_list|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|top_entry
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|top_entry
argument_list|)
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|top_entry
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.2f"
argument_list|,
name|vars
operator|.
name|left
operator|/
literal|72.0
argument_list|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|left_entry
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|left_entry
argument_list|)
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|left_entry
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|bottom_entry
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|scaling
operator|<
literal|0
condition|)
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.2f"
argument_list|,
operator|(
name|vars
operator|.
name|top
operator|+
operator|(
name|image_height
operator|*
operator|-
literal|72.0
operator|/
name|vars
operator|.
name|scaling
operator|)
operator|)
operator|/
literal|72.0
argument_list|)
expr_stmt|;
else|else
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.2f"
argument_list|,
operator|(
name|vars
operator|.
name|top
operator|+
name|print_height
operator|)
operator|/
literal|72.0
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|bottom_entry
argument_list|)
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|bottom_entry
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|right_entry
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|scaling
operator|<
literal|0
condition|)
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.2f"
argument_list|,
operator|(
name|vars
operator|.
name|left
operator|+
operator|(
name|image_width
operator|*
operator|-
literal|72.0
operator|/
name|vars
operator|.
name|scaling
operator|)
operator|)
operator|/
literal|72.0
argument_list|)
expr_stmt|;
else|else
name|g_snprintf
argument_list|(
name|s
argument_list|,
sizeof|sizeof
argument_list|(
name|s
argument_list|)
argument_list|,
literal|"%.2f"
argument_list|,
operator|(
name|vars
operator|.
name|left
operator|+
name|print_width
operator|)
operator|/
literal|72.0
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|right_entry
argument_list|)
argument_list|,
name|s
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|right_entry
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gdk_draw_rectangle
argument_list|(
name|preview
operator|->
name|widget
operator|.
name|window
argument_list|,
name|gc
argument_list|,
literal|1
argument_list|,
name|page_left
operator|+
literal|10
operator|*
name|left
operator|/
literal|72
argument_list|,
name|page_top
operator|+
literal|10
operator|*
name|top
operator|/
literal|72
argument_list|,
literal|10
operator|*
name|print_width
operator|/
literal|72
argument_list|,
literal|10
operator|*
name|print_height
operator|/
literal|72
argument_list|)
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_preview_button_callback() -   */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_preview_button_callback (GtkWidget * widget,GdkEventButton * event,gpointer data)
name|gimp_preview_button_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEventButton
modifier|*
name|event
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|mouse_x
operator|=
name|event
operator|->
name|x
expr_stmt|;
name|mouse_y
operator|=
name|event
operator|->
name|y
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  *  gimp_preview_motion_callback() -   */
end_comment

begin_function
specifier|static
name|void
DECL|function|gimp_preview_motion_callback (GtkWidget * widget,GdkEventMotion * event,gpointer data)
name|gimp_preview_motion_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEventMotion
modifier|*
name|event
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
name|vars
operator|.
name|left
operator|<
literal|0
operator|||
name|vars
operator|.
name|top
operator|<
literal|0
condition|)
block|{
name|vars
operator|.
name|left
operator|=
literal|72
operator|*
operator|(
name|page_width
operator|-
name|print_width
operator|)
operator|/
literal|20
expr_stmt|;
name|vars
operator|.
name|top
operator|=
literal|72
operator|*
operator|(
name|page_height
operator|-
name|print_height
operator|)
operator|/
literal|20
expr_stmt|;
block|}
name|vars
operator|.
name|left
operator|+=
literal|72
operator|*
operator|(
name|event
operator|->
name|x
operator|-
name|mouse_x
operator|)
operator|/
literal|10
expr_stmt|;
name|vars
operator|.
name|top
operator|+=
literal|72
operator|*
operator|(
name|event
operator|->
name|y
operator|-
name|mouse_y
operator|)
operator|/
literal|10
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|left
operator|<
literal|0
condition|)
name|vars
operator|.
name|left
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|vars
operator|.
name|top
operator|<
literal|0
condition|)
name|vars
operator|.
name|top
operator|=
literal|0
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|left
operator|=
name|vars
operator|.
name|left
expr_stmt|;
name|plist
index|[
name|plist_current
index|]
operator|.
name|v
operator|.
name|top
operator|=
name|vars
operator|.
name|top
expr_stmt|;
name|gimp_preview_update
argument_list|()
expr_stmt|;
name|mouse_x
operator|=
name|event
operator|->
name|x
expr_stmt|;
name|mouse_y
operator|=
name|event
operator|->
name|y
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* ! GIMP_1_0 */
end_comment

end_unit

