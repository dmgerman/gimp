begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * This is a plug-in for GIMP.  *  * Generates clickable image maps.  *  * Copyright (C) 1998-2004 Maurits Rijk  m.rijk@chello.nl  *  * This program is free software: you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 3 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program.  If not, see<http://www.gnu.org/licenses/>.  *  */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_comment
comment|/* abs */
end_comment

begin_include
include|#
directive|include
file|<gtk/gtk.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimp.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimpui.h>
end_include

begin_include
include|#
directive|include
file|"imap_main.h"
end_include

begin_include
include|#
directive|include
file|"imap_misc.h"
end_include

begin_include
include|#
directive|include
file|"imap_object_popup.h"
end_include

begin_include
include|#
directive|include
file|"imap_rectangle.h"
end_include

begin_include
include|#
directive|include
file|"imap_stock.h"
end_include

begin_include
include|#
directive|include
file|"imap_table.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/stdplugins-intl.h"
end_include

begin_function_decl
specifier|static
name|gboolean
name|rectangle_is_valid
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|Object_t
modifier|*
name|rectangle_clone
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_assign
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|Object_t
modifier|*
name|des
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_normalize
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_draw
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|GdkWindow
modifier|*
name|window
parameter_list|,
name|GdkGC
modifier|*
name|gc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_draw_sashes
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|GdkWindow
modifier|*
name|window
parameter_list|,
name|GdkGC
modifier|*
name|gc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|MoveSashFunc_t
name|rectangle_near_sash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gboolean
name|rectangle_point_is_on
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_get_dimensions
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
modifier|*
name|x
parameter_list|,
name|gint
modifier|*
name|y
parameter_list|,
name|gint
modifier|*
name|width
parameter_list|,
name|gint
modifier|*
name|height
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_resize
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|percentage_x
parameter_list|,
name|gint
name|percentage_y
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_move
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gpointer
name|rectangle_create_info_widget
parameter_list|(
name|GtkWidget
modifier|*
name|frame
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_fill_info_tab
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_set_initial_focus
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_update
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_write_csim
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|param
parameter_list|,
name|OutputFunc_t
name|output
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_write_cern
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|param
parameter_list|,
name|OutputFunc_t
name|output
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rectangle_write_ncsa
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|param
parameter_list|,
name|OutputFunc_t
name|output
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
specifier|const
name|gchar
modifier|*
name|rectangle_get_stock_icon_name
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
DECL|variable|rectangle_class
specifier|static
name|ObjectClass_t
name|rectangle_class
init|=
block|{
name|N_
argument_list|(
literal|"_Rectangle"
argument_list|)
block|,
name|NULL
block|,
comment|/* info_dialog */
name|NULL
block|,
comment|/* icon */
name|NULL
block|,
comment|/* mask */
name|rectangle_is_valid
block|,
name|NULL
block|,
comment|/* rectangle_destruct */
name|rectangle_clone
block|,
name|rectangle_assign
block|,
name|rectangle_normalize
block|,
name|rectangle_draw
block|,
name|rectangle_draw_sashes
block|,
name|rectangle_near_sash
block|,
name|rectangle_point_is_on
block|,
name|rectangle_get_dimensions
block|,
name|rectangle_resize
block|,
name|rectangle_move
block|,
name|rectangle_create_info_widget
block|,
name|rectangle_fill_info_tab
block|,
comment|/* rectangle_update_info_widget */
name|rectangle_fill_info_tab
block|,
name|rectangle_set_initial_focus
block|,
name|rectangle_update
block|,
name|rectangle_write_csim
block|,
name|rectangle_write_cern
block|,
name|rectangle_write_ncsa
block|,
name|object_do_popup
block|,
name|rectangle_get_stock_icon_name
block|}
decl_stmt|;
end_decl_stmt

begin_function
name|Object_t
modifier|*
DECL|function|create_rectangle (gint x,gint y,gint width,gint height)
name|create_rectangle
parameter_list|(
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|gint
name|width
parameter_list|,
name|gint
name|height
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|g_new
argument_list|(
name|Rectangle_t
argument_list|,
literal|1
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|x
operator|=
name|x
expr_stmt|;
name|rectangle
operator|->
name|y
operator|=
name|y
expr_stmt|;
name|rectangle
operator|->
name|width
operator|=
name|width
expr_stmt|;
name|rectangle
operator|->
name|height
operator|=
name|height
expr_stmt|;
return|return
name|object_init
argument_list|(
operator|&
name|rectangle
operator|->
name|obj
argument_list|,
operator|&
name|rectangle_class
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|draw_any_rectangle (GdkWindow * window,GdkGC * gc,gint x,gint y,gint w,gint h)
name|draw_any_rectangle
parameter_list|(
name|GdkWindow
modifier|*
name|window
parameter_list|,
name|GdkGC
modifier|*
name|gc
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|gint
name|w
parameter_list|,
name|gint
name|h
parameter_list|)
block|{
if|if
condition|(
name|w
operator|<
literal|0
condition|)
block|{
name|x
operator|+=
name|w
expr_stmt|;
name|w
operator|=
operator|-
name|w
expr_stmt|;
block|}
if|if
condition|(
name|h
operator|<
literal|0
condition|)
block|{
name|y
operator|+=
name|h
expr_stmt|;
name|h
operator|=
operator|-
name|h
expr_stmt|;
block|}
name|draw_rectangle
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|FALSE
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|w
argument_list|,
name|h
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gboolean
DECL|function|rectangle_is_valid (Object_t * obj)
name|rectangle_is_valid
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
return|return
name|rectangle
operator|->
name|width
operator|&&
name|rectangle
operator|->
name|height
return|;
block|}
end_function

begin_function
specifier|static
name|Object_t
modifier|*
DECL|function|rectangle_clone (Object_t * obj)
name|rectangle_clone
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|Rectangle_t
modifier|*
name|clone
init|=
name|g_new
argument_list|(
name|Rectangle_t
argument_list|,
literal|1
argument_list|)
decl_stmt|;
name|clone
operator|->
name|x
operator|=
name|rectangle
operator|->
name|x
expr_stmt|;
name|clone
operator|->
name|y
operator|=
name|rectangle
operator|->
name|y
expr_stmt|;
name|clone
operator|->
name|width
operator|=
name|rectangle
operator|->
name|width
expr_stmt|;
name|clone
operator|->
name|height
operator|=
name|rectangle
operator|->
name|height
expr_stmt|;
return|return
operator|&
name|clone
operator|->
name|obj
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_assign (Object_t * obj,Object_t * des)
name|rectangle_assign
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|Object_t
modifier|*
name|des
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|src_rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|Rectangle_t
modifier|*
name|des_rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|des
argument_list|)
decl_stmt|;
name|des_rectangle
operator|->
name|x
operator|=
name|src_rectangle
operator|->
name|x
expr_stmt|;
name|des_rectangle
operator|->
name|y
operator|=
name|src_rectangle
operator|->
name|y
expr_stmt|;
name|des_rectangle
operator|->
name|width
operator|=
name|src_rectangle
operator|->
name|width
expr_stmt|;
name|des_rectangle
operator|->
name|height
operator|=
name|src_rectangle
operator|->
name|height
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_normalize (Object_t * obj)
name|rectangle_normalize
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
if|if
condition|(
name|rectangle
operator|->
name|width
operator|<
literal|0
condition|)
block|{
name|rectangle
operator|->
name|x
operator|+=
name|rectangle
operator|->
name|width
expr_stmt|;
name|rectangle
operator|->
name|width
operator|=
operator|-
name|rectangle
operator|->
name|width
expr_stmt|;
block|}
if|if
condition|(
name|rectangle
operator|->
name|height
operator|<
literal|0
condition|)
block|{
name|rectangle
operator|->
name|y
operator|+=
name|rectangle
operator|->
name|height
expr_stmt|;
name|rectangle
operator|->
name|height
operator|=
operator|-
name|rectangle
operator|->
name|height
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_draw (Object_t * obj,GdkWindow * window,GdkGC * gc)
name|rectangle_draw
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|GdkWindow
modifier|*
name|window
parameter_list|,
name|GdkGC
modifier|*
name|gc
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|draw_any_rectangle
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
argument_list|,
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|height
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_draw_sashes (Object_t * obj,GdkWindow * window,GdkGC * gc)
name|rectangle_draw_sashes
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|GdkWindow
modifier|*
name|window
parameter_list|,
name|GdkGC
modifier|*
name|gc
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|draw_sash
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
argument_list|)
expr_stmt|;
name|draw_sash
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
operator|/
literal|2
argument_list|,
name|rectangle
operator|->
name|y
argument_list|)
expr_stmt|;
name|draw_sash
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|y
argument_list|)
expr_stmt|;
name|draw_sash
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
operator|/
literal|2
argument_list|)
expr_stmt|;
name|draw_sash
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
operator|/
literal|2
argument_list|)
expr_stmt|;
name|draw_sash
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
argument_list|)
expr_stmt|;
name|draw_sash
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
operator|/
literal|2
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
argument_list|)
expr_stmt|;
name|draw_sash
argument_list|(
name|window
argument_list|,
name|gc
argument_list|,
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|MoveUpperSash (Object_t * obj,gint dx,gint dy)
name|MoveUpperSash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|y
operator|+=
name|dy
expr_stmt|;
name|rectangle
operator|->
name|height
operator|-=
name|dy
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|MoveLeftSash (Object_t * obj,gint dx,gint dy)
name|MoveLeftSash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|x
operator|+=
name|dx
expr_stmt|;
name|rectangle
operator|->
name|width
operator|-=
name|dx
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|MoveRightSash (Object_t * obj,gint dx,gint dy)
name|MoveRightSash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|width
operator|+=
name|dx
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|MoveLowerSash (Object_t * obj,gint dx,gint dy)
name|MoveLowerSash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|height
operator|+=
name|dy
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|MoveUpperLeftSash (Object_t * obj,gint dx,gint dy)
name|MoveUpperLeftSash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|x
operator|+=
name|dx
expr_stmt|;
name|rectangle
operator|->
name|y
operator|+=
name|dy
expr_stmt|;
name|rectangle
operator|->
name|width
operator|-=
name|dx
expr_stmt|;
name|rectangle
operator|->
name|height
operator|-=
name|dy
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|MoveUpperRightSash (Object_t * obj,gint dx,gint dy)
name|MoveUpperRightSash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|y
operator|+=
name|dy
expr_stmt|;
name|rectangle
operator|->
name|width
operator|+=
name|dx
expr_stmt|;
name|rectangle
operator|->
name|height
operator|-=
name|dy
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|MoveLowerLeftSash (Object_t * obj,gint dx,gint dy)
name|MoveLowerLeftSash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|x
operator|+=
name|dx
expr_stmt|;
name|rectangle
operator|->
name|width
operator|-=
name|dx
expr_stmt|;
name|rectangle
operator|->
name|height
operator|+=
name|dy
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|MoveLowerRightSash (Object_t * obj,gint dx,gint dy)
name|MoveLowerRightSash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|width
operator|+=
name|dx
expr_stmt|;
name|rectangle
operator|->
name|height
operator|+=
name|dy
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|MoveSashFunc_t
DECL|function|rectangle_near_sash (Object_t * obj,gint x,gint y)
name|rectangle_near_sash
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
if|if
condition|(
name|near_sash
argument_list|(
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
condition|)
return|return
name|MoveUpperLeftSash
return|;
elseif|else
if|if
condition|(
name|near_sash
argument_list|(
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
operator|/
literal|2
argument_list|,
name|rectangle
operator|->
name|y
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
condition|)
return|return
name|MoveUpperSash
return|;
elseif|else
if|if
condition|(
name|near_sash
argument_list|(
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|y
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
condition|)
return|return
name|MoveUpperRightSash
return|;
elseif|else
if|if
condition|(
name|near_sash
argument_list|(
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
operator|/
literal|2
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
condition|)
return|return
name|MoveLeftSash
return|;
elseif|else
if|if
condition|(
name|near_sash
argument_list|(
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
operator|/
literal|2
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
condition|)
return|return
name|MoveRightSash
return|;
elseif|else
if|if
condition|(
name|near_sash
argument_list|(
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
condition|)
return|return
name|MoveLowerLeftSash
return|;
elseif|else
if|if
condition|(
name|near_sash
argument_list|(
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
operator|/
literal|2
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
condition|)
return|return
name|MoveLowerSash
return|;
elseif|else
if|if
condition|(
name|near_sash
argument_list|(
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
condition|)
return|return
name|MoveLowerRightSash
return|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
name|gboolean
DECL|function|rectangle_point_is_on (Object_t * obj,gint x,gint y)
name|rectangle_point_is_on
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
return|return
name|x
operator|>=
name|rectangle
operator|->
name|x
operator|&&
name|x
operator|<=
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
operator|&&
name|y
operator|>=
name|rectangle
operator|->
name|y
operator|&&
name|y
operator|<=
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_get_dimensions (Object_t * obj,gint * x,gint * y,gint * width,gint * height)
name|rectangle_get_dimensions
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
modifier|*
name|x
parameter_list|,
name|gint
modifier|*
name|y
parameter_list|,
name|gint
modifier|*
name|width
parameter_list|,
name|gint
modifier|*
name|height
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
operator|*
name|x
operator|=
name|rectangle
operator|->
name|x
expr_stmt|;
operator|*
name|y
operator|=
name|rectangle
operator|->
name|y
expr_stmt|;
operator|*
name|width
operator|=
name|rectangle
operator|->
name|width
expr_stmt|;
operator|*
name|height
operator|=
name|rectangle
operator|->
name|height
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_resize (Object_t * obj,gint percentage_x,gint percentage_y)
name|rectangle_resize
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|percentage_x
parameter_list|,
name|gint
name|percentage_y
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|x
operator|=
name|rectangle
operator|->
name|x
operator|*
name|percentage_x
operator|/
literal|100
expr_stmt|;
name|rectangle
operator|->
name|y
operator|=
name|rectangle
operator|->
name|y
operator|*
name|percentage_y
operator|/
literal|100
expr_stmt|;
name|rectangle
operator|->
name|width
operator|=
name|rectangle
operator|->
name|width
operator|*
name|percentage_x
operator|/
literal|100
expr_stmt|;
name|rectangle
operator|->
name|height
operator|=
name|rectangle
operator|->
name|height
operator|*
name|percentage_y
operator|/
literal|100
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_move (Object_t * obj,gint dx,gint dy)
name|rectangle_move
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|dx
parameter_list|,
name|gint
name|dy
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|x
operator|+=
name|dx
expr_stmt|;
name|rectangle
operator|->
name|y
operator|+=
name|dy
expr_stmt|;
block|}
end_function

begin_typedef
DECL|struct|__anon28c7dbca0108
typedef|typedef
struct|struct
block|{
DECL|member|obj
name|Object_t
modifier|*
name|obj
decl_stmt|;
DECL|member|x
name|GtkWidget
modifier|*
name|x
decl_stmt|;
DECL|member|y
name|GtkWidget
modifier|*
name|y
decl_stmt|;
DECL|member|width
name|GtkWidget
modifier|*
name|width
decl_stmt|;
DECL|member|height
name|GtkWidget
modifier|*
name|height
decl_stmt|;
DECL|member|chain_button
name|GtkWidget
modifier|*
name|chain_button
decl_stmt|;
DECL|typedef|RectangleProperties_t
block|}
name|RectangleProperties_t
typedef|;
end_typedef

begin_function
specifier|static
name|void
DECL|function|x_changed_cb (GtkWidget * widget,gpointer data)
name|x_changed_cb
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|RectangleProperties_t
modifier|*
name|props
init|=
operator|(
name|RectangleProperties_t
operator|*
operator|)
name|data
decl_stmt|;
name|Object_t
modifier|*
name|obj
init|=
name|props
operator|->
name|obj
decl_stmt|;
name|gint
name|x
init|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|widget
argument_list|)
argument_list|)
decl_stmt|;
if|if
condition|(
name|gimp_chain_button_get_active
argument_list|(
name|GIMP_CHAIN_BUTTON
argument_list|(
name|props
operator|->
name|chain_button
argument_list|)
argument_list|)
condition|)
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|props
operator|->
name|y
argument_list|)
argument_list|,
name|x
argument_list|)
expr_stmt|;
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
operator|->
name|x
operator|=
name|x
expr_stmt|;
name|edit_area_info_dialog_emit_geometry_signal
argument_list|(
name|obj
operator|->
name|class
operator|->
name|info_dialog
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|y_changed_cb (GtkWidget * widget,gpointer data)
name|y_changed_cb
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|Object_t
modifier|*
name|obj
init|=
operator|(
operator|(
name|RectangleProperties_t
operator|*
operator|)
name|data
operator|)
operator|->
name|obj
decl_stmt|;
name|gint
name|y
init|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|widget
argument_list|)
argument_list|)
decl_stmt|;
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
operator|->
name|y
operator|=
name|y
expr_stmt|;
name|edit_area_info_dialog_emit_geometry_signal
argument_list|(
name|obj
operator|->
name|class
operator|->
name|info_dialog
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|width_changed_cb (GtkWidget * widget,gpointer data)
name|width_changed_cb
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|Object_t
modifier|*
name|obj
init|=
operator|(
operator|(
name|RectangleProperties_t
operator|*
operator|)
name|data
operator|)
operator|->
name|obj
decl_stmt|;
name|gint
name|width
init|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|widget
argument_list|)
argument_list|)
decl_stmt|;
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
operator|->
name|width
operator|=
name|width
expr_stmt|;
name|edit_area_info_dialog_emit_geometry_signal
argument_list|(
name|obj
operator|->
name|class
operator|->
name|info_dialog
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|height_changed_cb (GtkWidget * widget,gpointer data)
name|height_changed_cb
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|Object_t
modifier|*
name|obj
init|=
operator|(
operator|(
name|RectangleProperties_t
operator|*
operator|)
name|data
operator|)
operator|->
name|obj
decl_stmt|;
name|gint
name|height
init|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|widget
argument_list|)
argument_list|)
decl_stmt|;
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
operator|->
name|height
operator|=
name|height
expr_stmt|;
name|edit_area_info_dialog_emit_geometry_signal
argument_list|(
name|obj
operator|->
name|class
operator|->
name|info_dialog
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gpointer
DECL|function|rectangle_create_info_widget (GtkWidget * frame)
name|rectangle_create_info_widget
parameter_list|(
name|GtkWidget
modifier|*
name|frame
parameter_list|)
block|{
name|RectangleProperties_t
modifier|*
name|props
init|=
name|g_new
argument_list|(
name|RectangleProperties_t
argument_list|,
literal|1
argument_list|)
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|,
modifier|*
name|label
decl_stmt|,
modifier|*
name|chain_button
decl_stmt|;
name|gint
name|max_width
init|=
name|get_image_width
argument_list|()
decl_stmt|;
name|gint
name|max_height
init|=
name|get_image_height
argument_list|()
decl_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|4
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|label
operator|=
name|create_label_in_table
argument_list|(
name|table
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Upper left _x:"
argument_list|)
argument_list|)
expr_stmt|;
name|props
operator|->
name|x
operator|=
name|create_spin_button_in_table
argument_list|(
name|table
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|max_width
operator|-
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|props
operator|->
name|x
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|x_changed_cb
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|props
argument_list|)
expr_stmt|;
name|create_label_in_table
argument_list|(
name|table
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
name|_
argument_list|(
literal|"pixels"
argument_list|)
argument_list|)
expr_stmt|;
name|label
operator|=
name|create_label_in_table
argument_list|(
name|table
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Upper left _y:"
argument_list|)
argument_list|)
expr_stmt|;
name|props
operator|->
name|y
operator|=
name|create_spin_button_in_table
argument_list|(
name|table
argument_list|,
name|label
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|max_height
operator|-
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|props
operator|->
name|y
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|y_changed_cb
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|props
argument_list|)
expr_stmt|;
name|create_label_in_table
argument_list|(
name|table
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
name|_
argument_list|(
literal|"pixels"
argument_list|)
argument_list|)
expr_stmt|;
name|label
operator|=
name|create_label_in_table
argument_list|(
name|table
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"_Width:"
argument_list|)
argument_list|)
expr_stmt|;
name|props
operator|->
name|width
operator|=
name|create_spin_button_in_table
argument_list|(
name|table
argument_list|,
name|label
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
name|max_width
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|props
operator|->
name|width
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|width_changed_cb
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|props
argument_list|)
expr_stmt|;
name|create_label_in_table
argument_list|(
name|table
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|_
argument_list|(
literal|"pixels"
argument_list|)
argument_list|)
expr_stmt|;
name|label
operator|=
name|create_label_in_table
argument_list|(
name|table
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"_Height:"
argument_list|)
argument_list|)
expr_stmt|;
name|props
operator|->
name|height
operator|=
name|create_spin_button_in_table
argument_list|(
name|table
argument_list|,
name|label
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
name|max_height
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|props
operator|->
name|height
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|height_changed_cb
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|props
argument_list|)
expr_stmt|;
name|create_label_in_table
argument_list|(
name|table
argument_list|,
literal|3
argument_list|,
literal|3
argument_list|,
name|_
argument_list|(
literal|"pixels"
argument_list|)
argument_list|)
expr_stmt|;
name|chain_button
operator|=
name|gimp_chain_button_new
argument_list|(
name|GIMP_CHAIN_RIGHT
argument_list|)
expr_stmt|;
name|props
operator|->
name|chain_button
operator|=
name|chain_button
expr_stmt|;
name|gtk_table_attach_defaults
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|chain_button
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|chain_button
argument_list|)
expr_stmt|;
return|return
name|props
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_fill_info_tab (Object_t * obj,gpointer data)
name|rectangle_fill_info_tab
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|RectangleProperties_t
modifier|*
name|props
init|=
operator|(
name|RectangleProperties_t
operator|*
operator|)
name|data
decl_stmt|;
name|props
operator|->
name|obj
operator|=
name|obj
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|props
operator|->
name|x
argument_list|)
argument_list|,
name|rectangle
operator|->
name|x
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|props
operator|->
name|y
argument_list|)
argument_list|,
name|rectangle
operator|->
name|y
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|props
operator|->
name|width
argument_list|)
argument_list|,
name|rectangle
operator|->
name|width
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|props
operator|->
name|height
argument_list|)
argument_list|,
name|rectangle
operator|->
name|height
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_set_initial_focus (Object_t * obj,gpointer data)
name|rectangle_set_initial_focus
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|RectangleProperties_t
modifier|*
name|props
init|=
operator|(
name|RectangleProperties_t
operator|*
operator|)
name|data
decl_stmt|;
name|gtk_widget_grab_focus
argument_list|(
name|props
operator|->
name|x
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_update (Object_t * obj,gpointer data)
name|rectangle_update
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|RectangleProperties_t
modifier|*
name|props
init|=
operator|(
name|RectangleProperties_t
operator|*
operator|)
name|data
decl_stmt|;
name|rectangle
operator|->
name|x
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|props
operator|->
name|x
argument_list|)
argument_list|)
expr_stmt|;
name|rectangle
operator|->
name|y
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|props
operator|->
name|y
argument_list|)
argument_list|)
expr_stmt|;
name|rectangle
operator|->
name|width
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|props
operator|->
name|width
argument_list|)
argument_list|)
expr_stmt|;
name|rectangle
operator|->
name|height
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|props
operator|->
name|height
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_write_csim (Object_t * obj,gpointer param,OutputFunc_t output)
name|rectangle_write_csim
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|param
parameter_list|,
name|OutputFunc_t
name|output
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|output
argument_list|(
name|param
argument_list|,
literal|"\"rect\" coords=\"%d,%d,%d,%d\""
argument_list|,
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
argument_list|,
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_write_cern (Object_t * obj,gpointer param,OutputFunc_t output)
name|rectangle_write_cern
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|param
parameter_list|,
name|OutputFunc_t
name|output
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|output
argument_list|(
name|param
argument_list|,
literal|"rect (%d,%d) (%d,%d)"
argument_list|,
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
argument_list|,
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_write_ncsa (Object_t * obj,gpointer param,OutputFunc_t output)
name|rectangle_write_ncsa
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gpointer
name|param
parameter_list|,
name|OutputFunc_t
name|output
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|output
argument_list|(
name|param
argument_list|,
literal|"rect %s %d,%d %d,%d"
argument_list|,
name|obj
operator|->
name|url
argument_list|,
name|rectangle
operator|->
name|x
argument_list|,
name|rectangle
operator|->
name|y
argument_list|,
name|rectangle
operator|->
name|x
operator|+
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|y
operator|+
name|rectangle
operator|->
name|height
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
specifier|const
name|gchar
modifier|*
DECL|function|rectangle_get_stock_icon_name (void)
name|rectangle_get_stock_icon_name
parameter_list|(
name|void
parameter_list|)
block|{
return|return
name|IMAP_STOCK_RECTANGLE
return|;
block|}
end_function

begin_function
specifier|static
name|gboolean
DECL|function|rectangle_factory_finish (Object_t * obj,gint x,gint y)
name|rectangle_factory_finish
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|width
operator|=
name|x
operator|-
name|rectangle
operator|->
name|x
expr_stmt|;
name|rectangle
operator|->
name|height
operator|=
name|y
operator|-
name|rectangle
operator|->
name|y
expr_stmt|;
name|rectangle_normalize
argument_list|(
name|obj
argument_list|)
expr_stmt|;
return|return
name|TRUE
return|;
block|}
end_function

begin_function
specifier|static
name|Object_t
modifier|*
DECL|function|rectangle_factory_create_object (gint x,gint y)
name|rectangle_factory_create_object
parameter_list|(
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|)
block|{
return|return
name|create_rectangle
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rectangle_factory_set_xy (Object_t * obj,guint state,gint x,gint y)
name|rectangle_factory_set_xy
parameter_list|(
name|Object_t
modifier|*
name|obj
parameter_list|,
name|guint
name|state
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|)
block|{
name|Rectangle_t
modifier|*
name|rectangle
init|=
name|ObjectToRectangle
argument_list|(
name|obj
argument_list|)
decl_stmt|;
name|rectangle
operator|->
name|width
operator|=
name|x
operator|-
name|rectangle
operator|->
name|x
expr_stmt|;
name|rectangle
operator|->
name|height
operator|=
name|y
operator|-
name|rectangle
operator|->
name|y
expr_stmt|;
if|if
condition|(
name|state
operator|&
name|GDK_SHIFT_MASK
condition|)
block|{
name|gint
name|width
init|=
name|abs
argument_list|(
name|rectangle
operator|->
name|width
argument_list|)
decl_stmt|;
name|gint
name|height
init|=
name|abs
argument_list|(
name|rectangle
operator|->
name|height
argument_list|)
decl_stmt|;
if|if
condition|(
name|width
operator|<
name|height
condition|)
name|rectangle
operator|->
name|height
operator|=
operator|(
name|rectangle
operator|->
name|height
operator|<
literal|0
operator|)
condition|?
operator|-
name|width
else|:
name|width
expr_stmt|;
else|else
name|rectangle
operator|->
name|width
operator|=
operator|(
name|rectangle
operator|->
name|width
operator|<
literal|0
operator|)
condition|?
operator|-
name|height
else|:
name|height
expr_stmt|;
block|}
name|main_set_dimension
argument_list|(
name|rectangle
operator|->
name|width
argument_list|,
name|rectangle
operator|->
name|height
argument_list|)
expr_stmt|;
block|}
end_function

begin_decl_stmt
DECL|variable|rectangle_factory
specifier|static
name|ObjectFactory_t
name|rectangle_factory
init|=
block|{
name|NULL
block|,
comment|/* Object pointer */
name|rectangle_factory_finish
block|,
name|NULL
block|,
comment|/* Cancel func */
name|rectangle_factory_create_object
block|,
name|rectangle_factory_set_xy
block|}
decl_stmt|;
end_decl_stmt

begin_function
name|ObjectFactory_t
modifier|*
DECL|function|get_rectangle_factory (guint state)
name|get_rectangle_factory
parameter_list|(
name|guint
name|state
parameter_list|)
block|{
return|return
operator|&
name|rectangle_factory
return|;
block|}
end_function

end_unit

