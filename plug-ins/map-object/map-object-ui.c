begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/**************************************************************/
end_comment

begin_comment
comment|/* Dialog creation and updaters, callbacks and event-handlers */
end_comment

begin_comment
comment|/**************************************************************/
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<libgimp/gimp.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimpui.h>
end_include

begin_include
include|#
directive|include
file|"arcball.h"
end_include

begin_include
include|#
directive|include
file|"map-object-ui.h"
end_include

begin_include
include|#
directive|include
file|"map-object-icons.h"
end_include

begin_include
include|#
directive|include
file|"map-object-image.h"
end_include

begin_include
include|#
directive|include
file|"map-object-apply.h"
end_include

begin_include
include|#
directive|include
file|"map-object-preview.h"
end_include

begin_include
include|#
directive|include
file|"map-object-main.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/stdplugins-intl.h"
end_include

begin_decl_stmt
DECL|variable|previewarea
name|GtkWidget
modifier|*
name|previewarea
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|appwin
specifier|static
name|GtkWidget
modifier|*
name|appwin
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|options_note_book
specifier|static
name|GtkNotebook
modifier|*
name|options_note_book
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|pointlightwid
specifier|static
name|GtkWidget
modifier|*
name|pointlightwid
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|dirlightwid
specifier|static
name|GtkWidget
modifier|*
name|dirlightwid
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|xadj
DECL|variable|yadj
DECL|variable|zadj
specifier|static
name|GtkAdjustment
modifier|*
name|xadj
decl_stmt|,
modifier|*
name|yadj
decl_stmt|,
modifier|*
name|zadj
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|box_page
specifier|static
name|GtkWidget
modifier|*
name|box_page
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|cylinder_page
specifier|static
name|GtkWidget
modifier|*
name|cylinder_page
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|left_button_pressed
specifier|static
name|guint
name|left_button_pressed
init|=
name|FALSE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|light_hit
specifier|static
name|guint
name|light_hit
init|=
name|FALSE
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|void
name|create_main_notebook
parameter_list|(
name|GtkWidget
modifier|*
name|container
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|preview_events
parameter_list|(
name|GtkWidget
modifier|*
name|area
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|update_light_pos_entries
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|double_adjustment_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|lightmenu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|preview_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|box_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|cylinder_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|create_options_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|create_light_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|create_material_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|create_orientation_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|create_box_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|create_cylinder_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/******************************************************/
end_comment

begin_comment
comment|/* Update angle& position (redraw grid if necessary) */
end_comment

begin_comment
comment|/******************************************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|double_adjustment_update (GtkAdjustment * adjustment,gpointer data)
name|double_adjustment_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gimp_double_adjustment_update
argument_list|(
name|adjustment
argument_list|,
name|data
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|livepreview
condition|)
name|compute_preview_image
argument_list|()
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|update_light_pos_entries (void)
name|update_light_pos_entries
parameter_list|(
name|void
parameter_list|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|xadj
argument_list|,
name|double_adjustment_update
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|xadj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|xadj
argument_list|,
name|double_adjustment_update
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|yadj
argument_list|,
name|double_adjustment_update
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|yadj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|yadj
argument_list|,
name|double_adjustment_update
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|zadj
argument_list|,
name|double_adjustment_update
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|zadj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|zadj
argument_list|,
name|double_adjustment_update
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/**********************/
end_comment

begin_comment
comment|/* Std. toggle update */
end_comment

begin_comment
comment|/**********************/
end_comment

begin_function
specifier|static
name|void
DECL|function|toggle_update (GtkWidget * widget,gpointer data)
name|toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gimp_toggle_button_update
argument_list|(
name|widget
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|compute_preview_image
argument_list|()
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*****************************************/
end_comment

begin_comment
comment|/* Main window light type menu callback. */
end_comment

begin_comment
comment|/*****************************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|lightmenu_callback (GtkWidget * widget,gpointer data)
name|lightmenu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|int
name|active
decl_stmt|;
name|gimp_int_combo_box_get_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|widget
argument_list|)
argument_list|,
operator|&
name|active
argument_list|)
expr_stmt|;
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|=
name|active
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|POINT_LIGHT
condition|)
block|{
name|gtk_widget_hide
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|DIRECTIONAL_LIGHT
condition|)
block|{
name|gtk_widget_hide
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gtk_widget_hide
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
name|gtk_widget_hide
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|mapvals
operator|.
name|livepreview
condition|)
block|{
name|compute_preview_image
argument_list|()
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/***************************************/
end_comment

begin_comment
comment|/* Main window map type menu callback. */
end_comment

begin_comment
comment|/***************************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|mapmenu_callback (GtkWidget * widget,gpointer data)
name|mapmenu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|int
name|active
decl_stmt|;
name|gimp_int_combo_box_get_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|widget
argument_list|)
argument_list|,
operator|&
name|active
argument_list|)
expr_stmt|;
name|mapvals
operator|.
name|maptype
operator|=
name|active
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|livepreview
condition|)
block|{
name|compute_preview_image
argument_list|()
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|mapvals
operator|.
name|maptype
operator|==
name|MAP_BOX
condition|)
block|{
if|if
condition|(
name|cylinder_page
operator|&&
name|gtk_widget_get_parent
argument_list|(
name|GTK_WIDGET
argument_list|(
name|cylinder_page
argument_list|)
argument_list|)
operator|==
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
condition|)
block|{
name|gtk_container_remove
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|options_note_book
argument_list|)
argument_list|,
name|cylinder_page
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|box_page
condition|)
block|{
name|box_page
operator|=
name|create_box_page
argument_list|()
expr_stmt|;
name|g_object_ref
argument_list|(
name|box_page
argument_list|)
expr_stmt|;
block|}
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|box_page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Box"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|mapvals
operator|.
name|maptype
operator|==
name|MAP_CYLINDER
condition|)
block|{
if|if
condition|(
name|box_page
operator|&&
name|gtk_widget_get_parent
argument_list|(
name|GTK_WIDGET
argument_list|(
name|box_page
argument_list|)
argument_list|)
operator|==
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
condition|)
block|{
name|gtk_container_remove
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|options_note_book
argument_list|)
argument_list|,
name|box_page
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|cylinder_page
condition|)
block|{
name|cylinder_page
operator|=
name|create_cylinder_page
argument_list|()
expr_stmt|;
name|g_object_ref
argument_list|(
name|cylinder_page
argument_list|)
expr_stmt|;
block|}
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|cylinder_page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"C_ylinder"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|box_page
operator|&&
name|gtk_widget_get_parent
argument_list|(
name|GTK_WIDGET
argument_list|(
name|box_page
argument_list|)
argument_list|)
operator|==
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
condition|)
block|{
name|gtk_container_remove
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|options_note_book
argument_list|)
argument_list|,
name|box_page
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|cylinder_page
operator|&&
name|gtk_widget_get_parent
argument_list|(
name|GTK_WIDGET
argument_list|(
name|cylinder_page
argument_list|)
argument_list|)
operator|==
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
condition|)
block|{
name|gtk_container_remove
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|options_note_book
argument_list|)
argument_list|,
name|cylinder_page
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_comment
comment|/******************************************/
end_comment

begin_comment
comment|/* Main window "Preview!" button callback */
end_comment

begin_comment
comment|/******************************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|preview_callback (GtkWidget * widget,gpointer data)
name|preview_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|compute_preview_image
argument_list|()
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|zoomed_callback (GimpZoomModel * model)
name|zoomed_callback
parameter_list|(
name|GimpZoomModel
modifier|*
name|model
parameter_list|)
block|{
name|mapvals
operator|.
name|zoom
operator|=
name|gimp_zoom_model_get_factor
argument_list|(
name|model
argument_list|)
expr_stmt|;
name|compute_preview_image
argument_list|()
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/**********************************************/
end_comment

begin_comment
comment|/* Main window "Apply" button callback.       */
end_comment

begin_comment
comment|/* Render to GIMP image, close down and exit. */
end_comment

begin_comment
comment|/**********************************************/
end_comment

begin_function
specifier|static
name|gint
DECL|function|box_constrain (gint32 image_id,gint32 drawable_id,gpointer data)
name|box_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
name|drawable_id
operator|==
operator|-
literal|1
condition|)
return|return
name|TRUE
return|;
return|return
operator|(
name|gimp_drawable_is_rgb
argument_list|(
name|drawable_id
argument_list|)
operator|&&
operator|!
name|gimp_drawable_is_indexed
argument_list|(
name|drawable_id
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|cylinder_constrain (gint32 image_id,gint32 drawable_id,gpointer data)
name|cylinder_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
name|drawable_id
operator|==
operator|-
literal|1
condition|)
return|return
name|TRUE
return|;
return|return
operator|(
name|gimp_drawable_is_rgb
argument_list|(
name|drawable_id
argument_list|)
operator|&&
operator|!
name|gimp_drawable_is_indexed
argument_list|(
name|drawable_id
argument_list|)
operator|)
return|;
block|}
end_function

begin_comment
comment|/******************************/
end_comment

begin_comment
comment|/* Preview area event handler */
end_comment

begin_comment
comment|/******************************/
end_comment

begin_function
specifier|static
name|gint
DECL|function|preview_events (GtkWidget * area,GdkEvent * event)
name|preview_events
parameter_list|(
name|GtkWidget
modifier|*
name|area
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|)
block|{
name|HVect
name|__attribute__
argument_list|(
operator|(
name|unused
operator|)
argument_list|)
name|pos
decl_stmt|;
comment|/*  HMatrix RotMat;   gdouble a,b,c; */
switch|switch
condition|(
name|event
operator|->
name|type
condition|)
block|{
case|case
name|GDK_ENTER_NOTIFY
case|:
break|break;
case|case
name|GDK_LEAVE_NOTIFY
case|:
break|break;
case|case
name|GDK_BUTTON_PRESS
case|:
name|light_hit
operator|=
name|check_light_hit
argument_list|(
name|event
operator|->
name|button
operator|.
name|x
argument_list|,
name|event
operator|->
name|button
operator|.
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|light_hit
operator|==
name|FALSE
condition|)
block|{
name|pos
operator|.
name|x
operator|=
operator|-
operator|(
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|button
operator|.
name|x
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_WIDTH
operator|-
literal|1.0
operator|)
expr_stmt|;
name|pos
operator|.
name|y
operator|=
operator|(
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|button
operator|.
name|y
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_HEIGHT
operator|-
literal|1.0
operator|)
expr_stmt|;
comment|/*ArcBall_Mouse(pos);             ArcBall_BeginDrag(); */
block|}
name|left_button_pressed
operator|=
name|TRUE
expr_stmt|;
break|break;
case|case
name|GDK_BUTTON_RELEASE
case|:
if|if
condition|(
name|light_hit
operator|==
name|TRUE
condition|)
block|{
name|compute_preview_image
argument_list|()
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|pos
operator|.
name|x
operator|=
operator|-
operator|(
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|button
operator|.
name|x
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_WIDTH
operator|-
literal|1.0
operator|)
expr_stmt|;
name|pos
operator|.
name|y
operator|=
operator|(
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|button
operator|.
name|y
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_HEIGHT
operator|-
literal|1.0
operator|)
expr_stmt|;
comment|/*ArcBall_Mouse(pos);             ArcBall_EndDrag(); */
block|}
name|left_button_pressed
operator|=
name|FALSE
expr_stmt|;
break|break;
case|case
name|GDK_MOTION_NOTIFY
case|:
if|if
condition|(
name|left_button_pressed
operator|==
name|TRUE
condition|)
block|{
if|if
condition|(
name|light_hit
operator|==
name|TRUE
condition|)
block|{
name|gint
name|live
init|=
name|mapvals
operator|.
name|livepreview
decl_stmt|;
name|mapvals
operator|.
name|livepreview
operator|=
name|FALSE
expr_stmt|;
name|update_light
argument_list|(
name|event
operator|->
name|motion
operator|.
name|x
argument_list|,
name|event
operator|->
name|motion
operator|.
name|y
argument_list|)
expr_stmt|;
name|update_light_pos_entries
argument_list|()
expr_stmt|;
name|mapvals
operator|.
name|livepreview
operator|=
name|live
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|pos
operator|.
name|x
operator|=
operator|-
operator|(
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|motion
operator|.
name|x
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_WIDTH
operator|-
literal|1.0
operator|)
expr_stmt|;
name|pos
operator|.
name|y
operator|=
operator|(
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|motion
operator|.
name|y
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_HEIGHT
operator|-
literal|1.0
operator|)
expr_stmt|;
comment|/*                ArcBall_Mouse(pos);                 ArcBall_Update();                 ArcBall_Values(&a,&b,&c);                 Alpha+=RadToDeg(-a);                 Beta+RadToDeg(-b);                 Gamma+=RadToDeg(-c);                 if (Alpha>180) Alpha-=360;                 if (Alpha<-180) Alpha+=360;                 if (Beta>180) Beta-=360;                 if (Beta<-180) Beta+=360;                 if (Gamma>180) Gamma-=360;                 if (Gamma<-180) Gamma+=360;                       UpdateAngleSliders(); */
block|}
block|}
break|break;
default|default:
break|break;
block|}
return|return
name|FALSE
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|spin_button_new (GtkAdjustment ** adjustment,gdouble value,gdouble lower,gdouble upper,gdouble step_increment,gdouble page_increment,gdouble page_size,gdouble climb_rate,guint digits)
name|spin_button_new
parameter_list|(
name|GtkAdjustment
modifier|*
modifier|*
name|adjustment
parameter_list|,
comment|/* return value */
name|gdouble
name|value
parameter_list|,
name|gdouble
name|lower
parameter_list|,
name|gdouble
name|upper
parameter_list|,
name|gdouble
name|step_increment
parameter_list|,
name|gdouble
name|page_increment
parameter_list|,
name|gdouble
name|page_size
parameter_list|,
name|gdouble
name|climb_rate
parameter_list|,
name|guint
name|digits
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|spinbutton
decl_stmt|;
operator|*
name|adjustment
operator|=
name|gtk_adjustment_new
argument_list|(
name|value
argument_list|,
name|lower
argument_list|,
name|upper
argument_list|,
name|step_increment
argument_list|,
name|page_increment
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|*
name|adjustment
argument_list|,
name|climb_rate
argument_list|,
name|digits
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|spinbutton
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
return|return
name|spinbutton
return|;
block|}
end_function

begin_comment
comment|/*******************************/
end_comment

begin_comment
comment|/* Create general options page */
end_comment

begin_comment
comment|/*******************************/
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_options_page (void)
name|create_options_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|combo
decl_stmt|;
name|GtkWidget
modifier|*
name|toggle
decl_stmt|;
name|GtkWidget
modifier|*
name|grid
decl_stmt|;
name|GtkWidget
modifier|*
name|spinbutton
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|page
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_VERTICAL
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
comment|/* General options */
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"General Options"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_VERTICAL
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_HORIZONTAL
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Map to:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|label
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|combo
operator|=
name|gimp_int_combo_box_new
argument_list|(
name|_
argument_list|(
literal|"Plane"
argument_list|)
argument_list|,
name|MAP_PLANE
argument_list|,
name|_
argument_list|(
literal|"Sphere"
argument_list|)
argument_list|,
name|MAP_SPHERE
argument_list|,
name|_
argument_list|(
literal|"Box"
argument_list|)
argument_list|,
name|MAP_BOX
argument_list|,
name|_
argument_list|(
literal|"Cylinder"
argument_list|)
argument_list|,
name|MAP_CYLINDER
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_int_combo_box_set_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|combo
argument_list|)
argument_list|,
name|mapvals
operator|.
name|maptype
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|combo
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|combo
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|combo
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|mapmenu_callback
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|maptype
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|combo
argument_list|,
name|_
argument_list|(
literal|"Type of object to map to"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Transparent background"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|transparent_background
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|toggle_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|transparent_background
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Make image transparent outside object"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Tile source image"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|tiled
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|toggle_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|tiled
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Tile source image: useful for infinite planes"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Create new image"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|create_new_image
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_toggle_button_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|create_new_image
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Create a new image when applying filter"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Create new layer"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|create_new_layer
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_toggle_button_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|create_new_layer
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Create a new layer when applying filter"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/* Antialiasing options */
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"Enable _antialiasing"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|antialiasing
argument_list|)
expr_stmt|;
name|gtk_frame_set_label_widget
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|toggle
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_toggle_button_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|antialiasing
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Enable/disable jagged edges removal "
literal|"(antialiasing)"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|grid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
name|g_object_bind_property
argument_list|(
name|toggle
argument_list|,
literal|"active"
argument_list|,
name|grid
argument_list|,
literal|"sensitive"
argument_list|,
name|G_BINDING_SYNC_CREATE
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"_Depth:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|maxdepth
argument_list|,
literal|1.0
argument_list|,
literal|5.0
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Antialiasing quality. Higher is better, "
literal|"but slower"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|maxdepth
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|pixelthreshold
argument_list|,
literal|0.001
argument_list|,
literal|1000
argument_list|,
literal|0.1
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"_Threshold:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|pixelthreshold
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Stop when pixel differences are smaller than "
literal|"this value"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/******************************/
end_comment

begin_comment
comment|/* Create light settings page */
end_comment

begin_comment
comment|/******************************/
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_light_page (void)
name|create_light_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|grid
decl_stmt|;
name|GtkWidget
modifier|*
name|combo
decl_stmt|;
name|GtkWidget
modifier|*
name|colorbutton
decl_stmt|;
name|GtkWidget
modifier|*
name|spinbutton
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|page
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_VERTICAL
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Light Settings"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|grid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
name|combo
operator|=
name|gimp_int_combo_box_new
argument_list|(
name|_
argument_list|(
literal|"Point light"
argument_list|)
argument_list|,
name|POINT_LIGHT
argument_list|,
name|_
argument_list|(
literal|"Directional light"
argument_list|)
argument_list|,
name|DIRECTIONAL_LIGHT
argument_list|,
name|_
argument_list|(
literal|"No light"
argument_list|)
argument_list|,
name|NO_LIGHT
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_int_combo_box_set_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|combo
argument_list|)
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|type
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Lightsource type:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|combo
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|combo
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|lightmenu_callback
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|type
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|combo
argument_list|,
name|_
argument_list|(
literal|"Type of light source to apply"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|colorbutton
operator|=
name|gimp_color_button_new
argument_list|(
name|_
argument_list|(
literal|"Select lightsource color"
argument_list|)
argument_list|,
literal|64
argument_list|,
literal|16
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|color
argument_list|,
name|GIMP_COLOR_AREA_FLAT
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Lightsource color:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|colorbutton
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|colorbutton
argument_list|,
literal|"color-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_color_button_get_color
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|color
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|colorbutton
argument_list|,
name|_
argument_list|(
literal|"Set light source color"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|pointlightwid
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Position"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|pointlightwid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|POINT_LIGHT
condition|)
name|gtk_widget_show
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|pointlightwid
argument_list|)
argument_list|,
name|grid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|xadj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|,
operator|-
name|G_MAXFLOAT
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"X:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|xadj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Light source X position in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|yadj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|,
operator|-
name|G_MAXFLOAT
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Y:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|yadj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Light source Y position in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|zadj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|,
operator|-
name|G_MAXFLOAT
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Z:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|zadj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Light source Z position in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|dirlightwid
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Direction Vector"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|dirlightwid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|DIRECTIONAL_LIGHT
condition|)
name|gtk_widget_show
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|dirlightwid
argument_list|)
argument_list|,
name|grid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|x
argument_list|,
operator|-
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"X:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|x
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Light source X direction in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|y
argument_list|,
operator|-
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Y:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|y
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Light source Y direction in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|z
argument_list|,
operator|-
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Z:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|z
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Light source Z direction in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/*********************************/
end_comment

begin_comment
comment|/* Create material settings page */
end_comment

begin_comment
comment|/*********************************/
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_material_page (void)
name|create_material_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkSizeGroup
modifier|*
name|group
init|=
name|gtk_size_group_new
argument_list|(
name|GTK_SIZE_GROUP_HORIZONTAL
argument_list|)
decl_stmt|;
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|grid
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|spinbutton
decl_stmt|;
name|GtkWidget
modifier|*
name|image
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|page
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_VERTICAL
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Intensity Levels"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_HORIZONTAL
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_widget_set_halign
argument_list|(
name|hbox
argument_list|,
name|GTK_ALIGN_START
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|grid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
comment|/* Ambient intensity */
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_INTENSITY_AMBIENT_LOW
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Ambient:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|image
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|ambient_int
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|ambient_int
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Amount of original color to show where no "
literal|"direct light falls"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_INTENSITY_AMBIENT_HIGH
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|image
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|image
argument_list|)
expr_stmt|;
comment|/* Diffuse intensity */
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_INTENSITY_DIFFUSE_LOW
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Diffuse:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|image
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|diffuse_int
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|diffuse_int
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Intensity of original color when lit by a light "
literal|"source"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_INTENSITY_DIFFUSE_HIGH
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|image
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|image
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Reflectivity"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_HORIZONTAL
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_widget_set_halign
argument_list|(
name|hbox
argument_list|,
name|GTK_ALIGN_START
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|grid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
comment|/* Diffuse reflection */
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_REFLECTIVITY_DIFFUSE_LOW
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Diffuse:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|image
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|diffuse_ref
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|diffuse_ref
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Higher values makes the object reflect more "
literal|"light (appear lighter)"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_REFLECTIVITY_DIFFUSE_HIGH
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|image
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|image
argument_list|)
expr_stmt|;
comment|/* Specular reflection */
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_REFLECTIVITY_SPECULAR_LOW
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Specular:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|image
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|specular_ref
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|specular_ref
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Controls how intense the highlights will be"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_REFLECTIVITY_SPECULAR_HIGH
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|image
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|image
argument_list|)
expr_stmt|;
comment|/* Highlight */
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_REFLECTIVITY_HIGHLIGHT_LOW
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Highlight:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|image
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|highlight
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|highlight
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Higher values makes the highlights more focused"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|image
operator|=
name|gtk_image_new_from_icon_name
argument_list|(
name|MAPOBJECT_REFLECTIVITY_HIGHLIGHT_HIGH
argument_list|,
name|GTK_ICON_SIZE_BUTTON
argument_list|)
expr_stmt|;
name|gtk_grid_attach
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
name|image
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|image
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
name|g_object_unref
argument_list|(
name|group
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/****************************************/
end_comment

begin_comment
comment|/* Create orientation and position page */
end_comment

begin_comment
comment|/****************************************/
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_orientation_page (void)
name|create_orientation_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkSizeGroup
modifier|*
name|group
init|=
name|gtk_size_group_new
argument_list|(
name|GTK_SIZE_GROUP_HORIZONTAL
argument_list|)
decl_stmt|;
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|grid
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|page
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_VERTICAL
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Position"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|grid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"X:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|position
operator|.
name|x
argument_list|,
operator|-
literal|1.0
argument_list|,
literal|2.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|5
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Object X position in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_spin_button_configure
argument_list|(
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON_ADJ
argument_list|(
name|adj
argument_list|)
argument_list|,
literal|0.01
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|position
operator|.
name|x
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Y:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|position
operator|.
name|y
argument_list|,
operator|-
literal|1.0
argument_list|,
literal|2.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|5
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Object Y position in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_spin_button_configure
argument_list|(
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON_ADJ
argument_list|(
name|adj
argument_list|)
argument_list|,
literal|0.01
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|position
operator|.
name|y
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Z:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|position
operator|.
name|z
argument_list|,
operator|-
literal|1.0
argument_list|,
literal|2.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|5
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Object Z position in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_spin_button_configure
argument_list|(
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON_ADJ
argument_list|(
name|adj
argument_list|)
argument_list|,
literal|0.01
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|position
operator|.
name|z
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Rotation"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|grid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"X:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|alpha
argument_list|,
operator|-
literal|180.0
argument_list|,
literal|180.0
argument_list|,
literal|1.0
argument_list|,
literal|15.0
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Rotation angle about X axis"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|alpha
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Y:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|beta
argument_list|,
operator|-
literal|180.0
argument_list|,
literal|180.0
argument_list|,
literal|1.0
argument_list|,
literal|15.0
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Rotation angle about Y axis"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|beta
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Z:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|gamma
argument_list|,
operator|-
literal|180.0
argument_list|,
literal|180.0
argument_list|,
literal|1.0
argument_list|,
literal|15.0
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Rotation angle about Z axis"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|gamma
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
name|g_object_unref
argument_list|(
name|group
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_box_page (void)
name|create_box_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|grid
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|gint
name|i
decl_stmt|;
specifier|static
name|gchar
modifier|*
name|labels
index|[]
init|=
block|{
name|N_
argument_list|(
literal|"Front:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Back:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Top:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Bottom:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Left:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Right:"
argument_list|)
block|}
decl_stmt|;
name|page
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_VERTICAL
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Map Images to Box Faces"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_VERTICAL
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|grid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|6
condition|;
name|i
operator|++
control|)
block|{
name|GtkWidget
modifier|*
name|combo
decl_stmt|;
name|combo
operator|=
name|gimp_drawable_combo_box_new
argument_list|(
name|box_constrain
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_int_combo_box_connect
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|combo
argument_list|)
argument_list|,
name|mapvals
operator|.
name|boxmap_id
index|[
name|i
index|]
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_int_combo_box_get_active
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|boxmap_id
index|[
name|i
index|]
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
name|i
argument_list|,
name|gettext
argument_list|(
name|labels
index|[
name|i
index|]
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|combo
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
comment|/* Scale scales */
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|grid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Scale X:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|scale
operator|.
name|x
argument_list|,
literal|0.0
argument_list|,
literal|5.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"X scale (size)"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_spin_button_configure
argument_list|(
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON_ADJ
argument_list|(
name|adj
argument_list|)
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|scale
operator|.
name|x
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Y:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|scale
operator|.
name|y
argument_list|,
literal|0.0
argument_list|,
literal|5.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Y scale (size)"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_spin_button_configure
argument_list|(
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON_ADJ
argument_list|(
name|adj
argument_list|)
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|scale
operator|.
name|y
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Z:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|scale
operator|.
name|z
argument_list|,
literal|0.0
argument_list|,
literal|5.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Z scale (size)"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_spin_button_configure
argument_list|(
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON_ADJ
argument_list|(
name|adj
argument_list|)
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|scale
operator|.
name|z
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_cylinder_page (void)
name|create_cylinder_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkSizeGroup
modifier|*
name|group
init|=
name|gtk_size_group_new
argument_list|(
name|GTK_SIZE_GROUP_HORIZONTAL
argument_list|)
decl_stmt|;
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|grid
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|gint
name|i
decl_stmt|;
specifier|static
specifier|const
name|gchar
modifier|*
name|labels
index|[]
init|=
block|{
name|N_
argument_list|(
literal|"_Top:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"_Bottom:"
argument_list|)
block|}
decl_stmt|;
name|page
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_VERTICAL
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Images for the Cap Faces"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|grid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
comment|/* Option menus */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|2
condition|;
name|i
operator|++
control|)
block|{
name|GtkWidget
modifier|*
name|combo
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|combo
operator|=
name|gimp_drawable_combo_box_new
argument_list|(
name|cylinder_constrain
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_int_combo_box_connect
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|combo
argument_list|)
argument_list|,
name|mapvals
operator|.
name|cylindermap_id
index|[
name|i
index|]
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_int_combo_box_get_active
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|cylindermap_id
index|[
name|i
index|]
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_grid_attach_aligned
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
name|i
argument_list|,
name|gettext
argument_list|(
name|labels
index|[
name|i
index|]
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|combo
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
block|}
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Size"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|grid
operator|=
name|gtk_grid_new
argument_list|()
expr_stmt|;
name|gtk_grid_set_row_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_grid_set_column_spacing
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|grid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|grid
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"R_adius:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|cylinder_radius
argument_list|,
literal|0.0
argument_list|,
literal|2.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Cylinder radius"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|GIMP_SCALE_ENTRY_LABEL
argument_list|(
name|adj
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_spin_button_configure
argument_list|(
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON_ADJ
argument_list|(
name|adj
argument_list|)
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|cylinder_radius
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gimp_scale_entry_new
argument_list|(
name|GTK_GRID
argument_list|(
name|grid
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"L_ength:"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|mapvals
operator|.
name|cylinder_length
argument_list|,
literal|0.0
argument_list|,
literal|2.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Cylinder length"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|GIMP_SCALE_ENTRY_LABEL
argument_list|(
name|adj
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_spin_button_configure
argument_list|(
name|GIMP_SCALE_ENTRY_SPINBUTTON
argument_list|(
name|adj
argument_list|)
argument_list|,
name|GIMP_SCALE_ENTRY_SPINBUTTON_ADJ
argument_list|(
name|adj
argument_list|)
argument_list|,
literal|0.1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|cylinder_length
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
name|g_object_unref
argument_list|(
name|group
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/****************************/
end_comment

begin_comment
comment|/* Create notbook and pages */
end_comment

begin_comment
comment|/****************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|create_main_notebook (GtkWidget * container)
name|create_main_notebook
parameter_list|(
name|GtkWidget
modifier|*
name|container
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|options_note_book
operator|=
name|GTK_NOTEBOOK
argument_list|(
name|gtk_notebook_new
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|container
argument_list|)
argument_list|,
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_options_page
argument_list|()
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"O_ptions"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_light_page
argument_list|()
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Light"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_material_page
argument_list|()
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Material"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_orientation_page
argument_list|()
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"O_rientation"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|maptype
operator|==
name|MAP_BOX
condition|)
block|{
name|box_page
operator|=
name|create_box_page
argument_list|()
expr_stmt|;
name|g_object_ref
argument_list|(
name|box_page
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|box_page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Box"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|mapvals
operator|.
name|maptype
operator|==
name|MAP_CYLINDER
condition|)
block|{
name|cylinder_page
operator|=
name|create_cylinder_page
argument_list|()
expr_stmt|;
name|g_object_ref
argument_list|(
name|cylinder_page
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|cylinder_page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"C_ylinder"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_show
argument_list|(
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/********************************/
end_comment

begin_comment
comment|/* Create and show main dialog. */
end_comment

begin_comment
comment|/********************************/
end_comment

begin_function
name|gboolean
DECL|function|main_dialog (gint32 drawable_id)
name|main_dialog
parameter_list|(
name|gint32
name|drawable_id
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|main_hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkWidget
modifier|*
name|toggle
decl_stmt|;
name|GimpZoomModel
modifier|*
name|model
decl_stmt|;
name|gboolean
name|run
init|=
name|FALSE
decl_stmt|;
name|gimp_ui_init
argument_list|(
name|PLUG_IN_BINARY
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|appwin
operator|=
name|gimp_dialog_new
argument_list|(
name|_
argument_list|(
literal|"Map to Object"
argument_list|)
argument_list|,
name|PLUG_IN_ROLE
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|,
name|gimp_standard_help_func
argument_list|,
name|PLUG_IN_PROC
argument_list|,
name|_
argument_list|(
literal|"_Cancel"
argument_list|)
argument_list|,
name|GTK_RESPONSE_CANCEL
argument_list|,
name|_
argument_list|(
literal|"_OK"
argument_list|)
argument_list|,
name|GTK_RESPONSE_OK
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_dialog_set_alternative_button_order
argument_list|(
name|GTK_DIALOG
argument_list|(
name|appwin
argument_list|)
argument_list|,
name|GTK_RESPONSE_OK
argument_list|,
name|GTK_RESPONSE_CANCEL
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gimp_window_set_transient
argument_list|(
name|GTK_WINDOW
argument_list|(
name|appwin
argument_list|)
argument_list|)
expr_stmt|;
name|main_hbox
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_HORIZONTAL
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|main_hbox
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|gtk_dialog_get_content_area
argument_list|(
name|GTK_DIALOG
argument_list|(
name|appwin
argument_list|)
argument_list|)
argument_list|)
argument_list|,
name|main_hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|main_hbox
argument_list|)
expr_stmt|;
comment|/* Create the Preview */
name|vbox
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_VERTICAL
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|main_hbox
argument_list|)
argument_list|,
name|vbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
comment|/* Add preview widget and various buttons to the first part */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_realize
argument_list|(
name|appwin
argument_list|)
expr_stmt|;
name|previewarea
operator|=
name|gtk_drawing_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|previewarea
argument_list|,
name|PREVIEW_WIDTH
argument_list|,
name|PREVIEW_HEIGHT
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|previewarea
argument_list|,
operator|(
name|GDK_EXPOSURE_MASK
operator||
name|GDK_BUTTON1_MOTION_MASK
operator||
name|GDK_BUTTON_PRESS_MASK
operator||
name|GDK_BUTTON_RELEASE_MASK
operator|)
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|previewarea
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|previewarea
argument_list|,
literal|"event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|preview_events
argument_list|)
argument_list|,
name|previewarea
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|previewarea
argument_list|,
literal|"draw"
argument_list|,
name|G_CALLBACK
argument_list|(
name|preview_draw
argument_list|)
argument_list|,
name|previewarea
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_box_new
argument_list|(
name|GTK_ORIENTATION_HORIZONTAL
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Preview!"
argument_list|)
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|gtk_bin_get_child
argument_list|(
name|GTK_BIN
argument_list|(
name|button
argument_list|)
argument_list|)
argument_list|,
literal|"margin-start"
argument_list|,
literal|2
argument_list|,
literal|"margin-end"
argument_list|,
literal|2
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|button
argument_list|,
name|_
argument_list|(
literal|"Recompute preview image"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|model
operator|=
name|gimp_zoom_model_new
argument_list|()
expr_stmt|;
name|gimp_zoom_model_set_range
argument_list|(
name|model
argument_list|,
literal|0.25
argument_list|,
literal|1.0
argument_list|)
expr_stmt|;
name|gimp_zoom_model_zoom
argument_list|(
name|model
argument_list|,
name|GIMP_ZOOM_TO
argument_list|,
name|mapvals
operator|.
name|zoom
argument_list|)
expr_stmt|;
name|button
operator|=
name|gimp_zoom_button_new
argument_list|(
name|model
argument_list|,
name|GIMP_ZOOM_IN
argument_list|,
name|GTK_ICON_SIZE_MENU
argument_list|)
expr_stmt|;
name|gtk_box_pack_end
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gimp_zoom_button_new
argument_list|(
name|model
argument_list|,
name|GIMP_ZOOM_OUT
argument_list|,
name|GTK_ICON_SIZE_MENU
argument_list|)
expr_stmt|;
name|gtk_box_pack_end
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|model
argument_list|,
literal|"zoomed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|zoomed_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"Show _wireframe"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|showgrid
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|toggle_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|showgrid
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"Update preview _live"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|livepreview
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|toggle_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|livepreview
argument_list|)
expr_stmt|;
name|create_main_notebook
argument_list|(
name|main_hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|appwin
argument_list|)
expr_stmt|;
block|{
name|GdkCursor
modifier|*
name|cursor
decl_stmt|;
name|cursor
operator|=
name|gdk_cursor_new_for_display
argument_list|(
name|gtk_widget_get_display
argument_list|(
name|previewarea
argument_list|)
argument_list|,
name|GDK_HAND2
argument_list|)
expr_stmt|;
name|gdk_window_set_cursor
argument_list|(
name|gtk_widget_get_window
argument_list|(
name|previewarea
argument_list|)
argument_list|,
name|cursor
argument_list|)
expr_stmt|;
name|g_object_unref
argument_list|(
name|cursor
argument_list|)
expr_stmt|;
block|}
name|image_setup
argument_list|(
name|drawable_id
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|compute_preview_image
argument_list|()
expr_stmt|;
if|if
condition|(
name|gimp_dialog_run
argument_list|(
name|GIMP_DIALOG
argument_list|(
name|appwin
argument_list|)
argument_list|)
operator|==
name|GTK_RESPONSE_OK
condition|)
name|run
operator|=
name|TRUE
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|appwin
argument_list|)
expr_stmt|;
if|if
condition|(
name|preview_rgb_data
condition|)
name|g_free
argument_list|(
name|preview_rgb_data
argument_list|)
expr_stmt|;
if|if
condition|(
name|preview_surface
condition|)
name|cairo_surface_destroy
argument_list|(
name|preview_surface
argument_list|)
expr_stmt|;
if|if
condition|(
name|box_page
condition|)
name|g_object_unref
argument_list|(
name|box_page
argument_list|)
expr_stmt|;
if|if
condition|(
name|cylinder_page
condition|)
name|g_object_unref
argument_list|(
name|cylinder_page
argument_list|)
expr_stmt|;
return|return
name|run
return|;
block|}
end_function

end_unit

