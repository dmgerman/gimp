begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Lighting Effects - A plug-in for GIMP  *  * Dialog creation and updaters, callbacks and event-handlers  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<libgimp/gimp.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimpui.h>
end_include

begin_include
include|#
directive|include
file|"lighting_ui.h"
end_include

begin_include
include|#
directive|include
file|"lighting_main.h"
end_include

begin_include
include|#
directive|include
file|"lighting_image.h"
end_include

begin_include
include|#
directive|include
file|"lighting_apply.h"
end_include

begin_include
include|#
directive|include
file|"lighting_preview.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/stdplugins-intl.h"
end_include

begin_include
include|#
directive|include
file|"amb1.xpm"
end_include

begin_include
include|#
directive|include
file|"amb2.xpm"
end_include

begin_include
include|#
directive|include
file|"diffint1.xpm"
end_include

begin_include
include|#
directive|include
file|"diffint2.xpm"
end_include

begin_include
include|#
directive|include
file|"diffref1.xpm"
end_include

begin_include
include|#
directive|include
file|"diffref2.xpm"
end_include

begin_include
include|#
directive|include
file|"specref1.xpm"
end_include

begin_include
include|#
directive|include
file|"specref2.xpm"
end_include

begin_include
include|#
directive|include
file|"high1.xpm"
end_include

begin_include
include|#
directive|include
file|"high2.xpm"
end_include

begin_decl_stmt
specifier|extern
name|LightingValues
name|mapvals
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|appwin
specifier|static
name|GtkWidget
modifier|*
name|appwin
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|options_note_book
specifier|static
name|GtkNotebook
modifier|*
name|options_note_book
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* static GtkWidget   *bump_page         = NULL; static GtkWidget   *env_page          = NULL; */
end_comment

begin_decl_stmt
DECL|variable|gc
name|GdkGC
modifier|*
name|gc
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|previewarea
name|GtkWidget
modifier|*
name|previewarea
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|pointlightwid
specifier|static
name|GtkWidget
modifier|*
name|pointlightwid
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|dirlightwid
specifier|static
name|GtkWidget
modifier|*
name|dirlightwid
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* static gint bump_page_pos = -1; static gint env_page_pos  = -1; */
end_comment

begin_function_decl
specifier|static
name|void
name|create_main_notebook
parameter_list|(
name|GtkWidget
modifier|*
name|container
parameter_list|)
function_decl|;
end_function_decl

begin_ifdef
ifdef|#
directive|ifdef
name|_LIGHTNING_UNUSED_CODE
end_ifdef

begin_function_decl
specifier|static
name|void
name|xyzval_update
parameter_list|(
name|GtkEntry
modifier|*
name|entry
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_function_decl
specifier|static
name|void
name|toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* static void togglebump_update         (GtkWidget *widget, 				       gpointer   data);  static void toggleenvironment_update  (GtkWidget *widget, 				       gpointer   data); */
end_comment

begin_function_decl
specifier|static
name|void
name|lightmenu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gboolean
name|bumpmap_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gboolean
name|envmap_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|envmap_combo_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* static GtkWidget *create_bump_page        (void);  static GtkWidget *create_environment_page (void); */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|_LIGHTNING_UNUSED_CODE
end_ifdef

begin_comment
comment|/**********************************************************/
end_comment

begin_comment
comment|/* Update entry fields that affect the preview parameters */
end_comment

begin_comment
comment|/**********************************************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|xyzval_update (GtkEntry * entry)
name|xyzval_update
parameter_list|(
name|GtkEntry
modifier|*
name|entry
parameter_list|)
block|{
name|gdouble
modifier|*
name|valueptr
decl_stmt|;
name|gdouble
name|value
decl_stmt|;
name|valueptr
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
name|value
operator|=
name|atof
argument_list|(
name|gtk_entry_get_text
argument_list|(
name|entry
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|valueptr
operator|=
name|value
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/**********************/
end_comment

begin_comment
comment|/* Std. toggle update */
end_comment

begin_comment
comment|/**********************/
end_comment

begin_function
specifier|static
name|void
DECL|function|toggle_update (GtkWidget * widget,gpointer data)
name|toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gimp_toggle_button_update
argument_list|(
name|widget
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*****************************/
end_comment

begin_comment
comment|/* Toggle bumpmapping update */
end_comment

begin_comment
comment|/*****************************/
end_comment

begin_comment
comment|/* static void togglebump_update (GtkWidget *widget, 		   gpointer   data) {   gimp_toggle_button_update (widget, data);    if (mapvals.bump_mapped)     {       bump_page_pos = g_list_length (options_note_book->children);        bump_page = create_bump_page ();       gtk_notebook_append_page (options_note_book, bump_page, 				gtk_label_new (_("Bumpmap")));     }   else   {       gtk_notebook_remove_page (options_note_book, bump_page_pos);       if (bump_page_pos< env_page_pos)         env_page_pos--;       bump_page_pos = 0;     } } */
end_comment

begin_comment
comment|/*************************************/
end_comment

begin_comment
comment|/* Toggle environment mapping update */
end_comment

begin_comment
comment|/*************************************/
end_comment

begin_comment
comment|/* static void toggleenvironment_update (GtkWidget *widget, 			  gpointer   data) {   gimp_toggle_button_update (widget, data);    if (mapvals.env_mapped)     {       env_page_pos = g_list_length (options_note_book->children);        env_page = create_environment_page ();       gtk_notebook_append_page (options_note_book, env_page, 				gtk_label_new (_("Environment")));     }   else     {       gtk_notebook_remove_page (options_note_book, env_page_pos);       if (env_page_pos< bump_page_pos)         bump_page_pos--;       env_page_pos = 0;     } } */
end_comment

begin_comment
comment|/*****************************************/
end_comment

begin_comment
comment|/* Main window light type menu callback. */
end_comment

begin_comment
comment|/*****************************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|lightmenu_callback (GtkWidget * widget,gpointer data)
name|lightmenu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gimp_int_combo_box_get_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|widget
argument_list|)
argument_list|,
operator|(
name|gint
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|POINT_LIGHT
condition|)
block|{
name|gtk_widget_hide
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|DIRECTIONAL_LIGHT
condition|)
block|{
name|gtk_widget_hide
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gtk_widget_hide
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
name|gtk_widget_hide
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
block|}
name|interactive_preview_callback
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|mapmenu2_callback (GtkWidget * widget,gpointer data)
name|mapmenu2_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gimp_int_combo_box_get_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|widget
argument_list|)
argument_list|,
operator|(
name|gint
operator|*
operator|)
name|data
argument_list|)
expr_stmt|;
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/******************************************/
end_comment

begin_comment
comment|/* Main window "Preview!" button callback */
end_comment

begin_comment
comment|/******************************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|preview_callback (GtkWidget * widget)
name|preview_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|)
block|{
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*********************************************/
end_comment

begin_comment
comment|/* Main window "-" (zoom in) button callback */
end_comment

begin_comment
comment|/*********************************************/
end_comment

begin_comment
comment|/* static void zoomout_callback (GtkWidget *widget) {   mapvals.preview_zoom_factor *= 0.5;   draw_preview_image (TRUE); } */
end_comment

begin_comment
comment|/*********************************************/
end_comment

begin_comment
comment|/* Main window "+" (zoom out) button callback */
end_comment

begin_comment
comment|/*********************************************/
end_comment

begin_comment
comment|/* static void zoomin_callback (GtkWidget *widget) {   mapvals.preview_zoom_factor *= 2.0;   draw_preview_image (TRUE); } */
end_comment

begin_comment
comment|/**********************************************/
end_comment

begin_comment
comment|/* Main window "Apply" button callback.       */
end_comment

begin_comment
comment|/* Render to GIMP image, close down and exit. */
end_comment

begin_comment
comment|/**********************************************/
end_comment

begin_function
specifier|static
name|gint
DECL|function|bumpmap_constrain (gint32 image_id,gint32 drawable_id,gpointer data)
name|bumpmap_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
return|return
operator|(
operator|(
name|gimp_drawable_width
argument_list|(
name|drawable_id
argument_list|)
operator|==
name|gimp_drawable_width
argument_list|(
name|mapvals
operator|.
name|drawable_id
argument_list|)
operator|)
operator|&&
operator|(
name|gimp_drawable_height
argument_list|(
name|drawable_id
argument_list|)
operator|==
name|gimp_drawable_height
argument_list|(
name|mapvals
operator|.
name|drawable_id
argument_list|)
operator|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|envmap_constrain (gint32 image_id,gint32 drawable_id,gpointer data)
name|envmap_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
return|return
operator|(
operator|!
name|gimp_drawable_is_gray
argument_list|(
name|drawable_id
argument_list|)
operator|&&
operator|!
name|gimp_drawable_has_alpha
argument_list|(
name|drawable_id
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|envmap_combo_callback (GtkWidget * widget,gpointer data)
name|envmap_combo_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gimp_int_combo_box_get_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|widget
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|envmap_id
argument_list|)
expr_stmt|;
name|env_width
operator|=
name|gimp_drawable_width
argument_list|(
name|mapvals
operator|.
name|envmap_id
argument_list|)
expr_stmt|;
name|env_height
operator|=
name|gimp_drawable_height
argument_list|(
name|mapvals
operator|.
name|envmap_id
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/***********************/
end_comment

begin_comment
comment|/* Dialog constructors */
end_comment

begin_comment
comment|/***********************/
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_options_page (void)
name|create_options_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|toggle
decl_stmt|;
name|page
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
comment|/* General options */
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"General Options"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
comment|/*   toggle = gtk_check_button_new_with_label (_("Use Bump Mapping"));   gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (toggle), 				mapvals.bump_mapped);   gtk_box_pack_start (GTK_BOX (vbox), toggle, FALSE, FALSE, 0);   g_signal_connect (toggle, "toggled", 		    G_CALLBACK (togglebump_update),&mapvals.bump_mapped);   gtk_widget_show (toggle);    gimp_help_set_help_data (toggle, 			   _("Enable/disable bump-mapping (image depth)"), 			   NULL);    toggle = gtk_check_button_new_with_label (_("Use Environment Mapping"));   gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (toggle), 				mapvals.env_mapped);   gtk_box_pack_start (GTK_BOX (vbox), toggle, FALSE, FALSE, 0);   g_signal_connect (toggle, "toggled", 		    G_CALLBACK (toggleenvironment_update),&mapvals.env_mapped);   gtk_widget_show (toggle);    gimp_help_set_help_data (toggle, 			   _("Enable/disable environment mapping (reflection)"), 			   NULL);   */
name|toggle
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"T_ransparent Background"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|transparent_background
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|toggle_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|transparent_background
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Make destination image transparent where bump "
literal|"height is zero"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"Cre_ate New Image"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|create_new_image
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_toggle_button_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|create_new_image
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Create a new image when applying filter"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"High _Quality Preview"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|previewquality
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|toggle_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|previewquality
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Enable/disable high quality preview"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|#
directive|if
literal|0
comment|/* Antialiasing options */
comment|/* commented out -- there is no code to implement this -- WES 4/02/04 */
block|frame = gtk_frame_new (NULL);   gtk_box_pack_start (GTK_BOX (page), frame, FALSE, FALSE, 0);   gtk_widget_show (frame);    toggle = gtk_check_button_new_with_mnemonic (_("E_nable Antialiasing"));   gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (toggle), 				mapvals.antialiasing);   gtk_frame_set_label_widget (GTK_FRAME (frame), toggle);   gtk_widget_show (toggle);    g_signal_connect (toggle, "toggled",                     G_CALLBACK (gimp_toggle_button_update),&mapvals.antialiasing);    table = gtk_table_new (2, 3, FALSE);   gtk_table_set_col_spacings (GTK_TABLE (table), 12);   gtk_table_set_row_spacings (GTK_TABLE (table), 12);   gtk_container_add (GTK_CONTAINER (frame), table);   gtk_widget_show (table);    gtk_widget_set_sensitive (table, mapvals.antialiasing);   g_object_set_data (G_OBJECT (toggle), "set_sensitive", table);    adj = gimp_scale_entry_new (GTK_TABLE (table), 0, 0, 			      _("_Depth:"), 0, 6, 			      mapvals.max_depth, 1.0, 5.0, 0.5, 1.0, 			      1, TRUE, 0, 0, 			      _("Antialiasing quality. Higher is better, " 				"but slower"), NULL);   g_signal_connect (adj, "value_changed",                     G_CALLBACK (gimp_double_adjustment_update),&mapvals.max_depth);    adj = gimp_scale_entry_new (GTK_TABLE (table), 0, 1, 			      _("T_hreshold:"), 0, 6, 			      mapvals.pixel_treshold, 0.01, 1000.0, 1.0, 15.0, 2, 			      TRUE, 0, 0, 			      _("Stop when pixel differences are smaller than " 			        "this value"), NULL);   g_signal_connect (adj, "value_changed",                     G_CALLBACK (gimp_double_adjustment_update),&mapvals.pixel_treshold);    spinbutton = gimp_spin_button_new (&adj, mapvals.pixel_treshold, 				     0.001, 1000, 0.1, 1, 1, 0, 3);   g_signal_connect (adj, "value_changed", 		    G_CALLBACK (gimp_double_adjustment_update),&mapvals.pixel_treshold);   gimp_table_attach_aligned (GTK_TABLE (table), 0, 1, 			     _("Threshold:"), 0.0, 1.0, 			     spinbutton, 1, TRUE);    gimp_help_set_help_data (spinbutton, 			   _("Stop when pixel differences are smaller than " 			     "this value"), NULL);
endif|#
directive|endif
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/******************************/
end_comment

begin_comment
comment|/* Create light settings page */
end_comment

begin_comment
comment|/******************************/
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_light_page (void)
name|create_light_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|combo
decl_stmt|;
name|GtkWidget
modifier|*
name|ebox
decl_stmt|;
name|GtkWidget
modifier|*
name|colorbutton
decl_stmt|;
name|GtkObject
modifier|*
name|adj
decl_stmt|;
name|page
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Light Settings"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|combo
operator|=
name|gimp_int_combo_box_new
argument_list|(
name|_
argument_list|(
literal|"None"
argument_list|)
argument_list|,
name|NO_LIGHT
argument_list|,
name|_
argument_list|(
literal|"Directional"
argument_list|)
argument_list|,
name|DIRECTIONAL_LIGHT
argument_list|,
name|_
argument_list|(
literal|"Point"
argument_list|)
argument_list|,
name|POINT_LIGHT
argument_list|,
comment|/* _("Spot"),     SPOT_LIGHT, */
name|NULL
argument_list|)
expr_stmt|;
name|gimp_int_combo_box_set_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|combo
argument_list|)
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|type
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|combo
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|lightmenu_callback
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|type
argument_list|)
expr_stmt|;
name|ebox
operator|=
name|gtk_event_box_new
argument_list|()
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|ebox
argument_list|)
argument_list|,
name|combo
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|combo
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"L_ight Type:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|ebox
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|ebox
argument_list|,
name|_
argument_list|(
literal|"Type of light source to apply"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|colorbutton
operator|=
name|gimp_color_button_new
argument_list|(
name|_
argument_list|(
literal|"Select Lightsource Color"
argument_list|)
argument_list|,
literal|64
argument_list|,
literal|16
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|color
argument_list|,
name|GIMP_COLOR_AREA_FLAT
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|colorbutton
argument_list|,
literal|"color_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_color_button_get_color
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|color
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|colorbutton
argument_list|,
literal|"color_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Lig_ht Color:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|colorbutton
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|colorbutton
argument_list|,
name|_
argument_list|(
literal|"Set light source color"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|pointlightwid
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Position"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|pointlightwid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|POINT_LIGHT
condition|)
name|gtk_widget_show
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|pointlightwid
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|spin_pos_x
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|,
operator|-
name|G_MAXFLOAT
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"_X:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spin_pos_x
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spin_pos_x
argument_list|,
name|_
argument_list|(
literal|"Light source X position in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spin_pos_y
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|,
operator|-
name|G_MAXFLOAT
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"_Y:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spin_pos_y
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spin_pos_y
argument_list|,
name|_
argument_list|(
literal|"Light source Y position in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spin_pos_z
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|,
operator|-
name|G_MAXFLOAT
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"_Z:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spin_pos_z
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spin_pos_z
argument_list|,
name|_
argument_list|(
literal|"Light source Z position in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|dirlightwid
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Direction Vector"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|dirlightwid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|DIRECTIONAL_LIGHT
condition|)
name|gtk_widget_show
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|dirlightwid
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|spin_dir_x
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|x
argument_list|,
operator|-
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"X:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spin_dir_x
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|x
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spin_dir_x
argument_list|,
name|_
argument_list|(
literal|"Light source X direction in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spin_dir_y
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|y
argument_list|,
operator|-
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Y:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spin_dir_y
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|y
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spin_dir_y
argument_list|,
name|_
argument_list|(
literal|"Light source Y direction in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spin_dir_z
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|z
argument_list|,
operator|-
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Z:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spin_dir_z
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|z
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spin_dir_z
argument_list|,
name|_
argument_list|(
literal|"Light source Z direction in XYZ space"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/*********************************/
end_comment

begin_comment
comment|/* Create material settings page */
end_comment

begin_comment
comment|/*********************************/
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_material_page (void)
name|create_material_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkSizeGroup
modifier|*
name|group
init|=
name|gtk_size_group_new
argument_list|(
name|GTK_SIZE_GROUP_HORIZONTAL
argument_list|)
decl_stmt|;
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|spinbutton
decl_stmt|;
name|GtkObject
modifier|*
name|adj
decl_stmt|;
name|GtkWidget
modifier|*
name|pixmap
decl_stmt|;
name|page
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Intensity Levels"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
comment|/* Ambient intensity */
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|amb1_xpm
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"_Ambient:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|ambient_int
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|ambient_int
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|gtk_label_set_mnemonic_widget
argument_list|(
name|GTK_LABEL
argument_list|(
name|label
argument_list|)
argument_list|,
name|spinbutton
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Amount of original color to show where no "
literal|"direct light falls"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|amb2_xpm
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
comment|/* Diffuse intensity */
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|diffint1_xpm
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"_Diffuse:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|diffuse_int
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|diffuse_int
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|gtk_label_set_mnemonic_widget
argument_list|(
name|GTK_LABEL
argument_list|(
name|label
argument_list|)
argument_list|,
name|spinbutton
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Intensity of original color when lit by a light "
literal|"source"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|diffint2_xpm
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Reflectivity"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
comment|/* Diffuse reflection */
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|diffref1_xpm
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"D_iffuse:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|diffuse_ref
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|diffuse_ref
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|gtk_label_set_mnemonic_widget
argument_list|(
name|GTK_LABEL
argument_list|(
name|label
argument_list|)
argument_list|,
name|spinbutton
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Higher values makes the object reflect more "
literal|"light (appear lighter)"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|diffref2_xpm
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
comment|/* Specular reflection */
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|specref1_xpm
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"_Specular:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|specular_ref
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|specular_ref
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|gtk_label_set_mnemonic_widget
argument_list|(
name|GTK_LABEL
argument_list|(
name|label
argument_list|)
argument_list|,
name|spinbutton
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Controls how intense the highlights will be"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|specref2_xpm
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
comment|/* Highlight */
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|high1_xpm
argument_list|)
expr_stmt|;
name|label
operator|=
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"_Highlight:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|highlight
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|material
operator|.
name|highlight
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|gtk_label_set_mnemonic_widget
argument_list|(
name|GTK_LABEL
argument_list|(
name|label
argument_list|)
argument_list|,
name|spinbutton
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Higher values makes the highlights more focused"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gimp_pixmap_new
argument_list|(
name|high2_xpm
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/* Create Bump mapping page */
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_bump_page (void)
name|create_bump_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|toggle
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|combo
decl_stmt|;
name|GtkWidget
modifier|*
name|spinbutton
decl_stmt|;
name|GtkObject
modifier|*
name|adj
decl_stmt|;
name|page
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"E_nable Bump Mapping"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|bump_mapped
argument_list|)
expr_stmt|;
name|gtk_frame_set_label_widget
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|toggle
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_toggle_button_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|bump_mapped
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Enable/disable bump-mapping (image depth)"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|6
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|table
argument_list|,
name|mapvals
operator|.
name|bump_mapped
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|toggle
argument_list|)
argument_list|,
literal|"set_sensitive"
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|combo
operator|=
name|gimp_drawable_combo_box_new
argument_list|(
name|bumpmap_constrain
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_int_combo_box_connect
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|combo
argument_list|)
argument_list|,
name|mapvals
operator|.
name|bumpmap_id
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_int_combo_box_get_active
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|bumpmap_id
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"Bumpm_ap Image:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|combo
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|combo
operator|=
name|gimp_int_combo_box_new
argument_list|(
name|_
argument_list|(
literal|"Linear"
argument_list|)
argument_list|,
name|LINEAR_MAP
argument_list|,
name|_
argument_list|(
literal|"Logarithmic"
argument_list|)
argument_list|,
name|LOGARITHMIC_MAP
argument_list|,
name|_
argument_list|(
literal|"Sinusoidal"
argument_list|)
argument_list|,
name|SINUSOIDAL_MAP
argument_list|,
name|_
argument_list|(
literal|"Spherical"
argument_list|)
argument_list|,
name|SPHERICAL_MAP
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_int_combo_box_set_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|combo
argument_list|)
argument_list|,
name|mapvals
operator|.
name|bumpmaptype
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|combo
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|mapmenu2_callback
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|bumpmaptype
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|_
argument_list|(
literal|"Cu_rve:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|combo
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adj
argument_list|,
name|mapvals
operator|.
name|bumpmax
argument_list|,
literal|0
argument_list|,
name|G_MAXFLOAT
argument_list|,
literal|0.01
argument_list|,
literal|0.1
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|_
argument_list|(
literal|"Ma_ximum Height:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_double_adjustment_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|bumpmax
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adj
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|spinbutton
argument_list|,
name|_
argument_list|(
literal|"Maximum height for bumps"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|create_environment_page (void)
name|create_environment_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|toggle
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|combo
decl_stmt|;
name|GtkWidget
modifier|*
name|ebox
decl_stmt|;
name|page
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|page
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|page
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"E_nable Environment Mapping"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|env_mapped
argument_list|)
expr_stmt|;
name|gtk_frame_set_label_widget
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|toggle
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_toggle_button_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|env_mapped
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Enable/disable environment-mapping (reflection)"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|table
argument_list|,
name|mapvals
operator|.
name|env_mapped
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|toggle
argument_list|)
argument_list|,
literal|"set_sensitive"
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|combo
operator|=
name|gimp_drawable_combo_box_new
argument_list|(
name|envmap_constrain
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_int_combo_box_connect
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|combo
argument_list|)
argument_list|,
name|mapvals
operator|.
name|envmap_id
argument_list|,
name|G_CALLBACK
argument_list|(
name|envmap_combo_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|ebox
operator|=
name|gtk_event_box_new
argument_list|()
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|ebox
argument_list|)
argument_list|,
name|combo
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|combo
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|_
argument_list|(
literal|"En_vironment Image:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|ebox
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|ebox
argument_list|,
name|_
argument_list|(
literal|"Environment image to use"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/*****************************/
end_comment

begin_comment
comment|/* Create notebook and pages */
end_comment

begin_comment
comment|/*****************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|create_main_notebook (GtkWidget * container)
name|create_main_notebook
parameter_list|(
name|GtkWidget
modifier|*
name|container
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|options_note_book
operator|=
name|GTK_NOTEBOOK
argument_list|(
name|gtk_notebook_new
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|container
argument_list|)
argument_list|,
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_options_page
argument_list|()
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"Op_tions"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_light_page
argument_list|()
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Light"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_material_page
argument_list|()
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Material"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_bump_page
argument_list|()
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Bump Map"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_environment_page
argument_list|()
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|gtk_label_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Environment Map"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
comment|/*   if (mapvals.bump_mapped == TRUE)     {       bump_page = create_bump_page ();       bump_page_pos = g_list_length (options_note_book->children);       gtk_notebook_append_page (options_note_book, bump_page, 				gtk_label_new (_("Bumpmap")));     }    if (mapvals.env_mapped == TRUE)     {       env_page = create_environment_page ();       env_page_pos = g_list_length (options_note_book->children);       gtk_notebook_append_page (options_note_book, env_page, 				gtk_label_new (_("Environment")));     }   */
name|gtk_widget_show
argument_list|(
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/********************************/
end_comment

begin_comment
comment|/* Create and show main dialog. */
end_comment

begin_comment
comment|/********************************/
end_comment

begin_function
name|gboolean
DECL|function|main_dialog (GimpDrawable * drawable)
name|main_dialog
parameter_list|(
name|GimpDrawable
modifier|*
name|drawable
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|main_hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkWidget
modifier|*
name|toggle
decl_stmt|;
name|gboolean
name|run
init|=
name|FALSE
decl_stmt|;
comment|/*   GtkWidget *image;   */
name|gimp_ui_init
argument_list|(
literal|"Lighting"
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|appwin
operator|=
name|gimp_dialog_new
argument_list|(
name|_
argument_list|(
literal|"Lighting Effects"
argument_list|)
argument_list|,
literal|"Lighting"
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|,
name|gimp_standard_help_func
argument_list|,
literal|"plug-in-lighting"
argument_list|,
name|GTK_STOCK_CANCEL
argument_list|,
name|GTK_RESPONSE_CANCEL
argument_list|,
name|GTK_STOCK_OK
argument_list|,
name|GTK_RESPONSE_OK
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|main_hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|main_hbox
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|appwin
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|main_hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|main_hbox
argument_list|)
expr_stmt|;
comment|/* Create the Preview */
comment|/* ================== */
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|main_hbox
argument_list|)
argument_list|,
name|vbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
comment|/* Add preview widget and various buttons to the first part */
comment|/* ======================================================== */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_realize
argument_list|(
name|appwin
argument_list|)
expr_stmt|;
name|previewarea
operator|=
name|gtk_drawing_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|previewarea
argument_list|,
name|PREVIEW_WIDTH
argument_list|,
name|PREVIEW_HEIGHT
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|previewarea
argument_list|,
operator|(
name|GDK_EXPOSURE_MASK
operator||
name|GDK_BUTTON1_MOTION_MASK
operator||
name|GDK_BUTTON_PRESS_MASK
operator||
name|GDK_BUTTON_RELEASE_MASK
operator|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|previewarea
argument_list|,
literal|"event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|preview_events
argument_list|)
argument_list|,
name|previewarea
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|previewarea
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|previewarea
argument_list|)
expr_stmt|;
comment|/* create preview options, frame and vbox */
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"_Update"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|button
argument_list|,
name|_
argument_list|(
literal|"Recompute preview image"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|_
argument_list|(
literal|"I_nteractive"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|mapvals
operator|.
name|interactive_preview
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_toggle_button_update
argument_list|)
argument_list|,
operator|&
name|mapvals
operator|.
name|interactive_preview
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|toggle
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|interactive_preview_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|toggle
argument_list|,
name|_
argument_list|(
literal|"Enable/disable real time preview of changes"
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|create_main_notebook
argument_list|(
name|main_hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|appwin
argument_list|)
expr_stmt|;
block|{
name|GdkCursor
modifier|*
name|cursor
decl_stmt|;
name|cursor
operator|=
name|gdk_cursor_new_for_display
argument_list|(
name|gtk_widget_get_display
argument_list|(
name|previewarea
argument_list|)
argument_list|,
name|GDK_HAND2
argument_list|)
expr_stmt|;
name|gdk_window_set_cursor
argument_list|(
name|previewarea
operator|->
name|window
argument_list|,
name|cursor
argument_list|)
expr_stmt|;
name|gdk_cursor_unref
argument_list|(
name|cursor
argument_list|)
expr_stmt|;
block|}
name|image_setup
argument_list|(
name|drawable
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
if|if
condition|(
name|gimp_dialog_run
argument_list|(
name|GIMP_DIALOG
argument_list|(
name|appwin
argument_list|)
argument_list|)
operator|==
name|GTK_RESPONSE_OK
condition|)
name|run
operator|=
name|TRUE
expr_stmt|;
if|if
condition|(
name|preview_rgb_data
operator|!=
name|NULL
condition|)
name|g_free
argument_list|(
name|preview_rgb_data
argument_list|)
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|appwin
argument_list|)
expr_stmt|;
return|return
name|run
return|;
block|}
end_function

end_unit

