begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 1995 Spencer Kimball and Peter Mattis  *  * This is a plug-in for the GIMP.  *  * Copyright (C) Pavel Grinfeld (pavel@ml.com)  *  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimp.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimpui.h>
end_include

begin_include
include|#
directive|include
file|"libgimp/stdplugins-intl.h"
end_include

begin_define
DECL|macro|MAX_PREVIEW_SIZE
define|#
directive|define
name|MAX_PREVIEW_SIZE
value|125
end_define

begin_define
DECL|macro|MAX_ROUGHNESS
define|#
directive|define
name|MAX_ROUGHNESS
value|128
end_define

begin_define
DECL|macro|RANGE_HEIGHT
define|#
directive|define
name|RANGE_HEIGHT
value|15
end_define

begin_define
DECL|macro|PR_BX_BRDR
define|#
directive|define
name|PR_BX_BRDR
value|4
end_define

begin_define
DECL|macro|ALL
define|#
directive|define
name|ALL
value|255
end_define

begin_define
DECL|macro|MARGIN
define|#
directive|define
name|MARGIN
value|4
end_define

begin_define
DECL|macro|HELP_ID
define|#
directive|define
name|HELP_ID
value|"plug-in-filter-pack"
end_define

begin_define
DECL|macro|RANGE_ADJUST_MASK
define|#
directive|define
name|RANGE_ADJUST_MASK
value|GDK_EXPOSURE_MASK | \                         GDK_ENTER_NOTIFY_MASK | \                         GDK_BUTTON_PRESS_MASK | \                         GDK_BUTTON_RELEASE_MASK | \                         GDK_BUTTON1_MOTION_MASK | \                         GDK_POINTER_MOTION_HINT_MASK
end_define

begin_typedef
DECL|struct|__anon2c65f6e10108
typedef|typedef
struct|struct
block|{
DECL|member|run
name|gint
name|run
decl_stmt|;
DECL|typedef|fpInterface
block|}
name|fpInterface
typedef|;
end_typedef

begin_typedef
DECL|struct|__anon2c65f6e10208
typedef|typedef
struct|struct
block|{
DECL|member|width
name|gint
name|width
decl_stmt|;
DECL|member|height
name|gint
name|height
decl_stmt|;
DECL|member|rgb
name|guchar
modifier|*
name|rgb
decl_stmt|;
DECL|member|hsv
name|gdouble
modifier|*
name|hsv
decl_stmt|;
DECL|member|mask
name|guchar
modifier|*
name|mask
decl_stmt|;
DECL|typedef|ReducedImage
block|}
name|ReducedImage
typedef|;
end_typedef

begin_typedef
DECL|enum|__anon2c65f6e10303
typedef|typedef
enum|enum
block|{
DECL|enumerator|SHADOWS
name|SHADOWS
block|,
DECL|enumerator|MIDTONES
name|MIDTONES
block|,
DECL|enumerator|HIGHLIGHTS
name|HIGHLIGHTS
block|,
DECL|enumerator|INTENSITIES
name|INTENSITIES
DECL|typedef|FP_Intensity
block|}
name|FP_Intensity
typedef|;
end_typedef

begin_enum
DECL|enum|__anon2c65f6e10403
enum|enum
block|{
DECL|enumerator|NONEATALL
name|NONEATALL
init|=
literal|0
block|,
DECL|enumerator|CURRENT
name|CURRENT
init|=
literal|1
block|,
DECL|enumerator|HUE
name|HUE
init|=
literal|2
block|,
DECL|enumerator|SATURATION
name|SATURATION
init|=
literal|4
block|,
DECL|enumerator|VALUE
name|VALUE
init|=
literal|8
block|}
enum|;
end_enum

begin_enum
DECL|enum|__anon2c65f6e10503
enum|enum
block|{
DECL|enumerator|BY_HUE
name|BY_HUE
block|,
DECL|enumerator|BY_SAT
name|BY_SAT
block|,
DECL|enumerator|BY_VAL
name|BY_VAL
block|,
DECL|enumerator|JUDGE_BY
name|JUDGE_BY
block|}
enum|;
end_enum

begin_enum
DECL|enum|__anon2c65f6e10603
enum|enum
block|{
DECL|enumerator|RED
name|RED
block|,
DECL|enumerator|GREEN
name|GREEN
block|,
DECL|enumerator|BLUE
name|BLUE
block|,
DECL|enumerator|CYAN
name|CYAN
block|,
DECL|enumerator|YELLOW
name|YELLOW
block|,
DECL|enumerator|MAGENTA
name|MAGENTA
block|,
DECL|enumerator|ALL_PRIMARY
name|ALL_PRIMARY
block|}
enum|;
end_enum

begin_enum
DECL|enum|__anon2c65f6e10703
enum|enum
block|{
DECL|enumerator|DOWN
name|DOWN
init|=
operator|-
literal|1
block|,
DECL|enumerator|UP
name|UP
init|=
literal|1
block|}
enum|;
end_enum

begin_typedef
DECL|struct|__anon2c65f6e10808
typedef|typedef
struct|struct
block|{
DECL|member|window
name|GtkWidget
modifier|*
name|window
decl_stmt|;
DECL|member|shadowsEntry
name|GtkWidget
modifier|*
name|shadowsEntry
decl_stmt|;
DECL|member|midtonesEntry
name|GtkWidget
modifier|*
name|midtonesEntry
decl_stmt|;
DECL|member|rangePreview
name|GtkWidget
modifier|*
name|rangePreview
decl_stmt|;
DECL|member|aliasingPreview
name|GtkWidget
modifier|*
name|aliasingPreview
decl_stmt|;
DECL|member|aliasingData
name|GtkObject
modifier|*
name|aliasingData
decl_stmt|;
DECL|member|aliasingGraph
name|GtkWidget
modifier|*
name|aliasingGraph
decl_stmt|;
DECL|typedef|AdvancedWindow
block|}
name|AdvancedWindow
typedef|;
end_typedef

begin_typedef
DECL|struct|__anon2c65f6e10908
typedef|typedef
struct|struct
block|{
DECL|member|Color
name|int
name|Color
decl_stmt|;
DECL|member|Rough
name|float
name|Rough
decl_stmt|;
DECL|member|roughnessScale
name|GtkWidget
modifier|*
name|roughnessScale
decl_stmt|;
DECL|member|Alias
name|float
name|Alias
decl_stmt|;
DECL|member|aliasingScale
name|GtkWidget
modifier|*
name|aliasingScale
decl_stmt|;
DECL|member|PreviewSize
name|float
name|PreviewSize
decl_stmt|;
DECL|member|previewSizeScale
name|GtkWidget
modifier|*
name|previewSizeScale
decl_stmt|;
DECL|member|Range
name|FP_Intensity
name|Range
decl_stmt|;
DECL|member|ValueBy
name|gint
name|ValueBy
decl_stmt|;
DECL|member|SlctnOnly
name|gint
name|SlctnOnly
decl_stmt|;
DECL|member|RealTime
name|gint
name|RealTime
decl_stmt|;
DECL|member|Offset
name|guchar
name|Offset
decl_stmt|;
DECL|member|VisibleFrames
name|guchar
name|VisibleFrames
decl_stmt|;
DECL|member|Cutoffs
name|guchar
name|Cutoffs
index|[
name|INTENSITIES
index|]
decl_stmt|;
DECL|member|Touched
name|gint
name|Touched
index|[
name|JUDGE_BY
index|]
decl_stmt|;
DECL|member|redAdj
name|gint
name|redAdj
index|[
name|JUDGE_BY
index|]
index|[
literal|256
index|]
decl_stmt|;
DECL|member|blueAdj
name|gint
name|blueAdj
index|[
name|JUDGE_BY
index|]
index|[
literal|256
index|]
decl_stmt|;
DECL|member|greenAdj
name|gint
name|greenAdj
index|[
name|JUDGE_BY
index|]
index|[
literal|256
index|]
decl_stmt|;
DECL|member|satAdj
name|gint
name|satAdj
index|[
name|JUDGE_BY
index|]
index|[
literal|256
index|]
decl_stmt|;
DECL|member|rangeLabels
name|GtkWidget
modifier|*
name|rangeLabels
index|[
literal|12
index|]
decl_stmt|;
DECL|typedef|FP_Params
block|}
name|FP_Params
typedef|;
end_typedef

begin_function_decl
specifier|static
name|void
name|fp_show_hide_frame
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|GtkWidget
modifier|*
name|frame
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|ReducedImage
modifier|*
name|Reduce_The_Image
parameter_list|(
name|GimpDrawable
modifier|*
parameter_list|,
name|GimpDrawable
modifier|*
parameter_list|,
name|gint
parameter_list|,
name|gint
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|fp_render_preview
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gint
parameter_list|,
name|gint
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Update_Current_FP
parameter_list|(
name|gint
parameter_list|,
name|gint
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|fp_Create_Nudge
parameter_list|(
name|gint
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gboolean
name|fp_dialog
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|fp_advanced_dialog
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|selectionMade
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|fp_scale_update
parameter_list|(
name|GtkAdjustment
modifier|*
parameter_list|,
name|float
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|resetFilterPacks
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|fp_create_smoothness_graph
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|fp_range_preview_spill
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gint
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Adjust_Preview_Sizes
parameter_list|(
name|gint
name|width
parameter_list|,
name|gint
name|height
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|fp_redraw_all_windows
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|refreshPreviews
parameter_list|(
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|initializeFilterPacks
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|As_You_Drag
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|preview_size_scale_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|float
modifier|*
name|scale_val
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|fp
parameter_list|(
name|GimpDrawable
modifier|*
name|drawable
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|fp_create_bna
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|fp_create_rough
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|fp_create_range
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|fp_create_circle_palette
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|fp_create_lnd
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|fp_create_show
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|fp_create_msnls
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|fp_create_pixels_select_by
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|update_range_labels
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gboolean
name|FP_Range_Change_Events
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|,
name|FP_Params
modifier|*
name|current
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Create_A_Preview
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
parameter_list|,
name|GtkWidget
modifier|*
modifier|*
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Create_A_Table_Entry
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
parameter_list|,
name|GtkWidget
modifier|*
parameter_list|,
specifier|const
name|gchar
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Check_Button_In_A_Box
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
specifier|const
name|gchar
modifier|*
name|label
parameter_list|,
name|GtkSignalFunc
name|func
parameter_list|,
name|gpointer
name|data
parameter_list|,
name|int
name|clicked
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|Frames_Check_Button_In_A_Box
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
specifier|const
name|gchar
modifier|*
name|label
parameter_list|,
name|GtkSignalFunc
name|func
parameter_list|,
name|GtkWidget
modifier|*
name|frame
parameter_list|,
name|int
name|clicked
parameter_list|)
function_decl|;
end_function_decl

begin_define
DECL|macro|RESPONSE_RESET
define|#
directive|define
name|RESPONSE_RESET
value|1
end_define

begin_comment
comment|/* These values are translated for the GUI but also used internally    to figure out which button the user pushed, etc.    Not my design, please don't blame me -- njl */
end_comment

begin_decl_stmt
DECL|variable|hue_red
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_red
init|=
name|N_
argument_list|(
literal|"Red:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_green
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_green
init|=
name|N_
argument_list|(
literal|"Green:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_blue
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_blue
init|=
name|N_
argument_list|(
literal|"Blue:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_cyan
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_cyan
init|=
name|N_
argument_list|(
literal|"Cyan:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_yellow
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_yellow
init|=
name|N_
argument_list|(
literal|"Yellow:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_magenta
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_magenta
init|=
name|N_
argument_list|(
literal|"Magenta:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|val_darker
specifier|static
specifier|const
name|gchar
modifier|*
name|val_darker
init|=
name|N_
argument_list|(
literal|"Darker:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|val_lighter
specifier|static
specifier|const
name|gchar
modifier|*
name|val_lighter
init|=
name|N_
argument_list|(
literal|"Lighter:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|sat_more
specifier|static
specifier|const
name|gchar
modifier|*
name|sat_more
init|=
name|N_
argument_list|(
literal|"More Sat:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|sat_less
specifier|static
specifier|const
name|gchar
modifier|*
name|sat_less
init|=
name|N_
argument_list|(
literal|"Less Sat:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|current_val
specifier|static
specifier|const
name|gchar
modifier|*
name|current_val
init|=
name|N_
argument_list|(
literal|"Current:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|colorSign
specifier|static
name|gint
name|colorSign
index|[
literal|3
index|]
index|[
name|ALL_PRIMARY
index|]
init|=
block|{
block|{
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|1
block|,
literal|1
block|}
block|,
block|{
operator|-
literal|1
block|,
literal|1
block|,
operator|-
literal|1
block|,
literal|1
block|,
literal|1
block|,
operator|-
literal|1
block|}
block|,
block|{
operator|-
literal|1
block|,
operator|-
literal|1
block|,
literal|1
block|,
literal|1
block|,
operator|-
literal|1
block|,
literal|1
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|AW
specifier|static
name|AdvancedWindow
name|AW
init|=
block|{
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|nudgeArray
specifier|static
name|gint
name|nudgeArray
index|[
literal|256
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|origPreview
DECL|variable|curPreview
specifier|static
name|GtkWidget
modifier|*
name|origPreview
decl_stmt|,
modifier|*
name|curPreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|rPreview
DECL|variable|gPreview
DECL|variable|bPreview
specifier|static
name|GtkWidget
modifier|*
name|rPreview
decl_stmt|,
modifier|*
name|gPreview
decl_stmt|,
modifier|*
name|bPreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|cPreview
DECL|variable|yPreview
DECL|variable|mPreview
specifier|static
name|GtkWidget
modifier|*
name|cPreview
decl_stmt|,
modifier|*
name|yPreview
decl_stmt|,
modifier|*
name|mPreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|centerPreview
specifier|static
name|GtkWidget
modifier|*
name|centerPreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|darkerPreview
DECL|variable|lighterPreview
DECL|variable|middlePreview
specifier|static
name|GtkWidget
modifier|*
name|darkerPreview
decl_stmt|,
modifier|*
name|lighterPreview
decl_stmt|,
modifier|*
name|middlePreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|dlg
specifier|static
name|GtkWidget
modifier|*
name|dlg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|plusSatPreview
DECL|variable|SatPreview
DECL|variable|minusSatPreview
specifier|static
name|GtkWidget
modifier|*
name|plusSatPreview
decl_stmt|,
modifier|*
name|SatPreview
decl_stmt|,
modifier|*
name|minusSatPreview
decl_stmt|;
end_decl_stmt

begin_struct
specifier|static
struct|struct
DECL|struct|__anon2c65f6e10a08
block|{
DECL|member|bna
name|GtkWidget
modifier|*
name|bna
decl_stmt|;
DECL|member|palette
name|GtkWidget
modifier|*
name|palette
decl_stmt|;
DECL|member|rough
name|GtkWidget
modifier|*
name|rough
decl_stmt|;
DECL|member|range
name|GtkWidget
modifier|*
name|range
decl_stmt|;
DECL|member|show
name|GtkWidget
modifier|*
name|show
decl_stmt|;
DECL|member|lnd
name|GtkWidget
modifier|*
name|lnd
decl_stmt|;
DECL|member|pixelsBy
name|GtkWidget
modifier|*
name|pixelsBy
decl_stmt|;
DECL|member|frameSelect
name|GtkWidget
modifier|*
name|frameSelect
decl_stmt|;
DECL|member|satur
name|GtkWidget
modifier|*
name|satur
decl_stmt|;
DECL|variable|fpFrames
block|}
name|fpFrames
struct|;
end_struct

begin_decl_stmt
DECL|variable|FPint
specifier|static
name|fpInterface
name|FPint
init|=
block|{
name|FALSE
comment|/*  run  */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|reduced
specifier|static
name|ReducedImage
modifier|*
name|reduced
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|Current
specifier|static
name|FP_Params
name|Current
init|=
block|{
literal|1
block|,
literal|.25
block|,
comment|/* Initial Roughness */
name|NULL
block|,
literal|.6
block|,
comment|/* Initial Degree of Aliasing */
name|NULL
block|,
literal|80
block|,
name|NULL
block|,
name|MIDTONES
block|,
comment|/* Initial Range */
name|BY_VAL
block|,
comment|/* Initial God knows what */
name|TRUE
block|,
comment|/* Selection Only */
name|TRUE
block|,
comment|/* Real Time */
literal|0
block|,
comment|/* Offset */
literal|0
block|,
block|{
literal|32
block|,
literal|224
block|,
literal|255
block|}
block|,
block|{
literal|0
block|,
literal|0
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable
DECL|variable|mask
specifier|static
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|,
modifier|*
name|mask
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|void
name|query
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|run
parameter_list|(
specifier|const
name|gchar
modifier|*
name|name
parameter_list|,
name|gint
name|nparams
parameter_list|,
specifier|const
name|GimpParam
modifier|*
name|param
parameter_list|,
name|gint
modifier|*
name|nreturn_vals
parameter_list|,
name|GimpParam
modifier|*
modifier|*
name|return_vals
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
DECL|variable|PLUG_IN_INFO
name|GimpPlugInInfo
name|PLUG_IN_INFO
init|=
block|{
name|NULL
block|,
comment|/* init_proc  */
name|NULL
block|,
comment|/* quit_proc  */
name|query
block|,
comment|/* query_proc */
name|run
block|,
comment|/* run_proc   */
block|}
decl_stmt|;
end_decl_stmt

begin_macro
DECL|function|MAIN ()
name|MAIN
argument_list|()
end_macro

begin_function
specifier|static
name|void
name|query
parameter_list|(
name|void
parameter_list|)
block|{
name|GimpParamDef
name|args
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"run_mode"
block|,
literal|"Interactive, non-interactive"
block|}
block|,
block|{
name|GIMP_PDB_IMAGE
block|,
literal|"image"
block|,
literal|"Input image (used for indexed images)"
block|}
block|,
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"Input drawable"
block|}
block|,   }
decl_stmt|;
name|gimp_install_procedure
argument_list|(
literal|"plug_in_filter_pack"
argument_list|,
literal|"Allows the user to change H, S, or C with many previews"
argument_list|,
literal|"No help available"
argument_list|,
literal|"Pavel Grinfeld (pavel@ml.com)"
argument_list|,
literal|"Pavel Grinfeld (pavel@ml.com)"
argument_list|,
literal|"27th March 1997"
argument_list|,
name|N_
argument_list|(
literal|"_Filter Pack..."
argument_list|)
argument_list|,
literal|"RGB*"
argument_list|,
name|GIMP_PLUGIN
argument_list|,
name|G_N_ELEMENTS
argument_list|(
name|args
argument_list|)
argument_list|,
literal|0
argument_list|,
name|args
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_plugin_menu_register
argument_list|(
literal|"plug_in_filter_pack"
argument_list|,
literal|"<Image>/Filters/Colors"
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/********************************STANDARD RUN*************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|run (const gchar * name,gint nparams,const GimpParam * param,gint * nreturn_vals,GimpParam ** return_vals)
name|run
parameter_list|(
specifier|const
name|gchar
modifier|*
name|name
parameter_list|,
name|gint
name|nparams
parameter_list|,
specifier|const
name|GimpParam
modifier|*
name|param
parameter_list|,
name|gint
modifier|*
name|nreturn_vals
parameter_list|,
name|GimpParam
modifier|*
modifier|*
name|return_vals
parameter_list|)
block|{
name|GimpParam
name|values
index|[
literal|1
index|]
decl_stmt|;
name|GimpPDBStatusType
name|status
init|=
name|GIMP_PDB_SUCCESS
decl_stmt|;
name|GimpRunMode
name|run_mode
decl_stmt|;
operator|*
name|nreturn_vals
operator|=
literal|1
expr_stmt|;
operator|*
name|return_vals
operator|=
name|values
expr_stmt|;
name|run_mode
operator|=
name|param
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_int32
expr_stmt|;
name|INIT_I18N
argument_list|()
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|GIMP_PDB_STATUS
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|status
expr_stmt|;
name|initializeFilterPacks
argument_list|()
expr_stmt|;
name|drawable
operator|=
name|gimp_drawable_get
argument_list|(
name|param
index|[
literal|2
index|]
operator|.
name|data
operator|.
name|d_drawable
argument_list|)
expr_stmt|;
name|mask
operator|=
name|gimp_drawable_get
argument_list|(
name|gimp_image_get_selection
argument_list|(
name|param
index|[
literal|1
index|]
operator|.
name|data
operator|.
name|d_image
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|gimp_drawable_is_indexed
argument_list|(
name|drawable
operator|->
name|drawable_id
argument_list|)
operator|||
name|gimp_drawable_is_gray
argument_list|(
name|drawable
operator|->
name|drawable_id
argument_list|)
condition|)
block|{
name|gimp_message
argument_list|(
name|_
argument_list|(
literal|"Convert the image to RGB first!"
argument_list|)
argument_list|)
expr_stmt|;
name|status
operator|=
name|GIMP_PDB_EXECUTION_ERROR
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|gimp_drawable_is_rgb
argument_list|(
name|drawable
operator|->
name|drawable_id
argument_list|)
operator|&&
name|fp_dialog
argument_list|()
condition|)
block|{
name|gimp_progress_init
argument_list|(
name|_
argument_list|(
literal|"Applying the Filter Pack..."
argument_list|)
argument_list|)
expr_stmt|;
name|gimp_tile_cache_ntiles
argument_list|(
literal|2
operator|*
operator|(
name|drawable
operator|->
name|width
operator|/
name|gimp_tile_width
argument_list|()
operator|+
literal|1
operator|)
argument_list|)
expr_stmt|;
name|fp
argument_list|(
name|drawable
argument_list|)
expr_stmt|;
name|gimp_displays_flush
argument_list|()
expr_stmt|;
block|}
else|else
name|status
operator|=
name|GIMP_PDB_EXECUTION_ERROR
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|status
expr_stmt|;
if|if
condition|(
name|status
operator|==
name|GIMP_PDB_SUCCESS
condition|)
name|gimp_drawable_detach
argument_list|(
name|drawable
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_func (const guchar * src,guchar * dest,gint bpp,gpointer data)
name|fp_func
parameter_list|(
specifier|const
name|guchar
modifier|*
name|src
parameter_list|,
name|guchar
modifier|*
name|dest
parameter_list|,
name|gint
name|bpp
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gint
name|bytenum
decl_stmt|,
name|k
decl_stmt|;
name|gint
name|JudgeBy
decl_stmt|,
name|Intensity
init|=
literal|0
decl_stmt|,
name|P
index|[
literal|3
index|]
decl_stmt|;
name|GimpRGB
name|rgb
decl_stmt|;
name|GimpHSV
name|hsv
decl_stmt|;
name|gint
name|M
decl_stmt|,
name|m
decl_stmt|,
name|middle
decl_stmt|;
name|P
index|[
literal|0
index|]
operator|=
name|src
index|[
literal|0
index|]
expr_stmt|;
name|P
index|[
literal|1
index|]
operator|=
name|src
index|[
literal|1
index|]
expr_stmt|;
name|P
index|[
literal|2
index|]
operator|=
name|src
index|[
literal|2
index|]
expr_stmt|;
name|gimp_rgb_set_uchar
argument_list|(
operator|&
name|rgb
argument_list|,
operator|(
name|guchar
operator|)
name|P
index|[
literal|0
index|]
argument_list|,
operator|(
name|guchar
operator|)
name|P
index|[
literal|1
index|]
argument_list|,
operator|(
name|guchar
operator|)
name|P
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|gimp_rgb_to_hsv
argument_list|(
operator|&
name|rgb
argument_list|,
operator|&
name|hsv
argument_list|)
expr_stmt|;
for|for
control|(
name|JudgeBy
operator|=
name|BY_HUE
init|;
name|JudgeBy
operator|<
name|JUDGE_BY
condition|;
name|JudgeBy
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|Current
operator|.
name|Touched
index|[
name|JudgeBy
index|]
condition|)
continue|continue;
switch|switch
condition|(
name|JudgeBy
condition|)
block|{
case|case
name|BY_HUE
case|:
name|Intensity
operator|=
literal|255
operator|*
name|hsv
operator|.
name|h
expr_stmt|;
break|break;
case|case
name|BY_SAT
case|:
name|Intensity
operator|=
literal|255
operator|*
name|hsv
operator|.
name|s
expr_stmt|;
break|break;
case|case
name|BY_VAL
case|:
name|Intensity
operator|=
literal|255
operator|*
name|hsv
operator|.
name|v
expr_stmt|;
break|break;
block|}
comment|/* It's important to take care of Saturation first!!! */
name|m
operator|=
name|MIN
argument_list|(
name|MIN
argument_list|(
name|P
index|[
literal|0
index|]
argument_list|,
name|P
index|[
literal|1
index|]
argument_list|)
argument_list|,
name|P
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|M
operator|=
name|MAX
argument_list|(
name|MAX
argument_list|(
name|P
index|[
literal|0
index|]
argument_list|,
name|P
index|[
literal|1
index|]
argument_list|)
argument_list|,
name|P
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|middle
operator|=
operator|(
name|M
operator|+
name|m
operator|)
operator|/
literal|2
expr_stmt|;
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
literal|3
condition|;
name|k
operator|++
control|)
if|if
condition|(
name|P
index|[
name|k
index|]
operator|!=
name|m
operator|&&
name|P
index|[
name|k
index|]
operator|!=
name|M
condition|)
name|middle
operator|=
name|P
index|[
name|k
index|]
expr_stmt|;
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
literal|3
condition|;
name|k
operator|++
control|)
if|if
condition|(
name|M
operator|!=
name|m
condition|)
block|{
if|if
condition|(
name|P
index|[
name|k
index|]
operator|==
name|M
condition|)
name|P
index|[
name|k
index|]
operator|=
name|MAX
argument_list|(
name|P
index|[
name|k
index|]
operator|+
name|Current
operator|.
name|satAdj
index|[
name|JudgeBy
index|]
index|[
name|Intensity
index|]
argument_list|,
name|middle
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|P
index|[
name|k
index|]
operator|==
name|m
condition|)
name|P
index|[
name|k
index|]
operator|=
name|MIN
argument_list|(
name|P
index|[
name|k
index|]
operator|-
name|Current
operator|.
name|satAdj
index|[
name|JudgeBy
index|]
index|[
name|Intensity
index|]
argument_list|,
name|middle
argument_list|)
expr_stmt|;
block|}
name|P
index|[
literal|0
index|]
operator|+=
name|Current
operator|.
name|redAdj
index|[
name|JudgeBy
index|]
index|[
name|Intensity
index|]
expr_stmt|;
name|P
index|[
literal|1
index|]
operator|+=
name|Current
operator|.
name|greenAdj
index|[
name|JudgeBy
index|]
index|[
name|Intensity
index|]
expr_stmt|;
name|P
index|[
literal|2
index|]
operator|+=
name|Current
operator|.
name|blueAdj
index|[
name|JudgeBy
index|]
index|[
name|Intensity
index|]
expr_stmt|;
name|P
index|[
literal|0
index|]
operator|=
name|CLAMP0255
argument_list|(
name|P
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|P
index|[
literal|1
index|]
operator|=
name|CLAMP0255
argument_list|(
name|P
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|P
index|[
literal|2
index|]
operator|=
name|CLAMP0255
argument_list|(
name|P
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
block|}
name|dest
index|[
literal|0
index|]
operator|=
name|P
index|[
literal|0
index|]
expr_stmt|;
name|dest
index|[
literal|1
index|]
operator|=
name|P
index|[
literal|1
index|]
expr_stmt|;
name|dest
index|[
literal|2
index|]
operator|=
name|P
index|[
literal|2
index|]
expr_stmt|;
for|for
control|(
name|bytenum
operator|=
literal|3
init|;
name|bytenum
operator|<
name|bpp
condition|;
name|bytenum
operator|++
control|)
name|dest
index|[
name|bytenum
index|]
operator|=
name|src
index|[
name|bytenum
index|]
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp (GimpDrawable * drawable)
name|fp
parameter_list|(
name|GimpDrawable
modifier|*
name|drawable
parameter_list|)
block|{
name|gimp_rgn_iterate2
argument_list|(
name|drawable
argument_list|,
literal|0
comment|/* unused */
argument_list|,
name|fp_func
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/***********************************************************/
end_comment

begin_comment
comment|/************   Main Dialog Window   ******************/
end_comment

begin_comment
comment|/***********************************************************/
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|fp_create_bna (void)
name|fp_create_bna
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|bframe
decl_stmt|,
modifier|*
name|aframe
decl_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|origPreview
argument_list|,
operator|&
name|bframe
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|curPreview
argument_list|,
operator|&
name|aframe
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Original:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_SHRINK
argument_list|,
name|GTK_SHRINK
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|bframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Current:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_SHRINK
argument_list|,
name|GTK_SHRINK
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|aframe
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
return|return
name|table
return|;
block|}
end_function

begin_comment
comment|/* close a sub dialog (from window manager) by simulating toggle click */
end_comment

begin_function
specifier|static
name|gboolean
DECL|function|sub_dialog_destroy (GtkWidget * dialog,GdkEvent * ev,gpointer dummy)
name|sub_dialog_destroy
parameter_list|(
name|GtkWidget
modifier|*
name|dialog
parameter_list|,
name|GdkEvent
modifier|*
name|ev
parameter_list|,
name|gpointer
name|dummy
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
init|=
name|GTK_WIDGET
argument_list|(
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|dialog
argument_list|)
argument_list|,
literal|"ctrlButton"
argument_list|)
argument_list|)
decl_stmt|;
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|TRUE
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|fp_create_circle_palette (void)
name|fp_create_circle_palette
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|rVbox
decl_stmt|,
modifier|*
name|rFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|gVbox
decl_stmt|,
modifier|*
name|gFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|bVbox
decl_stmt|,
modifier|*
name|bFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|cVbox
decl_stmt|,
modifier|*
name|cFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|yVbox
decl_stmt|,
modifier|*
name|yFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|mVbox
decl_stmt|,
modifier|*
name|mFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|centerVbox
decl_stmt|,
modifier|*
name|centerFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|win
decl_stmt|;
name|win
operator|=
name|gtk_window_new
argument_list|(
name|GTK_WINDOW_TOPLEVEL
argument_list|)
expr_stmt|;
name|gimp_help_connect
argument_list|(
name|win
argument_list|,
name|gimp_standard_help_func
argument_list|,
name|HELP_ID
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|win
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Hue Variations"
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|win
argument_list|,
literal|"delete_event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|sub_dialog_destroy
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|win
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|rPreview
argument_list|,
operator|&
name|rFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|gPreview
argument_list|,
operator|&
name|gFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|bPreview
argument_list|,
operator|&
name|bFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|cPreview
argument_list|,
operator|&
name|cFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|yPreview
argument_list|,
operator|&
name|yFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|mPreview
argument_list|,
operator|&
name|mFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|centerPreview
argument_list|,
operator|&
name|centerFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|rVbox
argument_list|,
name|rFrame
argument_list|,
name|hue_red
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|gVbox
argument_list|,
name|gFrame
argument_list|,
name|hue_green
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|bVbox
argument_list|,
name|bFrame
argument_list|,
name|hue_blue
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|cVbox
argument_list|,
name|cFrame
argument_list|,
name|hue_cyan
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|yVbox
argument_list|,
name|yFrame
argument_list|,
name|hue_yellow
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|mVbox
argument_list|,
name|mFrame
argument_list|,
name|hue_magenta
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|centerVbox
argument_list|,
name|centerFrame
argument_list|,
name|current_val
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|rVbox
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|gVbox
argument_list|,
literal|2
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|bVbox
argument_list|,
literal|2
argument_list|,
literal|5
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|cVbox
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|yVbox
argument_list|,
literal|6
argument_list|,
literal|9
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|mVbox
argument_list|,
literal|6
argument_list|,
literal|9
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|centerVbox
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
name|win
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|fp_create_rough (void)
name|fp_create_rough
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|vbox
decl_stmt|,
modifier|*
name|scale
decl_stmt|;
name|GtkObject
modifier|*
name|data
decl_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Roughness"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|data
operator|=
name|gtk_adjustment_new
argument_list|(
name|Current
operator|.
name|Rough
argument_list|,
literal|0
argument_list|,
literal|1.0
argument_list|,
literal|0.05
argument_list|,
literal|0.01
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|Current
operator|.
name|roughnessScale
operator|=
name|scale
operator|=
name|gtk_hscale_new
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|scale
argument_list|,
literal|60
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gtk_scale_set_value_pos
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_scale_set_digits
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|data
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|fp_scale_update
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|Rough
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|scale
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_change_current_range (GtkWidget * widget,gpointer data)
name|fp_change_current_range
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gimp_radio_button_update
argument_list|(
name|widget
argument_list|,
name|data
argument_list|)
expr_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
condition|)
block|{
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
if|if
condition|(
name|AW
operator|.
name|window
operator|&&
name|GTK_WIDGET_VISIBLE
argument_list|(
name|AW
operator|.
name|window
argument_list|)
condition|)
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|fp_create_range (void)
name|fp_create_range
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|frame
operator|=
name|gimp_int_radio_group_new
argument_list|(
name|TRUE
argument_list|,
name|_
argument_list|(
literal|"Affected Range"
argument_list|)
argument_list|,
name|G_CALLBACK
argument_list|(
name|fp_change_current_range
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|Range
argument_list|,
name|Current
operator|.
name|Range
argument_list|,
name|_
argument_list|(
literal|"Sha_dows"
argument_list|)
argument_list|,
name|SHADOWS
argument_list|,
name|NULL
argument_list|,
name|_
argument_list|(
literal|"_Midtones"
argument_list|)
argument_list|,
name|MIDTONES
argument_list|,
name|NULL
argument_list|,
name|_
argument_list|(
literal|"H_ighlights"
argument_list|)
argument_list|,
name|HIGHLIGHTS
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|fp_create_control (void)
name|fp_create_control
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|box
decl_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Windows"
argument_list|)
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|box
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|box
argument_list|)
expr_stmt|;
name|Frames_Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"_Hue"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|fpFrames
operator|.
name|palette
argument_list|,
name|Current
operator|.
name|VisibleFrames
operator|&
name|HUE
argument_list|)
expr_stmt|;
name|Frames_Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"_Saturation"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|fpFrames
operator|.
name|satur
argument_list|,
name|Current
operator|.
name|VisibleFrames
operator|&
name|SATURATION
argument_list|)
expr_stmt|;
name|Frames_Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"_Value"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|fpFrames
operator|.
name|lnd
argument_list|,
name|Current
operator|.
name|VisibleFrames
operator|&
name|VALUE
argument_list|)
expr_stmt|;
name|Frames_Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"A_dvanced"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|AW
operator|.
name|window
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|fp_create_lnd (void)
name|fp_create_lnd
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|,
modifier|*
name|lighterFrame
decl_stmt|,
modifier|*
name|middleFrame
decl_stmt|,
modifier|*
name|darkerFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|lighterVbox
decl_stmt|,
modifier|*
name|middleVbox
decl_stmt|,
modifier|*
name|darkerVbox
decl_stmt|;
name|GtkWidget
modifier|*
name|win
decl_stmt|;
name|win
operator|=
name|gtk_window_new
argument_list|(
name|GTK_WINDOW_TOPLEVEL
argument_list|)
expr_stmt|;
name|gimp_help_connect
argument_list|(
name|win
argument_list|,
name|gimp_standard_help_func
argument_list|,
name|HELP_ID
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|win
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Value Variations"
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|win
argument_list|,
literal|"delete_event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|sub_dialog_destroy
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|lighterPreview
argument_list|,
operator|&
name|lighterFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|middlePreview
argument_list|,
operator|&
name|middleFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|darkerPreview
argument_list|,
operator|&
name|darkerFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|lighterVbox
argument_list|,
name|lighterFrame
argument_list|,
name|val_lighter
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|middleVbox
argument_list|,
name|middleFrame
argument_list|,
name|current_val
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|darkerVbox
argument_list|,
name|darkerFrame
argument_list|,
name|val_darker
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|11
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|win
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|lighterVbox
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|middleVbox
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|darkerVbox
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
name|win
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|fp_create_msnls (void)
name|fp_create_msnls
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|,
modifier|*
name|lessFrame
decl_stmt|,
modifier|*
name|middleFrame
decl_stmt|,
modifier|*
name|moreFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|lessVbox
decl_stmt|,
modifier|*
name|middleVbox
decl_stmt|,
modifier|*
name|moreVbox
decl_stmt|;
name|GtkWidget
modifier|*
name|win
decl_stmt|;
name|win
operator|=
name|gtk_window_new
argument_list|(
name|GTK_WINDOW_TOPLEVEL
argument_list|)
expr_stmt|;
name|gimp_help_connect
argument_list|(
name|win
argument_list|,
name|gimp_standard_help_func
argument_list|,
name|HELP_ID
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|win
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Saturation Variations"
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|win
argument_list|,
literal|"delete_event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|sub_dialog_destroy
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|minusSatPreview
argument_list|,
operator|&
name|lessFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|SatPreview
argument_list|,
operator|&
name|middleFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|plusSatPreview
argument_list|,
operator|&
name|moreFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|moreVbox
argument_list|,
name|moreFrame
argument_list|,
name|sat_more
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|middleVbox
argument_list|,
name|middleFrame
argument_list|,
name|current_val
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|lessVbox
argument_list|,
name|lessFrame
argument_list|,
name|sat_less
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|11
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|win
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|moreVbox
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|middleVbox
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|lessVbox
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
name|win
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_change_current_pixels_by (GtkWidget * widget,gpointer data)
name|fp_change_current_pixels_by
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gimp_radio_button_update
argument_list|(
name|widget
argument_list|,
name|data
argument_list|)
expr_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
condition|)
block|{
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
if|if
condition|(
name|AW
operator|.
name|window
operator|&&
name|GTK_WIDGET_VISIBLE
argument_list|(
name|AW
operator|.
name|window
argument_list|)
operator|&&
name|AW
operator|.
name|rangePreview
condition|)
name|fp_range_preview_spill
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|,
name|Current
operator|.
name|ValueBy
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|fp_create_pixels_select_by (void)
name|fp_create_pixels_select_by
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|frame
operator|=
name|gimp_int_radio_group_new
argument_list|(
name|TRUE
argument_list|,
name|_
argument_list|(
literal|"Select Pixels by"
argument_list|)
argument_list|,
name|G_CALLBACK
argument_list|(
name|fp_change_current_pixels_by
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|ValueBy
argument_list|,
name|Current
operator|.
name|ValueBy
argument_list|,
name|_
argument_list|(
literal|"H_ue"
argument_list|)
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
name|_
argument_list|(
literal|"Satu_ration"
argument_list|)
argument_list|,
literal|1
argument_list|,
name|NULL
argument_list|,
name|_
argument_list|(
literal|"V_alue"
argument_list|)
argument_list|,
literal|2
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_change_selection (GtkWidget * widget,gpointer data)
name|fp_change_selection
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gimp_radio_button_update
argument_list|(
name|widget
argument_list|,
name|data
argument_list|)
expr_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
condition|)
block|{
name|fp_redraw_all_windows
argument_list|()
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|fp_create_show (void)
name|fp_create_show
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|frame
operator|=
name|gimp_int_radio_group_new
argument_list|(
name|TRUE
argument_list|,
name|_
argument_list|(
literal|"Show"
argument_list|)
argument_list|,
name|G_CALLBACK
argument_list|(
name|fp_change_selection
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|SlctnOnly
argument_list|,
name|Current
operator|.
name|SlctnOnly
argument_list|,
name|_
argument_list|(
literal|"_Entire Image"
argument_list|)
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
name|_
argument_list|(
literal|"Se_lection Only"
argument_list|)
argument_list|,
literal|1
argument_list|,
name|NULL
argument_list|,
name|_
argument_list|(
literal|"Selec_tion In Context"
argument_list|)
argument_list|,
literal|2
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|Create_A_Preview (GtkWidget ** preview,GtkWidget ** frame,gint previewWidth,gint previewHeight)
name|Create_A_Preview
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|preview
parameter_list|,
name|GtkWidget
modifier|*
modifier|*
name|frame
parameter_list|,
name|gint
name|previewWidth
parameter_list|,
name|gint
name|previewHeight
parameter_list|)
block|{
operator|*
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|frame
argument_list|)
expr_stmt|;
operator|*
name|preview
operator|=
name|gimp_preview_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
operator|*
name|preview
argument_list|,
name|previewWidth
argument_list|,
name|previewHeight
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|preview
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
operator|*
name|preview
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|Check_Button_In_A_Box (GtkWidget * vbox,const gchar * label,GtkSignalFunc function,gpointer data,gboolean clicked)
name|Check_Button_In_A_Box
parameter_list|(
name|GtkWidget
modifier|*
name|vbox
parameter_list|,
specifier|const
name|gchar
modifier|*
name|label
parameter_list|,
name|GtkSignalFunc
name|function
parameter_list|,
name|gpointer
name|data
parameter_list|,
name|gboolean
name|clicked
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|function
argument_list|)
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|clicked
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|Frames_Check_Button_In_A_Box (GtkWidget * vbox,const gchar * label,GtkSignalFunc function,GtkWidget * frame,gboolean clicked)
name|Frames_Check_Button_In_A_Box
parameter_list|(
name|GtkWidget
modifier|*
name|vbox
parameter_list|,
specifier|const
name|gchar
modifier|*
name|label
parameter_list|,
name|GtkSignalFunc
name|function
parameter_list|,
name|GtkWidget
modifier|*
name|frame
parameter_list|,
name|gboolean
name|clicked
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|"ctrlButton"
argument_list|,
operator|(
name|gpointer
operator|)
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|function
argument_list|)
argument_list|,
name|frame
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|clicked
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|Create_A_Table_Entry (GtkWidget ** box,GtkWidget * SmallerFrame,const gchar * description)
name|Create_A_Table_Entry
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|box
parameter_list|,
name|GtkWidget
modifier|*
name|SmallerFrame
parameter_list|,
specifier|const
name|gchar
modifier|*
name|description
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|button
decl_stmt|,
modifier|*
name|table
decl_stmt|;
operator|*
name|box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
operator|*
name|box
argument_list|)
argument_list|,
name|PR_BX_BRDR
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|box
argument_list|)
expr_stmt|;
comment|/* Delayed translation applied here */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|gettext
argument_list|(
name|description
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
operator|*
name|box
argument_list|)
argument_list|,
name|table
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|description
operator|!=
name|current_val
condition|)
block|{
name|button
operator|=
name|gtk_button_new
argument_list|()
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|button
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|button
argument_list|)
argument_list|,
name|SmallerFrame
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|selectionMade
argument_list|)
argument_list|,
operator|(
name|gchar
operator|*
operator|)
name|description
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|SmallerFrame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|4
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_redraw_all_windows (void)
name|fp_redraw_all_windows
parameter_list|(
name|void
parameter_list|)
block|{
name|reduced
operator|=
name|Reduce_The_Image
argument_list|(
name|drawable
argument_list|,
name|mask
argument_list|,
name|Current
operator|.
name|PreviewSize
argument_list|,
name|Current
operator|.
name|SlctnOnly
argument_list|)
expr_stmt|;
name|Adjust_Preview_Sizes
argument_list|(
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|fpFrames
operator|.
name|palette
argument_list|)
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|fpFrames
operator|.
name|satur
argument_list|)
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|fpFrames
operator|.
name|lnd
argument_list|)
expr_stmt|;
name|gtk_widget_queue_draw
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_show_hide_frame (GtkWidget * button,GtkWidget * frame)
name|fp_show_hide_frame
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|GtkWidget
modifier|*
name|frame
parameter_list|)
block|{
name|gint
name|prev
init|=
name|Current
operator|.
name|VisibleFrames
decl_stmt|;
if|if
condition|(
name|frame
operator|==
name|NULL
condition|)
return|return;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
block|{
if|if
condition|(
operator|!
name|GTK_WIDGET_VISIBLE
argument_list|(
name|frame
argument_list|)
condition|)
block|{
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|palette
condition|)
name|Current
operator|.
name|VisibleFrames
operator||=
name|HUE
expr_stmt|;
elseif|else
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|satur
condition|)
name|Current
operator|.
name|VisibleFrames
operator||=
name|SATURATION
expr_stmt|;
elseif|else
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|lnd
condition|)
name|Current
operator|.
name|VisibleFrames
operator||=
name|VALUE
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
operator|&
operator|~
name|prev
argument_list|)
expr_stmt|;
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|fp_range_preview_spill
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|,
name|Current
operator|.
name|ValueBy
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|GTK_WIDGET_VISIBLE
argument_list|(
name|frame
argument_list|)
condition|)
block|{
name|gtk_widget_hide
argument_list|(
name|frame
argument_list|)
expr_stmt|;
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|palette
condition|)
name|Current
operator|.
name|VisibleFrames
operator|&=
operator|~
name|HUE
expr_stmt|;
elseif|else
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|satur
condition|)
name|Current
operator|.
name|VisibleFrames
operator|&=
operator|~
name|SATURATION
expr_stmt|;
elseif|else
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|lnd
condition|)
name|Current
operator|.
name|VisibleFrames
operator|&=
operator|~
name|VALUE
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|Adjust_Preview_Sizes (gint width,gint height)
name|Adjust_Preview_Sizes
parameter_list|(
name|gint
name|width
parameter_list|,
name|gint
name|height
parameter_list|)
block|{
name|gtk_widget_set_size_request
argument_list|(
name|origPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|curPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|rPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|gPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|bPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|cPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|yPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|mPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|centerPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|lighterPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|darkerPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|middlePreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|minusSatPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|SatPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|plusSatPreview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|selectionMade (GtkWidget * widget,gpointer data)
name|selectionMade
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|Current
operator|.
name|Touched
index|[
name|Current
operator|.
name|ValueBy
index|]
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_red
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|RED
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_green
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|GREEN
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_blue
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|BLUE
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_cyan
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|CYAN
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_yellow
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|YELLOW
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_magenta
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|MAGENTA
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|val_darker
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|VALUE
argument_list|,
name|DOWN
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|val_lighter
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|VALUE
argument_list|,
name|UP
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|sat_more
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|SATURATION
argument_list|,
name|UP
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|sat_less
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|SATURATION
argument_list|,
name|DOWN
argument_list|)
expr_stmt|;
block|}
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|refreshPreviews (gint which)
name|refreshPreviews
parameter_list|(
name|gint
name|which
parameter_list|)
block|{
name|fp_Create_Nudge
argument_list|(
name|nudgeArray
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|origPreview
argument_list|,
name|NONEATALL
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|curPreview
argument_list|,
name|CURRENT
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|which
operator|&
name|HUE
condition|)
block|{
name|fp_render_preview
argument_list|(
name|rPreview
argument_list|,
name|HUE
argument_list|,
name|RED
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|gPreview
argument_list|,
name|HUE
argument_list|,
name|GREEN
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|bPreview
argument_list|,
name|HUE
argument_list|,
name|BLUE
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|cPreview
argument_list|,
name|HUE
argument_list|,
name|CYAN
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|yPreview
argument_list|,
name|HUE
argument_list|,
name|YELLOW
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|mPreview
argument_list|,
name|HUE
argument_list|,
name|MAGENTA
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|centerPreview
argument_list|,
name|CURRENT
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|which
operator|&
name|VALUE
condition|)
block|{
name|fp_render_preview
argument_list|(
name|lighterPreview
argument_list|,
name|VALUE
argument_list|,
name|UP
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|middlePreview
argument_list|,
name|CURRENT
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|darkerPreview
argument_list|,
name|VALUE
argument_list|,
name|DOWN
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|which
operator|&
name|SATURATION
condition|)
block|{
name|fp_render_preview
argument_list|(
name|plusSatPreview
argument_list|,
name|SATURATION
argument_list|,
name|UP
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|SatPreview
argument_list|,
name|CURRENT
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|minusSatPreview
argument_list|,
name|SATURATION
argument_list|,
name|DOWN
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_response (GtkWidget * widget,gint response_id,gpointer data)
name|fp_response
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gint
name|response_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
switch|switch
condition|(
name|response_id
condition|)
block|{
case|case
name|RESPONSE_RESET
case|:
name|resetFilterPacks
argument_list|()
expr_stmt|;
break|break;
case|case
name|GTK_RESPONSE_OK
case|:
name|FPint
operator|.
name|run
operator|=
name|TRUE
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|widget
argument_list|)
expr_stmt|;
break|break;
default|default:
name|gtk_widget_destroy
argument_list|(
name|widget
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_scale_update (GtkAdjustment * adjustment,float * scale_val)
name|fp_scale_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|float
modifier|*
name|scale_val
parameter_list|)
block|{
specifier|static
name|gfloat
name|prevValue
init|=
literal|0.25
decl_stmt|;
operator|*
name|scale_val
operator|=
name|adjustment
operator|->
name|value
expr_stmt|;
if|if
condition|(
name|prevValue
operator|!=
name|adjustment
operator|->
name|value
condition|)
block|{
name|fp_Create_Nudge
argument_list|(
name|nudgeArray
argument_list|)
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
if|if
condition|(
name|AW
operator|.
name|window
operator|!=
name|NULL
operator|&&
name|GTK_WIDGET_VISIBLE
argument_list|(
name|AW
operator|.
name|window
argument_list|)
condition|)
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|prevValue
operator|=
name|adjustment
operator|->
name|value
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|gboolean
DECL|function|fp_dialog (void)
name|fp_dialog
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|bna
decl_stmt|;
name|GtkWidget
modifier|*
name|palette
decl_stmt|;
name|GtkWidget
modifier|*
name|lnd
decl_stmt|;
name|GtkWidget
modifier|*
name|show
decl_stmt|;
name|GtkWidget
modifier|*
name|rough
decl_stmt|;
name|GtkWidget
modifier|*
name|range
decl_stmt|;
name|GtkWidget
modifier|*
name|pixelsBy
decl_stmt|;
name|GtkWidget
modifier|*
name|satur
decl_stmt|;
name|GtkWidget
modifier|*
name|control
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|reduced
operator|=
name|Reduce_The_Image
argument_list|(
name|drawable
argument_list|,
name|mask
argument_list|,
name|Current
operator|.
name|PreviewSize
argument_list|,
name|Current
operator|.
name|SlctnOnly
argument_list|)
expr_stmt|;
name|gimp_ui_init
argument_list|(
literal|"fp"
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|dlg
operator|=
name|gimp_dialog_new
argument_list|(
name|_
argument_list|(
literal|"Filter Pack Simulation"
argument_list|)
argument_list|,
literal|"fp"
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|,
name|gimp_standard_help_func
argument_list|,
name|HELP_ID
argument_list|,
name|GIMP_STOCK_RESET
argument_list|,
name|RESPONSE_RESET
argument_list|,
name|GTK_STOCK_CANCEL
argument_list|,
name|GTK_RESPONSE_CANCEL
argument_list|,
name|GTK_STOCK_OK
argument_list|,
name|GTK_RESPONSE_OK
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_dialog_set_alternative_button_order
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
argument_list|,
name|RESPONSE_RESET
argument_list|,
name|GTK_RESPONSE_OK
argument_list|,
name|GTK_RESPONSE_CANCEL
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|dlg
argument_list|,
literal|"response"
argument_list|,
name|G_CALLBACK
argument_list|(
name|fp_response
argument_list|)
argument_list|,
name|dlg
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|dlg
argument_list|,
literal|"destroy"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gtk_main_quit
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|fp_advanced_dialog
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|bna
operator|=
name|bna
operator|=
name|fp_create_bna
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|rough
operator|=
name|rough
operator|=
name|fp_create_rough
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|range
operator|=
name|range
operator|=
name|fp_create_range
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|palette
operator|=
name|palette
operator|=
name|fp_create_circle_palette
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|lnd
operator|=
name|lnd
operator|=
name|fp_create_lnd
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|show
operator|=
name|show
operator|=
name|fp_create_show
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|satur
operator|=
name|satur
operator|=
name|fp_create_msnls
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|pixelsBy
operator|=
name|pixelsBy
operator|=
name|fp_create_pixels_select_by
argument_list|()
expr_stmt|;
name|control
operator|=
name|fp_create_control
argument_list|()
expr_stmt|;
comment|/********************************************************************/
comment|/********************   PUT EVERYTHING TOGETHER    ******************/
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|4
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|bna
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|control
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|rough
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|show
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|range
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixelsBy
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
name|gtk_main
argument_list|()
expr_stmt|;
return|return
name|FPint
operator|.
name|run
return|;
block|}
end_function

begin_comment
comment|/***********************************************************/
end_comment

begin_comment
comment|/************   Advanced Options Window   ******************/
end_comment

begin_comment
comment|/***********************************************************/
end_comment

begin_function
specifier|static
name|void
DECL|function|As_You_Drag (GtkWidget * button)
name|As_You_Drag
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|)
block|{
specifier|static
name|gboolean
name|notFirstTime
init|=
name|FALSE
decl_stmt|;
if|if
condition|(
operator|!
name|notFirstTime
condition|)
return|return;
name|notFirstTime
operator|=
name|TRUE
expr_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
block|{
name|Current
operator|.
name|RealTime
operator|=
name|TRUE
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|roughnessScale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|aliasingScale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|previewSizeScale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|Current
operator|.
name|RealTime
operator|=
name|FALSE
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|roughnessScale
argument_list|)
argument_list|,
name|GTK_UPDATE_DELAYED
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|aliasingScale
argument_list|)
argument_list|,
name|GTK_UPDATE_DELAYED
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|previewSizeScale
argument_list|)
argument_list|,
name|GTK_UPDATE_DELAYED
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|preview_size_scale_update (GtkAdjustment * adjustment,float * scale_val)
name|preview_size_scale_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|float
modifier|*
name|scale_val
parameter_list|)
block|{
name|Current
operator|.
name|PreviewSize
operator|=
name|adjustment
operator|->
name|value
expr_stmt|;
name|fp_redraw_all_windows
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_advanced_dialog (void)
name|fp_advanced_dialog
parameter_list|(
name|void
parameter_list|)
block|{
name|gchar
modifier|*
name|rangeNames
index|[]
init|=
block|{
name|N_
argument_list|(
literal|"Shadows:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Midtones:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Highlights:"
argument_list|)
block|}
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|mainvbox
decl_stmt|;
name|GtkObject
modifier|*
name|smoothnessData
decl_stmt|;
name|GtkWidget
modifier|*
name|graphFrame
decl_stmt|,
modifier|*
name|table
decl_stmt|,
modifier|*
name|scale
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|,
modifier|*
name|label
decl_stmt|,
modifier|*
name|labelTable
decl_stmt|,
modifier|*
name|alignment
decl_stmt|,
modifier|*
name|inner_vbox
decl_stmt|;
name|gint
name|i
decl_stmt|;
name|AW
operator|.
name|window
operator|=
name|gtk_window_new
argument_list|(
name|GTK_WINDOW_TOPLEVEL
argument_list|)
expr_stmt|;
name|gimp_help_connect
argument_list|(
name|AW
operator|.
name|window
argument_list|,
name|gimp_standard_help_func
argument_list|,
name|HELP_ID
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|AW
operator|.
name|window
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Advanced Filter Pack Options"
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|AW
operator|.
name|window
argument_list|,
literal|"delete_event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|sub_dialog_destroy
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|mainvbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|mainvbox
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|AW
operator|.
name|window
argument_list|)
argument_list|,
name|mainvbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|mainvbox
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Smoothness of Aliasing"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|mainvbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|graphFrame
operator|=
name|gtk_aspect_frame_new
argument_list|(
name|NULL
argument_list|,
literal|0.5
argument_list|,
literal|0.5
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|graphFrame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|graphFrame
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|graphFrame
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|graphFrame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|graphFrame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|alignment
operator|=
name|gtk_alignment_new
argument_list|(
literal|0.5
argument_list|,
literal|0.5
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start_defaults
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|alignment
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|alignment
argument_list|)
expr_stmt|;
name|inner_vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|alignment
argument_list|)
argument_list|,
name|inner_vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|inner_vbox
argument_list|)
expr_stmt|;
name|AW
operator|.
name|aliasingPreview
operator|=
name|gimp_preview_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|,
literal|256
argument_list|,
name|MAX_ROUGHNESS
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|inner_vbox
argument_list|)
argument_list|,
name|AW
operator|.
name|aliasingPreview
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|AW
operator|.
name|rangePreview
operator|=
name|gimp_preview_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|,
literal|256
argument_list|,
name|RANGE_HEIGHT
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|inner_vbox
argument_list|)
argument_list|,
name|AW
operator|.
name|rangePreview
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|)
expr_stmt|;
name|fp_range_preview_spill
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|,
name|Current
operator|.
name|ValueBy
argument_list|)
expr_stmt|;
name|labelTable
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|labelTable
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|labelTable
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|labelTable
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|labelTable
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|12
condition|;
name|i
operator|++
control|)
block|{
name|label
operator|=
name|Current
operator|.
name|rangeLabels
index|[
name|i
index|]
operator|=
name|gtk_label_new
argument_list|(
literal|"-"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|i
operator|%
literal|4
operator|)
condition|)
block|{
name|gtk_label_set_text
argument_list|(
name|GTK_LABEL
argument_list|(
name|label
argument_list|)
argument_list|,
name|gettext
argument_list|(
name|rangeNames
index|[
name|i
operator|/
literal|4
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|labelTable
argument_list|)
argument_list|,
name|label
argument_list|,
name|i
operator|%
literal|4
argument_list|,
name|i
operator|%
literal|4
operator|+
literal|1
argument_list|,
name|i
operator|/
literal|4
argument_list|,
name|i
operator|/
literal|4
operator|+
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
comment|/************************************************************/
name|AW
operator|.
name|aliasingGraph
operator|=
name|gtk_drawing_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|AW
operator|.
name|aliasingGraph
argument_list|,
literal|2
operator|*
name|MARGIN
operator|+
literal|256
argument_list|,
name|RANGE_HEIGHT
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|AW
operator|.
name|aliasingGraph
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|AW
operator|.
name|aliasingGraph
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|AW
operator|.
name|aliasingGraph
argument_list|,
name|RANGE_ADJUST_MASK
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|AW
operator|.
name|aliasingGraph
argument_list|,
literal|"event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|FP_Range_Change_Events
argument_list|)
argument_list|,
operator|&
name|Current
argument_list|)
expr_stmt|;
comment|/************************************************************/
name|smoothnessData
operator|=
name|gtk_adjustment_new
argument_list|(
name|Current
operator|.
name|Alias
argument_list|,
literal|0
argument_list|,
literal|1.0
argument_list|,
literal|0.05
argument_list|,
literal|0.01
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|Current
operator|.
name|aliasingScale
operator|=
name|scale
operator|=
name|gtk_hscale_new
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|smoothnessData
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|scale
argument_list|,
literal|200
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gtk_scale_set_digits
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_scale_set_value_pos
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|scale
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|smoothnessData
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|fp_scale_update
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|Alias
argument_list|)
expr_stmt|;
comment|/******************* MISC OPTIONS ***************************/
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|mainvbox
argument_list|)
argument_list|,
name|vbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|Check_Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|_
argument_list|(
literal|"Preview as You Drag"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|As_You_Drag
argument_list|)
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Preview Size"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|smoothnessData
operator|=
name|gtk_adjustment_new
argument_list|(
name|Current
operator|.
name|PreviewSize
argument_list|,
literal|50
argument_list|,
name|MAX_PREVIEW_SIZE
argument_list|,
literal|5
argument_list|,
literal|5
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|Current
operator|.
name|previewSizeScale
operator|=
name|scale
operator|=
name|gtk_hscale_new
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|smoothnessData
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|scale
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|scale
argument_list|,
literal|100
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gtk_scale_set_digits
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_scale_set_value_pos
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|smoothnessData
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|preview_size_scale_update
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|PreviewSize
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|slider_erase (GdkWindow * window,int xpos)
name|slider_erase
parameter_list|(
name|GdkWindow
modifier|*
name|window
parameter_list|,
name|int
name|xpos
parameter_list|)
block|{
name|gdk_window_clear_area
argument_list|(
name|window
argument_list|,
name|MARGIN
operator|+
name|xpos
operator|-
operator|(
name|RANGE_HEIGHT
operator|-
literal|1
operator|)
operator|/
literal|2
argument_list|,
literal|0
argument_list|,
name|RANGE_HEIGHT
argument_list|,
name|RANGE_HEIGHT
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|draw_slider (GdkWindow * window,GdkGC * border_gc,GdkGC * fill_gc,gint xpos)
name|draw_slider
parameter_list|(
name|GdkWindow
modifier|*
name|window
parameter_list|,
name|GdkGC
modifier|*
name|border_gc
parameter_list|,
name|GdkGC
modifier|*
name|fill_gc
parameter_list|,
name|gint
name|xpos
parameter_list|)
block|{
name|gint
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|RANGE_HEIGHT
condition|;
name|i
operator|++
control|)
name|gdk_draw_line
argument_list|(
name|window
argument_list|,
name|fill_gc
argument_list|,
name|MARGIN
operator|+
name|xpos
operator|-
name|i
operator|/
literal|2
argument_list|,
name|i
argument_list|,
name|MARGIN
operator|+
name|xpos
operator|+
name|i
operator|/
literal|2
argument_list|,
name|i
argument_list|)
expr_stmt|;
name|gdk_draw_line
argument_list|(
name|window
argument_list|,
name|border_gc
argument_list|,
name|MARGIN
operator|+
name|xpos
argument_list|,
literal|0
argument_list|,
name|MARGIN
operator|+
name|xpos
operator|-
operator|(
name|RANGE_HEIGHT
operator|-
literal|1
operator|)
operator|/
literal|2
argument_list|,
name|RANGE_HEIGHT
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gdk_draw_line
argument_list|(
name|window
argument_list|,
name|border_gc
argument_list|,
name|MARGIN
operator|+
name|xpos
argument_list|,
literal|0
argument_list|,
name|MARGIN
operator|+
name|xpos
operator|+
operator|(
name|RANGE_HEIGHT
operator|-
literal|1
operator|)
operator|/
literal|2
argument_list|,
name|RANGE_HEIGHT
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gdk_draw_line
argument_list|(
name|window
argument_list|,
name|border_gc
argument_list|,
name|MARGIN
operator|+
name|xpos
operator|-
operator|(
name|RANGE_HEIGHT
operator|-
literal|1
operator|)
operator|/
literal|2
argument_list|,
name|RANGE_HEIGHT
operator|-
literal|1
argument_list|,
name|MARGIN
operator|+
name|xpos
operator|+
operator|(
name|RANGE_HEIGHT
operator|-
literal|1
operator|)
operator|/
literal|2
argument_list|,
name|RANGE_HEIGHT
operator|-
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|draw_it (GtkWidget * widget)
name|draw_it
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|)
block|{
name|draw_slider
argument_list|(
name|AW
operator|.
name|aliasingGraph
operator|->
name|window
argument_list|,
name|AW
operator|.
name|aliasingGraph
operator|->
name|style
operator|->
name|black_gc
argument_list|,
name|AW
operator|.
name|aliasingGraph
operator|->
name|style
operator|->
name|dark_gc
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|Current
operator|.
name|Cutoffs
index|[
name|SHADOWS
index|]
argument_list|)
expr_stmt|;
name|draw_slider
argument_list|(
name|AW
operator|.
name|aliasingGraph
operator|->
name|window
argument_list|,
name|AW
operator|.
name|aliasingGraph
operator|->
name|style
operator|->
name|black_gc
argument_list|,
name|AW
operator|.
name|aliasingGraph
operator|->
name|style
operator|->
name|dark_gc
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|Current
operator|.
name|Cutoffs
index|[
name|MIDTONES
index|]
argument_list|)
expr_stmt|;
name|draw_slider
argument_list|(
name|AW
operator|.
name|aliasingGraph
operator|->
name|window
argument_list|,
name|AW
operator|.
name|aliasingGraph
operator|->
name|style
operator|->
name|black_gc
argument_list|,
name|AW
operator|.
name|aliasingGraph
operator|->
name|style
operator|->
name|dark_gc
index|[
name|GTK_STATE_SELECTED
index|]
argument_list|,
name|Current
operator|.
name|Offset
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gboolean
DECL|function|FP_Range_Change_Events (GtkWidget * widget,GdkEvent * event,FP_Params * current)
name|FP_Range_Change_Events
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|,
name|FP_Params
modifier|*
name|current
parameter_list|)
block|{
name|GdkEventButton
modifier|*
name|bevent
decl_stmt|;
name|GdkEventMotion
modifier|*
name|mevent
decl_stmt|;
name|gint
name|shad
decl_stmt|,
name|mid
decl_stmt|,
name|offset
decl_stmt|,
name|min
decl_stmt|;
specifier|static
name|guchar
modifier|*
name|new
decl_stmt|;
name|gint
name|x
decl_stmt|;
switch|switch
condition|(
name|event
operator|->
name|type
condition|)
block|{
case|case
name|GDK_EXPOSE
case|:
name|draw_it
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
break|break;
case|case
name|GDK_BUTTON_PRESS
case|:
name|bevent
operator|=
operator|(
name|GdkEventButton
operator|*
operator|)
name|event
expr_stmt|;
name|shad
operator|=
name|abs
argument_list|(
name|bevent
operator|->
name|x
operator|-
name|Current
operator|.
name|Cutoffs
index|[
name|SHADOWS
index|]
argument_list|)
expr_stmt|;
name|mid
operator|=
name|abs
argument_list|(
name|bevent
operator|->
name|x
operator|-
name|Current
operator|.
name|Cutoffs
index|[
name|MIDTONES
index|]
argument_list|)
expr_stmt|;
name|offset
operator|=
name|abs
argument_list|(
name|bevent
operator|->
name|x
operator|-
name|Current
operator|.
name|Offset
argument_list|)
expr_stmt|;
name|min
operator|=
name|MIN
argument_list|(
name|MIN
argument_list|(
name|shad
argument_list|,
name|mid
argument_list|)
argument_list|,
name|offset
argument_list|)
expr_stmt|;
if|if
condition|(
name|bevent
operator|->
name|x
operator|>
literal|0
operator|&&
name|bevent
operator|->
name|x
operator|<
literal|256
condition|)
block|{
if|if
condition|(
name|min
operator|==
name|shad
condition|)
name|new
operator|=
operator|&
name|Current
operator|.
name|Cutoffs
index|[
name|SHADOWS
index|]
expr_stmt|;
elseif|else
if|if
condition|(
name|min
operator|==
name|mid
condition|)
name|new
operator|=
operator|&
name|Current
operator|.
name|Cutoffs
index|[
name|MIDTONES
index|]
expr_stmt|;
else|else
name|new
operator|=
operator|&
name|Current
operator|.
name|Offset
expr_stmt|;
name|slider_erase
argument_list|(
name|AW
operator|.
name|aliasingGraph
operator|->
name|window
argument_list|,
operator|*
name|new
argument_list|)
expr_stmt|;
operator|*
name|new
operator|=
name|bevent
operator|->
name|x
expr_stmt|;
block|}
name|draw_it
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|RealTime
condition|)
block|{
name|fp_range_preview_spill
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|,
name|Current
operator|.
name|ValueBy
argument_list|)
expr_stmt|;
name|update_range_labels
argument_list|()
expr_stmt|;
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|GDK_BUTTON_RELEASE
case|:
if|if
condition|(
operator|!
name|Current
operator|.
name|RealTime
condition|)
block|{
name|fp_range_preview_spill
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|,
name|Current
operator|.
name|ValueBy
argument_list|)
expr_stmt|;
name|update_range_labels
argument_list|()
expr_stmt|;
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|GDK_MOTION_NOTIFY
case|:
name|mevent
operator|=
operator|(
name|GdkEventMotion
operator|*
operator|)
name|event
expr_stmt|;
name|gdk_window_get_pointer
argument_list|(
name|widget
operator|->
name|window
argument_list|,
operator|&
name|x
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|x
operator|>=
literal|0
operator|&&
name|x
operator|<
literal|256
condition|)
block|{
name|slider_erase
argument_list|(
name|AW
operator|.
name|aliasingGraph
operator|->
name|window
argument_list|,
operator|*
name|new
argument_list|)
expr_stmt|;
operator|*
name|new
operator|=
name|x
expr_stmt|;
name|draw_it
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|RealTime
condition|)
block|{
name|fp_range_preview_spill
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|,
name|Current
operator|.
name|ValueBy
argument_list|)
expr_stmt|;
name|update_range_labels
argument_list|()
expr_stmt|;
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
block|}
block|}
break|break;
default|default:
break|break;
block|}
return|return
name|FALSE
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|update_range_labels (void)
name|update_range_labels
parameter_list|(
name|void
parameter_list|)
block|{
name|gchar
name|buffer
index|[
literal|3
index|]
decl_stmt|;
name|gtk_label_set_text
argument_list|(
name|GTK_LABEL
argument_list|(
name|Current
operator|.
name|rangeLabels
index|[
literal|1
index|]
argument_list|)
argument_list|,
literal|"0"
argument_list|)
expr_stmt|;
name|g_snprintf
argument_list|(
name|buffer
argument_list|,
sizeof|sizeof
argument_list|(
name|buffer
argument_list|)
argument_list|,
literal|"%d"
argument_list|,
name|Current
operator|.
name|Cutoffs
index|[
name|SHADOWS
index|]
argument_list|)
expr_stmt|;
name|gtk_label_set_text
argument_list|(
name|GTK_LABEL
argument_list|(
name|Current
operator|.
name|rangeLabels
index|[
literal|3
index|]
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|gtk_label_set_text
argument_list|(
name|GTK_LABEL
argument_list|(
name|Current
operator|.
name|rangeLabels
index|[
literal|5
index|]
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|g_snprintf
argument_list|(
name|buffer
argument_list|,
sizeof|sizeof
argument_list|(
name|buffer
argument_list|)
argument_list|,
literal|"%d"
argument_list|,
name|Current
operator|.
name|Cutoffs
index|[
name|MIDTONES
index|]
argument_list|)
expr_stmt|;
name|gtk_label_set_text
argument_list|(
name|GTK_LABEL
argument_list|(
name|Current
operator|.
name|rangeLabels
index|[
literal|7
index|]
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|gtk_label_set_text
argument_list|(
name|GTK_LABEL
argument_list|(
name|Current
operator|.
name|rangeLabels
index|[
literal|9
index|]
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|gtk_label_set_text
argument_list|(
name|GTK_LABEL
argument_list|(
name|Current
operator|.
name|rangeLabels
index|[
literal|11
index|]
argument_list|)
argument_list|,
literal|"255"
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|initializeFilterPacks (void)
name|initializeFilterPacks
parameter_list|(
name|void
parameter_list|)
block|{
name|gint
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|256
condition|;
name|i
operator|++
control|)
for|for
control|(
name|j
operator|=
name|BY_HUE
init|;
name|j
operator|<
name|JUDGE_BY
condition|;
name|j
operator|++
control|)
block|{
name|Current
operator|.
name|redAdj
index|[
name|j
index|]
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
name|Current
operator|.
name|greenAdj
index|[
name|j
index|]
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
name|Current
operator|.
name|blueAdj
index|[
name|j
index|]
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
name|Current
operator|.
name|satAdj
index|[
name|j
index|]
index|[
name|i
index|]
operator|=
literal|0
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|resetFilterPacks (void)
name|resetFilterPacks
parameter_list|(
name|void
parameter_list|)
block|{
name|initializeFilterPacks
argument_list|()
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|ReducedImage
modifier|*
DECL|function|Reduce_The_Image (GimpDrawable * drawable,GimpDrawable * mask,gint LongerSize,gint Slctn)
name|Reduce_The_Image
parameter_list|(
name|GimpDrawable
modifier|*
name|drawable
parameter_list|,
name|GimpDrawable
modifier|*
name|mask
parameter_list|,
name|gint
name|LongerSize
parameter_list|,
name|gint
name|Slctn
parameter_list|)
block|{
name|gint
name|RH
decl_stmt|,
name|RW
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|,
name|bytes
init|=
name|drawable
operator|->
name|bpp
decl_stmt|;
name|ReducedImage
modifier|*
name|temp
init|=
operator|(
name|ReducedImage
operator|*
operator|)
name|malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|ReducedImage
argument_list|)
argument_list|)
decl_stmt|;
name|guchar
modifier|*
name|tempRGB
decl_stmt|,
modifier|*
name|src_row
decl_stmt|,
modifier|*
name|tempmask
decl_stmt|,
modifier|*
name|src_mask_row
decl_stmt|,
name|R
decl_stmt|,
name|G
decl_stmt|,
name|B
decl_stmt|;
name|gint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|whichcol
decl_stmt|,
name|whichrow
decl_stmt|,
name|x1
decl_stmt|,
name|x2
decl_stmt|,
name|y1
decl_stmt|,
name|y2
decl_stmt|;
name|GimpPixelRgn
name|srcPR
decl_stmt|,
name|srcMask
decl_stmt|;
name|gboolean
name|NoSelectionMade
init|=
name|TRUE
decl_stmt|;
name|gdouble
modifier|*
name|tempHSV
decl_stmt|;
name|GimpRGB
name|rgb
decl_stmt|;
name|GimpHSV
name|hsv
decl_stmt|;
name|gimp_drawable_mask_bounds
argument_list|(
name|drawable
operator|->
name|drawable_id
argument_list|,
operator|&
name|x1
argument_list|,
operator|&
name|y1
argument_list|,
operator|&
name|x2
argument_list|,
operator|&
name|y2
argument_list|)
expr_stmt|;
name|width
operator|=
name|x2
operator|-
name|x1
expr_stmt|;
name|height
operator|=
name|y2
operator|-
name|y1
expr_stmt|;
if|if
condition|(
name|width
operator|!=
name|drawable
operator|->
name|width
operator|&&
name|height
operator|!=
name|drawable
operator|->
name|height
condition|)
name|NoSelectionMade
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|Slctn
operator|==
literal|0
condition|)
block|{
name|x1
operator|=
literal|0
expr_stmt|;
name|x2
operator|=
name|drawable
operator|->
name|width
expr_stmt|;
name|y1
operator|=
literal|0
expr_stmt|;
name|y2
operator|=
name|drawable
operator|->
name|height
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|Slctn
operator|==
literal|2
condition|)
block|{
name|x1
operator|=
name|MAX
argument_list|(
literal|0
argument_list|,
name|x1
operator|-
name|width
operator|/
literal|2.0
argument_list|)
expr_stmt|;
name|x2
operator|=
name|MIN
argument_list|(
name|drawable
operator|->
name|width
argument_list|,
name|x2
operator|+
name|width
operator|/
literal|2.0
argument_list|)
expr_stmt|;
name|y1
operator|=
name|MAX
argument_list|(
literal|0
argument_list|,
name|y1
operator|-
name|height
operator|/
literal|2.0
argument_list|)
expr_stmt|;
name|y2
operator|=
name|MIN
argument_list|(
name|drawable
operator|->
name|height
argument_list|,
name|y2
operator|+
name|height
operator|/
literal|2.0
argument_list|)
expr_stmt|;
block|}
name|width
operator|=
name|x2
operator|-
name|x1
expr_stmt|;
name|height
operator|=
name|y2
operator|-
name|y1
expr_stmt|;
if|if
condition|(
name|width
operator|>
name|height
condition|)
block|{
name|RW
operator|=
name|LongerSize
expr_stmt|;
name|RH
operator|=
operator|(
name|gfloat
operator|)
name|height
operator|*
operator|(
name|gfloat
operator|)
name|LongerSize
operator|/
operator|(
name|gfloat
operator|)
name|width
expr_stmt|;
block|}
else|else
block|{
name|RH
operator|=
name|LongerSize
expr_stmt|;
name|RW
operator|=
operator|(
name|gfloat
operator|)
name|width
operator|*
operator|(
name|gfloat
operator|)
name|LongerSize
operator|/
operator|(
name|gfloat
operator|)
name|height
expr_stmt|;
block|}
name|tempRGB
operator|=
operator|(
name|guchar
operator|*
operator|)
name|malloc
argument_list|(
name|RW
operator|*
name|RH
operator|*
name|bytes
argument_list|)
expr_stmt|;
name|tempHSV
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|malloc
argument_list|(
name|RW
operator|*
name|RH
operator|*
name|bytes
operator|*
sizeof|sizeof
argument_list|(
name|gdouble
argument_list|)
argument_list|)
expr_stmt|;
name|tempmask
operator|=
operator|(
name|guchar
operator|*
operator|)
name|malloc
argument_list|(
name|RW
operator|*
name|RH
argument_list|)
expr_stmt|;
name|gimp_pixel_rgn_init
argument_list|(
operator|&
name|srcPR
argument_list|,
name|drawable
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_pixel_rgn_init
argument_list|(
operator|&
name|srcMask
argument_list|,
name|mask
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|src_row
operator|=
operator|(
name|guchar
operator|*
operator|)
name|malloc
argument_list|(
name|width
operator|*
name|bytes
argument_list|)
expr_stmt|;
name|src_mask_row
operator|=
operator|(
name|guchar
operator|*
operator|)
name|malloc
argument_list|(
name|width
operator|*
name|bytes
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|RH
condition|;
name|i
operator|++
control|)
block|{
name|whichrow
operator|=
operator|(
name|gfloat
operator|)
name|i
operator|*
operator|(
name|gfloat
operator|)
name|height
operator|/
operator|(
name|gfloat
operator|)
name|RH
expr_stmt|;
name|gimp_pixel_rgn_get_row
argument_list|(
operator|&
name|srcPR
argument_list|,
name|src_row
argument_list|,
name|x1
argument_list|,
name|y1
operator|+
name|whichrow
argument_list|,
name|width
argument_list|)
expr_stmt|;
name|gimp_pixel_rgn_get_row
argument_list|(
operator|&
name|srcMask
argument_list|,
name|src_mask_row
argument_list|,
name|x1
argument_list|,
name|y1
operator|+
name|whichrow
argument_list|,
name|width
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|RW
condition|;
name|j
operator|++
control|)
block|{
name|whichcol
operator|=
operator|(
name|gfloat
operator|)
name|j
operator|*
operator|(
name|gfloat
operator|)
name|width
operator|/
operator|(
name|gfloat
operator|)
name|RW
expr_stmt|;
if|if
condition|(
name|NoSelectionMade
condition|)
name|tempmask
index|[
name|i
operator|*
name|RW
operator|+
name|j
index|]
operator|=
literal|255
expr_stmt|;
else|else
name|tempmask
index|[
name|i
operator|*
name|RW
operator|+
name|j
index|]
operator|=
name|src_mask_row
index|[
name|whichcol
index|]
expr_stmt|;
name|R
operator|=
name|src_row
index|[
name|whichcol
operator|*
name|bytes
operator|+
literal|0
index|]
expr_stmt|;
name|G
operator|=
name|src_row
index|[
name|whichcol
operator|*
name|bytes
operator|+
literal|1
index|]
expr_stmt|;
name|B
operator|=
name|src_row
index|[
name|whichcol
operator|*
name|bytes
operator|+
literal|2
index|]
expr_stmt|;
name|gimp_rgb_set_uchar
argument_list|(
operator|&
name|rgb
argument_list|,
name|R
argument_list|,
name|G
argument_list|,
name|B
argument_list|)
expr_stmt|;
name|gimp_rgb_to_hsv
argument_list|(
operator|&
name|rgb
argument_list|,
operator|&
name|hsv
argument_list|)
expr_stmt|;
name|tempRGB
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|0
index|]
operator|=
name|R
expr_stmt|;
name|tempRGB
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|1
index|]
operator|=
name|G
expr_stmt|;
name|tempRGB
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|2
index|]
operator|=
name|B
expr_stmt|;
name|tempHSV
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|0
index|]
operator|=
name|hsv
operator|.
name|h
expr_stmt|;
name|tempHSV
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|1
index|]
operator|=
name|hsv
operator|.
name|s
expr_stmt|;
name|tempHSV
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|2
index|]
operator|=
name|hsv
operator|.
name|v
expr_stmt|;
if|if
condition|(
name|bytes
operator|==
literal|4
condition|)
name|tempRGB
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|3
index|]
operator|=
name|src_row
index|[
name|whichcol
operator|*
name|bytes
operator|+
literal|3
index|]
expr_stmt|;
block|}
block|}
name|temp
operator|->
name|width
operator|=
name|RW
expr_stmt|;
name|temp
operator|->
name|height
operator|=
name|RH
expr_stmt|;
name|temp
operator|->
name|rgb
operator|=
name|tempRGB
expr_stmt|;
name|temp
operator|->
name|hsv
operator|=
name|tempHSV
expr_stmt|;
name|temp
operator|->
name|mask
operator|=
name|tempmask
expr_stmt|;
return|return
name|temp
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_render_preview (GtkWidget * preview,gint changewhat,gint changewhich)
name|fp_render_preview
parameter_list|(
name|GtkWidget
modifier|*
name|preview
parameter_list|,
name|gint
name|changewhat
parameter_list|,
name|gint
name|changewhich
parameter_list|)
block|{
name|guchar
modifier|*
name|a
decl_stmt|;
name|gint
name|Inten
decl_stmt|,
name|bytes
init|=
name|drawable
operator|->
name|bpp
decl_stmt|;
name|gint
name|i
decl_stmt|,
name|j
decl_stmt|,
name|k
decl_stmt|,
name|nudge
decl_stmt|,
name|M
decl_stmt|,
name|m
decl_stmt|,
name|middle
decl_stmt|,
name|JudgeBy
decl_stmt|;
name|float
name|partial
decl_stmt|;
name|gint
name|RW
init|=
name|reduced
operator|->
name|width
decl_stmt|;
name|gint
name|RH
init|=
name|reduced
operator|->
name|height
decl_stmt|;
name|gint
name|backupP
index|[
literal|3
index|]
decl_stmt|,
name|P
index|[
literal|3
index|]
decl_stmt|,
name|tempSat
index|[
name|JUDGE_BY
index|]
index|[
literal|256
index|]
decl_stmt|;
name|a
operator|=
name|g_new
argument_list|(
name|guchar
argument_list|,
literal|4
operator|*
name|RW
operator|*
name|RH
argument_list|)
expr_stmt|;
if|if
condition|(
name|changewhat
operator|==
name|SATURATION
condition|)
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
literal|256
condition|;
name|k
operator|++
control|)
block|{
for|for
control|(
name|JudgeBy
operator|=
name|BY_HUE
init|;
name|JudgeBy
operator|<
name|JUDGE_BY
condition|;
name|JudgeBy
operator|++
control|)
name|tempSat
index|[
name|JudgeBy
index|]
index|[
name|k
index|]
operator|=
literal|0
expr_stmt|;
name|tempSat
index|[
name|Current
operator|.
name|ValueBy
index|]
index|[
name|k
index|]
operator|+=
name|changewhich
operator|*
name|nudgeArray
index|[
operator|(
name|k
operator|+
name|Current
operator|.
name|Offset
operator|)
operator|%
literal|256
index|]
expr_stmt|;
block|}
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|RH
condition|;
name|i
operator|++
control|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|RW
condition|;
name|j
operator|++
control|)
block|{
name|backupP
index|[
literal|0
index|]
operator|=
name|P
index|[
literal|0
index|]
operator|=
operator|(
name|int
operator|)
name|reduced
operator|->
name|rgb
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|0
index|]
expr_stmt|;
name|backupP
index|[
literal|1
index|]
operator|=
name|P
index|[
literal|1
index|]
operator|=
operator|(
name|int
operator|)
name|reduced
operator|->
name|rgb
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|1
index|]
expr_stmt|;
name|backupP
index|[
literal|2
index|]
operator|=
name|P
index|[
literal|2
index|]
operator|=
operator|(
name|int
operator|)
name|reduced
operator|->
name|rgb
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|2
index|]
expr_stmt|;
name|m
operator|=
name|MIN
argument_list|(
name|MIN
argument_list|(
name|P
index|[
literal|0
index|]
argument_list|,
name|P
index|[
literal|1
index|]
argument_list|)
argument_list|,
name|P
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|M
operator|=
name|MAX
argument_list|(
name|MAX
argument_list|(
name|P
index|[
literal|0
index|]
argument_list|,
name|P
index|[
literal|1
index|]
argument_list|)
argument_list|,
name|P
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|middle
operator|=
operator|(
name|M
operator|+
name|m
operator|)
operator|/
literal|2
expr_stmt|;
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
literal|3
condition|;
name|k
operator|++
control|)
if|if
condition|(
name|P
index|[
name|k
index|]
operator|!=
name|m
operator|&&
name|P
index|[
name|k
index|]
operator|!=
name|M
condition|)
name|middle
operator|=
name|P
index|[
name|k
index|]
expr_stmt|;
name|partial
operator|=
name|reduced
operator|->
name|mask
index|[
name|i
operator|*
name|RW
operator|+
name|j
index|]
operator|/
literal|255.0
expr_stmt|;
for|for
control|(
name|JudgeBy
operator|=
name|BY_HUE
init|;
name|JudgeBy
operator|<
name|JUDGE_BY
condition|;
name|JudgeBy
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|Current
operator|.
name|Touched
index|[
name|JudgeBy
index|]
condition|)
continue|continue;
name|Inten
operator|=
name|reduced
operator|->
name|hsv
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
name|JudgeBy
index|]
operator|*
literal|255.0
expr_stmt|;
comment|/*DO SATURATION FIRST*/
if|if
condition|(
name|changewhat
operator|!=
name|NONEATALL
condition|)
block|{
if|if
condition|(
name|M
operator|!=
name|m
condition|)
block|{
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
literal|3
condition|;
name|k
operator|++
control|)
if|if
condition|(
name|backupP
index|[
name|k
index|]
operator|==
name|M
condition|)
name|P
index|[
name|k
index|]
operator|=
name|MAX
argument_list|(
name|P
index|[
name|k
index|]
operator|+
name|partial
operator|*
name|Current
operator|.
name|satAdj
index|[
name|JudgeBy
index|]
index|[
name|Inten
index|]
argument_list|,
name|middle
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|backupP
index|[
name|k
index|]
operator|==
name|m
condition|)
name|P
index|[
name|k
index|]
operator|=
name|MIN
argument_list|(
name|P
index|[
name|k
index|]
operator|-
name|partial
operator|*
name|Current
operator|.
name|satAdj
index|[
name|JudgeBy
index|]
index|[
name|Inten
index|]
argument_list|,
name|middle
argument_list|)
expr_stmt|;
block|}
name|P
index|[
literal|0
index|]
operator|+=
name|partial
operator|*
name|Current
operator|.
name|redAdj
index|[
name|JudgeBy
index|]
index|[
name|Inten
index|]
expr_stmt|;
name|P
index|[
literal|1
index|]
operator|+=
name|partial
operator|*
name|Current
operator|.
name|greenAdj
index|[
name|JudgeBy
index|]
index|[
name|Inten
index|]
expr_stmt|;
name|P
index|[
literal|2
index|]
operator|+=
name|partial
operator|*
name|Current
operator|.
name|blueAdj
index|[
name|JudgeBy
index|]
index|[
name|Inten
index|]
expr_stmt|;
block|}
block|}
name|Inten
operator|=
name|reduced
operator|->
name|hsv
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
name|Current
operator|.
name|ValueBy
index|]
operator|*
literal|255.0
expr_stmt|;
name|nudge
operator|=
name|partial
operator|*
name|nudgeArray
index|[
operator|(
name|Inten
operator|+
name|Current
operator|.
name|Offset
operator|)
operator|%
literal|256
index|]
expr_stmt|;
switch|switch
condition|(
name|changewhat
condition|)
block|{
case|case
name|HUE
case|:
name|P
index|[
literal|0
index|]
operator|+=
name|colorSign
index|[
name|RED
index|]
index|[
name|changewhich
index|]
operator|*
name|nudge
expr_stmt|;
name|P
index|[
literal|1
index|]
operator|+=
name|colorSign
index|[
name|GREEN
index|]
index|[
name|changewhich
index|]
operator|*
name|nudge
expr_stmt|;
name|P
index|[
literal|2
index|]
operator|+=
name|colorSign
index|[
name|BLUE
index|]
index|[
name|changewhich
index|]
operator|*
name|nudge
expr_stmt|;
break|break;
case|case
name|SATURATION
case|:
for|for
control|(
name|JudgeBy
operator|=
name|BY_HUE
init|;
name|JudgeBy
operator|<
name|JUDGE_BY
condition|;
name|JudgeBy
operator|++
control|)
for|for
control|(
name|k
operator|=
literal|0
init|;
name|k
operator|<
literal|3
condition|;
name|k
operator|++
control|)
if|if
condition|(
name|M
operator|!=
name|m
condition|)
block|{
if|if
condition|(
name|backupP
index|[
name|k
index|]
operator|==
name|M
condition|)
name|P
index|[
name|k
index|]
operator|=
name|MAX
argument_list|(
name|P
index|[
name|k
index|]
operator|+
name|partial
operator|*
name|tempSat
index|[
name|JudgeBy
index|]
index|[
name|Inten
index|]
argument_list|,
name|middle
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|backupP
index|[
name|k
index|]
operator|==
name|m
condition|)
name|P
index|[
name|k
index|]
operator|=
name|MIN
argument_list|(
name|P
index|[
name|k
index|]
operator|-
name|partial
operator|*
name|tempSat
index|[
name|JudgeBy
index|]
index|[
name|Inten
index|]
argument_list|,
name|middle
argument_list|)
expr_stmt|;
block|}
break|break;
case|case
name|VALUE
case|:
name|P
index|[
literal|0
index|]
operator|+=
name|changewhich
operator|*
name|nudge
expr_stmt|;
name|P
index|[
literal|1
index|]
operator|+=
name|changewhich
operator|*
name|nudge
expr_stmt|;
name|P
index|[
literal|2
index|]
operator|+=
name|changewhich
operator|*
name|nudge
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|a
index|[
operator|(
name|i
operator|*
name|RW
operator|+
name|j
operator|)
operator|*
literal|4
operator|+
literal|0
index|]
operator|=
name|CLAMP0255
argument_list|(
name|P
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|a
index|[
operator|(
name|i
operator|*
name|RW
operator|+
name|j
operator|)
operator|*
literal|4
operator|+
literal|1
index|]
operator|=
name|CLAMP0255
argument_list|(
name|P
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|a
index|[
operator|(
name|i
operator|*
name|RW
operator|+
name|j
operator|)
operator|*
literal|4
operator|+
literal|2
index|]
operator|=
name|CLAMP0255
argument_list|(
name|P
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
name|bytes
operator|==
literal|4
condition|)
name|a
index|[
operator|(
name|i
operator|*
name|RW
operator|+
name|j
operator|)
operator|*
literal|4
operator|+
literal|3
index|]
operator|=
name|reduced
operator|->
name|rgb
index|[
name|i
operator|*
name|RW
operator|*
name|bytes
operator|+
name|j
operator|*
name|bytes
operator|+
literal|3
index|]
expr_stmt|;
else|else
name|a
index|[
operator|(
name|i
operator|*
name|RW
operator|+
name|j
operator|)
operator|*
literal|4
operator|+
literal|3
index|]
operator|=
literal|255
expr_stmt|;
block|}
block|}
name|gimp_preview_area_draw
argument_list|(
name|GIMP_PREVIEW_AREA
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|RW
argument_list|,
name|RH
argument_list|,
name|GIMP_RGBA_IMAGE
argument_list|,
name|a
argument_list|,
name|RW
operator|*
literal|4
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|a
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|Update_Current_FP (gint changewhat,gint changewhich)
name|Update_Current_FP
parameter_list|(
name|gint
name|changewhat
parameter_list|,
name|gint
name|changewhich
parameter_list|)
block|{
name|gint
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|256
condition|;
name|i
operator|++
control|)
block|{
name|gint
name|nudge
decl_stmt|;
name|fp_Create_Nudge
argument_list|(
name|nudgeArray
argument_list|)
expr_stmt|;
name|nudge
operator|=
name|nudgeArray
index|[
operator|(
name|i
operator|+
name|Current
operator|.
name|Offset
operator|)
operator|%
literal|256
index|]
expr_stmt|;
switch|switch
condition|(
name|changewhat
condition|)
block|{
case|case
name|HUE
case|:
name|Current
operator|.
name|redAdj
index|[
name|Current
operator|.
name|ValueBy
index|]
index|[
name|i
index|]
operator|+=
name|colorSign
index|[
name|RED
index|]
index|[
name|changewhich
index|]
operator|*
name|nudge
expr_stmt|;
name|Current
operator|.
name|greenAdj
index|[
name|Current
operator|.
name|ValueBy
index|]
index|[
name|i
index|]
operator|+=
name|colorSign
index|[
name|GREEN
index|]
index|[
name|changewhich
index|]
operator|*
name|nudge
expr_stmt|;
name|Current
operator|.
name|blueAdj
index|[
name|Current
operator|.
name|ValueBy
index|]
index|[
name|i
index|]
operator|+=
name|colorSign
index|[
name|BLUE
index|]
index|[
name|changewhich
index|]
operator|*
name|nudge
expr_stmt|;
break|break;
case|case
name|SATURATION
case|:
name|Current
operator|.
name|satAdj
index|[
name|Current
operator|.
name|ValueBy
index|]
index|[
name|i
index|]
operator|+=
name|changewhich
operator|*
name|nudge
expr_stmt|;
break|break;
case|case
name|VALUE
case|:
name|Current
operator|.
name|redAdj
index|[
name|Current
operator|.
name|ValueBy
index|]
index|[
name|i
index|]
operator|+=
name|changewhich
operator|*
name|nudge
expr_stmt|;
name|Current
operator|.
name|greenAdj
index|[
name|Current
operator|.
name|ValueBy
index|]
index|[
name|i
index|]
operator|+=
name|changewhich
operator|*
name|nudge
expr_stmt|;
name|Current
operator|.
name|blueAdj
index|[
name|Current
operator|.
name|ValueBy
index|]
index|[
name|i
index|]
operator|+=
name|changewhich
operator|*
name|nudge
expr_stmt|;
break|break;
default|default:
break|break;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_create_smoothness_graph (GtkWidget * preview)
name|fp_create_smoothness_graph
parameter_list|(
name|GtkWidget
modifier|*
name|preview
parameter_list|)
block|{
name|guchar
name|data
index|[
literal|256
operator|*
name|MAX_ROUGHNESS
operator|*
literal|3
index|]
decl_stmt|;
name|gint
name|nArray
index|[
literal|256
index|]
decl_stmt|;
name|gint
name|i
decl_stmt|,
name|j
decl_stmt|;
name|gboolean
name|toBeBlack
decl_stmt|;
name|fp_Create_Nudge
argument_list|(
name|nArray
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|MAX_ROUGHNESS
condition|;
name|i
operator|++
control|)
block|{
name|gint
name|coor
init|=
name|MAX_ROUGHNESS
operator|-
name|i
decl_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|256
condition|;
name|j
operator|++
control|)
block|{
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|0
index|]
operator|=
literal|255
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|1
index|]
operator|=
literal|255
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|2
index|]
operator|=
literal|255
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|i
operator|%
operator|(
name|MAX_ROUGHNESS
operator|/
literal|4
operator|)
operator|)
condition|)
block|{
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|0
index|]
operator|=
literal|255
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|1
index|]
operator|=
literal|128
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|2
index|]
operator|=
literal|128
expr_stmt|;
block|}
if|if
condition|(
operator|!
operator|(
operator|(
name|j
operator|+
literal|1
operator|)
operator|%
literal|32
operator|)
condition|)
block|{
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|0
index|]
operator|=
literal|255
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|1
index|]
operator|=
literal|128
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|2
index|]
operator|=
literal|128
expr_stmt|;
block|}
name|toBeBlack
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|nArray
index|[
name|j
index|]
operator|==
name|coor
condition|)
name|toBeBlack
operator|=
name|TRUE
expr_stmt|;
if|if
condition|(
name|j
operator|<
literal|255
condition|)
block|{
name|gint
name|jump
init|=
name|abs
argument_list|(
name|nArray
index|[
name|j
index|]
operator|-
name|nArray
index|[
name|j
operator|+
literal|1
index|]
argument_list|)
decl_stmt|;
if|if
condition|(
name|abs
argument_list|(
name|coor
operator|-
name|nArray
index|[
name|j
index|]
argument_list|)
operator|<
name|jump
operator|&&
name|abs
argument_list|(
name|coor
operator|-
name|nArray
index|[
name|j
operator|+
literal|1
index|]
argument_list|)
operator|<
name|jump
condition|)
name|toBeBlack
operator|=
name|TRUE
expr_stmt|;
block|}
if|if
condition|(
name|toBeBlack
condition|)
block|{
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|0
index|]
operator|=
literal|0
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|1
index|]
operator|=
literal|0
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|2
index|]
operator|=
literal|0
expr_stmt|;
block|}
block|}
block|}
name|gimp_preview_area_draw
argument_list|(
name|GIMP_PREVIEW_AREA
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|256
argument_list|,
name|MAX_ROUGHNESS
argument_list|,
name|GIMP_RGB_IMAGE
argument_list|,
name|data
argument_list|,
literal|256
operator|*
literal|3
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_range_preview_spill (GtkWidget * preview,gint type)
name|fp_range_preview_spill
parameter_list|(
name|GtkWidget
modifier|*
name|preview
parameter_list|,
name|gint
name|type
parameter_list|)
block|{
name|gint
name|i
decl_stmt|,
name|j
decl_stmt|;
name|guchar
name|data
index|[
literal|256
operator|*
name|RANGE_HEIGHT
operator|*
literal|3
index|]
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|RANGE_HEIGHT
condition|;
name|i
operator|++
control|)
block|{
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
literal|256
condition|;
name|j
operator|++
control|)
block|{
name|GimpRGB
name|rgb
decl_stmt|;
name|GimpHSV
name|hsv
decl_stmt|;
if|if
condition|(
operator|!
operator|(
operator|(
name|j
operator|+
literal|1
operator|)
operator|%
literal|32
operator|)
condition|)
block|{
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|0
index|]
operator|=
literal|255
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|1
index|]
operator|=
literal|128
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|2
index|]
operator|=
literal|128
expr_stmt|;
block|}
else|else
block|{
switch|switch
condition|(
name|type
condition|)
block|{
case|case
name|BY_VAL
case|:
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|0
index|]
operator|=
name|j
operator|-
name|Current
operator|.
name|Offset
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|1
index|]
operator|=
name|j
operator|-
name|Current
operator|.
name|Offset
expr_stmt|;
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|2
index|]
operator|=
name|j
operator|-
name|Current
operator|.
name|Offset
expr_stmt|;
break|break;
case|case
name|BY_HUE
case|:
name|gimp_hsv_set
argument_list|(
operator|&
name|hsv
argument_list|,
operator|(
operator|(
name|j
operator|-
name|Current
operator|.
name|Offset
operator|+
literal|256
operator|)
operator|%
literal|256
operator|)
operator|/
literal|255.0
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gimp_hsv_to_rgb
argument_list|(
operator|&
name|hsv
argument_list|,
operator|&
name|rgb
argument_list|)
expr_stmt|;
name|gimp_rgb_get_uchar
argument_list|(
operator|&
name|rgb
argument_list|,
operator|&
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|0
index|]
argument_list|,
operator|&
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|1
index|]
argument_list|,
operator|&
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|2
index|]
argument_list|)
expr_stmt|;
break|break;
case|case
name|BY_SAT
case|:
name|gimp_hsv_set
argument_list|(
operator|&
name|hsv
argument_list|,
literal|0.5
argument_list|,
operator|(
operator|(
name|j
operator|-
operator|(
name|gint
operator|)
name|Current
operator|.
name|Offset
operator|+
literal|256
operator|)
operator|%
literal|256
operator|)
operator|/
literal|255.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gimp_hsv_to_rgb
argument_list|(
operator|&
name|hsv
argument_list|,
operator|&
name|rgb
argument_list|)
expr_stmt|;
name|gimp_rgb_get_uchar
argument_list|(
operator|&
name|rgb
argument_list|,
operator|&
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|0
index|]
argument_list|,
operator|&
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|1
index|]
argument_list|,
operator|&
name|data
index|[
literal|3
operator|*
operator|(
name|i
operator|*
literal|256
operator|+
name|j
operator|)
operator|+
literal|2
index|]
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
block|}
block|}
name|gimp_preview_area_draw
argument_list|(
name|GIMP_PREVIEW_AREA
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|256
argument_list|,
name|RANGE_HEIGHT
argument_list|,
name|GIMP_RGB_IMAGE
argument_list|,
name|data
argument_list|,
literal|256
operator|*
literal|3
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|fp_Create_Nudge (gint * adjArray)
name|fp_Create_Nudge
parameter_list|(
name|gint
modifier|*
name|adjArray
parameter_list|)
block|{
name|gint
name|left
decl_stmt|,
name|right
decl_stmt|,
name|middle
decl_stmt|,
name|i
decl_stmt|;
comment|/* The following function was determined by trial and error */
name|gdouble
name|Steepness
init|=
name|pow
argument_list|(
literal|1
operator|-
name|Current
operator|.
name|Alias
argument_list|,
literal|4
argument_list|)
operator|*
literal|.8
decl_stmt|;
name|left
operator|=
operator|(
name|Current
operator|.
name|Range
operator|==
name|SHADOWS
operator|)
condition|?
literal|0
else|:
name|Current
operator|.
name|Cutoffs
index|[
name|Current
operator|.
name|Range
operator|-
literal|1
index|]
expr_stmt|;
name|right
operator|=
name|Current
operator|.
name|Cutoffs
index|[
name|Current
operator|.
name|Range
index|]
expr_stmt|;
name|middle
operator|=
operator|(
name|left
operator|+
name|right
operator|)
operator|/
literal|2
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Alias
condition|)
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|256
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|i
operator|<=
name|middle
condition|)
name|adjArray
index|[
name|i
index|]
operator|=
name|MAX_ROUGHNESS
operator|*
name|Current
operator|.
name|Rough
operator|*
operator|(
literal|1
operator|+
name|tanh
argument_list|(
name|Steepness
operator|*
operator|(
name|i
operator|-
name|left
operator|)
argument_list|)
operator|)
operator|/
literal|2
expr_stmt|;
else|else
name|adjArray
index|[
name|i
index|]
operator|=
name|MAX_ROUGHNESS
operator|*
name|Current
operator|.
name|Rough
operator|*
operator|(
literal|1
operator|+
name|tanh
argument_list|(
name|Steepness
operator|*
operator|(
name|right
operator|-
name|i
operator|)
argument_list|)
operator|)
operator|/
literal|2
expr_stmt|;
else|else
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|256
condition|;
name|i
operator|++
control|)
name|adjArray
index|[
name|i
index|]
operator|=
operator|(
name|left
operator|<=
name|i
operator|&&
name|i
operator|<=
name|right
operator|)
condition|?
name|MAX_ROUGHNESS
operator|*
name|Current
operator|.
name|Rough
else|:
literal|0
expr_stmt|;
block|}
end_function

end_unit

