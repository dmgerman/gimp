begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* Stereogram 0.5 --- image filter plug-in for The Gimp  * Copyright (C) 1997 Francisco Bustamante  * pointnclick@geocities.com  * http://www.geocities.com/SiliconValley/Lakes/4813/index.html  *  * The Gimp -- an image manipulation program  * Copyright (C) 1995 Spencer Kimball and Peter Mattis  *  */
end_comment

begin_comment
comment|/* This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.   *   * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.  */
end_comment

begin_comment
comment|/* This plug-in based on information from the Stereogram FAQ */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<gtk/gtk.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimp.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimpui.h>
end_include

begin_define
DECL|macro|SIRDS
define|#
directive|define
name|SIRDS
value|1
end_define

begin_define
DECL|macro|SIS
define|#
directive|define
name|SIS
value|2
end_define

begin_define
DECL|macro|TILE_CACHE_SIZE
define|#
directive|define
name|TILE_CACHE_SIZE
value|16
end_define

begin_typedef
DECL|struct|__anon2c03448f0108
typedef|typedef
struct|struct
block|{
DECL|member|run
name|gint
name|run
decl_stmt|;
DECL|typedef|StereogramInterface
block|}
name|StereogramInterface
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|sint
specifier|static
name|StereogramInterface
name|sint
init|=
block|{
name|FALSE
block|}
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|void
name|query
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|run
parameter_list|(
name|char
modifier|*
name|name
parameter_list|,
name|int
name|nparams
parameter_list|,
name|GParam
modifier|*
name|param
parameter_list|,
name|int
modifier|*
name|nreturn_vals
parameter_list|,
name|GParam
modifier|*
modifier|*
name|return_vals
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|create_stereogram
parameter_list|(
name|GDrawable
modifier|*
name|heightdrawable
parameter_list|,
name|guchar
modifier|*
name|pixels
parameter_list|,
name|GDrawable
modifier|*
name|patterndrawable
parameter_list|,
name|int
name|type
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|stereogram_dialog
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|stereogram_close_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|stereogram_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|stereogram_drawable_callback
parameter_list|(
name|gint32
name|id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|stereogram_toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|stereogram_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_typedef
DECL|struct|__anon2c03448f0208
typedef|typedef
struct|struct
block|{
DECL|member|t
name|int
name|t
decl_stmt|;
comment|/* Stereogram type */
DECL|member|patID
name|gint32
name|patID
decl_stmt|;
comment|/* Pattern Drawable ID*/
DECL|typedef|StereogramVals
block|}
name|StereogramVals
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|svals
specifier|static
name|StereogramVals
name|svals
init|=
block|{
name|SIRDS
block|,
comment|/* type */
operator|-
literal|1
comment|/* patID */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|PLUG_IN_INFO
name|GPlugInInfo
name|PLUG_IN_INFO
init|=
block|{
name|NULL
block|,
comment|/*init_proc*/
name|NULL
block|,
comment|/*quit_proc*/
name|query
block|,
comment|/*query_proc*/
name|run
block|,
comment|/*run_proc*/
block|}
decl_stmt|;
end_decl_stmt

begin_macro
DECL|function|MAIN ()
name|MAIN
argument_list|()
end_macro

begin_function
specifier|static
name|void
name|query
parameter_list|(
name|void
parameter_list|)
block|{
specifier|static
name|GParamDef
name|args
index|[]
init|=
block|{
block|{
name|PARAM_INT32
block|,
literal|"run_mode"
block|,
literal|"Interactive, non-interactive"
block|}
block|,
block|{
name|PARAM_IMAGE
block|,
literal|"image"
block|,
literal|"Input Image"
block|}
block|,
block|{
name|PARAM_DRAWABLE
block|,
literal|"heightmap"
block|,
literal|"Height Map"
block|}
block|,
block|{
name|PARAM_INT32
block|,
literal|"type"
block|,
literal|"Type of stereogram"
block|}
block|,
block|{
name|PARAM_DRAWABLE
block|,
literal|"pat"
block|,
literal|"Pattern to use for stereogram"
block|}
block|, 	}
decl_stmt|;
specifier|static
name|GParamDef
modifier|*
name|return_vals
init|=
name|NULL
decl_stmt|;
specifier|static
name|int
name|nargs
init|=
sizeof|sizeof
argument_list|(
name|args
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
specifier|static
name|int
name|nreturn_vals
init|=
literal|0
decl_stmt|;
name|gimp_install_procedure
argument_list|(
literal|"plug_in_stereogram"
argument_list|,
literal|"Creates SIS (Single Image Stereograms) and SIRDS (Single Image Random Dot Stereogram)"
argument_list|,
literal|"Based on the Stereogram FAQ"
argument_list|,
literal|"Francisco Bustamante"
argument_list|,
literal|"Francisco Bustamante"
argument_list|,
literal|"1997"
argument_list|,
literal|"<Image>/Filters/Misc/Stereogram"
argument_list|,
literal|"GRAY"
argument_list|,
name|PROC_PLUG_IN
argument_list|,
name|nargs
argument_list|,
name|nreturn_vals
argument_list|,
name|args
argument_list|,
name|return_vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*query*/
end_comment

begin_function
specifier|static
name|void
DECL|function|run (char * name,int nparams,GParam * param,int * nreturn_vals,GParam ** return_vals)
name|run
parameter_list|(
name|char
modifier|*
name|name
parameter_list|,
name|int
name|nparams
parameter_list|,
name|GParam
modifier|*
name|param
parameter_list|,
name|int
modifier|*
name|nreturn_vals
parameter_list|,
name|GParam
modifier|*
modifier|*
name|return_vals
parameter_list|)
block|{
name|GRunModeType
name|run_mode
decl_stmt|;
specifier|static
name|GParam
name|values
index|[
literal|1
index|]
decl_stmt|;
name|GDrawable
modifier|*
name|heightdrawable
decl_stmt|;
name|GDrawable
modifier|*
name|patterndrawable
decl_stmt|;
name|GDrawable
modifier|*
name|destdrawable
decl_stmt|;
name|GStatusType
name|status
init|=
name|STATUS_SUCCESS
decl_stmt|;
name|GPixelRgn
name|destrgn
decl_stmt|;
name|guchar
modifier|*
name|dest_pixels
decl_stmt|;
specifier|static
name|gint32
name|DestImageID
decl_stmt|;
name|gint32
name|layerID
decl_stmt|;
name|run_mode
operator|=
name|param
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_int32
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
literal|1
expr_stmt|;
operator|*
name|return_vals
operator|=
name|values
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|PARAM_STATUS
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|status
expr_stmt|;
switch|switch
condition|(
name|run_mode
condition|)
block|{
case|case
name|RUN_INTERACTIVE
case|:
comment|/*Retrieve data */
name|gimp_get_data
argument_list|(
literal|"plug_in_stereogram"
argument_list|,
operator|&
name|svals
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|stereogram_dialog
argument_list|()
condition|)
return|return;
break|break;
case|case
name|RUN_NONINTERACTIVE
case|:
if|if
condition|(
operator|(
name|nparams
operator|<
literal|4
operator|)
operator|||
operator|(
operator|(
name|nparams
operator|!=
literal|5
operator|)
operator|&&
operator|(
name|param
index|[
literal|3
index|]
operator|.
name|data
operator|.
name|d_int32
operator|==
name|SIS
operator|)
operator|)
condition|)
name|status
operator|=
name|STATUS_CALLING_ERROR
expr_stmt|;
if|if
condition|(
name|status
operator|==
name|STATUS_SUCCESS
condition|)
block|{
name|svals
operator|.
name|t
operator|=
name|param
index|[
literal|3
index|]
operator|.
name|data
operator|.
name|d_int32
expr_stmt|;
if|if
condition|(
name|nparams
operator|==
literal|5
condition|)
name|svals
operator|.
name|patID
operator|=
name|param
index|[
literal|4
index|]
operator|.
name|data
operator|.
name|d_drawable
expr_stmt|;
block|}
case|case
name|RUN_WITH_LAST_VALS
case|:
comment|/* Retrieve data */
name|gimp_get_data
argument_list|(
literal|"plug_in_stereogram"
argument_list|,
operator|&
name|svals
argument_list|)
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|heightdrawable
operator|=
name|gimp_drawable_get
argument_list|(
name|param
index|[
literal|2
index|]
operator|.
name|data
operator|.
name|d_drawable
argument_list|)
expr_stmt|;
name|DestImageID
operator|=
name|gimp_image_new
argument_list|(
name|heightdrawable
operator|->
name|width
argument_list|,
name|heightdrawable
operator|->
name|height
argument_list|,
name|RGB
argument_list|)
expr_stmt|;
name|layerID
operator|=
name|gimp_layer_new
argument_list|(
name|DestImageID
argument_list|,
literal|"Background"
argument_list|,
name|heightdrawable
operator|->
name|width
argument_list|,
name|heightdrawable
operator|->
name|height
argument_list|,
name|RGB
argument_list|,
literal|100
argument_list|,
name|NORMAL_MODE
argument_list|)
expr_stmt|;
name|gimp_image_add_layer
argument_list|(
name|DestImageID
argument_list|,
name|layerID
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|destdrawable
operator|=
name|gimp_drawable_get
argument_list|(
name|layerID
argument_list|)
expr_stmt|;
name|dest_pixels
operator|=
operator|(
name|guchar
operator|*
operator|)
name|g_malloc
argument_list|(
operator|(
name|destdrawable
operator|->
name|width
operator|)
operator|*
operator|(
name|destdrawable
operator|->
name|height
operator|)
operator|*
literal|3
argument_list|)
expr_stmt|;
if|if
condition|(
name|status
operator|==
name|STATUS_SUCCESS
condition|)
block|{
if|if
condition|(
name|gimp_drawable_gray
argument_list|(
name|param
index|[
literal|2
index|]
operator|.
name|data
operator|.
name|d_drawable
argument_list|)
condition|)
block|{
name|gimp_progress_init
argument_list|(
literal|"Stereogramming..."
argument_list|)
expr_stmt|;
name|gimp_tile_cache_ntiles
argument_list|(
name|TILE_CACHE_SIZE
argument_list|)
expr_stmt|;
name|patterndrawable
operator|=
name|NULL
expr_stmt|;
if|if
condition|(
name|svals
operator|.
name|patID
operator|!=
operator|-
literal|1
condition|)
name|patterndrawable
operator|=
name|gimp_drawable_get
argument_list|(
name|svals
operator|.
name|patID
argument_list|)
expr_stmt|;
name|create_stereogram
argument_list|(
name|heightdrawable
argument_list|,
name|dest_pixels
argument_list|,
name|patterndrawable
argument_list|,
name|svals
operator|.
name|t
argument_list|)
expr_stmt|;
if|if
condition|(
name|patterndrawable
condition|)
name|gimp_drawable_detach
argument_list|(
name|patterndrawable
argument_list|)
expr_stmt|;
if|if
condition|(
name|run_mode
operator|==
name|RUN_INTERACTIVE
condition|)
name|gimp_set_data
argument_list|(
literal|"plug_in_stereogram"
argument_list|,
operator|&
name|svals
argument_list|,
sizeof|sizeof
argument_list|(
name|StereogramVals
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|gimp_pixel_rgn_init
argument_list|(
operator|&
name|destrgn
argument_list|,
name|destdrawable
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|destdrawable
operator|->
name|width
argument_list|,
name|destdrawable
operator|->
name|height
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_pixel_rgn_set_rect
argument_list|(
operator|&
name|destrgn
argument_list|,
name|dest_pixels
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|destdrawable
operator|->
name|width
argument_list|,
name|destdrawable
operator|->
name|height
argument_list|)
expr_stmt|;
name|gimp_drawable_detach
argument_list|(
name|destdrawable
argument_list|)
expr_stmt|;
name|gimp_drawable_detach
argument_list|(
name|heightdrawable
argument_list|)
expr_stmt|;
name|gimp_display_new
argument_list|(
name|DestImageID
argument_list|)
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|status
expr_stmt|;
block|}
end_function

begin_decl_stmt
DECL|variable|red
name|guchar
name|red
index|[
literal|6
index|]
init|=
block|{
literal|0
block|,
literal|170
block|,
literal|20
block|,
literal|60
block|,
literal|135
block|,
literal|255
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|green
name|guchar
name|green
index|[
literal|6
index|]
init|=
block|{
literal|0
block|,
literal|32
block|,
literal|56
block|,
literal|153
block|,
literal|23
block|,
literal|255
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|blue
name|guchar
name|blue
index|[
literal|6
index|]
init|=
block|{
literal|0
block|,
literal|200
block|,
literal|140
block|,
literal|40
block|,
literal|100
block|,
literal|255
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
DECL|function|set_to_zeros (gint * buf,gint len)
name|set_to_zeros
parameter_list|(
name|gint
modifier|*
name|buf
parameter_list|,
name|gint
name|len
parameter_list|)
block|{
name|gint
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|len
condition|;
name|i
operator|++
control|)
block|{
name|buf
index|[
name|i
index|]
operator|=
operator|-
literal|1
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pixel_set (gint * buf,gint position,gint value)
name|pixel_set
parameter_list|(
name|gint
modifier|*
name|buf
parameter_list|,
name|gint
name|position
parameter_list|,
name|gint
name|value
parameter_list|)
block|{
name|buf
index|[
name|position
index|]
operator|=
name|value
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|is_pixel_set (gint * buf,gint position)
name|is_pixel_set
parameter_list|(
name|gint
modifier|*
name|buf
parameter_list|,
name|gint
name|position
parameter_list|)
block|{
if|if
condition|(
name|buf
index|[
name|position
index|]
operator|!=
operator|-
literal|1
condition|)
return|return
name|TRUE
return|;
else|else
return|return
name|FALSE
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|put_pixel_in_blank (guchar * pattern,gint pat_width,gint pat_height,guchar * dest,gint offset,gint dest_line,gint * set)
name|put_pixel_in_blank
parameter_list|(
name|guchar
modifier|*
name|pattern
parameter_list|,
name|gint
name|pat_width
parameter_list|,
name|gint
name|pat_height
parameter_list|,
name|guchar
modifier|*
name|dest
parameter_list|,
name|gint
name|offset
parameter_list|,
name|gint
name|dest_line
parameter_list|,
name|gint
modifier|*
name|set
parameter_list|)
block|{
name|guchar
modifier|*
name|temp
decl_stmt|;
name|guchar
modifier|*
name|temp_pat
decl_stmt|;
name|gint
name|pat_x
decl_stmt|,
name|pat_y
decl_stmt|;
name|gint
name|tempx
decl_stmt|;
name|tempx
operator|=
name|offset
expr_stmt|;
while|while
condition|(
operator|(
name|set
index|[
name|tempx
index|]
operator|==
operator|-
literal|1
operator|)
operator|&&
operator|(
name|tempx
operator|>
literal|0
operator|)
condition|)
name|tempx
operator|--
expr_stmt|;
if|if
condition|(
name|tempx
operator|==
literal|0
condition|)
block|{
name|set
index|[
name|tempx
index|]
operator|=
literal|0
expr_stmt|;
name|pat_x
operator|=
name|set
index|[
name|tempx
index|]
expr_stmt|;
name|pat_y
operator|=
name|dest_line
operator|%
name|pat_height
expr_stmt|;
name|temp
operator|=
name|dest
operator|+
name|tempx
operator|*
literal|3
expr_stmt|;
name|temp_pat
operator|=
name|pattern
operator|+
operator|(
name|pat_y
operator|*
name|pat_width
operator|*
literal|3
operator|)
operator|+
operator|(
name|pat_x
operator|*
literal|3
operator|)
expr_stmt|;
operator|*
name|temp
operator|++
operator|=
operator|*
name|temp_pat
operator|++
expr_stmt|;
operator|*
name|temp
operator|++
operator|=
operator|*
name|temp_pat
operator|++
expr_stmt|;
operator|*
name|temp
operator|=
operator|*
name|temp_pat
expr_stmt|;
name|tempx
operator|++
expr_stmt|;
block|}
name|tempx
operator|++
expr_stmt|;
while|while
condition|(
name|tempx
operator|<=
name|offset
condition|)
block|{
name|set
index|[
name|tempx
index|]
operator|=
operator|(
operator|(
name|set
index|[
name|tempx
operator|-
literal|1
index|]
operator|+
literal|1
operator|)
operator|%
name|pat_width
operator|)
expr_stmt|;
name|pat_x
operator|=
name|set
index|[
name|tempx
index|]
expr_stmt|;
name|pat_y
operator|=
name|dest_line
operator|%
name|pat_height
expr_stmt|;
name|temp
operator|=
name|dest
operator|+
name|tempx
operator|*
literal|3
expr_stmt|;
name|temp_pat
operator|=
name|pattern
operator|+
operator|(
name|pat_y
operator|*
name|pat_width
operator|*
literal|3
operator|)
operator|+
operator|(
name|pat_x
operator|*
literal|3
operator|)
expr_stmt|;
operator|*
name|temp
operator|++
operator|=
operator|*
name|temp_pat
operator|++
expr_stmt|;
operator|*
name|temp
operator|++
operator|=
operator|*
name|temp_pat
operator|++
expr_stmt|;
operator|*
name|temp
operator|=
operator|*
name|temp_pat
expr_stmt|;
name|tempx
operator|++
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
DECL|function|line_fill (guchar * pattern,gint pat_width,gint pat_height,guchar * dest,gint dest_line,gint * set,gint line_width)
name|line_fill
parameter_list|(
name|guchar
modifier|*
name|pattern
parameter_list|,
name|gint
name|pat_width
parameter_list|,
name|gint
name|pat_height
parameter_list|,
name|guchar
modifier|*
name|dest
parameter_list|,
name|gint
name|dest_line
parameter_list|,
name|gint
modifier|*
name|set
parameter_list|,
name|gint
name|line_width
parameter_list|)
block|{
name|gint
name|cur_x
decl_stmt|;
for|for
control|(
name|cur_x
operator|=
literal|0
init|;
name|cur_x
operator|<
name|line_width
condition|;
name|cur_x
operator|++
control|)
block|{
if|if
condition|(
name|set
index|[
name|cur_x
index|]
operator|==
operator|-
literal|1
condition|)
block|{
name|put_pixel_in_blank
argument_list|(
name|pattern
argument_list|,
name|pat_width
argument_list|,
name|pat_height
argument_list|,
name|dest
argument_list|,
name|cur_x
argument_list|,
name|dest_line
argument_list|,
name|set
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|create_stereogram (GDrawable * heightdrawable,guchar * pixels,GDrawable * patterndrawable,int type)
name|create_stereogram
parameter_list|(
name|GDrawable
modifier|*
name|heightdrawable
parameter_list|,
name|guchar
modifier|*
name|pixels
parameter_list|,
name|GDrawable
modifier|*
name|patterndrawable
parameter_list|,
name|int
name|type
parameter_list|)
block|{
name|int
name|E
decl_stmt|;
name|int
name|dist_to_screen
decl_stmt|;
name|GPixelRgn
name|patrgn
decl_stmt|;
name|GPixelRgn
name|hgtrgn
decl_stmt|;
name|gint
name|src_height
decl_stmt|,
name|src_width
decl_stmt|;
name|gint
name|pat_height
decl_stmt|,
name|pat_width
decl_stmt|;
name|gint
name|dest_height
decl_stmt|,
name|dest_width
decl_stmt|;
name|guchar
modifier|*
name|pattern
init|=
name|NULL
decl_stmt|;
name|guchar
modifier|*
name|final_line
decl_stmt|;
name|guchar
modifier|*
name|temp
decl_stmt|;
name|guchar
modifier|*
name|source_line
decl_stmt|;
name|guchar
modifier|*
name|temp_source
decl_stmt|;
name|gint
name|cur_progress
init|=
literal|0
decl_stmt|,
name|max_progress
init|=
name|heightdrawable
operator|->
name|height
decl_stmt|;
name|gint
name|cur_x
init|=
literal|0
decl_stmt|,
name|cur_y
init|=
literal|0
decl_stmt|,
name|curpat_y
init|=
literal|0
decl_stmt|;
name|gint
name|separation
decl_stmt|;
name|int
name|i
decl_stmt|,
name|left
decl_stmt|,
name|right
decl_stmt|;
name|gint
modifier|*
name|set
decl_stmt|;
name|dest_width
operator|=
name|src_width
operator|=
name|heightdrawable
operator|->
name|width
expr_stmt|;
name|dest_height
operator|=
name|src_height
operator|=
name|heightdrawable
operator|->
name|height
expr_stmt|;
name|source_line
operator|=
operator|(
name|guchar
operator|*
operator|)
name|g_malloc
argument_list|(
name|heightdrawable
operator|->
name|width
argument_list|)
expr_stmt|;
name|gimp_pixel_rgn_init
argument_list|(
operator|&
name|hgtrgn
argument_list|,
name|heightdrawable
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|src_width
argument_list|,
name|src_height
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|set
operator|=
operator|(
name|gint
operator|*
operator|)
name|g_malloc
argument_list|(
name|dest_width
operator|*
sizeof|sizeof
argument_list|(
name|gint
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|svals
operator|.
name|t
operator|==
name|SIS
condition|)
block|{
name|pat_width
operator|=
name|patterndrawable
operator|->
name|width
expr_stmt|;
name|pat_height
operator|=
name|patterndrawable
operator|->
name|height
expr_stmt|;
name|gimp_pixel_rgn_init
argument_list|(
operator|&
name|patrgn
argument_list|,
name|patterndrawable
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|pat_width
argument_list|,
name|pat_height
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|pattern
operator|=
operator|(
name|guchar
operator|*
operator|)
name|g_malloc
argument_list|(
name|pat_height
operator|*
name|pat_width
operator|*
literal|3
argument_list|)
expr_stmt|;
name|gimp_pixel_rgn_get_rect
argument_list|(
operator|&
name|patrgn
argument_list|,
name|pattern
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|pat_width
argument_list|,
name|pat_height
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|pat_width
operator|=
literal|80
expr_stmt|;
name|pat_height
operator|=
literal|80
expr_stmt|;
name|pattern
operator|=
operator|(
name|guchar
operator|*
operator|)
name|g_malloc
argument_list|(
name|pat_height
operator|*
name|pat_width
operator|*
literal|3
argument_list|)
expr_stmt|;
for|for
control|(
name|cur_y
operator|=
literal|0
init|;
name|cur_y
operator|<
name|pat_height
condition|;
name|cur_y
operator|++
control|)
block|{
for|for
control|(
name|cur_x
operator|=
literal|0
init|;
name|cur_x
operator|<
name|pat_width
condition|;
name|cur_x
operator|++
control|)
block|{
name|temp
operator|=
name|pattern
operator|+
operator|(
operator|(
name|cur_y
operator|*
name|pat_width
operator|)
operator|+
name|cur_x
operator|)
operator|*
literal|3
expr_stmt|;
name|i
operator|=
name|rand
argument_list|()
operator|%
literal|6
expr_stmt|;
operator|*
name|temp
operator|++
operator|=
name|red
index|[
name|i
index|]
expr_stmt|;
operator|*
name|temp
operator|++
operator|=
name|green
index|[
name|i
index|]
expr_stmt|;
operator|*
name|temp
operator|=
name|blue
index|[
name|i
index|]
expr_stmt|;
block|}
block|}
block|}
name|E
operator|=
literal|192
expr_stmt|;
name|dist_to_screen
operator|=
literal|900
expr_stmt|;
name|curpat_y
operator|=
literal|0
expr_stmt|;
for|for
control|(
name|cur_y
operator|=
literal|0
init|;
name|cur_y
operator|<
name|src_height
condition|;
name|cur_y
operator|++
control|)
block|{
name|set_to_zeros
argument_list|(
name|set
argument_list|,
name|dest_width
argument_list|)
expr_stmt|;
name|gimp_pixel_rgn_get_row
argument_list|(
operator|&
name|hgtrgn
argument_list|,
name|source_line
argument_list|,
literal|0
argument_list|,
name|cur_y
argument_list|,
name|src_width
argument_list|)
expr_stmt|;
name|final_line
operator|=
name|pixels
operator|+
operator|(
name|cur_y
operator|*
name|dest_width
operator|*
literal|3
operator|)
expr_stmt|;
for|for
control|(
name|cur_x
operator|=
literal|0
init|;
name|cur_x
operator|<
name|src_width
condition|;
name|cur_x
operator|++
control|)
block|{
name|temp_source
operator|=
name|source_line
operator|+
name|cur_x
expr_stmt|;
name|separation
operator|=
operator|(
operator|(
literal|800
operator|-
operator|*
name|temp_source
operator|)
operator|*
name|E
operator|)
operator|/
operator|(
name|dist_to_screen
operator|+
operator|(
literal|800
operator|-
operator|*
name|temp_source
operator|)
operator|)
expr_stmt|;
name|left
operator|=
name|cur_x
operator|-
operator|(
name|separation
operator|/
literal|2
operator|)
expr_stmt|;
name|right
operator|=
name|left
operator|+
name|separation
expr_stmt|;
if|if
condition|(
operator|(
name|right
operator|<
name|dest_width
operator|)
operator|&&
operator|(
name|left
operator|>=
literal|0
operator|)
condition|)
block|{
if|if
condition|(
name|is_pixel_set
argument_list|(
name|set
argument_list|,
name|left
argument_list|)
operator|==
name|FALSE
condition|)
block|{
name|put_pixel_in_blank
argument_list|(
name|pattern
argument_list|,
name|pat_width
argument_list|,
name|pat_height
argument_list|,
name|final_line
argument_list|,
name|left
argument_list|,
name|cur_y
argument_list|,
name|set
argument_list|)
expr_stmt|;
block|}
name|temp
operator|=
name|final_line
operator|+
name|left
operator|*
literal|3
expr_stmt|;
operator|*
operator|(
name|final_line
operator|+
operator|(
name|right
operator|*
literal|3
operator|)
operator|)
operator|=
operator|*
name|temp
expr_stmt|;
operator|*
operator|(
name|final_line
operator|+
operator|(
name|right
operator|*
literal|3
operator|+
literal|1
operator|)
operator|)
operator|=
operator|*
operator|++
name|temp
expr_stmt|;
operator|*
operator|(
name|final_line
operator|+
operator|(
name|right
operator|*
literal|3
operator|+
literal|2
operator|)
operator|)
operator|=
operator|*
operator|++
name|temp
expr_stmt|;
name|pixel_set
argument_list|(
name|set
argument_list|,
name|right
argument_list|,
name|set
index|[
name|left
index|]
argument_list|)
expr_stmt|;
block|}
block|}
name|line_fill
argument_list|(
name|pattern
argument_list|,
name|pat_width
argument_list|,
name|pat_height
argument_list|,
name|final_line
argument_list|,
name|cur_y
argument_list|,
name|set
argument_list|,
name|src_width
argument_list|)
expr_stmt|;
name|cur_progress
operator|++
expr_stmt|;
if|if
condition|(
operator|(
name|cur_progress
operator|%
literal|10
operator|)
operator|==
literal|0
condition|)
block|{
name|gimp_progress_update
argument_list|(
operator|(
name|gdouble
operator|)
name|cur_progress
operator|/
operator|(
name|gdouble
operator|)
name|max_progress
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|pattern
condition|)
name|g_free
argument_list|(
name|pattern
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
end_function

begin_comment
comment|/*create_stereogram*/
end_comment

begin_function
specifier|static
name|gint
DECL|function|stereogram_dialog (void)
name|stereogram_dialog
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|dlg
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|optionmenu
decl_stmt|;
name|GtkWidget
modifier|*
name|menu
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|toggle
decl_stmt|;
name|GtkWidget
modifier|*
name|toggle_hbox
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|gchar
modifier|*
modifier|*
name|argv
decl_stmt|;
name|gint
name|argc
decl_stmt|;
name|gint
name|sis
init|=
operator|(
name|svals
operator|.
name|t
operator|==
name|SIS
operator|)
decl_stmt|;
name|gint
name|sirds
init|=
operator|(
name|svals
operator|.
name|t
operator|==
name|SIRDS
operator|)
decl_stmt|;
name|argc
operator|=
literal|1
expr_stmt|;
name|argv
operator|=
name|g_new
argument_list|(
name|gchar
operator|*
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|argv
index|[
literal|0
index|]
operator|=
name|g_strdup
argument_list|(
literal|"stereogram"
argument_list|)
expr_stmt|;
name|gtk_init
argument_list|(
operator|&
name|argc
argument_list|,
operator|&
name|argv
argument_list|)
expr_stmt|;
name|dlg
operator|=
name|gtk_dialog_new
argument_list|()
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"Stereogram"
argument_list|)
expr_stmt|;
name|gtk_window_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|stereogram_close_callback
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"OK"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|stereogram_ok_callback
argument_list|,
name|dlg
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_grab_default
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"Cancel"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|stereogram_close_callback
argument_list|,
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
literal|"Stereogram Options"
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|8
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacing
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacing
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|1
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacing
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacing
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|1
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Stereogram Pattern: "
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|optionmenu
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|menu
operator|=
name|gimp_drawable_menu_new
argument_list|(
name|stereogram_constrain
argument_list|,
name|stereogram_drawable_callback
argument_list|,
name|NULL
argument_list|,
name|svals
operator|.
name|patID
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|optionmenu
argument_list|)
argument_list|,
name|menu
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|optionmenu
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|optionmenu
argument_list|)
expr_stmt|;
name|toggle_hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|toggle_hbox
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|toggle_hbox
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Stereogram type: "
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|toggle_hbox
argument_list|)
argument_list|,
name|label
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
literal|"SIS"
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|toggle_hbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toggle
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|stereogram_toggle_update
argument_list|,
operator|&
name|sis
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_state
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|sis
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|toggle
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
literal|"SIRDS"
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|toggle_hbox
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toggle
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|stereogram_toggle_update
argument_list|,
operator|&
name|sirds
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_state
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
name|sirds
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle_hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|gtk_main
argument_list|()
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
if|if
condition|(
name|sis
condition|)
name|svals
operator|.
name|t
operator|=
name|SIS
expr_stmt|;
else|else
name|svals
operator|.
name|t
operator|=
name|SIRDS
expr_stmt|;
return|return
name|sint
operator|.
name|run
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|stereogram_close_callback (GtkWidget * widget,gpointer data)
name|stereogram_close_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gtk_main_quit
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|stereogram_ok_callback (GtkWidget * widget,gpointer data)
name|stereogram_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|sint
operator|.
name|run
operator|=
name|TRUE
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|GTK_WIDGET
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|stereogram_toggle_update (GtkWidget * widget,gpointer data)
name|stereogram_toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|int
modifier|*
name|toggle_val
decl_stmt|;
name|toggle_val
operator|=
operator|(
name|int
operator|*
operator|)
name|data
expr_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
condition|)
operator|*
name|toggle_val
operator|=
name|TRUE
expr_stmt|;
else|else
operator|*
name|toggle_val
operator|=
name|FALSE
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|stereogram_constrain (gint32 image_id,gint32 drawable_id,gpointer data)
name|stereogram_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
name|drawable_id
operator|==
operator|-
literal|1
condition|)
return|return
name|TRUE
return|;
return|return
operator|(
name|gimp_drawable_color
argument_list|(
name|drawable_id
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|stereogram_drawable_callback (gint32 id,gpointer data)
name|stereogram_drawable_callback
parameter_list|(
name|gint32
name|id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|svals
operator|.
name|patID
operator|=
name|id
expr_stmt|;
block|}
end_function

end_unit

