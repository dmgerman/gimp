begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<gtk/gtk.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimp.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimpui.h>
end_include

begin_include
include|#
directive|include
file|"libgimp/stdplugins-intl.h"
end_include

begin_include
include|#
directive|include
file|"fp.h"
end_include

begin_comment
comment|/* These values are translated for the GUI but also used internally    to figure out which button the user pushed, etc.    Not my design, please don't blame me -- njl */
end_comment

begin_decl_stmt
DECL|variable|hue_red
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_red
init|=
name|N_
argument_list|(
literal|"Red:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_green
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_green
init|=
name|N_
argument_list|(
literal|"Green:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_blue
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_blue
init|=
name|N_
argument_list|(
literal|"Blue:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_cyan
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_cyan
init|=
name|N_
argument_list|(
literal|"Cyan:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_yellow
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_yellow
init|=
name|N_
argument_list|(
literal|"Yellow:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|hue_magenta
specifier|static
specifier|const
name|gchar
modifier|*
name|hue_magenta
init|=
name|N_
argument_list|(
literal|"Magenta:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|val_darker
specifier|static
specifier|const
name|gchar
modifier|*
name|val_darker
init|=
name|N_
argument_list|(
literal|"Darker:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|val_lighter
specifier|static
specifier|const
name|gchar
modifier|*
name|val_lighter
init|=
name|N_
argument_list|(
literal|"Lighter:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|sat_more
specifier|static
specifier|const
name|gchar
modifier|*
name|sat_more
init|=
name|N_
argument_list|(
literal|"More Sat:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|sat_less
specifier|static
specifier|const
name|gchar
modifier|*
name|sat_less
init|=
name|N_
argument_list|(
literal|"Less Sat:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|current_val
specifier|static
specifier|const
name|gchar
modifier|*
name|current_val
init|=
name|N_
argument_list|(
literal|"Current:"
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|AW
name|AdvancedWindow
name|AW
init|=
block|{
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|FP_Params
name|Current
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|GimpDrawable
modifier|*
name|mask
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|ShMidHi
name|FP_Intensity
name|ShMidHi
index|[]
init|=
block|{
name|SHADOWS
block|,
name|MIDTONES
block|,
name|HIGHLIGHTS
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|HueSatVal
name|gint
name|HueSatVal
index|[]
init|=
block|{
name|BY_HUE
block|,
name|BY_SAT
block|,
name|BY_VAL
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|nudgeArray
name|gint
name|nudgeArray
index|[
literal|256
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|origPreview
DECL|variable|curPreview
name|GtkWidget
modifier|*
name|origPreview
decl_stmt|,
modifier|*
name|curPreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|rPreview
DECL|variable|gPreview
DECL|variable|bPreview
name|GtkWidget
modifier|*
name|rPreview
decl_stmt|,
modifier|*
name|gPreview
decl_stmt|,
modifier|*
name|bPreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|cPreview
DECL|variable|yPreview
DECL|variable|mPreview
name|GtkWidget
modifier|*
name|cPreview
decl_stmt|,
modifier|*
name|yPreview
decl_stmt|,
modifier|*
name|mPreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|centerPreview
name|GtkWidget
modifier|*
name|centerPreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|darkerPreview
DECL|variable|lighterPreview
DECL|variable|middlePreview
name|GtkWidget
modifier|*
name|darkerPreview
decl_stmt|,
modifier|*
name|lighterPreview
decl_stmt|,
modifier|*
name|middlePreview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|allOrSell
DECL|variable|dlg
name|GtkWidget
modifier|*
name|allOrSell
decl_stmt|,
modifier|*
name|dlg
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|plusSatPreview
DECL|variable|SatPreview
DECL|variable|minusSatPreview
name|GtkWidget
modifier|*
name|plusSatPreview
decl_stmt|,
modifier|*
name|SatPreview
decl_stmt|,
modifier|*
name|minusSatPreview
decl_stmt|;
end_decl_stmt

begin_struct
struct|struct
DECL|struct|__anon27aa7fac0108
block|{
DECL|member|bna
name|GtkWidget
modifier|*
name|bna
decl_stmt|;
DECL|member|palette
name|GtkWidget
modifier|*
name|palette
decl_stmt|;
DECL|member|rough
name|GtkWidget
modifier|*
name|rough
decl_stmt|;
DECL|member|range
name|GtkWidget
modifier|*
name|range
decl_stmt|;
DECL|member|show
name|GtkWidget
modifier|*
name|show
decl_stmt|;
DECL|member|lnd
name|GtkWidget
modifier|*
name|lnd
decl_stmt|;
DECL|member|pixelsBy
name|GtkWidget
modifier|*
name|pixelsBy
decl_stmt|;
DECL|member|frameSelect
name|GtkWidget
modifier|*
name|frameSelect
decl_stmt|;
DECL|member|satur
name|GtkWidget
modifier|*
name|satur
decl_stmt|;
DECL|variable|fpFrames
block|}
name|fpFrames
struct|;
end_struct

begin_decl_stmt
DECL|variable|FPint
name|fpInterface
name|FPint
init|=
block|{
name|FALSE
comment|/*  run  */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|reduced
name|ReducedImage
modifier|*
name|reduced
decl_stmt|;
end_decl_stmt

begin_comment
comment|/***********************************************************/
end_comment

begin_comment
comment|/************   Main Dialog Window   ******************/
end_comment

begin_comment
comment|/***********************************************************/
end_comment

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_bna (void)
name|fp_create_bna
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|blabel
decl_stmt|,
modifier|*
name|alabel
decl_stmt|,
modifier|*
name|bframe
decl_stmt|,
modifier|*
name|aframe
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|origPreview
argument_list|,
operator|&
name|bframe
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|curPreview
argument_list|,
operator|&
name|aframe
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Before and After"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
comment|/* All the previews */
name|alabel
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Current:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|alabel
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|alabel
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|blabel
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Original:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|blabel
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|blabel
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|blabel
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|alabel
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|bframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|aframe
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_comment
comment|/* close a sub dialog (from window manager) by simulating toggle click */
end_comment

begin_function
name|gboolean
DECL|function|sub_dialog_destroy (GtkWidget * dialog,GdkEvent * ev,gpointer dummy)
name|sub_dialog_destroy
parameter_list|(
name|GtkWidget
modifier|*
name|dialog
parameter_list|,
name|GdkEvent
modifier|*
name|ev
parameter_list|,
name|gpointer
name|dummy
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
init|=
name|GTK_WIDGET
argument_list|(
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|dialog
argument_list|)
argument_list|,
literal|"ctrlButton"
argument_list|)
argument_list|)
decl_stmt|;
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|TRUE
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_circle_palette (void)
name|fp_create_circle_palette
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|rVbox
decl_stmt|,
modifier|*
name|rFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|gVbox
decl_stmt|,
modifier|*
name|gFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|bVbox
decl_stmt|,
modifier|*
name|bFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|cVbox
decl_stmt|,
modifier|*
name|cFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|yVbox
decl_stmt|,
modifier|*
name|yFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|mVbox
decl_stmt|,
modifier|*
name|mFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|centerVbox
decl_stmt|,
modifier|*
name|centerFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|win
decl_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|11
argument_list|,
literal|11
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|rPreview
argument_list|,
operator|&
name|rFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|gPreview
argument_list|,
operator|&
name|gFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|bPreview
argument_list|,
operator|&
name|bFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|cPreview
argument_list|,
operator|&
name|cFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|yPreview
argument_list|,
operator|&
name|yFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|mPreview
argument_list|,
operator|&
name|mFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|centerPreview
argument_list|,
operator|&
name|centerFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|rVbox
argument_list|,
name|rFrame
argument_list|,
name|hue_red
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|gVbox
argument_list|,
name|gFrame
argument_list|,
name|hue_green
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|bVbox
argument_list|,
name|bFrame
argument_list|,
name|hue_blue
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|cVbox
argument_list|,
name|cFrame
argument_list|,
name|hue_cyan
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|yVbox
argument_list|,
name|yFrame
argument_list|,
name|hue_yellow
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|mVbox
argument_list|,
name|mFrame
argument_list|,
name|hue_magenta
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|centerVbox
argument_list|,
name|centerFrame
argument_list|,
name|current_val
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|rVbox
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|gVbox
argument_list|,
literal|2
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|bVbox
argument_list|,
literal|2
argument_list|,
literal|5
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|cVbox
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|yVbox
argument_list|,
literal|6
argument_list|,
literal|9
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|mVbox
argument_list|,
literal|6
argument_list|,
literal|9
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|centerVbox
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|win
operator|=
name|gtk_window_new
argument_list|(
name|GTK_WINDOW_TOPLEVEL
argument_list|)
expr_stmt|;
name|gimp_help_connect
argument_list|(
name|win
argument_list|,
name|gimp_standard_help_func
argument_list|,
literal|"filters/fp.html"
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|win
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Hue Variations"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|win
argument_list|)
argument_list|,
name|frame
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|win
argument_list|)
argument_list|,
literal|"delete_event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|sub_dialog_destroy
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
name|win
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_rough (void)
name|fp_create_rough
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|scale
decl_stmt|,
modifier|*
name|vbox
decl_stmt|;
name|GtkObject
modifier|*
name|data
decl_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Roughness"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|data
operator|=
name|gtk_adjustment_new
argument_list|(
name|Current
operator|.
name|Rough
argument_list|,
literal|0
argument_list|,
literal|1.0
argument_list|,
literal|0.05
argument_list|,
literal|0.01
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|Current
operator|.
name|roughnessScale
operator|=
name|scale
operator|=
name|gtk_hscale_new
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|scale
argument_list|,
literal|60
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gtk_scale_set_value_pos
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_scale_set_digits
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|data
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|fp_scale_update
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|Rough
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|scale
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_range (void)
name|fp_create_range
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|vbox
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Affected Range"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|group
argument_list|,
name|_
argument_list|(
literal|"Shadows"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_change_current_range
argument_list|)
argument_list|,
name|ShMidHi
operator|+
name|SHADOWS
argument_list|,
name|Current
operator|.
name|Range
operator|==
name|SHADOWS
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|group
argument_list|,
name|_
argument_list|(
literal|"Midtones"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_change_current_range
argument_list|)
argument_list|,
name|ShMidHi
operator|+
name|MIDTONES
argument_list|,
name|Current
operator|.
name|Range
operator|==
name|MIDTONES
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|group
argument_list|,
name|_
argument_list|(
literal|"Highlights"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_change_current_range
argument_list|)
argument_list|,
name|ShMidHi
operator|+
name|HIGHLIGHTS
argument_list|,
name|Current
operator|.
name|Range
operator|==
name|HIGHLIGHTS
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_control (void)
name|fp_create_control
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|box
decl_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Windows"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|box
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|box
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|box
argument_list|)
expr_stmt|;
name|Frames_Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"Hue"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|fpFrames
operator|.
name|palette
argument_list|,
name|Current
operator|.
name|VisibleFrames
operator|&
name|HUE
argument_list|)
expr_stmt|;
name|Frames_Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"Saturation"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|fpFrames
operator|.
name|satur
argument_list|,
name|Current
operator|.
name|VisibleFrames
operator|&
name|SATURATION
argument_list|)
expr_stmt|;
name|Frames_Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"Value"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|fpFrames
operator|.
name|lnd
argument_list|,
name|Current
operator|.
name|VisibleFrames
operator|&
name|VALUE
argument_list|)
expr_stmt|;
name|Frames_Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"Advanced"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|AW
operator|.
name|window
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_lnd (void)
name|fp_create_lnd
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|table
decl_stmt|,
modifier|*
name|lighterFrame
decl_stmt|,
modifier|*
name|middleFrame
decl_stmt|,
modifier|*
name|darkerFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|lighterVbox
decl_stmt|,
modifier|*
name|middleVbox
decl_stmt|,
modifier|*
name|darkerVbox
decl_stmt|;
name|GtkWidget
modifier|*
name|win
decl_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|lighterPreview
argument_list|,
operator|&
name|lighterFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|middlePreview
argument_list|,
operator|&
name|middleFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|darkerPreview
argument_list|,
operator|&
name|darkerFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|lighterVbox
argument_list|,
name|lighterFrame
argument_list|,
name|val_lighter
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|middleVbox
argument_list|,
name|middleFrame
argument_list|,
name|current_val
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|darkerVbox
argument_list|,
name|darkerFrame
argument_list|,
name|val_darker
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|11
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|lighterVbox
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|middleVbox
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|darkerVbox
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|win
operator|=
name|gtk_window_new
argument_list|(
name|GTK_WINDOW_TOPLEVEL
argument_list|)
expr_stmt|;
name|gimp_help_connect
argument_list|(
name|win
argument_list|,
name|gimp_standard_help_func
argument_list|,
literal|"filters/fp.html"
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|win
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Value Variations"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|win
argument_list|)
argument_list|,
name|frame
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|win
argument_list|)
argument_list|,
literal|"delete_event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|sub_dialog_destroy
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
name|win
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_msnls (void)
name|fp_create_msnls
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|table
decl_stmt|,
modifier|*
name|lessFrame
decl_stmt|,
modifier|*
name|middleFrame
decl_stmt|,
modifier|*
name|moreFrame
decl_stmt|;
name|GtkWidget
modifier|*
name|lessVbox
decl_stmt|,
modifier|*
name|middleVbox
decl_stmt|,
modifier|*
name|moreVbox
decl_stmt|;
name|GtkWidget
modifier|*
name|win
decl_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|minusSatPreview
argument_list|,
operator|&
name|lessFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|SatPreview
argument_list|,
operator|&
name|middleFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|plusSatPreview
argument_list|,
operator|&
name|moreFrame
argument_list|,
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|moreVbox
argument_list|,
name|moreFrame
argument_list|,
name|sat_more
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|middleVbox
argument_list|,
name|middleFrame
argument_list|,
name|current_val
argument_list|)
expr_stmt|;
name|Create_A_Table_Entry
argument_list|(
operator|&
name|lessVbox
argument_list|,
name|lessFrame
argument_list|,
name|sat_less
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|11
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|moreVbox
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|middleVbox
argument_list|,
literal|4
argument_list|,
literal|7
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|lessVbox
argument_list|,
literal|8
argument_list|,
literal|11
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|win
operator|=
name|gtk_window_new
argument_list|(
name|GTK_WINDOW_TOPLEVEL
argument_list|)
expr_stmt|;
name|gimp_help_connect
argument_list|(
name|win
argument_list|,
name|gimp_standard_help_func
argument_list|,
literal|"filters/fp.html"
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|win
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Saturation Variations"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|win
argument_list|)
argument_list|,
name|frame
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|win
argument_list|)
argument_list|,
literal|"delete_event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|sub_dialog_destroy
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
name|win
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_pixels_select_by (void)
name|fp_create_pixels_select_by
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|vbox
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Select Pixels by"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|group
argument_list|,
name|_
argument_list|(
literal|"Hue"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_change_current_pixels_by
argument_list|)
argument_list|,
name|HueSatVal
operator|+
literal|0
argument_list|,
name|Current
operator|.
name|ValueBy
operator|==
name|BY_HUE
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|group
argument_list|,
name|_
argument_list|(
literal|"Saturation"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_change_current_pixels_by
argument_list|)
argument_list|,
name|HueSatVal
operator|+
literal|1
argument_list|,
name|Current
operator|.
name|ValueBy
operator|==
name|BY_SAT
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|group
argument_list|,
name|_
argument_list|(
literal|"Value"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_change_current_pixels_by
argument_list|)
argument_list|,
name|HueSatVal
operator|+
literal|2
argument_list|,
name|Current
operator|.
name|ValueBy
operator|==
name|BY_VAL
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_show (void)
name|fp_create_show
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|vbox
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Show"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|group
argument_list|,
name|_
argument_list|(
literal|"Entire Image"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_entire_image
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|SlctnOnly
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|group
argument_list|,
name|_
argument_list|(
literal|"Selection Only"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_selection_only
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|SlctnOnly
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|group
argument_list|,
name|_
argument_list|(
literal|"Selection In Context"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_selection_in_context
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|SlctnOnly
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|__FP_UNUSED_STUFF__
end_ifdef

begin_function
name|GtkWidget
modifier|*
DECL|function|fp_create_frame_select (void)
name|fp_create_frame_select
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|box
decl_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Display"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|8
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|box
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|box
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|box
argument_list|)
expr_stmt|;
name|Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"CirclePalette"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|fpFrames
operator|.
name|palette
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"Lighter And Darker"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|fpFrames
operator|.
name|lnd
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|Check_Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|_
argument_list|(
literal|"Saturation"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|fp_show_hide_frame
argument_list|)
argument_list|,
name|fpFrames
operator|.
name|satur
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_function
DECL|function|Create_A_Preview (GtkWidget ** preview,GtkWidget ** frame,int previewWidth,int previewHeight)
name|void
name|Create_A_Preview
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|preview
parameter_list|,
name|GtkWidget
modifier|*
modifier|*
name|frame
parameter_list|,
name|int
name|previewWidth
parameter_list|,
name|int
name|previewHeight
parameter_list|)
block|{
operator|*
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|frame
argument_list|)
expr_stmt|;
operator|*
name|preview
operator|=
name|gtk_preview_new
argument_list|(
name|Current
operator|.
name|Color
condition|?
name|GTK_PREVIEW_COLOR
else|:
name|GTK_PREVIEW_GRAYSCALE
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
operator|*
name|preview
argument_list|)
argument_list|,
name|previewWidth
argument_list|,
name|previewHeight
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|preview
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
operator|*
name|preview
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|GSList
modifier|*
DECL|function|Button_In_A_Box (GtkWidget * vbox,GSList * group,guchar * label,GtkSignalFunc function,gpointer data,gboolean clicked)
name|Button_In_A_Box
parameter_list|(
name|GtkWidget
modifier|*
name|vbox
parameter_list|,
name|GSList
modifier|*
name|group
parameter_list|,
name|guchar
modifier|*
name|label
parameter_list|,
name|GtkSignalFunc
name|function
parameter_list|,
name|gpointer
name|data
parameter_list|,
name|gboolean
name|clicked
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|function
argument_list|)
argument_list|,
name|data
argument_list|)
expr_stmt|;
if|if
condition|(
name|clicked
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|gtk_radio_button_get_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
name|void
DECL|function|Check_Button_In_A_Box (GtkWidget * vbox,guchar * label,GtkSignalFunc function,gpointer data,gboolean clicked)
name|Check_Button_In_A_Box
parameter_list|(
name|GtkWidget
modifier|*
name|vbox
parameter_list|,
name|guchar
modifier|*
name|label
parameter_list|,
name|GtkSignalFunc
name|function
parameter_list|,
name|gpointer
name|data
parameter_list|,
name|gboolean
name|clicked
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|function
argument_list|)
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|clicked
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|Frames_Check_Button_In_A_Box (GtkWidget * vbox,guchar * label,GtkSignalFunc function,GtkWidget * frame,gboolean clicked)
name|Frames_Check_Button_In_A_Box
parameter_list|(
name|GtkWidget
modifier|*
name|vbox
parameter_list|,
name|guchar
modifier|*
name|label
parameter_list|,
name|GtkSignalFunc
name|function
parameter_list|,
name|GtkWidget
modifier|*
name|frame
parameter_list|,
name|gboolean
name|clicked
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|"ctrlButton"
argument_list|,
operator|(
name|gpointer
operator|)
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|function
argument_list|)
argument_list|,
name|frame
argument_list|)
expr_stmt|;
empty|#
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|clicked
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|Create_A_Table_Entry (GtkWidget ** box,GtkWidget * SmallerFrame,const gchar * description)
name|Create_A_Table_Entry
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|box
parameter_list|,
name|GtkWidget
modifier|*
name|SmallerFrame
parameter_list|,
specifier|const
name|gchar
modifier|*
name|description
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|button
decl_stmt|,
modifier|*
name|table
decl_stmt|;
operator|*
name|box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
operator|*
name|box
argument_list|)
argument_list|,
name|PR_BX_BRDR
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|box
argument_list|)
expr_stmt|;
comment|/* Delayed translation applied here */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|gettext
argument_list|(
name|description
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
operator|*
name|box
argument_list|)
argument_list|,
name|table
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|description
operator|!=
name|current_val
condition|)
block|{
name|button
operator|=
name|gtk_button_new
argument_list|()
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|button
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|button
argument_list|)
argument_list|,
name|SmallerFrame
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|selectionMade
argument_list|)
argument_list|,
operator|(
name|gchar
operator|*
operator|)
name|description
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|SmallerFrame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|4
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
DECL|function|fp_redraw_all_windows (void)
name|fp_redraw_all_windows
parameter_list|(
name|void
parameter_list|)
block|{
name|reduced
operator|=
name|Reduce_The_Image
argument_list|(
name|drawable
argument_list|,
name|mask
argument_list|,
name|Current
operator|.
name|PreviewSize
argument_list|,
name|Current
operator|.
name|SlctnOnly
argument_list|)
expr_stmt|;
name|Adjust_Preview_Sizes
argument_list|(
name|reduced
operator|->
name|width
argument_list|,
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
comment|/*gtk_container_check_resize(GTK_CONTAINER(fpFrames.palette), NULL);*/
name|gtk_widget_queue_draw
argument_list|(
name|fpFrames
operator|.
name|palette
argument_list|)
expr_stmt|;
comment|/*gtk_container_check_resize(GTK_CONTAINER(fpFrames.satur), NULL);*/
name|gtk_widget_queue_draw
argument_list|(
name|fpFrames
operator|.
name|satur
argument_list|)
expr_stmt|;
comment|/*gtk_container_check_resize(GTK_CONTAINER(fpFrames.lnd), NULL);*/
name|gtk_widget_queue_draw
argument_list|(
name|fpFrames
operator|.
name|lnd
argument_list|)
expr_stmt|;
comment|/*gtk_container_check_resize(GTK_CONTAINER(dlg), NULL);*/
name|gtk_widget_queue_draw
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|fp_entire_image (GtkWidget * button,gpointer data)
name|fp_entire_image
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
operator|!
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
return|return;
name|Current
operator|.
name|SlctnOnly
operator|=
literal|0
expr_stmt|;
name|fp_redraw_all_windows
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|fp_selection_only (GtkWidget * button,gpointer data)
name|fp_selection_only
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
specifier|static
name|gint
name|notFirstTime
init|=
literal|0
decl_stmt|;
if|if
condition|(
operator|!
operator|(
name|notFirstTime
operator|++
operator|)
condition|)
return|return;
if|if
condition|(
operator|!
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
return|return;
name|Current
operator|.
name|SlctnOnly
operator|=
literal|1
expr_stmt|;
name|fp_redraw_all_windows
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|fp_selection_in_context (GtkWidget * button,gpointer data)
name|fp_selection_in_context
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
operator|!
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
return|return;
name|Current
operator|.
name|SlctnOnly
operator|=
literal|2
expr_stmt|;
name|fp_redraw_all_windows
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|fp_show_hide_frame (GtkWidget * button,GtkWidget * frame)
name|fp_show_hide_frame
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|GtkWidget
modifier|*
name|frame
parameter_list|)
block|{
name|gint
name|prev
init|=
name|Current
operator|.
name|VisibleFrames
decl_stmt|;
if|if
condition|(
name|frame
operator|==
name|NULL
condition|)
return|return;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
block|{
if|if
condition|(
operator|!
name|GTK_WIDGET_VISIBLE
argument_list|(
name|frame
argument_list|)
condition|)
block|{
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|palette
condition|)
name|Current
operator|.
name|VisibleFrames
operator||=
name|HUE
expr_stmt|;
elseif|else
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|satur
condition|)
name|Current
operator|.
name|VisibleFrames
operator||=
name|SATURATION
expr_stmt|;
elseif|else
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|lnd
condition|)
name|Current
operator|.
name|VisibleFrames
operator||=
name|VALUE
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
operator|&
operator|~
name|prev
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|GTK_WIDGET_VISIBLE
argument_list|(
name|frame
argument_list|)
condition|)
block|{
name|gtk_widget_hide
argument_list|(
name|frame
argument_list|)
expr_stmt|;
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|palette
condition|)
name|Current
operator|.
name|VisibleFrames
operator|&=
operator|~
name|HUE
expr_stmt|;
elseif|else
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|satur
condition|)
name|Current
operator|.
name|VisibleFrames
operator|&=
operator|~
name|SATURATION
expr_stmt|;
elseif|else
if|if
condition|(
name|frame
operator|==
name|fpFrames
operator|.
name|lnd
condition|)
name|Current
operator|.
name|VisibleFrames
operator|&=
operator|~
name|VALUE
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
name|void
DECL|function|Adjust_Preview_Sizes (gint width,gint height)
name|Adjust_Preview_Sizes
parameter_list|(
name|gint
name|width
parameter_list|,
name|gint
name|height
parameter_list|)
block|{
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|origPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|curPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|rPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|gPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|bPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|cPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|yPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|mPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|centerPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|lighterPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|darkerPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|middlePreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|minusSatPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|SatPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|plusSatPreview
argument_list|)
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|selectionMade (GtkWidget * widget,gpointer data)
name|selectionMade
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|Current
operator|.
name|Touched
index|[
name|Current
operator|.
name|ValueBy
index|]
operator|=
literal|1
expr_stmt|;
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_red
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|RED
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_green
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|GREEN
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_blue
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|BLUE
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_cyan
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|CYAN
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_yellow
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|YELLOW
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|hue_magenta
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|HUE
argument_list|,
name|MAGENTA
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|val_darker
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|VALUE
argument_list|,
name|DOWN
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|val_lighter
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|VALUE
argument_list|,
name|UP
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|sat_more
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|SATURATION
argument_list|,
name|UP
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|data
operator|==
operator|(
name|gpointer
operator|)
name|sat_less
condition|)
block|{
name|Update_Current_FP
argument_list|(
name|SATURATION
argument_list|,
name|DOWN
argument_list|)
expr_stmt|;
block|}
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|refreshPreviews (gint which)
name|refreshPreviews
parameter_list|(
name|gint
name|which
parameter_list|)
block|{
name|fp_Create_Nudge
argument_list|(
name|nudgeArray
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|origPreview
argument_list|,
name|NONEATALL
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|curPreview
argument_list|,
name|CURRENT
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|which
operator|&
name|HUE
condition|)
block|{
name|fp_render_preview
argument_list|(
name|rPreview
argument_list|,
name|HUE
argument_list|,
name|RED
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|gPreview
argument_list|,
name|HUE
argument_list|,
name|GREEN
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|bPreview
argument_list|,
name|HUE
argument_list|,
name|BLUE
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|cPreview
argument_list|,
name|HUE
argument_list|,
name|CYAN
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|yPreview
argument_list|,
name|HUE
argument_list|,
name|YELLOW
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|mPreview
argument_list|,
name|HUE
argument_list|,
name|MAGENTA
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|centerPreview
argument_list|,
name|CURRENT
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|which
operator|&
name|VALUE
condition|)
block|{
name|fp_render_preview
argument_list|(
name|lighterPreview
argument_list|,
name|VALUE
argument_list|,
name|UP
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|middlePreview
argument_list|,
name|CURRENT
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|darkerPreview
argument_list|,
name|VALUE
argument_list|,
name|DOWN
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|which
operator|&
name|SATURATION
condition|)
block|{
name|fp_render_preview
argument_list|(
name|plusSatPreview
argument_list|,
name|SATURATION
argument_list|,
name|UP
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|SatPreview
argument_list|,
name|CURRENT
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|fp_render_preview
argument_list|(
name|minusSatPreview
argument_list|,
name|SATURATION
argument_list|,
name|DOWN
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
DECL|function|fp_ok_callback (GtkWidget * widget,gpointer data)
name|fp_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|FPint
operator|.
name|run
operator|=
name|TRUE
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|GTK_WIDGET
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|fp_scale_update (GtkAdjustment * adjustment,float * scale_val)
name|fp_scale_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|float
modifier|*
name|scale_val
parameter_list|)
block|{
specifier|static
name|gfloat
name|prevValue
init|=
literal|0.25
decl_stmt|;
operator|*
name|scale_val
operator|=
name|adjustment
operator|->
name|value
expr_stmt|;
if|if
condition|(
name|prevValue
operator|!=
name|adjustment
operator|->
name|value
condition|)
block|{
name|fp_Create_Nudge
argument_list|(
name|nudgeArray
argument_list|)
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
if|if
condition|(
name|AW
operator|.
name|window
operator|!=
name|NULL
operator|&&
name|GTK_WIDGET_VISIBLE
argument_list|(
name|AW
operator|.
name|window
argument_list|)
condition|)
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|prevValue
operator|=
name|adjustment
operator|->
name|value
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
DECL|function|fp_change_current_range (GtkAdjustment * button,gint * Intensity)
name|fp_change_current_range
parameter_list|(
name|GtkAdjustment
modifier|*
name|button
parameter_list|,
name|gint
modifier|*
name|Intensity
parameter_list|)
block|{
specifier|static
name|FP_Intensity
name|prevValue
init|=
name|MIDTONES
decl_stmt|;
specifier|static
name|int
name|notFirstTime
init|=
literal|0
decl_stmt|;
if|if
condition|(
operator|!
operator|(
name|notFirstTime
operator|++
operator|)
condition|)
return|return;
if|if
condition|(
operator|!
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
return|return;
if|if
condition|(
operator|*
name|Intensity
operator|==
name|prevValue
condition|)
return|return;
name|Current
operator|.
name|Range
operator|=
operator|*
name|Intensity
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
if|if
condition|(
name|AW
operator|.
name|window
operator|!=
name|NULL
operator|&&
name|GTK_WIDGET_VISIBLE
argument_list|(
name|AW
operator|.
name|window
argument_list|)
condition|)
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|prevValue
operator|=
operator|*
name|Intensity
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|fp_change_current_pixels_by (GtkWidget * button,gint * valueBy)
name|fp_change_current_pixels_by
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gint
modifier|*
name|valueBy
parameter_list|)
block|{
name|gint
name|prevValue
init|=
name|VALUE
decl_stmt|;
specifier|static
name|gint
name|notFirstTime
init|=
literal|0
decl_stmt|;
if|if
condition|(
operator|!
operator|(
name|notFirstTime
operator|++
operator|)
condition|)
return|return;
if|if
condition|(
operator|!
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
return|return;
if|if
condition|(
operator|*
name|valueBy
operator|==
name|prevValue
condition|)
return|return;
name|Current
operator|.
name|ValueBy
operator|=
operator|*
name|valueBy
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
if|if
condition|(
name|AW
operator|.
name|window
operator|!=
name|NULL
operator|&&
name|GTK_WIDGET_VISIBLE
argument_list|(
name|AW
operator|.
name|window
argument_list|)
operator|&&
name|AW
operator|.
name|rangePreview
operator|!=
name|NULL
condition|)
name|fp_range_preview_spill
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|,
name|Current
operator|.
name|ValueBy
argument_list|)
expr_stmt|;
name|prevValue
operator|=
operator|*
name|valueBy
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|fp_advanced_call (void)
name|fp_advanced_call
parameter_list|(
name|void
parameter_list|)
block|{
if|if
condition|(
name|AW
operator|.
name|window
operator|!=
name|NULL
condition|)
if|if
condition|(
name|GTK_WIDGET_VISIBLE
argument_list|(
name|AW
operator|.
name|window
argument_list|)
condition|)
name|gtk_widget_hide
argument_list|(
name|AW
operator|.
name|window
argument_list|)
expr_stmt|;
else|else
name|gtk_widget_show
argument_list|(
name|AW
operator|.
name|window
argument_list|)
expr_stmt|;
else|else
name|fp_advanced_dialog
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
name|gint
DECL|function|fp_dialog (void)
name|fp_dialog
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|bna
decl_stmt|;
name|GtkWidget
modifier|*
name|palette
decl_stmt|;
name|GtkWidget
modifier|*
name|lnd
decl_stmt|;
name|GtkWidget
modifier|*
name|show
decl_stmt|;
name|GtkWidget
modifier|*
name|rough
decl_stmt|;
name|GtkWidget
modifier|*
name|range
decl_stmt|;
name|GtkWidget
modifier|*
name|pixelsBy
decl_stmt|;
name|GtkWidget
modifier|*
name|satur
decl_stmt|;
name|GtkWidget
modifier|*
name|control
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|reduced
operator|=
name|Reduce_The_Image
argument_list|(
name|drawable
argument_list|,
name|mask
argument_list|,
name|Current
operator|.
name|PreviewSize
argument_list|,
name|Current
operator|.
name|SlctnOnly
argument_list|)
expr_stmt|;
name|gimp_ui_init
argument_list|(
literal|"fp"
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
comment|/********************************************************************/
comment|/************************* All the Standard Stuff *******************/
name|dlg
operator|=
name|gimp_dialog_new
argument_list|(
name|_
argument_list|(
literal|"Filter Pack Simulation"
argument_list|)
argument_list|,
literal|"fp"
argument_list|,
name|gimp_standard_help_func
argument_list|,
literal|"filters/fp.html"
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|GTK_STOCK_OK
argument_list|,
name|fp_ok_callback
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"Reset"
argument_list|)
argument_list|,
name|resetFilterPacks
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|GTK_STOCK_CANCEL
argument_list|,
name|gtk_widget_destroy
argument_list|,
name|NULL
argument_list|,
literal|1
argument_list|,
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gtk_main_quit
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/********************************************************************/
name|fp_advanced_dialog
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|bna
operator|=
name|bna
operator|=
name|fp_create_bna
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|rough
operator|=
name|rough
operator|=
name|fp_create_rough
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|range
operator|=
name|range
operator|=
name|fp_create_range
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|palette
operator|=
name|palette
operator|=
name|fp_create_circle_palette
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|lnd
operator|=
name|lnd
operator|=
name|fp_create_lnd
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|show
operator|=
name|show
operator|=
name|fp_create_show
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|satur
operator|=
name|satur
operator|=
name|fp_create_msnls
argument_list|()
expr_stmt|;
name|fpFrames
operator|.
name|pixelsBy
operator|=
name|pixelsBy
operator|=
name|fp_create_pixels_select_by
argument_list|()
expr_stmt|;
name|control
operator|=
name|fp_create_control
argument_list|()
expr_stmt|;
comment|/********************************************************************/
comment|/********************   PUT EVRYTHING TOGETHER     ******************/
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|4
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|bna
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|control
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|rough
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|show
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|range
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixelsBy
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|refreshPreviews
argument_list|(
name|Current
operator|.
name|VisibleFrames
argument_list|)
expr_stmt|;
name|gtk_main
argument_list|()
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
return|return
name|FPint
operator|.
name|run
return|;
block|}
end_function

begin_comment
comment|/***********************************************************/
end_comment

begin_comment
comment|/************   Advanced Options Window   ******************/
end_comment

begin_comment
comment|/***********************************************************/
end_comment

begin_function
name|void
DECL|function|fp_advanced_ok (void)
name|fp_advanced_ok
parameter_list|(
name|void
parameter_list|)
block|{
name|gtk_widget_hide
argument_list|(
name|AW
operator|.
name|window
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|As_You_Drag (GtkWidget * button)
name|As_You_Drag
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|)
block|{
specifier|static
name|gboolean
name|notFirstTime
init|=
name|FALSE
decl_stmt|;
if|if
condition|(
operator|!
name|notFirstTime
condition|)
return|return;
name|notFirstTime
operator|=
name|TRUE
expr_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
block|{
name|Current
operator|.
name|RealTime
operator|=
name|TRUE
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|roughnessScale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|aliasingScale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|previewSizeScale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|Current
operator|.
name|RealTime
operator|=
name|FALSE
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|roughnessScale
argument_list|)
argument_list|,
name|GTK_UPDATE_DELAYED
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|aliasingScale
argument_list|)
argument_list|,
name|GTK_UPDATE_DELAYED
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|Current
operator|.
name|previewSizeScale
argument_list|)
argument_list|,
name|GTK_UPDATE_DELAYED
argument_list|)
expr_stmt|;
block|}
return|return;
block|}
end_function

begin_function
name|void
DECL|function|preview_size_scale_update (GtkAdjustment * adjustment,float * scale_val)
name|preview_size_scale_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|float
modifier|*
name|scale_val
parameter_list|)
block|{
name|Current
operator|.
name|PreviewSize
operator|=
name|adjustment
operator|->
name|value
expr_stmt|;
name|fp_redraw_all_windows
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
name|gint
DECL|function|fp_advanced_dialog (void)
name|fp_advanced_dialog
parameter_list|(
name|void
parameter_list|)
block|{
name|guchar
modifier|*
name|rangeNames
index|[]
init|=
block|{
name|N_
argument_list|(
literal|"Shadows:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Midtones:"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Highlights:"
argument_list|)
block|}
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|mainvbox
decl_stmt|;
name|GtkObject
modifier|*
name|smoothnessData
decl_stmt|;
name|GtkWidget
modifier|*
name|graphFrame
decl_stmt|,
modifier|*
name|table
decl_stmt|,
modifier|*
name|scale
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|,
modifier|*
name|label
decl_stmt|,
modifier|*
name|labelTable
decl_stmt|;
name|GtkWidget
modifier|*
name|optionsFrame
decl_stmt|;
name|gint
name|i
decl_stmt|;
name|AW
operator|.
name|window
operator|=
name|gtk_window_new
argument_list|(
name|GTK_WINDOW_TOPLEVEL
argument_list|)
expr_stmt|;
name|gimp_help_connect
argument_list|(
name|AW
operator|.
name|window
argument_list|,
name|gimp_standard_help_func
argument_list|,
literal|"filters/fp.html"
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|AW
operator|.
name|window
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Advanced Filter Pack Options"
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|AW
operator|.
name|window
argument_list|)
argument_list|,
literal|"delete_event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|sub_dialog_destroy
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|mainvbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|mainvbox
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|AW
operator|.
name|window
argument_list|)
argument_list|,
name|mainvbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|mainvbox
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Smoothness of Aliasing"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|mainvbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|graphFrame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|graphFrame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|graphFrame
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|graphFrame
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|graphFrame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|graphFrame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|AW
operator|.
name|aliasingPreview
operator|=
name|gtk_preview_new
argument_list|(
name|GTK_PREVIEW_COLOR
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
argument_list|,
literal|256
argument_list|,
name|MAX_ROUGHNESS
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|AW
operator|.
name|aliasingPreview
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|fp_create_smoothness_graph
argument_list|(
name|AW
operator|.
name|aliasingPreview
argument_list|)
expr_stmt|;
name|AW
operator|.
name|rangePreview
operator|=
name|gtk_preview_new
argument_list|(
name|GTK_PREVIEW_COLOR
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|)
argument_list|,
literal|256
argument_list|,
name|RANGE_HEIGHT
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|AW
operator|.
name|rangePreview
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|)
expr_stmt|;
name|fp_range_preview_spill
argument_list|(
name|AW
operator|.
name|rangePreview
argument_list|,
name|Current
operator|.
name|ValueBy
argument_list|)
expr_stmt|;
name|labelTable
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|labelTable
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|labelTable
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|labelTable
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|labelTable
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|12
condition|;
name|i
operator|++
control|)
block|{
name|label
operator|=
name|Current
operator|.
name|rangeLabels
index|[
name|i
index|]
operator|=
name|gtk_label_new
argument_list|(
literal|"-"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|i
operator|%
literal|4
operator|)
condition|)
block|{
name|gtk_label_set_text
argument_list|(
name|GTK_LABEL
argument_list|(
name|label
argument_list|)
argument_list|,
name|gettext
argument_list|(
name|rangeNames
index|[
name|i
operator|/
literal|4
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|1.0
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|labelTable
argument_list|)
argument_list|,
name|label
argument_list|,
name|i
operator|%
literal|4
argument_list|,
name|i
operator|%
literal|4
operator|+
literal|1
argument_list|,
name|i
operator|/
literal|4
argument_list|,
name|i
operator|/
literal|4
operator|+
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
comment|/************************************************************/
name|AW
operator|.
name|aliasingGraph
operator|=
name|gtk_drawing_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|AW
operator|.
name|aliasingGraph
argument_list|,
literal|2
operator|*
name|MARGIN
operator|+
literal|256
argument_list|,
name|RANGE_HEIGHT
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|AW
operator|.
name|aliasingGraph
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|AW
operator|.
name|aliasingGraph
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|AW
operator|.
name|aliasingGraph
argument_list|,
name|RANGE_ADJUST_MASK
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|AW
operator|.
name|aliasingGraph
argument_list|)
argument_list|,
literal|"event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|FP_Range_Change_Events
argument_list|)
argument_list|,
operator|&
name|Current
argument_list|)
expr_stmt|;
comment|/************************************************************/
name|smoothnessData
operator|=
name|gtk_adjustment_new
argument_list|(
name|Current
operator|.
name|Alias
argument_list|,
literal|0
argument_list|,
literal|1.0
argument_list|,
literal|0.05
argument_list|,
literal|0.01
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|Current
operator|.
name|aliasingScale
operator|=
name|scale
operator|=
name|gtk_hscale_new
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|smoothnessData
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|scale
argument_list|,
literal|200
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gtk_scale_set_digits
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_scale_set_value_pos
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|scale
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|smoothnessData
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|fp_scale_update
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|Alias
argument_list|)
expr_stmt|;
comment|/******************* MISC OPTIONS ***************************/
name|optionsFrame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Miscellaneous Options"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|optionsFrame
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|mainvbox
argument_list|)
argument_list|,
name|optionsFrame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|optionsFrame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|Check_Button_In_A_Box
argument_list|(
name|vbox
argument_list|,
name|_
argument_list|(
literal|"Preview as You Drag"
argument_list|)
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|As_You_Drag
argument_list|)
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Preview Size"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|smoothnessData
operator|=
name|gtk_adjustment_new
argument_list|(
name|Current
operator|.
name|PreviewSize
argument_list|,
literal|50
argument_list|,
name|MAX_PREVIEW_SIZE
argument_list|,
literal|5
argument_list|,
literal|5
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|Current
operator|.
name|previewSizeScale
operator|=
name|scale
operator|=
name|gtk_hscale_new
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|smoothnessData
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|scale
argument_list|)
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|scale
argument_list|,
literal|100
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gtk_scale_set_digits
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_scale_set_value_pos
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|smoothnessData
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|preview_size_scale_update
argument_list|)
argument_list|,
operator|&
name|Current
operator|.
name|PreviewSize
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
literal|1
return|;
block|}
end_function

end_unit

