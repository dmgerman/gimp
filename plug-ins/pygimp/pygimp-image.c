begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* -*- Mode: C; c-basic-offset: 4 -*-  * Gimp-Python - allows the writing of Gimp plugins in Python.  * Copyright (C) 1997-2002  James Henstridge<james@daa.com.au>  *  * This program is free software: you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 3 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program.  If not, see<http://www.gnu.org/licenses/>.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|<config.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"pygimp.h"
end_include

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_channel (PyGimpImage * self,PyObject * args)
name|img_add_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
name|int
name|pos
init|=
operator|-
literal|1
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!|i:add_channel"
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|chn
argument_list|,
operator|&
name|pos
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_insert_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
operator|-
literal|1
argument_list|,
name|pos
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not add channel (ID %d) to image (ID %d)"
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_insert_channel (PyGimpImage * self,PyObject * args,PyObject * kwargs)
name|img_insert_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
name|PyGimpChannel
modifier|*
name|parent
init|=
name|NULL
decl_stmt|;
name|int
name|pos
init|=
operator|-
literal|1
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"channel"
block|,
literal|"parent"
block|,
literal|"position"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"O!|O!i:insert_channel"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|chn
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|parent
argument_list|,
operator|&
name|pos
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_insert_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
name|parent
condition|?
name|parent
operator|->
name|ID
else|:
operator|-
literal|1
argument_list|,
name|pos
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not insert channel (ID %d) to image (ID %d)"
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_layer (PyGimpImage * self,PyObject * args)
name|img_add_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
name|int
name|pos
init|=
operator|-
literal|1
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!|i:add_layer"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|,
operator|&
name|pos
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_insert_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
operator|-
literal|1
argument_list|,
name|pos
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not add layer (ID %d) to image (ID %d)"
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_insert_layer (PyGimpImage * self,PyObject * args,PyObject * kwargs)
name|img_insert_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
name|PyGimpLayer
modifier|*
name|parent
init|=
name|NULL
decl_stmt|;
name|int
name|pos
init|=
operator|-
literal|1
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"layer"
block|,
literal|"parent"
block|,
literal|"position"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"O!|O!i:insert_layer"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|parent
argument_list|,
operator|&
name|pos
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_insert_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|parent
condition|?
name|parent
operator|->
name|ID
else|:
operator|-
literal|1
argument_list|,
name|pos
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not insert layer (ID %d) to image (ID %d)"
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_new_layer (PyGimpImage * self,PyObject * args,PyObject * kwargs)
name|img_new_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|char
modifier|*
name|layer_name
decl_stmt|;
name|int
name|layer_id
decl_stmt|;
name|int
name|width
decl_stmt|,
name|height
decl_stmt|;
name|int
name|layer_type
decl_stmt|;
name|int
name|offs_x
init|=
literal|0
decl_stmt|,
name|offs_y
init|=
literal|0
decl_stmt|;
name|gboolean
name|alpha
init|=
name|TRUE
decl_stmt|;
name|int
name|pos
init|=
operator|-
literal|1
decl_stmt|;
name|double
name|opacity
init|=
literal|100.0
decl_stmt|;
name|GimpLayerModeEffects
name|mode
init|=
name|GIMP_NORMAL_MODE
decl_stmt|;
name|GimpFillType
name|fill_mode
init|=
operator|-
literal|1
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"name"
block|,
literal|"width"
block|,
literal|"height"
block|,
literal|"offset_x"
block|,
literal|"offset_y"
block|,
literal|"alpha"
block|,
literal|"pos"
block|,
literal|"opacity"
block|,
literal|"mode"
block|,
literal|"fill_mode"
block|,
name|NULL
block|}
decl_stmt|;
name|layer_name
operator|=
literal|"New Layer"
expr_stmt|;
name|width
operator|=
name|gimp_image_width
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|height
operator|=
name|gimp_image_height
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"|siiiiiidii:new_layer"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|layer_name
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|,
operator|&
name|offs_x
argument_list|,
operator|&
name|offs_y
argument_list|,
operator|&
name|alpha
argument_list|,
operator|&
name|pos
argument_list|,
operator|&
name|opacity
argument_list|,
operator|&
name|mode
argument_list|,
operator|&
name|fill_mode
argument_list|)
condition|)
return|return
name|NULL
return|;
switch|switch
condition|(
name|gimp_image_base_type
argument_list|(
name|self
operator|->
name|ID
argument_list|)
condition|)
block|{
case|case
name|GIMP_RGB
case|:
name|layer_type
operator|=
name|alpha
condition|?
name|GIMP_RGBA_IMAGE
else|:
name|GIMP_RGB_IMAGE
expr_stmt|;
break|break;
case|case
name|GIMP_GRAY
case|:
name|layer_type
operator|=
name|alpha
condition|?
name|GIMP_GRAYA_IMAGE
else|:
name|GIMP_GRAY_IMAGE
expr_stmt|;
break|break;
case|case
name|GIMP_INDEXED
case|:
name|layer_type
operator|=
name|alpha
condition|?
name|GIMP_INDEXEDA_IMAGE
else|:
name|GIMP_INDEXED_IMAGE
expr_stmt|;
break|break;
default|default:
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"Unknown image base type"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|fill_mode
operator|==
operator|-
literal|1
condition|)
name|fill_mode
operator|=
name|alpha
condition|?
name|GIMP_TRANSPARENT_FILL
else|:
name|GIMP_BACKGROUND_FILL
expr_stmt|;
name|layer_id
operator|=
name|gimp_layer_new
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|layer_name
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|layer_type
argument_list|,
name|opacity
argument_list|,
name|mode
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|layer_id
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not create new layer in image (ID %d)"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|!
name|gimp_drawable_fill
argument_list|(
name|layer_id
argument_list|,
name|fill_mode
argument_list|)
condition|)
block|{
name|gimp_item_delete
argument_list|(
name|layer_id
argument_list|)
expr_stmt|;
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not fill new layer with fill mode %d"
argument_list|,
name|fill_mode
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|!
name|gimp_image_insert_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|layer_id
argument_list|,
operator|-
literal|1
argument_list|,
name|pos
argument_list|)
condition|)
block|{
name|gimp_item_delete
argument_list|(
name|layer_id
argument_list|)
expr_stmt|;
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not add layer (ID %d) to image (ID %d)"
argument_list|,
name|layer_id
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|!
name|gimp_layer_set_offsets
argument_list|(
name|layer_id
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
condition|)
block|{
name|gimp_image_remove_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|layer_id
argument_list|)
expr_stmt|;
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not set offset %d, %d on layer (ID %d)"
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|,
name|layer_id
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|layer_id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_clean_all (PyGimpImage * self)
name|img_clean_all
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
if|if
condition|(
operator|!
name|gimp_image_clean_all
argument_list|(
name|self
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not clean all on image (ID %d)"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_disable_undo (PyGimpImage * self)
name|img_disable_undo
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_image_undo_disable
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_enable_undo (PyGimpImage * self)
name|img_enable_undo
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_image_undo_enable
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_flatten (PyGimpImage * self)
name|img_flatten
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
return|return
name|pygimp_layer_new
argument_list|(
name|gimp_image_flatten
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_lower_channel (PyGimpImage * self,PyObject * args)
name|img_lower_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:lower_channel"
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|chn
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_lower_item
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not lower channel (ID %d) on image (ID %d)"
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_lower_layer (PyGimpImage * self,PyObject * args)
name|img_lower_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:lower_layer"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_lower_item
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not lower layer (ID %d) on image (ID %d)"
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_lower_layer_to_bottom (PyGimpImage * self,PyObject * args)
name|img_lower_layer_to_bottom
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:lower_layer_to_bottom"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_lower_item_to_bottom
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not lower layer (ID %d) to bottom on image (ID %d)"
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_merge_visible_layers (PyGimpImage * self,PyObject * args)
name|img_merge_visible_layers
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|gint32
name|id
decl_stmt|;
name|int
name|merge
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:merge_visible_layers"
argument_list|,
operator|&
name|merge
argument_list|)
condition|)
return|return
name|NULL
return|;
name|id
operator|=
name|gimp_image_merge_visible_layers
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|merge
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not merge visible layers on image (ID %d) "
literal|"with merge type %d"
argument_list|,
name|self
operator|->
name|ID
argument_list|,
name|merge
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_merge_down (PyGimpImage * self,PyObject * args)
name|img_merge_down
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|gint32
name|id
decl_stmt|;
name|PyGimpLayer
modifier|*
name|layer
decl_stmt|;
name|int
name|merge
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!i:merge_down"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|layer
argument_list|,
operator|&
name|merge
argument_list|)
condition|)
return|return
name|NULL
return|;
name|id
operator|=
name|gimp_image_merge_down
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|layer
operator|->
name|ID
argument_list|,
name|merge
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not merge down layer (ID %d) on image (ID %d) "
literal|"with merge type %d"
argument_list|,
name|layer
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|,
name|merge
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_pick_correlate_layer (PyGimpImage * self,PyObject * args)
name|img_pick_correlate_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|x
decl_stmt|,
name|y
decl_stmt|;
name|gint32
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:pick_correlate_layer"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
condition|)
return|return
name|NULL
return|;
name|id
operator|=
name|gimp_image_pick_correlate_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_raise_channel (PyGimpImage * self,PyObject * args)
name|img_raise_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:raise_channel"
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|chn
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_raise_item
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not raise channel (ID %d) on image (ID %d)"
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_raise_layer (PyGimpImage * self,PyObject * args)
name|img_raise_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:raise_layer"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_raise_item
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not raise layer (ID %d) on image (ID %d)"
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_raise_layer_to_top (PyGimpImage * self,PyObject * args)
name|img_raise_layer_to_top
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:raise_layer_to_top"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_raise_item_to_top
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not raise layer (ID %d) to top on image (ID %d)"
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_remove_channel (PyGimpImage * self,PyObject * args)
name|img_remove_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:remove_channel"
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|chn
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_remove_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not remove channel (ID %d) from image (ID %d)"
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_remove_layer (PyGimpImage * self,PyObject * args)
name|img_remove_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:remove_layer"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_remove_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not remove layer (ID %d) from image (ID %d)"
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_resize (PyGimpImage * self,PyObject * args,PyObject * kwargs)
name|img_resize
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|int
name|new_w
decl_stmt|,
name|new_h
decl_stmt|;
name|int
name|offs_x
init|=
literal|0
decl_stmt|,
name|offs_y
init|=
literal|0
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"width"
block|,
literal|"height"
block|,
literal|"offset_x"
block|,
literal|"offset_y"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"ii|ii:resize"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|new_w
argument_list|,
operator|&
name|new_h
argument_list|,
operator|&
name|offs_x
argument_list|,
operator|&
name|offs_y
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_resize
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|new_w
argument_list|,
name|new_h
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not resize image (ID %d) to %dx%d, offset %d, %d"
argument_list|,
name|self
operator|->
name|ID
argument_list|,
name|new_w
argument_list|,
name|new_h
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_resize_to_layers (PyGimpImage * self)
name|img_resize_to_layers
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
if|if
condition|(
operator|!
name|gimp_image_resize_to_layers
argument_list|(
name|self
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not resize to layers on image "
literal|"(ID %d)"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_scale (PyGimpImage * self,PyObject * args,PyObject * kwargs)
name|img_scale
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|int
name|new_width
decl_stmt|,
name|new_height
decl_stmt|;
name|int
name|interpolation
init|=
operator|-
literal|1
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"width"
block|,
literal|"height"
block|,
literal|"interpolation"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"ii|i:scale"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|new_width
argument_list|,
operator|&
name|new_height
argument_list|,
operator|&
name|interpolation
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|interpolation
operator|!=
operator|-
literal|1
condition|)
block|{
name|gimp_context_push
argument_list|()
expr_stmt|;
name|gimp_context_set_interpolation
argument_list|(
name|interpolation
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|gimp_image_scale
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|new_width
argument_list|,
name|new_height
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not scale image (ID %d) to %dx%d"
argument_list|,
name|self
operator|->
name|ID
argument_list|,
name|new_width
argument_list|,
name|new_height
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolation
operator|!=
operator|-
literal|1
condition|)
block|{
name|gimp_context_pop
argument_list|()
expr_stmt|;
block|}
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|interpolation
operator|!=
operator|-
literal|1
condition|)
block|{
name|gimp_context_pop
argument_list|()
expr_stmt|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_crop (PyGimpImage * self,PyObject * args,PyObject * kwargs)
name|img_crop
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|int
name|new_w
decl_stmt|,
name|new_h
decl_stmt|;
name|int
name|offs_x
init|=
literal|0
decl_stmt|,
name|offs_y
init|=
literal|0
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"width"
block|,
literal|"height"
block|,
literal|"offset_x"
block|,
literal|"offset_y"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"ii|ii:crop"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|new_w
argument_list|,
operator|&
name|new_h
argument_list|,
operator|&
name|offs_x
argument_list|,
operator|&
name|offs_y
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_crop
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|new_w
argument_list|,
name|new_h
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not crop image (ID %d) to %dx%d, offset %d, %d"
argument_list|,
name|self
operator|->
name|ID
argument_list|,
name|new_w
argument_list|,
name|new_h
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_free_shadow (PyGimpImage * self)
name|img_free_shadow
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
comment|/* this procedure is deprecated and does absolutely nothing */
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_unset_active_channel (PyGimpImage * self)
name|img_unset_active_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
if|if
condition|(
operator|!
name|gimp_image_unset_active_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not unset active channel on image (ID %d)"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_component_active (PyGimpImage * self,PyObject * args)
name|img_get_component_active
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|comp
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_component_active"
argument_list|,
operator|&
name|comp
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_image_get_component_active
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_component_visible (PyGimpImage * self,PyObject * args)
name|img_get_component_visible
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|comp
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_component_visible"
argument_list|,
operator|&
name|comp
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_image_get_component_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_set_component_active (PyGimpImage * self,PyObject * args)
name|img_set_component_active
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|comp
decl_stmt|,
name|a
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:set_component_active"
argument_list|,
operator|&
name|comp
argument_list|,
operator|&
name|a
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_set_component_active
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|,
name|a
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not set component (%d) %sactive on image (ID %d)"
argument_list|,
name|comp
argument_list|,
name|a
condition|?
literal|""
else|:
literal|"in"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_set_component_visible (PyGimpImage * self,PyObject * args)
name|img_set_component_visible
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|comp
decl_stmt|,
name|v
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:set_component_visible"
argument_list|,
operator|&
name|comp
argument_list|,
operator|&
name|v
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_set_component_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|,
name|v
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not set component (%d) %svisible on image (ID %d)"
argument_list|,
name|comp
argument_list|,
name|v
condition|?
literal|""
else|:
literal|"in"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_parasite_find (PyGimpImage * self,PyObject * args)
name|img_parasite_find
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:parasite_find"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|pygimp_parasite_new
argument_list|(
name|gimp_image_get_parasite
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_parasite_attach (PyGimpImage * self,PyObject * args)
name|img_parasite_attach
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpParasite
modifier|*
name|parasite
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:parasite_attach"
argument_list|,
operator|&
name|PyGimpParasite_Type
argument_list|,
operator|&
name|parasite
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_attach_parasite
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|parasite
operator|->
name|para
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not attach parasite '%s' to image (ID %d)"
argument_list|,
name|parasite
operator|->
name|para
operator|->
name|name
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_attach_new_parasite (PyGimpImage * self,PyObject * args,PyObject * kwargs)
name|img_attach_new_parasite
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
name|int
name|flags
decl_stmt|,
name|size
decl_stmt|;
name|guint8
modifier|*
name|data
decl_stmt|;
name|GimpParasite
modifier|*
name|parasite
decl_stmt|;
name|gboolean
name|success
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"name"
block|,
literal|"flags"
block|,
literal|"data"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"sis#:attach_new_parasite"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|flags
argument_list|,
operator|&
name|data
argument_list|,
operator|&
name|size
argument_list|)
condition|)
return|return
name|NULL
return|;
name|parasite
operator|=
name|gimp_parasite_new
argument_list|(
name|name
argument_list|,
name|flags
argument_list|,
name|size
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|success
operator|=
name|gimp_image_attach_parasite
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|parasite
argument_list|)
expr_stmt|;
name|gimp_parasite_free
argument_list|(
name|parasite
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|success
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not attach new parasite '%s' to image (ID %d)"
argument_list|,
name|name
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_parasite_detach (PyGimpImage * self,PyObject * args)
name|img_parasite_detach
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:parasite_detach"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_detach_parasite
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not detach parasite '%s' from image (ID %d)"
argument_list|,
name|name
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_parasite_list (PyGimpImage * self)
name|img_parasite_list
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
name|gint
name|num_parasites
decl_stmt|;
name|gchar
modifier|*
modifier|*
name|parasites
decl_stmt|;
name|parasites
operator|=
name|gimp_image_get_parasite_list
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|num_parasites
argument_list|)
expr_stmt|;
if|if
condition|(
name|parasites
condition|)
block|{
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|gint
name|i
decl_stmt|;
name|ret
operator|=
name|PyTuple_New
argument_list|(
name|num_parasites
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_parasites
condition|;
name|i
operator|++
control|)
block|{
name|PyTuple_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|PyString_FromString
argument_list|(
name|parasites
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|parasites
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|g_free
argument_list|(
name|parasites
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not list parasites on image (ID %d)"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_layer_by_tattoo (PyGimpImage * self,PyObject * args)
name|img_get_layer_by_tattoo
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|tattoo
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_layer_by_tattoo"
argument_list|,
operator|&
name|tattoo
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|pygimp_layer_new
argument_list|(
name|gimp_image_get_layer_by_tattoo
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|tattoo
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_channel_by_tattoo (PyGimpImage * self,PyObject * args)
name|img_get_channel_by_tattoo
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|tattoo
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_channel_by_tattoo"
argument_list|,
operator|&
name|tattoo
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|pygimp_channel_new
argument_list|(
name|gimp_image_get_channel_by_tattoo
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|tattoo
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_hguide (PyGimpImage * self,PyObject * args)
name|img_add_hguide
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|ypos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:add_hguide"
argument_list|,
operator|&
name|ypos
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_add_hguide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|ypos
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_vguide (PyGimpImage * self,PyObject * args)
name|img_add_vguide
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|xpos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:add_vguide"
argument_list|,
operator|&
name|xpos
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_add_vguide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|xpos
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_delete_guide (PyGimpImage * self,PyObject * args)
name|img_delete_guide
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:delete_guide"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_image_delete_guide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not delete guide (ID %d) from image (ID %d)"
argument_list|,
name|guide
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_find_next_guide (PyGimpImage * self,PyObject * args)
name|img_find_next_guide
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:find_next_guide"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_find_next_guide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_guide_orientation (PyGimpImage * self,PyObject * args)
name|img_get_guide_orientation
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_guide_orientation"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_guide_orientation
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_guide_position (PyGimpImage * self,PyObject * args)
name|img_get_guide_position
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_guide_position"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_guide_position
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_undo_is_enabled (PyGimpImage * self)
name|img_undo_is_enabled
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_image_undo_is_enabled
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_undo_freeze (PyGimpImage * self)
name|img_undo_freeze
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_image_undo_freeze
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_undo_thaw (PyGimpImage * self)
name|img_undo_thaw
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_image_undo_thaw
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_duplicate (PyGimpImage * self)
name|img_duplicate
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
return|return
name|pygimp_image_new
argument_list|(
name|gimp_image_duplicate
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_undo_group_start (PyGimpImage * self)
name|img_undo_group_start
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
if|if
condition|(
operator|!
name|gimp_image_undo_group_start
argument_list|(
name|self
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not start undo group on image (ID %d)"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_undo_group_end (PyGimpImage * self)
name|img_undo_group_end
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
if|if
condition|(
operator|!
name|gimp_image_undo_group_end
argument_list|(
name|self
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not end undo group on image (ID %d)"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|img_methods
specifier|static
name|PyMethodDef
name|img_methods
index|[]
init|=
block|{
block|{
literal|"add_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"insert_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_insert_channel
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"add_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"insert_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_insert_layer
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"new_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_new_layer
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"clean_all"
block|,
operator|(
name|PyCFunction
operator|)
name|img_clean_all
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"disable_undo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_disable_undo
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"enable_undo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_enable_undo
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"flatten"
block|,
operator|(
name|PyCFunction
operator|)
name|img_flatten
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"lower_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_lower_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"lower_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_lower_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"lower_layer_to_bottom"
block|,
operator|(
name|PyCFunction
operator|)
name|img_lower_layer_to_bottom
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"merge_visible_layers"
block|,
operator|(
name|PyCFunction
operator|)
name|img_merge_visible_layers
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"merge_down"
block|,
operator|(
name|PyCFunction
operator|)
name|img_merge_down
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"pick_correlate_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_pick_correlate_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"raise_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_raise_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"raise_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_raise_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"raise_layer_to_top"
block|,
operator|(
name|PyCFunction
operator|)
name|img_raise_layer_to_top
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"remove_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_remove_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"remove_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_remove_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"resize"
block|,
operator|(
name|PyCFunction
operator|)
name|img_resize
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"resize_to_layers"
block|,
operator|(
name|PyCFunction
operator|)
name|img_resize_to_layers
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"get_component_active"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_component_active
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_component_visible"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_component_visible
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_component_active"
block|,
operator|(
name|PyCFunction
operator|)
name|img_set_component_active
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_component_visible"
block|,
operator|(
name|PyCFunction
operator|)
name|img_set_component_visible
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_find"
block|,
operator|(
name|PyCFunction
operator|)
name|img_parasite_find
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_attach"
block|,
operator|(
name|PyCFunction
operator|)
name|img_parasite_attach
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"attach_new_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|img_attach_new_parasite
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"parasite_detach"
block|,
operator|(
name|PyCFunction
operator|)
name|img_parasite_detach
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_list"
block|,
operator|(
name|PyCFunction
operator|)
name|img_parasite_list
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"get_layer_by_tattoo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_layer_by_tattoo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_channel_by_tattoo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_channel_by_tattoo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_hguide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_hguide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_vguide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_vguide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"delete_guide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_delete_guide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"find_next_guide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_find_next_guide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_guide_orientation"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_guide_orientation
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_guide_position"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_guide_position
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"scale"
block|,
operator|(
name|PyCFunction
operator|)
name|img_scale
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"crop"
block|,
operator|(
name|PyCFunction
operator|)
name|img_crop
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"free_shadow"
block|,
operator|(
name|PyCFunction
operator|)
name|img_free_shadow
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"unset_active_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_unset_active_channel
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"undo_is_enabled"
block|,
operator|(
name|PyCFunction
operator|)
name|img_undo_is_enabled
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"undo_freeze"
block|,
operator|(
name|PyCFunction
operator|)
name|img_undo_freeze
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"undo_thaw"
block|,
operator|(
name|PyCFunction
operator|)
name|img_undo_thaw
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"duplicate"
block|,
operator|(
name|PyCFunction
operator|)
name|img_duplicate
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"undo_group_start"
block|,
operator|(
name|PyCFunction
operator|)
name|img_undo_group_start
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"undo_group_end"
block|,
operator|(
name|PyCFunction
operator|)
name|img_undo_group_end
block|,
name|METH_NOARGS
block|}
block|,
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_ID (PyGimpImage * self,void * closure)
name|img_get_ID
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|self
operator|->
name|ID
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_active_channel (PyGimpImage * self,void * closure)
name|img_get_active_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
name|id
init|=
name|gimp_image_get_active_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|)
decl_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_channel_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_active_channel (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_active_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"cannot delete active_channel"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|pygimp_channel_check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mismatch"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|chn
operator|=
operator|(
name|PyGimpChannel
operator|*
operator|)
name|value
expr_stmt|;
if|if
condition|(
operator|!
name|gimp_image_set_active_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not set active channel (ID %d) on image (ID %d)"
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_active_drawable (PyGimpImage * self,void * closure)
name|img_get_active_drawable
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
name|id
init|=
name|gimp_image_get_active_drawable
argument_list|(
name|self
operator|->
name|ID
argument_list|)
decl_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_drawable_new
argument_list|(
name|NULL
argument_list|,
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_active_layer (PyGimpImage * self,void * closure)
name|img_get_active_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
name|id
init|=
name|gimp_image_get_active_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|)
decl_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_active_layer (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_active_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"cannot delete active_layer"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|pygimp_layer_check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mismatch"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|lay
operator|=
operator|(
name|PyGimpLayer
operator|*
operator|)
name|value
expr_stmt|;
if|if
condition|(
operator|!
name|gimp_image_set_active_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not set active layer (ID %d) on image (ID %d)"
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_base_type (PyGimpImage * self,void * closure)
name|img_get_base_type
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_base_type
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_channels (PyGimpImage * self,void * closure)
name|img_get_channels
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
modifier|*
name|channels
decl_stmt|;
name|gint
name|n_channels
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|channels
operator|=
name|gimp_image_get_channels
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|n_channels
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|n_channels
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|n_channels
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|pygimp_channel_new
argument_list|(
name|channels
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|channels
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_colormap (PyGimpImage * self,void * closure)
name|img_get_colormap
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|guchar
modifier|*
name|cmap
decl_stmt|;
name|gint
name|n_colours
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|cmap
operator|=
name|gimp_image_get_colormap
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|n_colours
argument_list|)
expr_stmt|;
if|if
condition|(
name|cmap
operator|==
name|NULL
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not get colormap for image (ID %d)"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|ret
operator|=
name|PyString_FromStringAndSize
argument_list|(
operator|(
name|char
operator|*
operator|)
name|cmap
argument_list|,
name|n_colours
operator|*
literal|3
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|cmap
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_colormap (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_colormap
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"cannot delete colormap"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mismatch"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|gimp_image_set_colormap
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|(
name|guchar
operator|*
operator|)
name|PyString_AsString
argument_list|(
name|value
argument_list|)
argument_list|,
name|PyString_Size
argument_list|(
name|value
argument_list|)
operator|/
literal|3
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not set colormap on image (ID %d)"
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_is_dirty (PyGimpImage * self,void * closure)
name|img_get_is_dirty
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_image_is_dirty
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_filename (PyGimpImage * self,void * closure)
name|img_get_filename
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gchar
modifier|*
name|filename
decl_stmt|;
name|filename
operator|=
name|gimp_image_get_filename
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|filename
condition|)
block|{
name|PyObject
modifier|*
name|ret
init|=
name|PyString_FromString
argument_list|(
name|filename
argument_list|)
decl_stmt|;
name|g_free
argument_list|(
name|filename
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_filename (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_filename
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"cannot delete filename"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mismatch"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|gimp_image_set_filename
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyString_AsString
argument_list|(
name|value
argument_list|)
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"could not set filename "
literal|"(possibly bad encoding)"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_uri (PyGimpImage * self,void * closure)
name|img_get_uri
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gchar
modifier|*
name|uri
decl_stmt|;
name|uri
operator|=
name|gimp_image_get_uri
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|uri
condition|)
block|{
name|PyObject
modifier|*
name|ret
init|=
name|PyString_FromString
argument_list|(
name|uri
argument_list|)
decl_stmt|;
name|g_free
argument_list|(
name|uri
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_floating_selection (PyGimpImage * self,void * closure)
name|img_get_floating_selection
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
name|id
decl_stmt|;
name|id
operator|=
name|gimp_image_get_floating_sel
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_floating_sel_attached_to (PyGimpImage * self,void * closure)
name|img_get_floating_sel_attached_to
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
name|id
decl_stmt|;
name|id
operator|=
name|gimp_image_floating_sel_attached_to
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_layers (PyGimpImage * self,void * closure)
name|img_get_layers
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
modifier|*
name|layers
decl_stmt|;
name|gint
name|n_layers
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|layers
operator|=
name|gimp_image_get_layers
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|n_layers
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|n_layers
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|n_layers
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|pygimp_layer_new
argument_list|(
name|layers
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|layers
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_name (PyGimpImage * self,void * closure)
name|img_get_name
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gchar
modifier|*
name|name
decl_stmt|;
name|name
operator|=
name|gimp_image_get_name
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|name
condition|)
block|{
name|PyObject
modifier|*
name|ret
init|=
name|PyString_FromString
argument_list|(
name|name
argument_list|)
decl_stmt|;
name|g_free
argument_list|(
name|name
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_selection (PyGimpImage * self,void * closure)
name|img_get_selection
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|pygimp_channel_new
argument_list|(
name|gimp_image_get_selection
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_tattoo_state (PyGimpImage * self,void * closure)
name|img_get_tattoo_state
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_tattoo_state
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_tattoo_state (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_tattoo_state
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"cannot delete tattoo_state"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mismatch"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_tattoo_state
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|value
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_height (PyGimpImage * self,void * closure)
name|img_get_height
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_height
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_width (PyGimpImage * self,void * closure)
name|img_get_width
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_width
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_resolution (PyGimpImage * self,void * closure)
name|img_get_resolution
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|double
name|xres
decl_stmt|,
name|yres
decl_stmt|;
name|gimp_image_get_resolution
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|xres
argument_list|,
operator|&
name|yres
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(dd)"
argument_list|,
name|xres
argument_list|,
name|yres
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_resolution (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_resolution
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gdouble
name|xres
decl_stmt|,
name|yres
decl_stmt|;
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"cannot delete resolution"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|value
argument_list|)
operator|||
operator|!
name|PyArg_ParseTuple
argument_list|(
name|value
argument_list|,
literal|"dd"
argument_list|,
operator|&
name|xres
argument_list|,
operator|&
name|yres
argument_list|)
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mismatch"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|gimp_image_set_resolution
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|xres
argument_list|,
name|yres
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"could not set resolution"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_unit (PyGimpImage * self,void * closure)
name|img_get_unit
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_unit
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_unit (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_unit
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"cannot delete unit"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mismatch"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|gimp_image_set_unit
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|value
argument_list|)
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"could not set unit"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_vectors (PyGimpImage * self,void * closure)
name|img_get_vectors
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|int
modifier|*
name|vectors
decl_stmt|;
name|int
name|i
decl_stmt|,
name|num_vectors
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|vectors
operator|=
name|gimp_image_get_vectors
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|num_vectors
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|num_vectors
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_vectors
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|pygimp_vectors_new
argument_list|(
name|vectors
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|vectors
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_active_vectors (PyGimpImage * self,void * closure)
name|img_get_active_vectors
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
name|id
init|=
name|gimp_image_get_active_vectors
argument_list|(
name|self
operator|->
name|ID
argument_list|)
decl_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_vectors_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_active_vectors (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_active_vectors
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|PyGimpVectors
modifier|*
name|vtr
decl_stmt|;
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"cannot delete active_vectors"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|pygimp_vectors_check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mismatch"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|vtr
operator|=
operator|(
name|PyGimpVectors
operator|*
operator|)
name|value
expr_stmt|;
if|if
condition|(
operator|!
name|gimp_image_set_active_vectors
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|vtr
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not set active vectors (ID %d) on image (ID %d)"
argument_list|,
name|vtr
operator|->
name|ID
argument_list|,
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|img_getsets
specifier|static
name|PyGetSetDef
name|img_getsets
index|[]
init|=
block|{
block|{
literal|"ID"
block|,
operator|(
name|getter
operator|)
name|img_get_ID
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"active_channel"
block|,
operator|(
name|getter
operator|)
name|img_get_active_channel
block|,
operator|(
name|setter
operator|)
name|img_set_active_channel
block|}
block|,
block|{
literal|"active_drawable"
block|,
operator|(
name|getter
operator|)
name|img_get_active_drawable
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"active_layer"
block|,
operator|(
name|getter
operator|)
name|img_get_active_layer
block|,
operator|(
name|setter
operator|)
name|img_set_active_layer
block|}
block|,
block|{
literal|"active_vectors"
block|,
operator|(
name|getter
operator|)
name|img_get_active_vectors
block|,
operator|(
name|setter
operator|)
name|img_set_active_vectors
block|}
block|,
block|{
literal|"base_type"
block|,
operator|(
name|getter
operator|)
name|img_get_base_type
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"channels"
block|,
operator|(
name|getter
operator|)
name|img_get_channels
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"colormap"
block|,
operator|(
name|getter
operator|)
name|img_get_colormap
block|,
operator|(
name|setter
operator|)
name|img_set_colormap
block|}
block|,
block|{
literal|"dirty"
block|,
operator|(
name|getter
operator|)
name|img_get_is_dirty
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"filename"
block|,
operator|(
name|getter
operator|)
name|img_get_filename
block|,
operator|(
name|setter
operator|)
name|img_set_filename
block|}
block|,
block|{
literal|"floating_selection"
block|,
operator|(
name|getter
operator|)
name|img_get_floating_selection
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"floating_sel_attached_to"
block|,
operator|(
name|getter
operator|)
name|img_get_floating_sel_attached_to
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"height"
block|,
operator|(
name|getter
operator|)
name|img_get_height
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"layers"
block|,
operator|(
name|getter
operator|)
name|img_get_layers
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"name"
block|,
operator|(
name|getter
operator|)
name|img_get_name
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"resolution"
block|,
operator|(
name|getter
operator|)
name|img_get_resolution
block|,
operator|(
name|setter
operator|)
name|img_set_resolution
block|}
block|,
block|{
literal|"selection"
block|,
operator|(
name|getter
operator|)
name|img_get_selection
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"tattoo_state"
block|,
operator|(
name|getter
operator|)
name|img_get_tattoo_state
block|,
operator|(
name|setter
operator|)
name|img_set_tattoo_state
block|}
block|,
block|{
literal|"unit"
block|,
operator|(
name|getter
operator|)
name|img_get_unit
block|,
operator|(
name|setter
operator|)
name|img_set_unit
block|}
block|,
block|{
literal|"uri"
block|,
operator|(
name|getter
operator|)
name|img_get_uri
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"vectors"
block|,
operator|(
name|getter
operator|)
name|img_get_vectors
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"width"
block|,
operator|(
name|getter
operator|)
name|img_get_width
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
name|NULL
block|,
operator|(
name|getter
operator|)
literal|0
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------- */
end_comment

begin_function
name|PyObject
modifier|*
DECL|function|pygimp_image_new (gint32 ID)
name|pygimp_image_new
parameter_list|(
name|gint32
name|ID
parameter_list|)
block|{
name|PyGimpImage
modifier|*
name|self
decl_stmt|;
if|if
condition|(
operator|!
name|gimp_image_is_valid
argument_list|(
name|ID
argument_list|)
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|PyGimpImage
argument_list|,
operator|&
name|PyGimpImage_Type
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|self
operator|->
name|ID
operator|=
name|ID
expr_stmt|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|img_dealloc (PyGimpImage * self)
name|img_dealloc
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
comment|/* XXXX Add your own cleanup code here */
name|PyObject_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_repr (PyGimpImage * self)
name|img_repr
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
name|gchar
modifier|*
name|name
decl_stmt|;
name|name
operator|=
name|gimp_image_get_name
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|s
operator|=
name|PyString_FromFormat
argument_list|(
literal|"<gimp.Image '%s'>"
argument_list|,
name|name
condition|?
name|name
else|:
literal|"(null)"
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|name
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_cmp (PyGimpImage * self,PyGimpImage * other)
name|img_cmp
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyGimpImage
modifier|*
name|other
parameter_list|)
block|{
if|if
condition|(
name|self
operator|->
name|ID
operator|==
name|other
operator|->
name|ID
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|self
operator|->
name|ID
operator|>
name|other
operator|->
name|ID
condition|)
return|return
operator|-
literal|1
return|;
return|return
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_init (PyGimpImage * self,PyObject * args,PyObject * kwargs)
name|img_init
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|guint
name|width
decl_stmt|,
name|height
decl_stmt|;
name|GimpImageBaseType
name|type
init|=
name|GIMP_RGB
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"width"
block|,
literal|"height"
block|,
literal|"type"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"ii|i:gimp.Image.__init__"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|,
operator|&
name|type
argument_list|)
condition|)
return|return
operator|-
literal|1
return|;
name|self
operator|->
name|ID
operator|=
name|gimp_image_new
argument_list|(
name|width
argument_list|,
name|height
argument_list|,
name|type
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|->
name|ID
operator|<
literal|0
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not create image (width: %d, height: %d, type: %d)"
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|type
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|PyGimpImage_Type
name|PyTypeObject
name|PyGimpImage_Type
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
name|NULL
argument_list|)
literal|0
block|,
comment|/* ob_size */
literal|"gimp.Image"
block|,
comment|/* tp_name */
sizeof|sizeof
argument_list|(
name|PyGimpImage
argument_list|)
block|,
comment|/* tp_basicsize */
literal|0
block|,
comment|/* tp_itemsize */
comment|/* methods */
operator|(
name|destructor
operator|)
name|img_dealloc
block|,
comment|/* tp_dealloc */
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/* tp_print */
operator|(
name|getattrfunc
operator|)
literal|0
block|,
comment|/* tp_getattr */
operator|(
name|setattrfunc
operator|)
literal|0
block|,
comment|/* tp_setattr */
operator|(
name|cmpfunc
operator|)
name|img_cmp
block|,
comment|/* tp_compare */
operator|(
name|reprfunc
operator|)
name|img_repr
block|,
comment|/* tp_repr */
literal|0
block|,
comment|/* tp_as_number */
literal|0
block|,
comment|/* tp_as_sequence */
literal|0
block|,
comment|/* tp_as_mapping */
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/* tp_hash */
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/* tp_call */
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/* tp_str */
operator|(
name|getattrofunc
operator|)
literal|0
block|,
comment|/* tp_getattro */
operator|(
name|setattrofunc
operator|)
literal|0
block|,
comment|/* tp_setattro */
literal|0
block|,
comment|/* tp_as_buffer */
name|Py_TPFLAGS_DEFAULT
block|,
comment|/* tp_flags */
name|NULL
block|,
comment|/* Documentation string */
operator|(
name|traverseproc
operator|)
literal|0
block|,
comment|/* tp_traverse */
operator|(
name|inquiry
operator|)
literal|0
block|,
comment|/* tp_clear */
operator|(
name|richcmpfunc
operator|)
literal|0
block|,
comment|/* tp_richcompare */
literal|0
block|,
comment|/* tp_weaklistoffset */
operator|(
name|getiterfunc
operator|)
literal|0
block|,
comment|/* tp_iter */
operator|(
name|iternextfunc
operator|)
literal|0
block|,
comment|/* tp_iternext */
name|img_methods
block|,
comment|/* tp_methods */
literal|0
block|,
comment|/* tp_members */
name|img_getsets
block|,
comment|/* tp_getset */
operator|(
name|PyTypeObject
operator|*
operator|)
literal|0
block|,
comment|/* tp_base */
operator|(
name|PyObject
operator|*
operator|)
literal|0
block|,
comment|/* tp_dict */
literal|0
block|,
comment|/* tp_descr_get */
literal|0
block|,
comment|/* tp_descr_set */
literal|0
block|,
comment|/* tp_dictoffset */
operator|(
name|initproc
operator|)
name|img_init
block|,
comment|/* tp_init */
operator|(
name|allocfunc
operator|)
literal|0
block|,
comment|/* tp_alloc */
operator|(
name|newfunc
operator|)
literal|0
block|,
comment|/* tp_new */
block|}
decl_stmt|;
end_decl_stmt

end_unit

