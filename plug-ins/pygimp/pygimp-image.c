begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* -*- Mode: C; c-basic-offset: 4 -*-      Gimp-Python - allows the writing of Gimp plugins in Python.     Copyright (C) 1997-2002  James Henstridge<james@daa.com.au>      This program is free software; you can redistribute it and/or modify     it under the terms of the GNU General Public License as published by     the Free Software Foundation; either version 2 of the License, or     (at your option) any later version.      This program is distributed in the hope that it will be useful,     but WITHOUT ANY WARRANTY; without even the implied warranty of     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the     GNU General Public License for more details.      You should have received a copy of the GNU General Public License     along with this program; if not, write to the Free Software     Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|<config.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_include
include|#
directive|include
file|"pygimp.h"
end_include

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_channel (PyGimpImage * self,PyObject * args)
name|img_add_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
name|int
name|pos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!i:add_channel"
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|chn
argument_list|,
operator|&
name|pos
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
name|pos
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_layer (PyGimpImage * self,PyObject * args)
name|img_add_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
name|int
name|pos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!i:add_layer"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|,
operator|&
name|pos
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|pos
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_layer_mask (PyGimpImage * self,PyObject * args)
name|img_add_layer_mask
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
name|PyGimpChannel
modifier|*
name|mask
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!O!:add_layer_mask"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|mask
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_layer_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|mask
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_clean_all (PyGimpImage * self,PyObject * args)
name|img_clean_all
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":clean_all"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_clean_all
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_disable_undo (PyGimpImage * self,PyObject * args)
name|img_disable_undo
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
comment|/*GimpParam *return_vals;     int nreturn_vals;*/
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":disable_undo"
argument_list|)
condition|)
return|return
name|NULL
return|;
comment|/*return_vals = gimp_run_procedure("gimp_undo_push_group_start",&nreturn_vals, GIMP_PDB_IMAGE, self->ID, 				     GIMP_PDB_END);     gimp_destroy_params(return_vals, nreturn_vals);*/
name|gimp_image_undo_disable
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_enable_undo (PyGimpImage * self,PyObject * args)
name|img_enable_undo
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
comment|/*GimpParam *return_vals;     int nreturn_vals;*/
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":enable_undo"
argument_list|)
condition|)
return|return
name|NULL
return|;
comment|/*return_vals = gimp_run_procedure("gimp_undo_push_group_start",&nreturn_vals, GIMP_PDB_IMAGE, self->ID, 				     GIMP_PDB_END);     gimp_destroy_params(return_vals, nreturn_vals);*/
name|gimp_image_undo_enable
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_flatten (PyGimpImage * self,PyObject * args)
name|img_flatten
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":flatten"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_flatten
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_lower_channel (PyGimpImage * self,PyObject * args)
name|img_lower_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:lower_channel"
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|chn
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_lower_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_lower_layer (PyGimpImage * self,PyObject * args)
name|img_lower_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:lower_layer"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_lower_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_merge_visible_layers (PyGimpImage * self,PyObject * args)
name|img_merge_visible_layers
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|gint32
name|id
decl_stmt|;
name|int
name|merge
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:merge_visible_layers"
argument_list|,
operator|&
name|merge
argument_list|)
condition|)
return|return
name|NULL
return|;
name|id
operator|=
name|gimp_image_merge_visible_layers
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|merge
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"Can't merge layers."
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_pick_correlate_layer (PyGimpImage * self,PyObject * args)
name|img_pick_correlate_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|x
decl_stmt|,
name|y
decl_stmt|;
name|gint32
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:pick_correlate_layer"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
condition|)
return|return
name|NULL
return|;
name|id
operator|=
name|gimp_image_pick_correlate_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_raise_channel (PyGimpImage * self,PyObject * args)
name|img_raise_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:raise_channel"
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|chn
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_raise_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_raise_layer (PyGimpImage * self,PyObject * args)
name|img_raise_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:raise_layer"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_raise_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_remove_channel (PyGimpImage * self,PyObject * args)
name|img_remove_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpChannel
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:remove_channel"
argument_list|,
operator|&
name|PyGimpChannel_Type
argument_list|,
operator|&
name|chn
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_remove_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_remove_layer (PyGimpImage * self,PyObject * args)
name|img_remove_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:remove_layer"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_remove_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_remove_layer_mask (PyGimpImage * self,PyObject * args)
name|img_remove_layer_mask
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpLayer
modifier|*
name|lay
decl_stmt|;
name|int
name|mode
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!i:remove_layer_mask"
argument_list|,
operator|&
name|PyGimpLayer_Type
argument_list|,
operator|&
name|lay
argument_list|,
operator|&
name|mode
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_remove_layer_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|mode
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_resize (PyGimpImage * self,PyObject * args)
name|img_resize
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|unsigned
name|int
name|new_w
decl_stmt|,
name|new_h
decl_stmt|;
name|int
name|offs_x
decl_stmt|,
name|offs_y
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iiii:resize"
argument_list|,
operator|&
name|new_w
argument_list|,
operator|&
name|new_h
argument_list|,
operator|&
name|offs_x
argument_list|,
operator|&
name|offs_y
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_resize
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|new_w
argument_list|,
name|new_h
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_component_active (PyGimpImage * self,PyObject * args)
name|img_get_component_active
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|comp
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_component_active"
argument_list|,
operator|&
name|comp
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_image_get_component_active
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_component_visible (PyGimpImage * self,PyObject * args)
name|img_get_component_visible
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|comp
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_component_visible"
argument_list|,
operator|&
name|comp
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_image_get_component_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_set_component_active (PyGimpImage * self,PyObject * args)
name|img_set_component_active
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|comp
decl_stmt|,
name|a
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:set_component_active"
argument_list|,
operator|&
name|comp
argument_list|,
operator|&
name|a
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_set_component_active
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|,
name|a
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_set_component_visible (PyGimpImage * self,PyObject * args)
name|img_set_component_visible
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|comp
decl_stmt|,
name|v
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:set_component_visible"
argument_list|,
operator|&
name|comp
argument_list|,
operator|&
name|v
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_set_component_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_parasite_find (PyGimpImage * self,PyObject * args)
name|img_parasite_find
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:parasite_find"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|pygimp_parasite_new
argument_list|(
name|gimp_image_parasite_find
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_parasite_attach (PyGimpImage * self,PyObject * args)
name|img_parasite_attach
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpParasite
modifier|*
name|parasite
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:parasite_attach"
argument_list|,
operator|&
name|PyGimpParasite_Type
argument_list|,
operator|&
name|parasite
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_parasite_attach
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|parasite
operator|->
name|para
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_attach_new_parasite (PyGimpImage * self,PyObject * args)
name|img_attach_new_parasite
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|data
decl_stmt|;
name|int
name|flags
decl_stmt|,
name|size
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sis#:attach_new_parasite"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|flags
argument_list|,
operator|&
name|data
argument_list|,
operator|&
name|size
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_attach_new_parasite
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|,
name|flags
argument_list|,
name|size
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_parasite_detach (PyGimpImage * self,PyObject * args)
name|img_parasite_detach
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:parasite_detach"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_parasite_detach
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_comment
comment|/* gimp_image_set_resolution  * gimp_image_get_resolution  * gimp_set_unit  * gimp_get_unit  */
end_comment

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_layer_by_tattoo (PyGimpImage * self,PyObject * args)
name|img_get_layer_by_tattoo
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|tattoo
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_layer_by_tattoo"
argument_list|,
operator|&
name|tattoo
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|pygimp_layer_new
argument_list|(
name|gimp_image_get_layer_by_tattoo
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|tattoo
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_channel_by_tattoo (PyGimpImage * self,PyObject * args)
name|img_get_channel_by_tattoo
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|tattoo
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_channel_by_tattoo"
argument_list|,
operator|&
name|tattoo
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|pygimp_channel_new
argument_list|(
name|gimp_image_get_channel_by_tattoo
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|tattoo
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_hguide (PyGimpImage * self,PyObject * args)
name|img_add_hguide
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|ypos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:add_hguide"
argument_list|,
operator|&
name|ypos
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_hguide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|ypos
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_vguide (PyGimpImage * self,PyObject * args)
name|img_add_vguide
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|xpos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:add_vguide"
argument_list|,
operator|&
name|xpos
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_vguide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|xpos
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_delete_guide (PyGimpImage * self,PyObject * args)
name|img_delete_guide
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:delete_guide"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_delete_guide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_find_next_guide (PyGimpImage * self,PyObject * args)
name|img_find_next_guide
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:find_next_guide"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_find_next_guide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_guide_orientation (PyGimpImage * self,PyObject * args)
name|img_get_guide_orientation
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_guide_orientation"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_guide_orientation
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_guide_position (PyGimpImage * self,PyObject * args)
name|img_get_guide_position
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_guide_position"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_guide_position
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|img_methods
specifier|static
name|struct
name|PyMethodDef
name|img_methods
index|[]
init|=
block|{
block|{
literal|"add_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_layer_mask"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_layer_mask
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"clean_all"
block|,
operator|(
name|PyCFunction
operator|)
name|img_clean_all
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"disable_undo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_disable_undo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"enable_undo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_enable_undo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"flatten"
block|,
operator|(
name|PyCFunction
operator|)
name|img_flatten
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"lower_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_lower_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"lower_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_lower_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"merge_visible_layers"
block|,
operator|(
name|PyCFunction
operator|)
name|img_merge_visible_layers
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"pick_correlate_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_pick_correlate_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"raise_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_raise_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"raise_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_raise_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"remove_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_remove_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"remove_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_remove_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"remove_layer_mask"
block|,
operator|(
name|PyCFunction
operator|)
name|img_remove_layer_mask
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"resize"
block|,
operator|(
name|PyCFunction
operator|)
name|img_resize
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_component_active"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_component_active
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_component_visible"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_component_visible
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_component_active"
block|,
operator|(
name|PyCFunction
operator|)
name|img_set_component_active
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_component_visible"
block|,
operator|(
name|PyCFunction
operator|)
name|img_set_component_visible
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_find"
block|,
operator|(
name|PyCFunction
operator|)
name|img_parasite_find
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_attach"
block|,
operator|(
name|PyCFunction
operator|)
name|img_parasite_attach
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"attach_new_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|img_attach_new_parasite
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_detach"
block|,
operator|(
name|PyCFunction
operator|)
name|img_parasite_detach
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_layer_by_tattoo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_layer_by_tattoo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_channel_by_tattoo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_channel_by_tattoo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_hguide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_hguide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_vguide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_vguide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"delete_guide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_delete_guide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"find_next_guide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_find_next_guide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_guide_orientation"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_guide_orientation
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_guide_position"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_guide_position
block|,
name|METH_VARARGS
block|}
block|,
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_ID (PyGimpImage * self,void * closure)
name|img_get_ID
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|self
operator|->
name|ID
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_active_channel (PyGimpImage * self,void * closure)
name|img_get_active_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
name|id
init|=
name|gimp_image_get_active_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|)
decl_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_channel_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_active_channel (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_active_channel
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete active_channel."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|pygimp_channel_check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_active_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|(
operator|(
name|PyGimpChannel
operator|*
operator|)
name|value
operator|)
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_active_layer (PyGimpImage * self,void * closure)
name|img_get_active_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
name|id
init|=
name|gimp_image_get_active_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|)
decl_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_active_layer (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_active_layer
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete active_layer."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|pygimp_layer_check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_active_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|(
operator|(
name|PyGimpLayer
operator|*
operator|)
name|value
operator|)
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_base_type (PyGimpImage * self,void * closure)
name|img_get_base_type
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_base_type
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_channels (PyGimpImage * self,void * closure)
name|img_get_channels
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
modifier|*
name|channels
decl_stmt|;
name|gint
name|n_channels
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|channels
operator|=
name|gimp_image_get_channels
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|n_channels
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|n_channels
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|n_channels
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|pygimp_channel_new
argument_list|(
name|channels
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|channels
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_cmap (PyGimpImage * self,void * closure)
name|img_get_cmap
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|guchar
modifier|*
name|cmap
decl_stmt|;
name|gint
name|n_colours
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|cmap
operator|=
name|gimp_image_get_cmap
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|n_colours
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyString_FromStringAndSize
argument_list|(
name|cmap
argument_list|,
name|n_colours
operator|*
literal|3
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|cmap
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_cmap (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_cmap
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete cmap."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_cmap
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyString_AsString
argument_list|(
name|value
argument_list|)
argument_list|,
name|PyString_Size
argument_list|(
name|value
argument_list|)
operator|/
literal|3
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_filename (PyGimpImage * self,void * closure)
name|img_get_filename
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gchar
modifier|*
name|filename
decl_stmt|;
name|filename
operator|=
name|gimp_image_get_filename
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|filename
condition|)
block|{
name|PyObject
modifier|*
name|ret
init|=
name|PyString_FromString
argument_list|(
name|filename
argument_list|)
decl_stmt|;
name|g_free
argument_list|(
name|filename
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_filename (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_filename
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete filename."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_filename
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyString_AsString
argument_list|(
name|value
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_floating_selection (PyGimpImage * self,void * closure)
name|img_get_floating_selection
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
name|id
decl_stmt|;
name|id
operator|=
name|gimp_image_floating_selection
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
name|pygimp_layer_new
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_layers (PyGimpImage * self,void * closure)
name|img_get_layers
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gint32
modifier|*
name|layers
decl_stmt|;
name|gint
name|n_layers
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|layers
operator|=
name|gimp_image_get_layers
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|n_layers
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|n_layers
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|n_layers
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|pygimp_layer_new
argument_list|(
name|layers
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|layers
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_selection (PyGimpImage * self,void * closure)
name|img_get_selection
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|pygimp_channel_new
argument_list|(
name|gimp_image_get_selection
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_height (PyGimpImage * self,void * closure)
name|img_get_height
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_height
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_width (PyGimpImage * self,void * closure)
name|img_get_width
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_width
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_resolution (PyGimpImage * self,void * closure)
name|img_get_resolution
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|double
name|xres
decl_stmt|,
name|yres
decl_stmt|;
name|gimp_image_get_resolution
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|xres
argument_list|,
operator|&
name|yres
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(dd)"
argument_list|,
name|xres
argument_list|,
name|yres
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_resolution (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_resolution
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
name|gdouble
name|xres
decl_stmt|,
name|yres
decl_stmt|;
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete filename."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|value
argument_list|)
operator|||
operator|!
name|PyArg_ParseTuple
argument_list|(
name|value
argument_list|,
literal|"dd"
argument_list|,
operator|&
name|xres
argument_list|,
operator|&
name|yres
argument_list|)
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_resolution
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|xres
argument_list|,
name|yres
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_unit (PyGimpImage * self,void * closure)
name|img_get_unit
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_unit
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_set_unit (PyGimpImage * self,PyObject * value,void * closure)
name|img_set_unit
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|value
parameter_list|,
name|void
modifier|*
name|closure
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete filename."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|value
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_unit
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|value
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|img_getsets
specifier|static
name|struct
name|PyGetSetDef
name|img_getsets
index|[]
init|=
block|{
block|{
literal|"ID"
block|,
operator|(
name|getter
operator|)
name|img_get_ID
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"active_channel"
block|,
operator|(
name|getter
operator|)
name|img_get_active_channel
block|,
operator|(
name|setter
operator|)
name|img_set_active_channel
block|}
block|,
block|{
literal|"active_layer"
block|,
operator|(
name|getter
operator|)
name|img_get_active_layer
block|,
operator|(
name|setter
operator|)
name|img_set_active_layer
block|}
block|,
block|{
literal|"base_type"
block|,
operator|(
name|getter
operator|)
name|img_get_base_type
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"channels"
block|,
operator|(
name|getter
operator|)
name|img_get_channels
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"cmap"
block|,
operator|(
name|getter
operator|)
name|img_get_cmap
block|,
operator|(
name|setter
operator|)
name|img_set_cmap
block|}
block|,
block|{
literal|"filename"
block|,
operator|(
name|getter
operator|)
name|img_get_filename
block|,
operator|(
name|setter
operator|)
name|img_set_filename
block|}
block|,
block|{
literal|"floating_selection"
block|,
operator|(
name|getter
operator|)
name|img_get_floating_selection
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"height"
block|,
operator|(
name|getter
operator|)
name|img_get_height
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"layers"
block|,
operator|(
name|getter
operator|)
name|img_get_layers
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"resolution"
block|,
operator|(
name|getter
operator|)
name|img_get_resolution
block|,
operator|(
name|setter
operator|)
name|img_set_resolution
block|}
block|,
block|{
literal|"selection"
block|,
operator|(
name|getter
operator|)
name|img_get_selection
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
literal|"unit"
block|,
operator|(
name|getter
operator|)
name|img_get_unit
block|,
operator|(
name|setter
operator|)
name|img_set_unit
block|}
block|,
block|{
literal|"width"
block|,
operator|(
name|getter
operator|)
name|img_get_width
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|,
block|{
name|NULL
block|,
operator|(
name|getter
operator|)
literal|0
block|,
operator|(
name|setter
operator|)
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------- */
end_comment

begin_function
name|PyObject
modifier|*
DECL|function|pygimp_image_new (gint32 ID)
name|pygimp_image_new
parameter_list|(
name|gint32
name|ID
parameter_list|)
block|{
name|PyGimpImage
modifier|*
name|self
decl_stmt|;
if|if
condition|(
name|ID
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|PyGimpImage
argument_list|,
operator|&
name|PyGimpImage_Type
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|self
operator|->
name|ID
operator|=
name|ID
expr_stmt|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|img_dealloc (PyGimpImage * self)
name|img_dealloc
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
comment|/* XXXX Add your own cleanup code here */
name|PyObject_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_repr (PyGimpImage * self)
name|img_repr
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|)
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
name|gchar
modifier|*
name|name
decl_stmt|;
name|name
operator|=
name|gimp_image_get_filename
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|s
operator|=
name|PyString_FromFormat
argument_list|(
literal|"<gimp.image %s>"
argument_list|,
name|name
condition|?
name|name
else|:
literal|"(null)"
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|name
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_cmp (PyGimpImage * self,PyGimpImage * other)
name|img_cmp
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyGimpImage
modifier|*
name|other
parameter_list|)
block|{
if|if
condition|(
name|self
operator|->
name|ID
operator|==
name|other
operator|->
name|ID
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|self
operator|->
name|ID
operator|>
name|other
operator|->
name|ID
condition|)
return|return
operator|-
literal|1
return|;
return|return
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_init (PyGimpImage * self,PyObject * args,PyObject * kwargs)
name|img_init
parameter_list|(
name|PyGimpImage
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|guint
name|width
decl_stmt|,
name|height
decl_stmt|;
name|GimpImageBaseType
name|type
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iii:gimp.Image.__init__"
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|,
operator|&
name|type
argument_list|)
condition|)
return|return
operator|-
literal|1
return|;
name|self
operator|->
name|ID
operator|=
name|gimp_image_new
argument_list|(
name|width
argument_list|,
name|height
argument_list|,
name|type
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|->
name|ID
operator|<
literal|0
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not create image"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
literal|0
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|PyGimpImage_Type
name|PyTypeObject
name|PyGimpImage_Type
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
name|NULL
argument_list|)
literal|0
block|,
comment|/* ob_size */
literal|"gimp.Image"
block|,
comment|/* tp_name */
sizeof|sizeof
argument_list|(
name|PyGimpImage
argument_list|)
block|,
comment|/* tp_basicsize */
literal|0
block|,
comment|/* tp_itemsize */
comment|/* methods */
operator|(
name|destructor
operator|)
name|img_dealloc
block|,
comment|/* tp_dealloc */
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/* tp_print */
operator|(
name|getattrfunc
operator|)
literal|0
block|,
comment|/* tp_getattr */
operator|(
name|setattrfunc
operator|)
literal|0
block|,
comment|/* tp_setattr */
operator|(
name|cmpfunc
operator|)
name|img_cmp
block|,
comment|/* tp_compare */
operator|(
name|reprfunc
operator|)
name|img_repr
block|,
comment|/* tp_repr */
literal|0
block|,
comment|/* tp_as_number */
literal|0
block|,
comment|/* tp_as_sequence */
literal|0
block|,
comment|/* tp_as_mapping */
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/* tp_hash */
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/* tp_call */
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/* tp_str */
operator|(
name|getattrofunc
operator|)
literal|0
block|,
comment|/* tp_getattro */
operator|(
name|setattrofunc
operator|)
literal|0
block|,
comment|/* tp_setattro */
literal|0
block|,
comment|/* tp_as_buffer */
name|Py_TPFLAGS_DEFAULT
block|,
comment|/* tp_flags */
name|NULL
block|,
comment|/* Documentation string */
operator|(
name|traverseproc
operator|)
literal|0
block|,
comment|/* tp_traverse */
operator|(
name|inquiry
operator|)
literal|0
block|,
comment|/* tp_clear */
operator|(
name|richcmpfunc
operator|)
literal|0
block|,
comment|/* tp_richcompare */
literal|0
block|,
comment|/* tp_weaklistoffset */
operator|(
name|getiterfunc
operator|)
literal|0
block|,
comment|/* tp_iter */
operator|(
name|iternextfunc
operator|)
literal|0
block|,
comment|/* tp_iternext */
name|img_methods
block|,
comment|/* tp_methods */
literal|0
block|,
comment|/* tp_members */
name|img_getsets
block|,
comment|/* tp_getset */
operator|(
name|PyTypeObject
operator|*
operator|)
literal|0
block|,
comment|/* tp_base */
operator|(
name|PyObject
operator|*
operator|)
literal|0
block|,
comment|/* tp_dict */
literal|0
block|,
comment|/* tp_descr_get */
literal|0
block|,
comment|/* tp_descr_set */
literal|0
block|,
comment|/* tp_dictoffset */
operator|(
name|initproc
operator|)
name|img_init
block|,
comment|/* tp_init */
operator|(
name|allocfunc
operator|)
literal|0
block|,
comment|/* tp_alloc */
operator|(
name|newfunc
operator|)
literal|0
block|,
comment|/* tp_new */
block|}
decl_stmt|;
end_decl_stmt

end_unit

