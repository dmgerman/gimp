begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* -*- Mode: C; c-basic-offset: 4 -*- */
end_comment

begin_comment
comment|/*     Gimp-Python - allows the writing of Gimp plugins in Python.     Copyright (C) 1997-1999  James Henstridge<james@daa.com.au>      This program is free software; you can redistribute it and/or modify     it under the terms of the GNU General Public License as published by     the Free Software Foundation; either version 2 of the License, or     (at your option) any later version.      This program is distributed in the hope that it will be useful,     but WITHOUT ANY WARRANTY; without even the implied warranty of     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the     GNU General Public License for more details.      You should have received a copy of the GNU General Public License     along with this program; if not, write to the Free Software     Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.  */
end_comment

begin_include
include|#
directive|include
file|"Python.h"
end_include

begin_include
include|#
directive|include
file|"sysmodule.h"
end_include

begin_include
include|#
directive|include
file|"structmember.h"
end_include

begin_include
include|#
directive|include
file|<libgimp/gimp.h>
end_include

begin_decl_stmt
DECL|variable|ErrorObject
specifier|static
name|PyObject
modifier|*
name|ErrorObject
decl_stmt|;
end_decl_stmt

begin_ifndef
ifndef|#
directive|ifndef
name|GIMP_CHECK_VERSION
end_ifndef

begin_define
DECL|macro|GIMP_CHECK_VERSION (major,minor,micro)
define|#
directive|define
name|GIMP_CHECK_VERSION
parameter_list|(
name|major
parameter_list|,
name|minor
parameter_list|,
name|micro
parameter_list|)
define|\
value|(GIMP_MAJOR_VERSION> (major) || \      (GIMP_MAJOR_VERSION == (major)&& GIMP_MINOR_VERSION> (minor)) || \      (GIMP_MAJOR_VERSION == (major)&& GIMP_MINOR_VERSION == (minor)&& \       GIMP_MICRO_VERSION>= (micro)))
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_ifndef
ifndef|#
directive|ifndef
name|PG_DEBUG
end_ifndef

begin_define
DECL|macro|PG_DEBUG
define|#
directive|define
name|PG_DEBUG
value|0
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* ----------------------------------------------------- */
end_comment

begin_comment
comment|/* Declarations for objects of type pdb */
end_comment

begin_typedef
DECL|struct|__anon2c9154cd0108
typedef|typedef
struct|struct
block|{
name|PyObject_HEAD
comment|/* XXXX Add your own stuff here */
DECL|typedef|pdbobject
block|}
name|pdbobject
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|Pdbtype
name|staticforward
name|PyTypeObject
name|Pdbtype
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|pdb_check (v)
define|#
directive|define
name|pdb_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Pdbtype)
end_define

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_comment
comment|/* Declarations for objects of type pdbFunc */
end_comment

begin_typedef
DECL|struct|__anon2c9154cd0208
typedef|typedef
struct|struct
block|{
name|PyObject_HEAD
DECL|member|name
name|char
modifier|*
name|name
decl_stmt|;
DECL|member|proc_name
DECL|member|proc_blurb
DECL|member|proc_help
DECL|member|proc_author
name|PyObject
modifier|*
name|proc_name
decl_stmt|,
modifier|*
name|proc_blurb
decl_stmt|,
modifier|*
name|proc_help
decl_stmt|,
modifier|*
name|proc_author
decl_stmt|,
DECL|member|proc_copyright
DECL|member|proc_date
DECL|member|proc_type
DECL|member|py_params
modifier|*
name|proc_copyright
decl_stmt|,
modifier|*
name|proc_date
decl_stmt|,
modifier|*
name|proc_type
decl_stmt|,
modifier|*
name|py_params
decl_stmt|,
DECL|member|py_return_vals
modifier|*
name|py_return_vals
decl_stmt|;
DECL|member|nparams
DECL|member|nreturn_vals
name|int
name|nparams
decl_stmt|,
name|nreturn_vals
decl_stmt|;
DECL|member|params
DECL|member|return_vals
name|GParamDef
modifier|*
name|params
decl_stmt|,
modifier|*
name|return_vals
decl_stmt|;
DECL|typedef|pfobject
block|}
name|pfobject
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|Pftype
name|staticforward
name|PyTypeObject
name|Pftype
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|pf_check (v)
define|#
directive|define
name|pf_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Pftype)
end_define

begin_function_decl
specifier|static
name|pfobject
modifier|*
name|newpfobject
parameter_list|(
name|char
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_comment
comment|/* Declarations for objects of type Image */
end_comment

begin_typedef
DECL|struct|__anon2c9154cd0308
typedef|typedef
struct|struct
block|{
name|PyObject_HEAD
DECL|member|ID
name|gint32
name|ID
decl_stmt|;
DECL|typedef|imgobject
block|}
name|imgobject
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|Imgtype
name|staticforward
name|PyTypeObject
name|Imgtype
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|img_check (v)
define|#
directive|define
name|img_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Imgtype)
end_define

begin_function_decl
specifier|static
name|imgobject
modifier|*
name|newimgobject
parameter_list|(
name|gint32
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_comment
comment|/* Declarations for objects of type Display */
end_comment

begin_typedef
DECL|struct|__anon2c9154cd0408
typedef|typedef
struct|struct
block|{
name|PyObject_HEAD
DECL|member|ID
name|gint32
name|ID
decl_stmt|;
DECL|typedef|dispobject
block|}
name|dispobject
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|Disptype
name|staticforward
name|PyTypeObject
name|Disptype
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|disp_check (v)
define|#
directive|define
name|disp_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Disptype)
end_define

begin_function_decl
specifier|static
name|dispobject
modifier|*
name|newdispobject
parameter_list|(
name|gint32
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_comment
comment|/* Declarations for objects of type Layer and channel */
end_comment

begin_typedef
DECL|struct|__anon2c9154cd0508
typedef|typedef
struct|struct
block|{
name|PyObject_HEAD
DECL|member|ID
name|gint32
name|ID
decl_stmt|;
DECL|member|drawable
name|GDrawable
modifier|*
name|drawable
decl_stmt|;
DECL|typedef|drwobject
DECL|typedef|layobject
DECL|typedef|chnobject
block|}
name|drwobject
operator|,
name|layobject
operator|,
name|chnobject
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|Laytype
name|staticforward
name|PyTypeObject
name|Laytype
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|lay_check (v)
define|#
directive|define
name|lay_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Laytype)
end_define

begin_function_decl
specifier|static
name|layobject
modifier|*
name|newlayobject
parameter_list|(
name|gint32
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
DECL|variable|Chntype
name|staticforward
name|PyTypeObject
name|Chntype
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|chn_check (v)
define|#
directive|define
name|chn_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Chntype)
end_define

begin_function_decl
specifier|static
name|chnobject
modifier|*
name|newchnobject
parameter_list|(
name|gint32
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* The drawable type isn't really a type -- it can be a channel or layer */
end_comment

begin_define
DECL|macro|drw_check (v)
define|#
directive|define
name|drw_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Laytype || (v)->ob_type ==&Chntype)
end_define

begin_function_decl
specifier|static
name|drwobject
modifier|*
name|newdrwobject
parameter_list|(
name|GDrawable
modifier|*
parameter_list|,
name|gint32
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_comment
comment|/* Declarations for objects of type Tile */
end_comment

begin_typedef
DECL|struct|__anon2c9154cd0608
typedef|typedef
struct|struct
block|{
name|PyObject_HEAD
DECL|member|tile
name|GTile
modifier|*
name|tile
decl_stmt|;
DECL|member|drawable
name|drwobject
modifier|*
name|drawable
decl_stmt|;
comment|/* we keep a reference to the drawable */
DECL|typedef|tileobject
block|}
name|tileobject
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|Tiletype
name|staticforward
name|PyTypeObject
name|Tiletype
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|tile_check (v)
define|#
directive|define
name|tile_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Tiletype)
end_define

begin_function_decl
specifier|static
name|tileobject
modifier|*
name|newtileobject
parameter_list|(
name|GTile
modifier|*
parameter_list|,
name|drwobject
modifier|*
name|drw
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_comment
comment|/* Declarations for objects of type PixelRegion */
end_comment

begin_typedef
DECL|struct|__anon2c9154cd0708
typedef|typedef
struct|struct
block|{
name|PyObject_HEAD
DECL|member|pr
name|GPixelRgn
name|pr
decl_stmt|;
DECL|member|drawable
name|drwobject
modifier|*
name|drawable
decl_stmt|;
comment|/* keep the drawable around */
DECL|typedef|probject
block|}
name|probject
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|Prtype
name|staticforward
name|PyTypeObject
name|Prtype
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|pr_check (v)
define|#
directive|define
name|pr_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Prtype)
end_define

begin_function_decl
specifier|static
name|probject
modifier|*
name|newprobject
parameter_list|(
name|drwobject
modifier|*
name|drw
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|,
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
end_ifdef

begin_comment
comment|/* Declarations for objects of type Parasite */
end_comment

begin_typedef
DECL|struct|__anon2c9154cd0808
typedef|typedef
struct|struct
block|{
name|PyObject_HEAD
DECL|member|para
name|Parasite
modifier|*
name|para
decl_stmt|;
DECL|typedef|paraobject
block|}
name|paraobject
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|Paratype
name|staticforward
name|PyTypeObject
name|Paratype
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|para_check (v)
define|#
directive|define
name|para_check
parameter_list|(
name|v
parameter_list|)
value|((v)->ob_type ==&Paratype)
end_define

begin_function_decl
specifier|static
name|paraobject
modifier|*
name|newparaobject
parameter_list|(
name|Parasite
modifier|*
name|para
parameter_list|)
function_decl|;
end_function_decl

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_comment
comment|/* routines to convert between Python tuples and gimp GParam's */
end_comment

begin_if
if|#
directive|if
name|PG_DEBUG
operator|>
literal|0
end_if

begin_function
DECL|function|print_GParam (int nparams,GParam * params)
specifier|static
name|void
name|print_GParam
parameter_list|(
name|int
name|nparams
parameter_list|,
name|GParam
modifier|*
name|params
parameter_list|)
block|{
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nparams
condition|;
name|i
operator|++
control|)
block|{
switch|switch
condition|(
name|params
index|[
name|i
index|]
operator|.
name|type
condition|)
block|{
case|case
name|PARAM_INT32
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%i. int %i\n"
argument_list|,
name|i
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int32
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT16
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%i. int %i\n"
argument_list|,
name|i
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int16
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT8
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%i. int %i\n"
argument_list|,
name|i
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int8
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_FLOAT
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%i. float %f\n"
argument_list|,
name|i
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_float
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_STRING
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%i. string %s\n"
argument_list|,
name|i
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_string
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT32ARRAY
case|:
case|case
name|PARAM_INT16ARRAY
case|:
case|case
name|PARAM_INT8ARRAY
case|:
case|case
name|PARAM_FLOATARRAY
case|:
case|case
name|PARAM_STRINGARRAY
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%i. array of type %i %s\n"
argument_list|,
name|i
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|type
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int32array
operator|==
name|NULL
condition|?
literal|"(null)"
else|:
literal|""
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_STATUS
case|:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%i. status %i\n"
argument_list|,
name|i
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_status
argument_list|)
expr_stmt|;
break|break;
default|default:
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"%i. other %i\n"
argument_list|,
name|i
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int32
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|GParam_to_tuple (int nparams,GParam * params)
name|GParam_to_tuple
parameter_list|(
name|int
name|nparams
parameter_list|,
name|GParam
modifier|*
name|params
parameter_list|)
block|{
name|PyObject
modifier|*
name|args
decl_stmt|,
modifier|*
name|tmp
decl_stmt|;
name|int
name|i
decl_stmt|,
name|j
decl_stmt|,
name|n
decl_stmt|;
name|args
operator|=
name|PyTuple_New
argument_list|(
name|nparams
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nparams
operator|&&
name|params
index|[
name|i
index|]
operator|.
name|type
operator|!=
name|PARAM_END
condition|;
name|i
operator|++
control|)
block|{
switch|switch
condition|(
name|params
index|[
name|i
index|]
operator|.
name|type
condition|)
block|{
case|case
name|PARAM_INT32
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int32
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT16
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int16
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT8
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int8
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_FLOAT
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyFloat_FromDouble
argument_list|(
operator|(
name|double
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_float
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_STRING
case|:
if|if
condition|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_string
operator|==
name|NULL
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|Py_None
argument_list|)
expr_stmt|;
block|}
else|else
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyString_FromString
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_string
argument_list|)
argument_list|)
expr_stmt|;
break|break;
comment|/* For these to work, the previous argument must have 	     * been an integer 	     */
case|case
name|PARAM_INT32ARRAY
case|:
if|if
condition|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int32array
operator|==
name|NULL
condition|)
block|{
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyTuple_New
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
operator|(
name|tmp
operator|=
name|PyTuple_GetItem
argument_list|(
name|args
argument_list|,
name|i
operator|-
literal|1
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|tmp
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"count type must be integer"
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|n
operator|=
name|PyInt_AsLong
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
name|tmp
operator|=
name|PyTuple_New
argument_list|(
name|n
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|n
condition|;
name|j
operator|++
control|)
name|PyTuple_SetItem
argument_list|(
name|tmp
argument_list|,
name|j
argument_list|,
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int32array
index|[
name|j
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|tmp
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT16ARRAY
case|:
if|if
condition|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int16array
operator|==
name|NULL
condition|)
block|{
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyTuple_New
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
operator|(
name|tmp
operator|=
name|PyTuple_GetItem
argument_list|(
name|args
argument_list|,
name|i
operator|-
literal|1
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|tmp
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"count type must be integer"
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|n
operator|=
name|PyInt_AsLong
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
name|tmp
operator|=
name|PyTuple_New
argument_list|(
name|n
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|n
condition|;
name|j
operator|++
control|)
name|PyTuple_SetItem
argument_list|(
name|tmp
argument_list|,
name|j
argument_list|,
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int16array
index|[
name|j
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|tmp
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT8ARRAY
case|:
if|if
condition|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int8array
operator|==
name|NULL
condition|)
block|{
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyTuple_New
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
operator|(
name|tmp
operator|=
name|PyTuple_GetItem
argument_list|(
name|args
argument_list|,
name|i
operator|-
literal|1
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|tmp
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"count type must be integer"
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|n
operator|=
name|PyInt_AsLong
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
name|tmp
operator|=
name|PyTuple_New
argument_list|(
name|n
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|n
condition|;
name|j
operator|++
control|)
name|PyTuple_SetItem
argument_list|(
name|tmp
argument_list|,
name|j
argument_list|,
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int8array
index|[
name|j
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|tmp
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_FLOATARRAY
case|:
if|if
condition|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_floatarray
operator|==
name|NULL
condition|)
block|{
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyTuple_New
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
operator|(
name|tmp
operator|=
name|PyTuple_GetItem
argument_list|(
name|args
argument_list|,
name|i
operator|-
literal|1
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|tmp
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"count type must be integer"
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|n
operator|=
name|PyInt_AsLong
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
name|tmp
operator|=
name|PyTuple_New
argument_list|(
name|n
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|n
condition|;
name|j
operator|++
control|)
name|PyTuple_SetItem
argument_list|(
name|tmp
argument_list|,
name|j
argument_list|,
name|PyFloat_FromDouble
argument_list|(
operator|(
name|double
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_floatarray
index|[
name|j
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|tmp
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_STRINGARRAY
case|:
if|if
condition|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_stringarray
operator|==
name|NULL
condition|)
block|{
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyTuple_New
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
break|break;
block|}
if|if
condition|(
operator|(
name|tmp
operator|=
name|PyTuple_GetItem
argument_list|(
name|args
argument_list|,
name|i
operator|-
literal|1
argument_list|)
operator|)
operator|==
name|NULL
condition|)
block|{
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|tmp
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"count type must be integer"
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|n
operator|=
name|PyInt_AsLong
argument_list|(
name|tmp
argument_list|)
expr_stmt|;
name|tmp
operator|=
name|PyTuple_New
argument_list|(
name|n
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|n
condition|;
name|j
operator|++
control|)
name|PyTuple_SetItem
argument_list|(
name|tmp
argument_list|,
name|j
argument_list|,
name|PyString_FromString
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_stringarray
index|[
name|j
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|tmp
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_COLOR
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|Py_BuildValue
argument_list|(
literal|"(iii)"
argument_list|,
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_color
operator|.
name|red
argument_list|,
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_color
operator|.
name|green
argument_list|,
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_color
operator|.
name|blue
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_REGION
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|Py_BuildValue
argument_list|(
literal|"(iiii)"
argument_list|,
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_region
operator|.
name|x
argument_list|,
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_region
operator|.
name|y
argument_list|,
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_region
operator|.
name|width
argument_list|,
operator|(
name|long
operator|)
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_region
operator|.
name|height
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_DISPLAY
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newdispobject
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_display
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_IMAGE
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newimgobject
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_image
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_LAYER
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_layer
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_CHANNEL
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newchnobject
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_channel
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_DRAWABLE
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newdrwobject
argument_list|(
name|NULL
argument_list|,
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_drawable
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_SELECTION
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_selection
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_BOUNDARY
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyInt_FromLong
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_boundary
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_PATH
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyInt_FromLong
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_path
argument_list|)
argument_list|)
expr_stmt|;
break|break;
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
case|case
name|PARAM_PARASITE
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newparaobject
argument_list|(
name|parasite_copy
argument_list|(
operator|&
operator|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_parasite
operator|)
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
break|break;
endif|#
directive|endif
case|case
name|PARAM_STATUS
case|:
name|PyTuple_SetItem
argument_list|(
name|args
argument_list|,
name|i
argument_list|,
name|PyInt_FromLong
argument_list|(
name|params
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_status
argument_list|)
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_END
case|:
break|break;
block|}
block|}
return|return
name|args
return|;
block|}
end_function

begin_function
specifier|static
name|GParam
modifier|*
DECL|function|tuple_to_GParam (PyObject * args,GParamDef * ptype,int nparams)
name|tuple_to_GParam
parameter_list|(
name|PyObject
modifier|*
name|args
parameter_list|,
name|GParamDef
modifier|*
name|ptype
parameter_list|,
name|int
name|nparams
parameter_list|)
block|{
name|PyObject
modifier|*
name|tuple
decl_stmt|,
modifier|*
name|item
decl_stmt|,
modifier|*
name|r
decl_stmt|,
modifier|*
name|g
decl_stmt|,
modifier|*
name|b
decl_stmt|,
modifier|*
name|x
decl_stmt|,
modifier|*
name|y
decl_stmt|,
modifier|*
name|w
decl_stmt|,
modifier|*
name|h
decl_stmt|;
name|GParam
modifier|*
name|ret
decl_stmt|;
name|int
name|i
decl_stmt|,
name|j
decl_stmt|,
name|len
decl_stmt|;
name|gint32
modifier|*
name|i32a
decl_stmt|;
name|gint16
modifier|*
name|i16a
decl_stmt|;
name|gint8
modifier|*
name|i8a
decl_stmt|;
name|gdouble
modifier|*
name|fa
decl_stmt|;
name|gchar
modifier|*
modifier|*
name|sa
decl_stmt|;
if|if
condition|(
name|nparams
operator|==
literal|0
condition|)
name|tuple
operator|=
name|PyTuple_New
argument_list|(
literal|0
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
operator|!
name|PyTuple_Check
argument_list|(
name|args
argument_list|)
operator|&&
name|nparams
operator|==
literal|1
condition|)
name|tuple
operator|=
name|Py_BuildValue
argument_list|(
literal|"(O)"
argument_list|,
name|args
argument_list|)
expr_stmt|;
else|else
block|{
name|Py_INCREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
name|tuple
operator|=
name|args
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|PyTuple_Check
argument_list|(
name|tuple
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"wrong type of parameter"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|PyTuple_Size
argument_list|(
name|tuple
argument_list|)
operator|!=
name|nparams
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"wrong number of parameters"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|ret
operator|=
name|g_new
argument_list|(
name|GParam
argument_list|,
name|nparams
operator|+
literal|1
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<=
name|nparams
condition|;
name|i
operator|++
control|)
name|ret
index|[
name|i
index|]
operator|.
name|type
operator|=
name|PARAM_STATUS
expr_stmt|;
DECL|macro|check (expr)
define|#
directive|define
name|check
parameter_list|(
name|expr
parameter_list|)
value|if (expr) { \ 	    PyErr_SetString(PyExc_TypeError, "wrong parameter type"); \ 	    Py_DECREF(tuple); \ 	    gimp_destroy_params(ret, nparams); \ 	    return NULL; \ 	}
DECL|macro|arraycheck (expr,ar)
define|#
directive|define
name|arraycheck
parameter_list|(
name|expr
parameter_list|,
name|ar
parameter_list|)
value|if (expr) { \ 	    PyErr_SetString(PyExc_TypeError, "subscript of wrong type"); \ 	    Py_DECREF(tuple); \ 	    gimp_destroy_params(ret, nparams); \ 	    g_free(ar); \ 	    return NULL; \ 	}
for|for
control|(
name|i
operator|=
literal|1
init|;
name|i
operator|<=
name|nparams
condition|;
name|i
operator|++
control|)
block|{
name|item
operator|=
name|PyTuple_GetItem
argument_list|(
name|tuple
argument_list|,
name|i
operator|-
literal|1
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|ptype
index|[
name|i
operator|-
literal|1
index|]
operator|.
name|type
condition|)
block|{
case|case
name|PARAM_INT32
case|:
name|check
argument_list|(
argument|(x = PyNumber_Int(item)) == NULL
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int32
operator|=
name|PyInt_AsLong
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|x
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT16
case|:
name|check
argument_list|(
argument|(x = PyNumber_Int(item)) == NULL
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int16
operator|=
name|PyInt_AsLong
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|x
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT8
case|:
name|check
argument_list|(
argument|(x = PyNumber_Int(item)) == NULL
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int8
operator|=
name|PyInt_AsLong
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|x
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_FLOAT
case|:
name|check
argument_list|(
argument|(x = PyNumber_Float(item)) == NULL
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_float
operator|=
name|PyFloat_AsDouble
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|x
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_STRING
case|:
name|check
argument_list|(
argument|(x = PyObject_Str(item)) == NULL
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_string
operator|=
name|g_strdup
argument_list|(
name|PyString_AsString
argument_list|(
name|x
argument_list|)
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|x
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_INT32ARRAY
case|:
name|check
argument_list|(
argument|!PySequence_Check(item)
argument_list|)
name|len
operator|=
name|PySequence_Length
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|i32a
operator|=
name|g_new
argument_list|(
name|gint32
argument_list|,
name|len
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|x
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
name|j
argument_list|)
expr_stmt|;
name|arraycheck
argument_list|(
operator|(
name|y
operator|=
name|PyNumber_Int
argument_list|(
name|x
argument_list|)
operator|)
operator|==
name|NULL
argument_list|,
name|i32a
argument_list|)
expr_stmt|;
name|i32a
index|[
name|j
index|]
operator|=
name|PyInt_AsLong
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|y
argument_list|)
expr_stmt|;
block|}
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int32array
operator|=
name|i32a
expr_stmt|;
break|break;
case|case
name|PARAM_INT16ARRAY
case|:
name|check
argument_list|(
argument|!PySequence_Check(item)
argument_list|)
name|len
operator|=
name|PySequence_Length
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|i16a
operator|=
name|g_new
argument_list|(
name|gint16
argument_list|,
name|len
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|x
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
name|j
argument_list|)
expr_stmt|;
name|arraycheck
argument_list|(
operator|(
name|y
operator|=
name|PyNumber_Int
argument_list|(
name|x
argument_list|)
operator|)
operator|==
name|NULL
argument_list|,
name|i16a
argument_list|)
expr_stmt|;
name|i16a
index|[
name|j
index|]
operator|=
name|PyInt_AsLong
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|y
argument_list|)
expr_stmt|;
block|}
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int16array
operator|=
name|i16a
expr_stmt|;
break|break;
case|case
name|PARAM_INT8ARRAY
case|:
name|check
argument_list|(
argument|!PySequence_Check(item)
argument_list|)
name|len
operator|=
name|PySequence_Length
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|i8a
operator|=
name|g_new
argument_list|(
name|gint8
argument_list|,
name|len
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|x
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
name|j
argument_list|)
expr_stmt|;
name|arraycheck
argument_list|(
operator|(
name|y
operator|=
name|PyNumber_Int
argument_list|(
name|x
argument_list|)
operator|)
operator|==
name|NULL
argument_list|,
name|i8a
argument_list|)
expr_stmt|;
name|i8a
index|[
name|j
index|]
operator|=
name|PyInt_AsLong
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|y
argument_list|)
expr_stmt|;
block|}
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_int8array
operator|=
name|i8a
expr_stmt|;
break|break;
case|case
name|PARAM_FLOATARRAY
case|:
name|check
argument_list|(
argument|!PySequence_Check(item)
argument_list|)
name|len
operator|=
name|PySequence_Length
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|fa
operator|=
name|g_new
argument_list|(
name|gdouble
argument_list|,
name|len
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|x
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
name|j
argument_list|)
expr_stmt|;
name|arraycheck
argument_list|(
operator|(
name|y
operator|=
name|PyNumber_Float
argument_list|(
name|x
argument_list|)
operator|)
operator|==
name|NULL
argument_list|,
name|fa
argument_list|)
expr_stmt|;
name|fa
index|[
name|j
index|]
operator|=
name|PyFloat_AsDouble
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|y
argument_list|)
expr_stmt|;
block|}
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_floatarray
operator|=
name|fa
expr_stmt|;
break|break;
case|case
name|PARAM_STRINGARRAY
case|:
name|check
argument_list|(
argument|!PySequence_Check(item)
argument_list|)
name|len
operator|=
name|PySequence_Length
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|sa
operator|=
name|g_new
argument_list|(
name|gchar
operator|*
argument_list|,
name|len
argument_list|)
expr_stmt|;
for|for
control|(
name|j
operator|=
literal|0
init|;
name|j
operator|<
name|len
condition|;
name|j
operator|++
control|)
block|{
name|x
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
name|j
argument_list|)
expr_stmt|;
name|arraycheck
argument_list|(
operator|(
name|y
operator|=
name|PyObject_Str
argument_list|(
name|x
argument_list|)
operator|)
operator|==
name|NULL
argument_list|,
name|sa
argument_list|)
expr_stmt|;
name|sa
index|[
name|j
index|]
operator|=
name|g_strdup
argument_list|(
name|PyString_AsString
argument_list|(
name|y
argument_list|)
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|y
argument_list|)
expr_stmt|;
block|}
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_stringarray
operator|=
name|sa
expr_stmt|;
break|break;
case|case
name|PARAM_COLOR
case|:
name|check
argument_list|(
argument|!PySequence_Check(item) || 		  PySequence_Length(item)<
literal|3
argument_list|)
name|r
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|check
argument_list|(
argument|!PyInt_Check(r) || !PyInt_Check(g) || 		  !PyInt_Check(b)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_color
operator|.
name|red
operator|=
name|PyInt_AsLong
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_color
operator|.
name|green
operator|=
name|PyInt_AsLong
argument_list|(
name|g
argument_list|)
expr_stmt|;
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_color
operator|.
name|blue
operator|=
name|PyInt_AsLong
argument_list|(
name|b
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_REGION
case|:
name|check
argument_list|(
argument|!PySequence_Check(item) || 		  PySequence_Length(item)<
literal|4
argument_list|)
name|x
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|y
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|w
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|h
operator|=
name|PySequence_GetItem
argument_list|(
name|item
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|check
argument_list|(
argument|!PyInt_Check(x) || !PyInt_Check(y) || 		  !PyInt_Check(w) || !PyInt_Check(h)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_region
operator|.
name|x
operator|=
name|PyInt_AsLong
argument_list|(
name|x
argument_list|)
expr_stmt|;
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_region
operator|.
name|y
operator|=
name|PyInt_AsLong
argument_list|(
name|y
argument_list|)
expr_stmt|;
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_region
operator|.
name|width
operator|=
name|PyInt_AsLong
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_region
operator|.
name|height
operator|=
name|PyInt_AsLong
argument_list|(
name|h
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_DISPLAY
case|:
name|check
argument_list|(
argument|!disp_check(item)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_display
operator|=
operator|(
operator|(
name|dispobject
operator|*
operator|)
name|item
operator|)
operator|->
name|ID
expr_stmt|;
break|break;
case|case
name|PARAM_IMAGE
case|:
if|if
condition|(
name|item
operator|==
name|Py_None
condition|)
block|{
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_image
operator|=
operator|-
literal|1
expr_stmt|;
break|break;
block|}
name|check
argument_list|(
argument|!img_check(item)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_image
operator|=
operator|(
operator|(
name|imgobject
operator|*
operator|)
name|item
operator|)
operator|->
name|ID
expr_stmt|;
break|break;
case|case
name|PARAM_LAYER
case|:
if|if
condition|(
name|item
operator|==
name|Py_None
condition|)
block|{
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_layer
operator|=
operator|-
literal|1
expr_stmt|;
break|break;
block|}
name|check
argument_list|(
argument|!lay_check(item)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_layer
operator|=
operator|(
operator|(
name|layobject
operator|*
operator|)
name|item
operator|)
operator|->
name|ID
expr_stmt|;
break|break;
case|case
name|PARAM_CHANNEL
case|:
if|if
condition|(
name|item
operator|==
name|Py_None
condition|)
block|{
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_channel
operator|=
operator|-
literal|1
expr_stmt|;
break|break;
block|}
name|check
argument_list|(
argument|!chn_check(item)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_channel
operator|=
operator|(
operator|(
name|chnobject
operator|*
operator|)
name|item
operator|)
operator|->
name|ID
expr_stmt|;
break|break;
case|case
name|PARAM_DRAWABLE
case|:
if|if
condition|(
name|item
operator|==
name|Py_None
condition|)
block|{
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_channel
operator|=
operator|-
literal|1
expr_stmt|;
break|break;
block|}
name|check
argument_list|(
argument|!drw_check(item)&& !lay_check(item)&& !chn_check(item)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_channel
operator|=
operator|(
operator|(
name|drwobject
operator|*
operator|)
name|item
operator|)
operator|->
name|ID
expr_stmt|;
break|break;
case|case
name|PARAM_SELECTION
case|:
name|check
argument_list|(
argument|!lay_check(item)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_selection
operator|=
operator|(
operator|(
name|layobject
operator|*
operator|)
name|item
operator|)
operator|->
name|ID
expr_stmt|;
break|break;
case|case
name|PARAM_BOUNDARY
case|:
name|check
argument_list|(
argument|!PyInt_Check(item)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_boundary
operator|=
name|PyInt_AsLong
argument_list|(
name|item
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_PATH
case|:
name|check
argument_list|(
argument|!PyInt_Check(item)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_path
operator|=
name|PyInt_AsLong
argument_list|(
name|item
argument_list|)
expr_stmt|;
break|break;
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
case|case
name|PARAM_PARASITE
case|:
comment|/* can't do anything, since size of Parasite is not known */
break|break;
endif|#
directive|endif
case|case
name|PARAM_STATUS
case|:
name|check
argument_list|(
argument|!PyInt_Check(item)
argument_list|)
name|ret
index|[
name|i
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|PyInt_AsLong
argument_list|(
name|item
argument_list|)
expr_stmt|;
break|break;
case|case
name|PARAM_END
case|:
break|break;
block|}
undef|#
directive|undef
name|check
undef|#
directive|undef
name|arraycheck
name|ret
index|[
name|i
index|]
operator|.
name|type
operator|=
name|ptype
index|[
name|i
operator|-
literal|1
index|]
operator|.
name|type
expr_stmt|;
block|}
name|Py_DECREF
argument_list|(
name|tuple
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_comment
comment|/* generic number conversions.  Most gimp objects contain an ID field  * at the start.  This code fragment adds conversion of that ID to  * an integer, hex, oct or float  */
end_comment

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gobj_int (self)
name|gobj_int
parameter_list|(
name|self
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
comment|/* or layobject, drwobject, chnobject ... */
block|{
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|self
operator|->
name|ID
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gobj_long (self)
name|gobj_long
parameter_list|(
name|self
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
block|{
return|return
name|PyLong_FromLong
argument_list|(
operator|(
name|long
operator|)
name|self
operator|->
name|ID
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gobj_float (self)
name|gobj_float
parameter_list|(
name|self
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
block|{
return|return
name|PyFloat_FromDouble
argument_list|(
operator|(
name|double
operator|)
name|self
operator|->
name|ID
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gobj_oct (self)
name|gobj_oct
parameter_list|(
name|self
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
block|{
name|char
name|buf
index|[
literal|20
index|]
decl_stmt|;
if|if
condition|(
name|self
operator|->
name|ID
operator|==
literal|0
condition|)
name|strcpy
argument_list|(
name|buf
argument_list|,
literal|"0"
argument_list|)
expr_stmt|;
else|else
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"0%lo"
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|PyString_FromString
argument_list|(
name|buf
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gobj_hex (self)
name|gobj_hex
parameter_list|(
name|self
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
block|{
name|char
name|buf
index|[
literal|20
index|]
decl_stmt|;
name|sprintf
argument_list|(
name|buf
argument_list|,
literal|"0x%lx"
argument_list|,
operator|(
name|unsigned
name|long
operator|)
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|PyString_FromString
argument_list|(
name|buf
argument_list|)
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gobj_as_number
specifier|static
name|PyNumberMethods
name|gobj_as_number
init|=
block|{
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_add*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_subtract*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_multiply*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_divide*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_remainder*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_divmod*/
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/*nb_power*/
operator|(
name|unaryfunc
operator|)
literal|0
block|,
comment|/*nb_negative*/
operator|(
name|unaryfunc
operator|)
literal|0
block|,
comment|/*nb_positive*/
operator|(
name|unaryfunc
operator|)
literal|0
block|,
comment|/*nb_absolute*/
operator|(
name|inquiry
operator|)
literal|0
block|,
comment|/*nb_nonzero*/
operator|(
name|unaryfunc
operator|)
literal|0
block|,
comment|/*nb_invert*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_lshift*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_rshift*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_and*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_xor*/
operator|(
name|binaryfunc
operator|)
literal|0
block|,
comment|/*nb_or*/
literal|0
block|,
comment|/*nb_coerce*/
operator|(
name|unaryfunc
operator|)
name|gobj_int
block|,
comment|/*nb_int*/
operator|(
name|unaryfunc
operator|)
name|gobj_long
block|,
comment|/*nb_long*/
operator|(
name|unaryfunc
operator|)
name|gobj_float
block|,
comment|/*nb_float*/
operator|(
name|unaryfunc
operator|)
name|gobj_oct
block|,
comment|/*nb_oct*/
operator|(
name|unaryfunc
operator|)
name|gobj_hex
block|,
comment|/*nb_hex*/
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------------------------------------------------------------- */
end_comment

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pdb_query (self,args)
name|pdb_query
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|pdbobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|n
init|=
literal|".*"
decl_stmt|,
modifier|*
name|b
init|=
literal|".*"
decl_stmt|,
modifier|*
name|h
init|=
literal|".*"
decl_stmt|,
modifier|*
name|a
init|=
literal|".*"
decl_stmt|,
modifier|*
name|c
init|=
literal|".*"
decl_stmt|,
modifier|*
name|d
init|=
literal|".*"
decl_stmt|,
modifier|*
name|t
init|=
literal|".*"
decl_stmt|;
name|int
name|num
decl_stmt|,
name|i
decl_stmt|;
name|char
modifier|*
modifier|*
name|names
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"|zzzzzzz:pdb.query"
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|b
argument_list|,
operator|&
name|h
argument_list|,
operator|&
name|a
argument_list|,
operator|&
name|c
argument_list|,
operator|&
name|d
argument_list|,
operator|&
name|t
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_query_database
argument_list|(
name|n
argument_list|,
name|b
argument_list|,
name|h
argument_list|,
name|a
argument_list|,
name|c
argument_list|,
name|d
argument_list|,
name|t
argument_list|,
operator|&
name|num
argument_list|,
operator|&
name|names
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|PyString_FromString
argument_list|(
name|names
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|names
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|pdb_methods
specifier|static
name|struct
name|PyMethodDef
name|pdb_methods
index|[]
init|=
block|{
block|{
literal|"query"
block|,
operator|(
name|PyCFunction
operator|)
name|pdb_query
block|,
name|METH_VARARGS
block|}
block|,
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------- */
end_comment

begin_function
specifier|static
name|pdbobject
modifier|*
DECL|function|newpdbobject ()
name|newpdbobject
parameter_list|()
block|{
name|pdbobject
modifier|*
name|self
decl_stmt|;
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|pdbobject
argument_list|,
operator|&
name|Pdbtype
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
comment|/* XXXX Add your own initializers here */
return|return
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pdb_dealloc (self)
name|pdb_dealloc
parameter_list|(
name|self
parameter_list|)
name|pdbobject
modifier|*
name|self
decl_stmt|;
block|{
comment|/* XXXX Add your own cleanup code here */
name|PyMem_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pdb_repr (self)
name|pdb_repr
parameter_list|(
name|self
parameter_list|)
name|pdbobject
modifier|*
name|self
decl_stmt|;
block|{
return|return
name|PyString_FromString
argument_list|(
literal|"<Procedural-Database>"
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/* Code to access pdb objects as mappings */
end_comment

begin_function
specifier|static
name|int
DECL|function|pdb_length (self)
name|pdb_length
parameter_list|(
name|self
parameter_list|)
name|pdbobject
modifier|*
name|self
decl_stmt|;
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"Can not size the procedural database."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pdb_subscript (self,key)
name|pdb_subscript
parameter_list|(
name|self
parameter_list|,
name|key
parameter_list|)
name|pdbobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|key
decl_stmt|;
block|{
name|PyObject
modifier|*
name|r
decl_stmt|;
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|key
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"Subscript must be a string."
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|r
operator|=
operator|(
name|PyObject
operator|*
operator|)
name|newpfobject
argument_list|(
name|PyString_AsString
argument_list|(
name|key
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|r
operator|==
name|NULL
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
name|PyErr_SetObject
argument_list|(
name|PyExc_KeyError
argument_list|,
name|key
argument_list|)
expr_stmt|;
block|}
return|return
name|r
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|pdb_ass_sub (self,v,w)
name|pdb_ass_sub
parameter_list|(
name|self
parameter_list|,
name|v
parameter_list|,
name|w
parameter_list|)
name|pdbobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|v
decl_stmt|,
decl|*
name|w
decl_stmt|;
end_function

begin_block
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"Use install_procedure to add to the PDB."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
end_block

begin_decl_stmt
DECL|variable|pdb_as_mapping
specifier|static
name|PyMappingMethods
name|pdb_as_mapping
init|=
block|{
operator|(
name|inquiry
operator|)
name|pdb_length
block|,
comment|/*mp_length*/
operator|(
name|binaryfunc
operator|)
name|pdb_subscript
block|,
comment|/*mp_subscript*/
operator|(
name|objobjargproc
operator|)
name|pdb_ass_sub
block|,
comment|/*mp_ass_subscript*/
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pdb_getattr (self,name)
name|pdb_getattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|)
name|pdbobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|PyObject
modifier|*
name|r
decl_stmt|;
name|r
operator|=
name|Py_FindMethod
argument_list|(
name|pdb_methods
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|self
argument_list|,
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|r
operator|==
name|NULL
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newpfobject
argument_list|(
name|name
argument_list|)
return|;
block|}
return|return
name|r
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|Pdbtype
specifier|static
name|PyTypeObject
name|Pdbtype
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
operator|&
name|PyType_Type
argument_list|)
literal|0
block|,
comment|/*ob_size*/
literal|"pdb"
block|,
comment|/*tp_name*/
sizeof|sizeof
argument_list|(
name|pdbobject
argument_list|)
block|,
comment|/*tp_basicsize*/
literal|0
block|,
comment|/*tp_itemsize*/
comment|/* methods */
operator|(
name|destructor
operator|)
name|pdb_dealloc
block|,
comment|/*tp_dealloc*/
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/*tp_print*/
operator|(
name|getattrfunc
operator|)
name|pdb_getattr
block|,
comment|/*tp_getattr*/
operator|(
name|setattrfunc
operator|)
literal|0
block|,
comment|/*tp_setattr*/
operator|(
name|cmpfunc
operator|)
literal|0
block|,
comment|/*tp_compare*/
operator|(
name|reprfunc
operator|)
name|pdb_repr
block|,
comment|/*tp_repr*/
literal|0
block|,
comment|/*tp_as_number*/
literal|0
block|,
comment|/*tp_as_sequence*/
operator|&
name|pdb_as_mapping
block|,
comment|/*tp_as_mapping*/
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/*tp_hash*/
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/*tp_call*/
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/*tp_str*/
comment|/* Space for future expansion */
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
name|NULL
comment|/* Documentation string */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* End of code for pdb objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_function
specifier|static
name|pfobject
modifier|*
DECL|function|newpfobject (name)
name|newpfobject
parameter_list|(
name|name
parameter_list|)
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|pfobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|b
decl_stmt|,
modifier|*
name|h
decl_stmt|,
modifier|*
name|a
decl_stmt|,
modifier|*
name|c
decl_stmt|,
modifier|*
name|d
decl_stmt|;
name|int
name|pt
decl_stmt|,
name|np
decl_stmt|,
name|nr
decl_stmt|,
name|i
decl_stmt|;
name|GParamDef
modifier|*
name|p
decl_stmt|,
modifier|*
name|r
decl_stmt|;
if|if
condition|(
operator|!
name|gimp_query_procedure
argument_list|(
name|name
argument_list|,
operator|&
name|b
argument_list|,
operator|&
name|h
argument_list|,
operator|&
name|a
argument_list|,
operator|&
name|c
argument_list|,
operator|&
name|d
argument_list|,
operator|&
name|pt
argument_list|,
operator|&
name|np
argument_list|,
operator|&
name|nr
argument_list|,
operator|&
name|p
argument_list|,
operator|&
name|r
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"procedure not found."
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|pfobject
argument_list|,
operator|&
name|Pftype
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|self
operator|->
name|name
operator|=
name|g_strdup
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|self
operator|->
name|proc_name
operator|=
name|PyString_FromString
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|self
operator|->
name|proc_blurb
operator|=
name|PyString_FromString
argument_list|(
name|b
argument_list|)
expr_stmt|;
name|self
operator|->
name|proc_help
operator|=
name|PyString_FromString
argument_list|(
name|h
argument_list|)
expr_stmt|;
name|self
operator|->
name|proc_author
operator|=
name|PyString_FromString
argument_list|(
name|a
argument_list|)
expr_stmt|;
name|self
operator|->
name|proc_copyright
operator|=
name|PyString_FromString
argument_list|(
name|c
argument_list|)
expr_stmt|;
name|self
operator|->
name|proc_date
operator|=
name|PyString_FromString
argument_list|(
name|d
argument_list|)
expr_stmt|;
name|self
operator|->
name|proc_type
operator|=
name|PyInt_FromLong
argument_list|(
name|pt
argument_list|)
expr_stmt|;
name|self
operator|->
name|nparams
operator|=
name|np
expr_stmt|;
name|self
operator|->
name|nreturn_vals
operator|=
name|nr
expr_stmt|;
name|self
operator|->
name|params
operator|=
name|p
expr_stmt|;
name|self
operator|->
name|return_vals
operator|=
name|r
expr_stmt|;
name|self
operator|->
name|py_params
operator|=
name|PyTuple_New
argument_list|(
name|np
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|np
condition|;
name|i
operator|++
control|)
name|PyTuple_SetItem
argument_list|(
name|self
operator|->
name|py_params
argument_list|,
name|i
argument_list|,
name|Py_BuildValue
argument_list|(
literal|"(iss)"
argument_list|,
name|p
index|[
name|i
index|]
operator|.
name|type
argument_list|,
name|p
index|[
name|i
index|]
operator|.
name|name
argument_list|,
name|p
index|[
name|i
index|]
operator|.
name|description
argument_list|)
argument_list|)
expr_stmt|;
name|self
operator|->
name|py_return_vals
operator|=
name|PyTuple_New
argument_list|(
name|nr
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nr
condition|;
name|i
operator|++
control|)
name|PyTuple_SetItem
argument_list|(
name|self
operator|->
name|py_return_vals
argument_list|,
name|i
argument_list|,
name|Py_BuildValue
argument_list|(
literal|"(iss)"
argument_list|,
name|r
index|[
name|i
index|]
operator|.
name|type
argument_list|,
name|r
index|[
name|i
index|]
operator|.
name|name
argument_list|,
name|r
index|[
name|i
index|]
operator|.
name|description
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|b
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|h
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|a
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|c
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|d
argument_list|)
expr_stmt|;
return|return
name|self
return|;
block|}
end_function

begin_ifndef
ifndef|#
directive|ifndef
name|GIMP_HAVE_DESTROY_PARAMDEFS
end_ifndef

begin_function
specifier|static
name|void
DECL|function|gimp_destroy_paramdefs (GParamDef * paramdefs,int nparams)
name|gimp_destroy_paramdefs
parameter_list|(
name|GParamDef
modifier|*
name|paramdefs
parameter_list|,
name|int
name|nparams
parameter_list|)
block|{
while|while
condition|(
name|nparams
operator|--
condition|)
block|{
name|g_free
argument_list|(
name|paramdefs
index|[
name|nparams
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|paramdefs
index|[
name|nparams
index|]
operator|.
name|description
argument_list|)
expr_stmt|;
block|}
name|g_free
argument_list|(
name|paramdefs
argument_list|)
expr_stmt|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_function
specifier|static
name|void
DECL|function|pf_dealloc (self)
name|pf_dealloc
parameter_list|(
name|self
parameter_list|)
name|pfobject
modifier|*
name|self
decl_stmt|;
block|{
name|g_free
argument_list|(
name|self
operator|->
name|name
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|proc_name
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|proc_blurb
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|proc_help
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|proc_author
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|proc_copyright
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|proc_date
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|proc_type
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|py_params
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|py_return_vals
argument_list|)
expr_stmt|;
name|gimp_destroy_paramdefs
argument_list|(
name|self
operator|->
name|params
argument_list|,
name|self
operator|->
name|nparams
argument_list|)
expr_stmt|;
name|gimp_destroy_paramdefs
argument_list|(
name|self
operator|->
name|return_vals
argument_list|,
name|self
operator|->
name|nreturn_vals
argument_list|)
expr_stmt|;
name|PyMem_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_define
DECL|macro|OFF (x)
define|#
directive|define
name|OFF
parameter_list|(
name|x
parameter_list|)
value|offsetof(pfobject, x)
end_define

begin_decl_stmt
DECL|variable|pf_memberlist
specifier|static
name|struct
name|memberlist
name|pf_memberlist
index|[]
init|=
block|{
block|{
literal|"proc_name"
block|,
name|T_OBJECT
block|,
name|OFF
argument_list|(
name|proc_name
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"proc_blurb"
block|,
name|T_OBJECT
block|,
name|OFF
argument_list|(
name|proc_blurb
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"proc_help"
block|,
name|T_OBJECT
block|,
name|OFF
argument_list|(
name|proc_help
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"proc_author"
block|,
name|T_OBJECT
block|,
name|OFF
argument_list|(
name|proc_author
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"proc_copyright"
block|,
name|T_OBJECT
block|,
name|OFF
argument_list|(
name|proc_copyright
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"proc_date"
block|,
name|T_OBJECT
block|,
name|OFF
argument_list|(
name|proc_date
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"proc_type"
block|,
name|T_OBJECT
block|,
name|OFF
argument_list|(
name|proc_type
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"nparams"
block|,
name|T_INT
block|,
name|OFF
argument_list|(
name|nparams
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"nreturn_vals"
block|,
name|T_INT
block|,
name|OFF
argument_list|(
name|nreturn_vals
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"params"
block|,
name|T_OBJECT
block|,
name|OFF
argument_list|(
name|py_params
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"return_vals"
block|,
name|T_OBJECT
block|,
name|OFF
argument_list|(
name|py_return_vals
argument_list|)
block|,
name|RO
block|}
block|,
block|{
name|NULL
block|}
comment|/* Sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_undef
undef|#
directive|undef
name|OFF
end_undef

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pf_getattr (self,name)
name|pf_getattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|)
name|pfobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
block|{
return|return
name|PyMember_Get
argument_list|(
operator|(
name|char
operator|*
operator|)
name|self
argument_list|,
name|pf_memberlist
argument_list|,
name|name
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pf_repr (self)
name|pf_repr
parameter_list|(
name|self
parameter_list|)
name|pfobject
modifier|*
name|self
decl_stmt|;
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|PyString_FromString
argument_list|(
literal|"<pdb function "
argument_list|)
expr_stmt|;
name|PyString_Concat
argument_list|(
operator|&
name|s
argument_list|,
name|self
operator|->
name|proc_name
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
literal|">"
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pf_call (self,args,kwargs)
name|pf_call
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|,
name|kwargs
parameter_list|)
name|pfobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
name|PyObject
modifier|*
name|kwargs
decl_stmt|;
block|{
name|GParam
modifier|*
name|params
decl_stmt|,
modifier|*
name|ret
decl_stmt|;
name|int
name|nret
decl_stmt|;
name|PyObject
modifier|*
name|t
init|=
name|NULL
decl_stmt|,
modifier|*
name|r
decl_stmt|;
if|#
directive|if
name|PG_DEBUG
operator|>
literal|0
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"--- %s --- "
argument_list|,
name|PyString_AsString
argument_list|(
name|self
operator|->
name|proc_name
argument_list|)
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|self
operator|->
name|nparams
operator|>
literal|0
operator|&&
operator|!
name|strcmp
argument_list|(
name|self
operator|->
name|params
index|[
literal|0
index|]
operator|.
name|name
argument_list|,
literal|"run_mode"
argument_list|)
condition|)
block|{
name|params
operator|=
name|tuple_to_GParam
argument_list|(
name|args
argument_list|,
name|self
operator|->
name|params
operator|+
literal|1
argument_list|,
name|self
operator|->
name|nparams
operator|-
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|params
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|params
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|self
operator|->
name|params
index|[
literal|0
index|]
operator|.
name|type
expr_stmt|;
name|params
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_int32
operator|=
name|RUN_NONINTERACTIVE
expr_stmt|;
if|#
directive|if
name|PG_DEBUG
operator|>
literal|1
name|print_GParam
argument_list|(
name|self
operator|->
name|nparams
argument_list|,
name|params
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|ret
operator|=
name|gimp_run_procedure2
argument_list|(
name|self
operator|->
name|name
argument_list|,
operator|&
name|nret
argument_list|,
name|self
operator|->
name|nparams
argument_list|,
name|params
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|params
operator|=
name|tuple_to_GParam
argument_list|(
name|args
argument_list|,
name|self
operator|->
name|params
argument_list|,
name|self
operator|->
name|nparams
argument_list|)
expr_stmt|;
if|if
condition|(
name|params
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
if|#
directive|if
name|PG_DEBUG
operator|>
literal|1
name|print_GParam
argument_list|(
name|self
operator|->
name|nparams
argument_list|,
name|params
operator|+
literal|1
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|ret
operator|=
name|gimp_run_procedure2
argument_list|(
name|self
operator|->
name|name
argument_list|,
operator|&
name|nret
argument_list|,
name|self
operator|->
name|nparams
argument_list|,
name|params
operator|+
literal|1
argument_list|)
expr_stmt|;
block|}
name|gimp_destroy_params
argument_list|(
name|params
argument_list|,
name|self
operator|->
name|nparams
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|ret
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"no status returned"
argument_list|)
expr_stmt|;
if|#
directive|if
name|PG_DEBUG
operator|>=
literal|1
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"ret == NULL\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
return|return
name|NULL
return|;
block|}
switch|switch
condition|(
name|ret
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
condition|)
block|{
case|case
name|STATUS_EXECUTION_ERROR
case|:
if|#
directive|if
name|PG_DEBUG
operator|>
literal|0
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"execution error\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|gimp_destroy_params
argument_list|(
name|ret
argument_list|,
name|nret
argument_list|)
expr_stmt|;
name|PyErr_SetString
argument_list|(
name|PyExc_RuntimeError
argument_list|,
literal|"execution error"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
break|break;
case|case
name|STATUS_CALLING_ERROR
case|:
if|#
directive|if
name|PG_DEBUG
operator|>
literal|0
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"calling error\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|gimp_destroy_params
argument_list|(
name|ret
argument_list|,
name|nret
argument_list|)
expr_stmt|;
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"invalid arguments"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
break|break;
case|case
name|STATUS_SUCCESS
case|:
if|#
directive|if
name|PG_DEBUG
operator|>
literal|0
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"success\n"
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|t
operator|=
name|GParam_to_tuple
argument_list|(
name|nret
operator|-
literal|1
argument_list|,
name|ret
operator|+
literal|1
argument_list|)
expr_stmt|;
name|gimp_destroy_params
argument_list|(
name|ret
argument_list|,
name|nret
argument_list|)
expr_stmt|;
if|if
condition|(
name|t
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"couldn't make return value"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
break|break;
default|default:
if|#
directive|if
name|PG_DEBUG
operator|>
literal|0
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"unknown - %i (type %i)\n"
argument_list|,
name|ret
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
argument_list|,
name|ret
index|[
literal|0
index|]
operator|.
name|type
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"unknown return code."
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
break|break;
block|}
if|if
condition|(
name|PyTuple_Size
argument_list|(
name|t
argument_list|)
operator|==
literal|1
condition|)
block|{
name|r
operator|=
name|PyTuple_GetItem
argument_list|(
name|t
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|t
argument_list|)
expr_stmt|;
return|return
name|r
return|;
block|}
if|if
condition|(
name|PyTuple_Size
argument_list|(
name|t
argument_list|)
operator|==
literal|0
condition|)
block|{
name|r
operator|=
name|Py_None
expr_stmt|;
name|Py_INCREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|t
argument_list|)
expr_stmt|;
return|return
name|r
return|;
block|}
return|return
name|t
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|Pftype
specifier|static
name|PyTypeObject
name|Pftype
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
operator|&
name|PyType_Type
argument_list|)
literal|0
block|,
comment|/*ob_size*/
literal|"pdbFunc"
block|,
comment|/*tp_name*/
sizeof|sizeof
argument_list|(
name|pfobject
argument_list|)
block|,
comment|/*tp_basicsize*/
literal|0
block|,
comment|/*tp_itemsize*/
comment|/* methods */
operator|(
name|destructor
operator|)
name|pf_dealloc
block|,
comment|/*tp_dealloc*/
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/*tp_print*/
operator|(
name|getattrfunc
operator|)
name|pf_getattr
block|,
comment|/*tp_getattr*/
operator|(
name|setattrfunc
operator|)
literal|0
block|,
comment|/*tp_setattr*/
operator|(
name|cmpfunc
operator|)
literal|0
block|,
comment|/*tp_compare*/
operator|(
name|reprfunc
operator|)
name|pf_repr
block|,
comment|/*tp_repr*/
literal|0
block|,
comment|/*tp_as_number*/
literal|0
block|,
comment|/*tp_as_sequence*/
literal|0
block|,
comment|/*tp_as_mapping*/
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/*tp_hash*/
operator|(
name|ternaryfunc
operator|)
name|pf_call
block|,
comment|/*tp_call*/
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/*tp_str*/
comment|/* Space for future expansion */
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
name|NULL
comment|/* Documentation string */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* End of code for pdbFunc objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_channel (self,args)
name|img_add_channel
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|chnobject
modifier|*
name|chn
decl_stmt|;
name|int
name|pos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!i:add_channel"
argument_list|,
operator|&
name|Chntype
argument_list|,
operator|&
name|chn
argument_list|,
operator|&
name|pos
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|,
name|pos
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_layer (self,args)
name|img_add_layer
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|layobject
modifier|*
name|lay
decl_stmt|;
name|int
name|pos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!i:add_layer"
argument_list|,
operator|&
name|Laytype
argument_list|,
operator|&
name|lay
argument_list|,
operator|&
name|pos
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|pos
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_layer_mask (self,args)
name|img_add_layer_mask
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|layobject
modifier|*
name|lay
decl_stmt|;
name|chnobject
modifier|*
name|mask
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!O!:add_layer_mask"
argument_list|,
operator|&
name|Laytype
argument_list|,
operator|&
name|lay
argument_list|,
operator|&
name|Chntype
argument_list|,
operator|&
name|mask
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_layer_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|mask
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_clean_all (self,args)
name|img_clean_all
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":clean_all"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_clean_all
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_disable_undo (self,args)
name|img_disable_undo
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
comment|/*GParam *return_vals;     int nreturn_vals;*/
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":disable_undo"
argument_list|)
condition|)
return|return
name|NULL
return|;
comment|/*return_vals = gimp_run_procedure("gimp_undo_push_group_start",&nreturn_vals, PARAM_IMAGE, self->ID, 				     PARAM_END);     gimp_destroy_params(return_vals, nreturn_vals);*/
name|gimp_image_undo_disable
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_enable_undo (self,args)
name|img_enable_undo
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
comment|/*GParam *return_vals;     int nreturn_vals;*/
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":enable_undo"
argument_list|)
condition|)
return|return
name|NULL
return|;
comment|/*return_vals = gimp_run_procedure("gimp_undo_push_group_start",&nreturn_vals, PARAM_IMAGE, self->ID, 				     PARAM_END);     gimp_destroy_params(return_vals, nreturn_vals);*/
name|gimp_image_undo_enable
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_flatten (self,args)
name|img_flatten
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":flatten"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_flatten
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_lower_channel (self,args)
name|img_lower_channel
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|chnobject
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:lower_channel"
argument_list|,
operator|&
name|Chntype
argument_list|,
operator|&
name|chn
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_lower_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_lower_layer (self,args)
name|img_lower_layer
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|layobject
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:lower_layer"
argument_list|,
operator|&
name|Laytype
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_lower_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_merge_visible_layers (self,args)
name|img_merge_visible_layers
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|gint32
name|id
decl_stmt|;
name|int
name|merge
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:merge_visible_layers"
argument_list|,
operator|&
name|merge
argument_list|)
condition|)
return|return
name|NULL
return|;
name|id
operator|=
name|gimp_image_merge_visible_layers
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|merge
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"Can't merge layers."
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_pick_correlate_layer (self,args)
name|img_pick_correlate_layer
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|x
decl_stmt|,
name|y
decl_stmt|;
name|gint32
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:pick_correlate_layer"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
condition|)
return|return
name|NULL
return|;
name|id
operator|=
name|gimp_image_pick_correlate_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_raise_channel (self,args)
name|img_raise_channel
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|chnobject
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:raise_channel"
argument_list|,
operator|&
name|Chntype
argument_list|,
operator|&
name|chn
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_raise_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_raise_layer (self,args)
name|img_raise_layer
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|layobject
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:raise_layer"
argument_list|,
operator|&
name|Laytype
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_raise_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_remove_channel (self,args)
name|img_remove_channel
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|chnobject
modifier|*
name|chn
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:remove_channel"
argument_list|,
operator|&
name|Chntype
argument_list|,
operator|&
name|chn
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_remove_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|chn
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_remove_layer (self,args)
name|img_remove_layer
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|layobject
modifier|*
name|lay
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:remove_layer"
argument_list|,
operator|&
name|Laytype
argument_list|,
operator|&
name|lay
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_remove_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_remove_layer_mask (self,args)
name|img_remove_layer_mask
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|layobject
modifier|*
name|lay
decl_stmt|;
name|int
name|mode
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!i:remove_layer_mask"
argument_list|,
operator|&
name|Laytype
argument_list|,
operator|&
name|lay
argument_list|,
operator|&
name|mode
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_remove_layer_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|lay
operator|->
name|ID
argument_list|,
name|mode
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_resize (self,args)
name|img_resize
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|unsigned
name|int
name|new_w
decl_stmt|,
name|new_h
decl_stmt|;
name|int
name|offs_x
decl_stmt|,
name|offs_y
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iiii:resize"
argument_list|,
operator|&
name|new_w
argument_list|,
operator|&
name|new_h
argument_list|,
operator|&
name|offs_x
argument_list|,
operator|&
name|offs_y
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_resize
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|new_w
argument_list|,
name|new_h
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_component_active (self,args)
name|img_get_component_active
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|comp
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_component_active"
argument_list|,
operator|&
name|comp
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_image_get_component_active
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_component_visible (self,args)
name|img_get_component_visible
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|comp
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_component_visible"
argument_list|,
operator|&
name|comp
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_image_get_component_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_set_component_active (self,args)
name|img_set_component_active
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|comp
decl_stmt|,
name|a
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:set_component_active"
argument_list|,
operator|&
name|comp
argument_list|,
operator|&
name|a
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_set_component_active
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|,
name|a
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_set_component_visible (self,args)
name|img_set_component_visible
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|comp
decl_stmt|,
name|v
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:set_component_visible"
argument_list|,
operator|&
name|comp
argument_list|,
operator|&
name|v
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_set_component_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|comp
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
end_ifdef

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_find_parasite (self,args)
name|img_find_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:find_parasite"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newparaobject
argument_list|(
name|gimp_image_parasite_find
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_attach_parasite (self,args)
name|img_attach_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|paraobject
modifier|*
name|parasite
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:attach_parasite"
argument_list|,
operator|&
name|Paratype
argument_list|,
operator|&
name|parasite
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_parasite_attach
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|parasite
operator|->
name|para
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_attach_new_parasite (self,args)
name|img_attach_new_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|data
decl_stmt|;
name|int
name|flags
decl_stmt|,
name|size
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sis#:attach_new_parasite"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|flags
argument_list|,
operator|&
name|data
argument_list|,
operator|&
name|size
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_attach_new_parasite
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|,
name|flags
argument_list|,
name|size
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_detach_parasite (self,args)
name|img_detach_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:detach_parasite"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_parasite_detach
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|GIMP_HAVE_RESOLUTION_INFO
end_ifdef

begin_comment
comment|/* gimp_image_set_resolution  * gimp_image_get_resolution  * gimp_set_unit  * gimp_get_unit  */
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_if
if|#
directive|if
name|GIMP_CHECK_VERSION
argument_list|(
literal|1
operator|,
literal|1
operator|,
literal|0
argument_list|)
end_if

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_layer_by_tattoo (self,args)
name|img_get_layer_by_tattoo
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|tattoo
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_layer_by_tattoo"
argument_list|,
operator|&
name|tattoo
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|gimp_image_get_layer_by_tattoo
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|tattoo
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_channel_by_tattoo (self,args)
name|img_get_channel_by_tattoo
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|tattoo
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_channel_by_tattoo"
argument_list|,
operator|&
name|tattoo
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newchnobject
argument_list|(
name|gimp_image_get_channel_by_tattoo
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|tattoo
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_hguide (self,args)
name|img_add_hguide
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|ypos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:add_hguide"
argument_list|,
operator|&
name|ypos
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_hguide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|ypos
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_add_vguide (self,args)
name|img_add_vguide
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|xpos
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:add_vguide"
argument_list|,
operator|&
name|xpos
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_add_vguide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|xpos
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_delete_guide (self,args)
name|img_delete_guide
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:delete_guide"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_image_delete_guide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_find_next_guide (self,args)
name|img_find_next_guide
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:find_next_guide"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_find_next_guide
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_guide_orientation (self,args)
name|img_get_guide_orientation
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_guide_orientation"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_guide_orientation
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_get_guide_position (self,args)
name|img_get_guide_position
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|guide
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:get_guide_position"
argument_list|,
operator|&
name|guide
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_guide_position
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|guide
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
DECL|variable|img_methods
specifier|static
name|struct
name|PyMethodDef
name|img_methods
index|[]
init|=
block|{
block|{
literal|"add_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_layer_mask"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_layer_mask
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"clean_all"
block|,
operator|(
name|PyCFunction
operator|)
name|img_clean_all
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"disable_undo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_disable_undo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"enable_undo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_enable_undo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"flatten"
block|,
operator|(
name|PyCFunction
operator|)
name|img_flatten
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"lower_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_lower_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"lower_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_lower_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"merge_visible_layers"
block|,
operator|(
name|PyCFunction
operator|)
name|img_merge_visible_layers
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"pick_correlate_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_pick_correlate_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"raise_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_raise_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"raise_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_raise_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"remove_channel"
block|,
operator|(
name|PyCFunction
operator|)
name|img_remove_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"remove_layer"
block|,
operator|(
name|PyCFunction
operator|)
name|img_remove_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"remove_layer_mask"
block|,
operator|(
name|PyCFunction
operator|)
name|img_remove_layer_mask
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"resize"
block|,
operator|(
name|PyCFunction
operator|)
name|img_resize
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_component_active"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_component_active
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_component_visible"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_component_visible
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_component_active"
block|,
operator|(
name|PyCFunction
operator|)
name|img_set_component_active
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_component_visible"
block|,
operator|(
name|PyCFunction
operator|)
name|img_set_component_visible
block|,
name|METH_VARARGS
block|}
block|,
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
block|{
literal|"find_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|img_find_parasite
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"attach_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|img_attach_parasite
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"attach_new_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|img_attach_new_parasite
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"detach_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|img_detach_parasite
block|,
name|METH_VARARGS
block|}
block|,
endif|#
directive|endif
if|#
directive|if
name|GIMP_CHECK_VERSION
argument_list|(
literal|1
operator|,
literal|1
operator|,
literal|0
argument_list|)
block|{
literal|"get_layer_by_tattoo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_layer_by_tattoo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_channel_by_tattoo"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_channel_by_tattoo
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_hguide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_hguide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_vguide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_add_vguide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"delete_guide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_delete_guide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"find_next_guide"
block|,
operator|(
name|PyCFunction
operator|)
name|img_find_next_guide
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_guide_orientation"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_guide_orientation
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_guide_position"
block|,
operator|(
name|PyCFunction
operator|)
name|img_get_guide_position
block|,
name|METH_VARARGS
block|}
block|,
endif|#
directive|endif
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------- */
end_comment

begin_function
specifier|static
name|imgobject
modifier|*
DECL|function|newimgobject (gint32 ID)
name|newimgobject
parameter_list|(
name|gint32
name|ID
parameter_list|)
block|{
name|imgobject
modifier|*
name|self
decl_stmt|;
if|if
condition|(
name|ID
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
operator|(
name|imgobject
operator|*
operator|)
name|Py_None
return|;
block|}
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|imgobject
argument_list|,
operator|&
name|Imgtype
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|self
operator|->
name|ID
operator|=
name|ID
expr_stmt|;
return|return
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|img_dealloc (self)
name|img_dealloc
parameter_list|(
name|self
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
block|{
comment|/* XXXX Add your own cleanup code here */
name|PyMem_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_getattr (self,name)
name|img_getattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|gint32
modifier|*
name|a
decl_stmt|,
name|id
decl_stmt|;
name|guchar
modifier|*
name|c
decl_stmt|;
name|int
name|n
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"__members__"
argument_list|)
condition|)
return|return
name|Py_BuildValue
argument_list|(
ifdef|#
directive|ifdef
name|GIMP_HAVE_RESOLUTION_INFO
literal|"[ssssssssssss]"
argument_list|,
else|#
directive|else
literal|"[ssssssssss]"
argument_list|,
endif|#
directive|endif
literal|"ID"
argument_list|,
literal|"active_channel"
argument_list|,
literal|"active_layer"
argument_list|,
literal|"base_type"
argument_list|,
literal|"channels"
argument_list|,
literal|"cmap"
argument_list|,
literal|"filename"
argument_list|,
literal|"floating_selection"
argument_list|,
literal|"height"
argument_list|,
literal|"layers"
argument_list|,
ifdef|#
directive|ifdef
name|GIMP_HAVE_RESOLUTION_INFO
literal|"resolution"
argument_list|,
endif|#
directive|endif
literal|"selection"
argument_list|,
ifdef|#
directive|ifdef
name|GIMP_HAVE_RESOLUTION_INFO
literal|"unit"
argument_list|,
endif|#
directive|endif
literal|"width"
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"ID"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|self
operator|->
name|ID
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"active_channel"
argument_list|)
condition|)
block|{
name|id
operator|=
name|gimp_image_get_active_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newchnobject
argument_list|(
name|id
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"active_layer"
argument_list|)
condition|)
block|{
name|id
operator|=
name|gimp_image_get_active_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|id
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"base_type"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_base_type
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"channels"
argument_list|)
condition|)
block|{
name|a
operator|=
name|gimp_image_get_channels
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|n
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|n
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newchnobject
argument_list|(
name|a
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"cmap"
argument_list|)
condition|)
block|{
name|c
operator|=
name|gimp_image_get_cmap
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|n
argument_list|)
expr_stmt|;
return|return
name|PyString_FromStringAndSize
argument_list|(
name|c
argument_list|,
name|n
operator|*
literal|3
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"filename"
argument_list|)
condition|)
return|return
name|PyString_FromString
argument_list|(
name|gimp_image_get_filename
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"floating_selection"
argument_list|)
condition|)
block|{
name|id
operator|=
name|gimp_image_floating_selection
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|id
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"layers"
argument_list|)
condition|)
block|{
name|a
operator|=
name|gimp_image_get_layers
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|n
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|n
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|n
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|a
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"selection"
argument_list|)
condition|)
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newchnobject
argument_list|(
name|gimp_image_get_selection
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"height"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_height
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"width"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_width
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
ifdef|#
directive|ifdef
name|GIMP_HAVE_RESOLUTION_INFO
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"resolution"
argument_list|)
condition|)
block|{
name|double
name|xres
decl_stmt|,
name|yres
decl_stmt|;
name|gimp_image_get_resolution
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|xres
argument_list|,
operator|&
name|yres
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(dd)"
argument_list|,
name|xres
argument_list|,
name|yres
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"unit"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_image_get_unit
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
endif|#
directive|endif
return|return
name|Py_FindMethod
argument_list|(
name|img_methods
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|self
argument_list|,
name|name
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_setattr (self,name,v)
name|img_setattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|,
name|v
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
name|PyObject
modifier|*
name|v
decl_stmt|;
block|{
if|if
condition|(
name|v
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete attributes."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"active_channel"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|chn_check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_active_channel
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|(
operator|(
name|chnobject
operator|*
operator|)
name|v
operator|)
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"active_layer"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|lay_check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_active_layer
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|(
operator|(
name|layobject
operator|*
operator|)
name|v
operator|)
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"cmap"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_cmap
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyString_AsString
argument_list|(
name|v
argument_list|)
argument_list|,
name|PyString_Size
argument_list|(
name|v
argument_list|)
operator|/
literal|3
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"filename"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_filename
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyString_AsString
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
ifdef|#
directive|ifdef
name|GIMP_HAVE_RESOLUTION_INFO
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"resolution"
argument_list|)
condition|)
block|{
name|PyObject
modifier|*
name|xo
decl_stmt|,
modifier|*
name|yo
decl_stmt|;
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|v
argument_list|)
operator|||
operator|!
name|PyFloat_Check
argument_list|(
name|xo
operator|=
name|PySequence_GetItem
argument_list|(
name|v
argument_list|,
literal|0
argument_list|)
argument_list|)
operator|||
operator|!
name|PyFloat_Check
argument_list|(
name|yo
operator|=
name|PySequence_GetItem
argument_list|(
name|v
argument_list|,
literal|1
argument_list|)
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_resolution
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyFloat_AsDouble
argument_list|(
name|xo
argument_list|)
argument_list|,
name|PyFloat_AsDouble
argument_list|(
name|yo
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"unit"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_image_set_unit
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"channels"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"layers"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"selection"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"height"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"base_type"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"width"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"floating_selection"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"ID"
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"read-only attribute."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|img_repr (self)
name|img_repr
parameter_list|(
name|self
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|;
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|PyString_FromString
argument_list|(
literal|"<image "
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_image_get_filename
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
literal|">"
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|img_cmp (self,other)
name|img_cmp
parameter_list|(
name|self
parameter_list|,
name|other
parameter_list|)
name|imgobject
modifier|*
name|self
decl_stmt|,
decl|*
name|other
decl_stmt|;
end_function

begin_block
block|{
return|return
name|self
operator|->
name|ID
operator|-
name|other
operator|->
name|ID
return|;
block|}
end_block

begin_decl_stmt
DECL|variable|Imgtype
specifier|static
name|PyTypeObject
name|Imgtype
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
operator|&
name|PyType_Type
argument_list|)
literal|0
block|,
comment|/*ob_size*/
literal|"Image"
block|,
comment|/*tp_name*/
sizeof|sizeof
argument_list|(
name|imgobject
argument_list|)
block|,
comment|/*tp_basicsize*/
literal|0
block|,
comment|/*tp_itemsize*/
comment|/* methods */
operator|(
name|destructor
operator|)
name|img_dealloc
block|,
comment|/*tp_dealloc*/
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/*tp_print*/
operator|(
name|getattrfunc
operator|)
name|img_getattr
block|,
comment|/*tp_getattr*/
operator|(
name|setattrfunc
operator|)
name|img_setattr
block|,
comment|/*tp_setattr*/
operator|(
name|cmpfunc
operator|)
name|img_cmp
block|,
comment|/*tp_compare*/
operator|(
name|reprfunc
operator|)
name|img_repr
block|,
comment|/*tp_repr*/
operator|&
name|gobj_as_number
block|,
comment|/*tp_as_number*/
literal|0
block|,
comment|/*tp_as_sequence*/
literal|0
block|,
comment|/*tp_as_mapping*/
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/*tp_hash*/
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/*tp_call*/
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/*tp_str*/
comment|/* Space for future expansion */
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
name|NULL
comment|/* Documentation string */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* End of code for Image objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_decl_stmt
DECL|variable|disp_methods
specifier|static
name|struct
name|PyMethodDef
name|disp_methods
index|[]
init|=
block|{
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------- */
end_comment

begin_function
specifier|static
name|dispobject
modifier|*
DECL|function|newdispobject (gint32 ID)
name|newdispobject
parameter_list|(
name|gint32
name|ID
parameter_list|)
block|{
name|dispobject
modifier|*
name|self
decl_stmt|;
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|dispobject
argument_list|,
operator|&
name|Disptype
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|self
operator|->
name|ID
operator|=
name|ID
expr_stmt|;
return|return
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|disp_dealloc (self)
name|disp_dealloc
parameter_list|(
name|self
parameter_list|)
name|dispobject
modifier|*
name|self
decl_stmt|;
block|{
name|PyMem_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|disp_getattr (self,name)
name|disp_getattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|)
name|dispobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
block|{
return|return
name|Py_FindMethod
argument_list|(
name|disp_methods
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|self
argument_list|,
name|name
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|disp_repr (self)
name|disp_repr
parameter_list|(
name|self
parameter_list|)
name|dispobject
modifier|*
name|self
decl_stmt|;
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|PyString_FromString
argument_list|(
literal|"<display>"
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|Disptype
specifier|static
name|PyTypeObject
name|Disptype
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
operator|&
name|PyType_Type
argument_list|)
literal|0
block|,
comment|/*ob_size*/
literal|"Display"
block|,
comment|/*tp_name*/
sizeof|sizeof
argument_list|(
name|dispobject
argument_list|)
block|,
comment|/*tp_basicsize*/
literal|0
block|,
comment|/*tp_itemsize*/
comment|/* methods */
operator|(
name|destructor
operator|)
name|disp_dealloc
block|,
comment|/*tp_dealloc*/
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/*tp_print*/
operator|(
name|getattrfunc
operator|)
name|disp_getattr
block|,
comment|/*tp_getattr*/
operator|(
name|setattrfunc
operator|)
literal|0
block|,
comment|/*tp_setattr*/
operator|(
name|cmpfunc
operator|)
literal|0
block|,
comment|/*tp_compare*/
operator|(
name|reprfunc
operator|)
name|disp_repr
block|,
comment|/*tp_repr*/
literal|0
block|,
comment|/*tp_as_number*/
literal|0
block|,
comment|/*tp_as_sequence*/
literal|0
block|,
comment|/*tp_as_mapping*/
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/*tp_hash*/
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/*tp_call*/
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/*tp_str*/
comment|/* Space for future expansion */
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
name|NULL
comment|/* Documentation string */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* End of code for Display objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_expr_stmt
DECL|function|ensure_drawable (self)
specifier|static
name|ensure_drawable
argument_list|(
argument|self
argument_list|)
name|drwobject
operator|*
name|self
expr_stmt|;
end_expr_stmt

begin_block
block|{
if|if
condition|(
operator|!
name|self
operator|->
name|drawable
condition|)
name|self
operator|->
name|drawable
operator|=
name|gimp_drawable_get
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_flush (self,args)
name|drw_flush
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":flush"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|ensure_drawable
argument_list|(
name|self
argument_list|)
expr_stmt|;
name|gimp_drawable_flush
argument_list|(
name|self
operator|->
name|drawable
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_update (self,args)
name|drw_update
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|x
decl_stmt|,
name|y
decl_stmt|;
name|unsigned
name|int
name|w
decl_stmt|,
name|h
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iiii:update"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|w
argument_list|,
operator|&
name|h
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_drawable_update
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|w
argument_list|,
name|h
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_merge_shadow (self,args)
name|drw_merge_shadow
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|u
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:merge_shadow"
argument_list|,
operator|&
name|u
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_drawable_merge_shadow
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|u
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_fill (self,args)
name|drw_fill
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|f
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:fill"
argument_list|,
operator|&
name|f
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_drawable_fill
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|f
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_get_tile (self,args)
name|drw_get_tile
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|GTile
modifier|*
name|t
decl_stmt|;
name|int
name|shadow
decl_stmt|,
name|r
decl_stmt|,
name|c
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iii:get_tile"
argument_list|,
operator|&
name|shadow
argument_list|,
operator|&
name|r
argument_list|,
operator|&
name|c
argument_list|)
condition|)
return|return
name|NULL
return|;
name|ensure_drawable
argument_list|(
name|self
argument_list|)
expr_stmt|;
name|t
operator|=
name|gimp_drawable_get_tile
argument_list|(
name|self
operator|->
name|drawable
argument_list|,
name|shadow
argument_list|,
name|r
argument_list|,
name|c
argument_list|)
expr_stmt|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newtileobject
argument_list|(
name|t
argument_list|,
name|self
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_get_tile2 (self,args)
name|drw_get_tile2
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|GTile
modifier|*
name|t
decl_stmt|;
name|int
name|shadow
decl_stmt|,
name|x
decl_stmt|,
name|y
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iii:get_tile2"
argument_list|,
operator|&
name|shadow
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
condition|)
return|return
name|NULL
return|;
name|ensure_drawable
argument_list|(
name|self
argument_list|)
expr_stmt|;
name|t
operator|=
name|gimp_drawable_get_tile2
argument_list|(
name|self
operator|->
name|drawable
argument_list|,
name|shadow
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
expr_stmt|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newtileobject
argument_list|(
name|t
argument_list|,
name|self
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_get_pixel_rgn (self,args)
name|drw_get_pixel_rgn
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|x
decl_stmt|,
name|y
decl_stmt|,
name|w
decl_stmt|,
name|h
decl_stmt|,
name|dirty
init|=
literal|1
decl_stmt|,
name|shadow
init|=
literal|0
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iiii|ii:get_pixel_rgn"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|w
argument_list|,
operator|&
name|h
argument_list|,
operator|&
name|dirty
argument_list|,
operator|&
name|shadow
argument_list|)
condition|)
return|return
name|NULL
return|;
name|ensure_drawable
argument_list|(
name|self
argument_list|)
expr_stmt|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newprobject
argument_list|(
name|self
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|w
argument_list|,
name|h
argument_list|,
name|dirty
argument_list|,
name|shadow
argument_list|)
return|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
end_ifdef

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_find_parasite (self,args)
name|drw_find_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:find_parasite"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newparaobject
argument_list|(
name|gimp_drawable_find_parasite
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_attach_parasite (self,args)
name|drw_attach_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|paraobject
modifier|*
name|parasite
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:attach_parasite"
argument_list|,
operator|&
name|Paratype
argument_list|,
operator|&
name|parasite
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_drawable_parasite_attach
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|parasite
operator|->
name|para
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_attach_new_parasite (self,args)
name|drw_attach_new_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|data
decl_stmt|;
name|int
name|flags
decl_stmt|,
name|size
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sis#:attach_new_parasite"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|flags
argument_list|,
operator|&
name|data
argument_list|,
operator|&
name|size
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_drawable_attach_new_parasite
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|,
name|flags
argument_list|,
name|size
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|drw_detach_parasite (self,args)
name|drw_detach_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|drwobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:detach_parasite"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_drawable_parasite_detach
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* for inclusion with the methods of layer and channel objects */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
end_ifdef

begin_define
DECL|macro|drw_methods ()
define|#
directive|define
name|drw_methods
parameter_list|()
define|\
value|{"flush",	(PyCFunction)drw_flush,	METH_VARARGS}, \     {"update",	(PyCFunction)drw_update,	METH_VARARGS}, \     {"merge_shadow",	(PyCFunction)drw_merge_shadow,	METH_VARARGS}, \     {"fill",	(PyCFunction)drw_fill,	METH_VARARGS}, \     {"get_tile",	(PyCFunction)drw_get_tile,	METH_VARARGS}, \     {"get_tile2",	(PyCFunction)drw_get_tile2,	METH_VARARGS}, \     {"get_pixel_rgn", (PyCFunction)drw_get_pixel_rgn, METH_VARARGS}, \     {"find_parasite",       (PyCFunction)img_find_parasite, METH_VARARGS}, \     {"attach_parasite",     (PyCFunction)img_attach_parasite, METH_VARARGS},\     {"attach_new_parasite",(PyCFunction)img_attach_new_parasite,METH_VARARGS},\     {"detach_parasite",     (PyCFunction)img_detach_parasite, METH_VARARGS}
end_define

begin_else
else|#
directive|else
end_else

begin_define
DECL|macro|drw_methods ()
define|#
directive|define
name|drw_methods
parameter_list|()
define|\
value|{"flush",	(PyCFunction)drw_flush,	METH_VARARGS}, \     {"update",	(PyCFunction)drw_update,	METH_VARARGS}, \     {"merge_shadow",	(PyCFunction)drw_merge_shadow,	METH_VARARGS}, \     {"fill",	(PyCFunction)drw_fill,	METH_VARARGS}, \     {"get_tile",	(PyCFunction)drw_get_tile,	METH_VARARGS}, \     {"get_tile2",	(PyCFunction)drw_get_tile2,	METH_VARARGS}, \     {"get_pixel_rgn", (PyCFunction)drw_get_pixel_rgn, METH_VARARGS}
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* ---------- */
end_comment

begin_function
specifier|static
name|drwobject
modifier|*
DECL|function|newdrwobject (GDrawable * d,gint32 ID)
name|newdrwobject
parameter_list|(
name|GDrawable
modifier|*
name|d
parameter_list|,
name|gint32
name|ID
parameter_list|)
block|{
name|drwobject
modifier|*
name|self
decl_stmt|;
if|if
condition|(
name|d
operator|==
name|NULL
operator|&&
name|ID
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
operator|(
name|drwobject
operator|*
operator|)
name|Py_None
return|;
block|}
if|if
condition|(
name|d
operator|!=
name|NULL
condition|)
name|ID
operator|=
name|d
operator|->
name|id
expr_stmt|;
comment|/* create the appropriate object type */
if|if
condition|(
name|gimp_drawable_is_layer
argument_list|(
name|ID
argument_list|)
condition|)
name|self
operator|=
name|newlayobject
argument_list|(
name|ID
argument_list|)
expr_stmt|;
else|else
name|self
operator|=
name|newchnobject
argument_list|(
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|self
operator|->
name|drawable
operator|=
name|d
expr_stmt|;
return|return
name|self
return|;
block|}
end_function

begin_comment
comment|/* End of code for Drawable objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_copy (self,args)
name|lay_copy
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|add_alpha
init|=
literal|0
decl_stmt|,
name|nreturn_vals
decl_stmt|;
name|GParam
modifier|*
name|return_vals
decl_stmt|;
name|gint32
name|id
decl_stmt|;
comment|/* start of long convoluted (working) layer_copy */
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"|i:copy"
argument_list|,
operator|&
name|add_alpha
argument_list|)
condition|)
return|return
name|NULL
return|;
name|return_vals
operator|=
name|gimp_run_procedure
argument_list|(
literal|"gimp_layer_copy"
argument_list|,
operator|&
name|nreturn_vals
argument_list|,
name|PARAM_LAYER
argument_list|,
name|self
operator|->
name|ID
argument_list|,
name|PARAM_INT32
argument_list|,
name|add_alpha
argument_list|,
name|PARAM_END
argument_list|)
expr_stmt|;
if|if
condition|(
name|return_vals
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|!=
name|STATUS_SUCCESS
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"can't create new layer"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|id
operator|=
name|return_vals
index|[
literal|1
index|]
operator|.
name|data
operator|.
name|d_layer
expr_stmt|;
name|gimp_destroy_params
argument_list|(
name|return_vals
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|id
argument_list|)
return|;
comment|/* This simple version of the code doesn't seem to work */
comment|/* return (PyObject *)newlayobject(gimp_layer_copy(self->ID));*/
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_add_alpha (self,args)
name|lay_add_alpha
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":add_alpha"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_layer_add_alpha
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_create_mask (self,args)
name|lay_create_mask
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|type
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:create_mask"
argument_list|,
operator|&
name|type
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newchnobject
argument_list|(
name|gimp_layer_create_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|type
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_resize (self,args)
name|lay_resize
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|unsigned
name|int
name|new_h
decl_stmt|,
name|new_w
decl_stmt|;
name|int
name|offs_x
decl_stmt|,
name|offs_y
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iiii:resize"
argument_list|,
operator|&
name|new_w
argument_list|,
operator|&
name|new_h
argument_list|,
operator|&
name|offs_x
argument_list|,
operator|&
name|offs_y
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_layer_resize
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|new_w
argument_list|,
name|new_h
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_scale (self,args)
name|lay_scale
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|unsigned
name|int
name|new_w
decl_stmt|,
name|new_h
decl_stmt|;
name|int
name|local_origin
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iii:scale"
argument_list|,
operator|&
name|new_w
argument_list|,
operator|&
name|new_h
argument_list|,
operator|&
name|local_origin
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_layer_scale
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|new_w
argument_list|,
name|new_h
argument_list|,
name|local_origin
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_translate (self,args)
name|lay_translate
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|offs_x
decl_stmt|,
name|offs_y
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:translate"
argument_list|,
operator|&
name|offs_x
argument_list|,
operator|&
name|offs_y
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_layer_translate
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_set_offsets (self,args)
name|lay_set_offsets
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|offs_x
decl_stmt|,
name|offs_y
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ii:set_offsets"
argument_list|,
operator|&
name|offs_x
argument_list|,
operator|&
name|offs_y
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_layer_set_offsets
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|offs_x
argument_list|,
name|offs_y
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_if
if|#
directive|if
name|GIMP_CHECK_VERSION
argument_list|(
literal|1
operator|,
literal|1
operator|,
literal|0
argument_list|)
end_if

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_get_tattoo (self,args)
name|lay_get_tattoo
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":get_tattoo"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_layer_get_tattoo
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
DECL|variable|lay_methods
specifier|static
name|struct
name|PyMethodDef
name|lay_methods
index|[]
init|=
block|{
block|{
literal|"copy"
block|,
operator|(
name|PyCFunction
operator|)
name|lay_copy
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"add_alpha"
block|,
operator|(
name|PyCFunction
operator|)
name|lay_add_alpha
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"create_mask"
block|,
operator|(
name|PyCFunction
operator|)
name|lay_create_mask
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"resize"
block|,
operator|(
name|PyCFunction
operator|)
name|lay_resize
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"scale"
block|,
operator|(
name|PyCFunction
operator|)
name|lay_scale
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"translate"
block|,
operator|(
name|PyCFunction
operator|)
name|lay_translate
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_offsets"
block|,
operator|(
name|PyCFunction
operator|)
name|lay_set_offsets
block|,
name|METH_VARARGS
block|}
block|,
if|#
directive|if
name|GIMP_CHECK_VERSION
argument_list|(
literal|1
operator|,
literal|1
operator|,
literal|0
argument_list|)
block|{
literal|"get_tattoo"
block|,
operator|(
name|PyCFunction
operator|)
name|lay_get_tattoo
block|,
name|METH_VARARGS
block|}
block|,
endif|#
directive|endif
name|drw_methods
argument_list|()
block|,
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------- */
end_comment

begin_function
specifier|static
name|layobject
modifier|*
DECL|function|newlayobject (gint32 ID)
name|newlayobject
parameter_list|(
name|gint32
name|ID
parameter_list|)
block|{
name|layobject
modifier|*
name|self
decl_stmt|;
if|if
condition|(
name|ID
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
operator|(
name|layobject
operator|*
operator|)
name|Py_None
return|;
block|}
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|layobject
argument_list|,
operator|&
name|Laytype
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|self
operator|->
name|ID
operator|=
name|ID
expr_stmt|;
name|self
operator|->
name|drawable
operator|=
name|NULL
expr_stmt|;
return|return
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|lay_dealloc (self)
name|lay_dealloc
parameter_list|(
name|self
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
block|{
if|if
condition|(
name|self
operator|->
name|drawable
condition|)
name|gimp_drawable_detach
argument_list|(
name|self
operator|->
name|drawable
argument_list|)
expr_stmt|;
name|PyMem_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_getattr (self,name)
name|lay_getattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|gint32
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"__members__"
argument_list|)
condition|)
return|return
name|Py_BuildValue
argument_list|(
literal|"[sssssssssssssssssss]"
argument_list|,
literal|"ID"
argument_list|,
literal|"apply_mask"
argument_list|,
literal|"bpp"
argument_list|,
literal|"edit_mask"
argument_list|,
literal|"has_alpha"
argument_list|,
literal|"height"
argument_list|,
literal|"image"
argument_list|,
literal|"is_color"
argument_list|,
literal|"is_colour"
argument_list|,
literal|"is_floating_selection"
argument_list|,
literal|"is_gray"
argument_list|,
literal|"is_grey"
argument_list|,
literal|"is_indexed"
argument_list|,
literal|"mask"
argument_list|,
literal|"mask_bounds"
argument_list|,
literal|"mode"
argument_list|,
literal|"name"
argument_list|,
literal|"offsets"
argument_list|,
literal|"opacity"
argument_list|,
literal|"preserve_transparency"
argument_list|,
literal|"show_mask"
argument_list|,
literal|"type"
argument_list|,
literal|"visible"
argument_list|,
literal|"width"
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"ID"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|self
operator|->
name|ID
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"bpp"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_bpp
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"has_alpha"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_has_alpha
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"height"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_height
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"image"
argument_list|)
condition|)
block|{
name|id
operator|=
name|gimp_layer_get_image_id
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newimgobject
argument_list|(
name|id
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_color"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_colour"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_color
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_floating_selection"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_layer_is_floating_selection
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_gray"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_grey"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_is_gray
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_indexed"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_is_indexed
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"mask"
argument_list|)
condition|)
block|{
name|id
operator|=
name|gimp_layer_get_mask_id
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newchnobject
argument_list|(
name|id
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"mask_bounds"
argument_list|)
condition|)
block|{
name|gint
name|x1
decl_stmt|,
name|y1
decl_stmt|,
name|x2
decl_stmt|,
name|y2
decl_stmt|;
name|gimp_drawable_mask_bounds
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|x1
argument_list|,
operator|&
name|y1
argument_list|,
operator|&
name|x2
argument_list|,
operator|&
name|y2
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(iiii)"
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|x2
argument_list|,
name|y2
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"apply_mask"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_get_apply_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"edit_mask"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_get_edit_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"mode"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_get_mode
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"name"
argument_list|)
condition|)
return|return
name|PyString_FromString
argument_list|(
name|gimp_layer_get_name
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"offsets"
argument_list|)
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|;
name|gimp_drawable_offsets
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(ii)"
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"opacity"
argument_list|)
condition|)
return|return
name|PyFloat_FromDouble
argument_list|(
operator|(
name|double
operator|)
name|gimp_layer_get_opacity
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"preserve_transparency"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_get_preserve_transparency
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"show_mask"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_get_show_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"type"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_type
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"visible"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_get_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"width"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_layer_width
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
return|return
name|Py_FindMethod
argument_list|(
name|lay_methods
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|self
argument_list|,
name|name
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|lay_setattr (self,name,v)
name|lay_setattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|,
name|v
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
name|PyObject
modifier|*
name|v
decl_stmt|;
block|{
if|if
condition|(
name|v
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete attributes."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
comment|/* Set attribute 'name' to value 'v'. v==NULL means delete */
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"apply_mask"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_layer_set_apply_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"edit_mask"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_layer_set_edit_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"mode"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_layer_set_mode
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|(
name|GLayerMode
operator|)
name|PyInt_AsLong
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"name"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_layer_set_name
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyString_AsString
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"opacity"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyFloat_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_layer_set_opacity
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyFloat_AsDouble
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"preserve_transparency"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_layer_set_preserve_transparency
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"show_mask"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_layer_set_show_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"visible"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_layer_set_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"ID"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"bpp"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"height"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"image"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"mask"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"type"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"width"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_floating_selection"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"offsets"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"mask_bounds"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"has_alpha"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_color"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_colour"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_gray"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_grey"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_indexed"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"__members__"
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"read-only attribute."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|lay_repr (self)
name|lay_repr
parameter_list|(
name|self
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|;
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|PyString_FromString
argument_list|(
literal|"<layer "
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_layer_get_name
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
literal|">"
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|lay_cmp (self,other)
name|lay_cmp
parameter_list|(
name|self
parameter_list|,
name|other
parameter_list|)
name|layobject
modifier|*
name|self
decl_stmt|,
decl|*
name|other
decl_stmt|;
end_function

begin_block
block|{
return|return
name|self
operator|->
name|ID
operator|-
name|other
operator|->
name|ID
return|;
block|}
end_block

begin_decl_stmt
DECL|variable|Laytype
specifier|static
name|PyTypeObject
name|Laytype
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
operator|&
name|PyType_Type
argument_list|)
literal|0
block|,
comment|/*ob_size*/
literal|"Layer"
block|,
comment|/*tp_name*/
sizeof|sizeof
argument_list|(
name|layobject
argument_list|)
block|,
comment|/*tp_basicsize*/
literal|0
block|,
comment|/*tp_itemsize*/
comment|/* methods */
operator|(
name|destructor
operator|)
name|lay_dealloc
block|,
comment|/*tp_dealloc*/
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/*tp_print*/
operator|(
name|getattrfunc
operator|)
name|lay_getattr
block|,
comment|/*tp_getattr*/
operator|(
name|setattrfunc
operator|)
name|lay_setattr
block|,
comment|/*tp_setattr*/
operator|(
name|cmpfunc
operator|)
name|lay_cmp
block|,
comment|/*tp_compare*/
operator|(
name|reprfunc
operator|)
name|lay_repr
block|,
comment|/*tp_repr*/
operator|&
name|gobj_as_number
block|,
comment|/*tp_as_number*/
literal|0
block|,
comment|/*tp_as_sequence*/
literal|0
block|,
comment|/*tp_as_mapping*/
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/*tp_hash*/
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/*tp_call*/
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/*tp_str*/
comment|/* Space for future expansion */
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
name|NULL
comment|/* Documentation string */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* End of code for Layer objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|chn_copy (self,args)
name|chn_copy
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|chnobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|gint32
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":copy"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|id
operator|=
name|gimp_channel_copy
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"can't copy channel"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newchnobject
argument_list|(
name|id
argument_list|)
return|;
block|}
end_function

begin_if
if|#
directive|if
name|GIMP_CHECK_VERSION
argument_list|(
literal|1
operator|,
literal|1
operator|,
literal|0
argument_list|)
end_if

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|chn_get_tattoo (self,args)
name|chn_get_tattoo
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|chnobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":get_tattoo"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_channel_get_tattoo
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
DECL|variable|chn_methods
specifier|static
name|struct
name|PyMethodDef
name|chn_methods
index|[]
init|=
block|{
block|{
literal|"copy"
block|,
operator|(
name|PyCFunction
operator|)
name|chn_copy
block|,
name|METH_VARARGS
block|}
block|,
if|#
directive|if
name|GIMP_CHECK_VERSION
argument_list|(
literal|1
operator|,
literal|1
operator|,
literal|0
argument_list|)
block|{
literal|"get_tattoo"
block|,
operator|(
name|PyCFunction
operator|)
name|chn_get_tattoo
block|,
name|METH_VARARGS
block|}
block|,
endif|#
directive|endif
name|drw_methods
argument_list|()
block|,
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------- */
end_comment

begin_function
specifier|static
name|chnobject
modifier|*
DECL|function|newchnobject (gint32 ID)
name|newchnobject
parameter_list|(
name|gint32
name|ID
parameter_list|)
block|{
name|chnobject
modifier|*
name|self
decl_stmt|;
if|if
condition|(
name|ID
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
operator|(
name|chnobject
operator|*
operator|)
name|Py_None
return|;
block|}
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|chnobject
argument_list|,
operator|&
name|Chntype
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|self
operator|->
name|ID
operator|=
name|ID
expr_stmt|;
name|self
operator|->
name|drawable
operator|=
name|NULL
expr_stmt|;
return|return
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|chn_dealloc (self)
name|chn_dealloc
parameter_list|(
name|self
parameter_list|)
name|chnobject
modifier|*
name|self
decl_stmt|;
block|{
if|if
condition|(
name|self
operator|->
name|drawable
condition|)
name|gimp_drawable_detach
argument_list|(
name|self
operator|->
name|drawable
argument_list|)
expr_stmt|;
name|PyMem_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|chn_getattr (self,name)
name|chn_getattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|)
name|chnobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|unsigned
name|char
name|r
decl_stmt|,
name|g
decl_stmt|,
name|b
decl_stmt|;
name|gint32
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"__members__"
argument_list|)
condition|)
return|return
name|Py_BuildValue
argument_list|(
literal|"[ssssssssssssssssssssss]"
argument_list|,
literal|"ID"
argument_list|,
literal|"bpp"
argument_list|,
literal|"color"
argument_list|,
literal|"colour"
argument_list|,
literal|"has_alpha"
argument_list|,
literal|"height"
argument_list|,
literal|"image"
argument_list|,
literal|"is_color"
argument_list|,
literal|"is_colour"
argument_list|,
literal|"is_gray"
argument_list|,
literal|"is_grey"
argument_list|,
literal|"is_indexed"
argument_list|,
literal|"layer"
argument_list|,
literal|"layer_mask"
argument_list|,
literal|"mask_bounds"
argument_list|,
literal|"name"
argument_list|,
literal|"offsets"
argument_list|,
literal|"opacity"
argument_list|,
literal|"show_masked"
argument_list|,
literal|"type"
argument_list|,
literal|"visible"
argument_list|,
literal|"width"
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"ID"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|self
operator|->
name|ID
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"bpp"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_bpp
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"color"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"colour"
argument_list|)
condition|)
block|{
name|gimp_channel_get_color
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(iii)"
argument_list|,
operator|(
name|long
operator|)
name|r
argument_list|,
operator|(
name|long
operator|)
name|g
argument_list|,
operator|(
name|long
operator|)
name|b
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"has_alpha"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_has_alpha
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"height"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
operator|(
name|long
operator|)
name|gimp_channel_height
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"image"
argument_list|)
condition|)
block|{
name|id
operator|=
name|gimp_channel_get_image_id
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newimgobject
argument_list|(
name|id
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_color"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_colour"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_color
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_gray"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_grey"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_is_gray
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_indexed"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_is_indexed
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"layer"
argument_list|)
condition|)
block|{
name|id
operator|=
name|gimp_channel_get_layer_id
argument_list|(
name|self
operator|->
name|ID
argument_list|)
expr_stmt|;
if|if
condition|(
name|id
operator|==
operator|-
literal|1
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|id
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"layer_mask"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_is_layer_mask
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"mask_bounds"
argument_list|)
condition|)
block|{
name|gint
name|x1
decl_stmt|,
name|y1
decl_stmt|,
name|x2
decl_stmt|,
name|y2
decl_stmt|;
name|gimp_drawable_mask_bounds
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|x1
argument_list|,
operator|&
name|y1
argument_list|,
operator|&
name|x2
argument_list|,
operator|&
name|y2
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(iiii)"
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|x2
argument_list|,
name|y2
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"name"
argument_list|)
condition|)
return|return
name|PyString_FromString
argument_list|(
name|gimp_channel_get_name
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"offsets"
argument_list|)
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|;
name|gimp_drawable_offsets
argument_list|(
name|self
operator|->
name|ID
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(ii)"
argument_list|,
name|x
argument_list|,
name|y
argument_list|)
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"opacity"
argument_list|)
condition|)
return|return
name|PyFloat_FromDouble
argument_list|(
name|gimp_channel_get_opacity
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"show_masked"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_channel_get_show_masked
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"type"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_drawable_type
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"visible"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_channel_get_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"width"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_channel_width
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
return|;
return|return
name|Py_FindMethod
argument_list|(
name|chn_methods
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|self
argument_list|,
name|name
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|chn_setattr (self,name,v)
name|chn_setattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|,
name|v
parameter_list|)
name|chnobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
name|PyObject
modifier|*
name|v
decl_stmt|;
block|{
name|PyObject
modifier|*
name|r
decl_stmt|,
modifier|*
name|g
decl_stmt|,
modifier|*
name|b
decl_stmt|;
if|if
condition|(
name|v
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete attributes."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"color"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"colour"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|v
argument_list|)
operator|||
name|PySequence_Length
argument_list|(
name|v
argument_list|)
operator|<
literal|3
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|r
operator|=
name|PySequence_GetItem
argument_list|(
name|v
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g
operator|=
name|PySequence_GetItem
argument_list|(
name|v
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|b
operator|=
name|PySequence_GetItem
argument_list|(
name|v
argument_list|,
literal|2
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|r
argument_list|)
operator|||
operator|!
name|PyInt_Check
argument_list|(
name|g
argument_list|)
operator|||
operator|!
name|PyInt_Check
argument_list|(
name|b
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|g
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|b
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_channel_set_color
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|r
argument_list|)
argument_list|,
name|PyInt_AsLong
argument_list|(
name|g
argument_list|)
argument_list|,
name|PyInt_AsLong
argument_list|(
name|b
argument_list|)
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|g
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|b
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"name"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_channel_set_name
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyString_AsString
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"opacity"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyFloat_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_channel_set_opacity
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyFloat_AsDouble
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
comment|/*	if (!strcmp(name, "show_masked")) { 	if (!PyInt_Check(v)) { 	PyErr_SetString(PyExc_TypeError, "type mis-match."); 	return -1; 	} 	gimp_channel_set_show_masked(self->ID, PyInt_AsLong(v)); 	return 0; 	}     */
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"visible"
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyInt_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"type mis-match."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_channel_set_visible
argument_list|(
name|self
operator|->
name|ID
argument_list|,
name|PyInt_AsLong
argument_list|(
name|v
argument_list|)
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"height"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"image"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"layer"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"width"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"ID"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"bpp"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"layer_mask"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"mask_bounds"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"offsets"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"type"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"has_alpha"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_color"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_colour"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_gray"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_grey"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_indexed"
argument_list|)
operator|||
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"__members__"
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"read-only attribute."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|chn_repr (self)
name|chn_repr
parameter_list|(
name|self
parameter_list|)
name|chnobject
modifier|*
name|self
decl_stmt|;
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|PyString_FromString
argument_list|(
literal|"<channel "
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_channel_get_name
argument_list|(
name|self
operator|->
name|ID
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
literal|">"
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|chn_cmp (self,other)
name|chn_cmp
parameter_list|(
name|self
parameter_list|,
name|other
parameter_list|)
name|chnobject
modifier|*
name|self
decl_stmt|,
decl|*
name|other
decl_stmt|;
end_function

begin_block
block|{
return|return
name|self
operator|->
name|ID
operator|-
name|other
operator|->
name|ID
return|;
block|}
end_block

begin_decl_stmt
DECL|variable|Chntype
specifier|static
name|PyTypeObject
name|Chntype
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
operator|&
name|PyType_Type
argument_list|)
literal|0
block|,
comment|/*ob_size*/
literal|"Channel"
block|,
comment|/*tp_name*/
sizeof|sizeof
argument_list|(
name|chnobject
argument_list|)
block|,
comment|/*tp_basicsize*/
literal|0
block|,
comment|/*tp_itemsize*/
comment|/* methods */
operator|(
name|destructor
operator|)
name|chn_dealloc
block|,
comment|/*tp_dealloc*/
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/*tp_print*/
operator|(
name|getattrfunc
operator|)
name|chn_getattr
block|,
comment|/*tp_getattr*/
operator|(
name|setattrfunc
operator|)
name|chn_setattr
block|,
comment|/*tp_setattr*/
operator|(
name|cmpfunc
operator|)
name|chn_cmp
block|,
comment|/*tp_compare*/
operator|(
name|reprfunc
operator|)
name|chn_repr
block|,
comment|/*tp_repr*/
operator|&
name|gobj_as_number
block|,
comment|/*tp_as_number*/
literal|0
block|,
comment|/*tp_as_sequence*/
literal|0
block|,
comment|/*tp_as_mapping*/
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/*tp_hash*/
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/*tp_call*/
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/*tp_str*/
comment|/* Space for future expansion */
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
name|NULL
comment|/* Documentation string */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* End of code for Channel objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|tile_flush (self,args)
name|tile_flush
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|tileobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":flush"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_tile_flush
argument_list|(
name|self
operator|->
name|tile
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|tile_methods
specifier|static
name|struct
name|PyMethodDef
name|tile_methods
index|[]
init|=
block|{
block|{
literal|"flush"
block|,
operator|(
name|PyCFunction
operator|)
name|tile_flush
block|,
name|METH_VARARGS
block|}
block|,
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------- */
end_comment

begin_function
specifier|static
name|tileobject
modifier|*
DECL|function|newtileobject (t,drw)
name|newtileobject
parameter_list|(
name|t
parameter_list|,
name|drw
parameter_list|)
name|GTile
modifier|*
name|t
decl_stmt|;
name|drwobject
modifier|*
name|drw
decl_stmt|;
block|{
name|tileobject
modifier|*
name|self
decl_stmt|;
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|tileobject
argument_list|,
operator|&
name|Tiletype
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|gimp_tile_ref
argument_list|(
name|t
argument_list|)
expr_stmt|;
name|self
operator|->
name|tile
operator|=
name|t
expr_stmt|;
name|Py_INCREF
argument_list|(
name|drw
argument_list|)
expr_stmt|;
name|self
operator|->
name|drawable
operator|=
name|drw
expr_stmt|;
return|return
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|tile_dealloc (self)
name|tile_dealloc
parameter_list|(
name|self
parameter_list|)
name|tileobject
modifier|*
name|self
decl_stmt|;
block|{
name|gimp_tile_unref
argument_list|(
name|self
operator|->
name|tile
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|self
operator|->
name|drawable
argument_list|)
expr_stmt|;
name|PyMem_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_define
DECL|macro|OFF (x)
define|#
directive|define
name|OFF
parameter_list|(
name|x
parameter_list|)
value|offsetof(GTile, x)
end_define

begin_decl_stmt
DECL|variable|tile_memberlist
specifier|static
name|struct
name|memberlist
name|tile_memberlist
index|[]
init|=
block|{
block|{
literal|"ewidth"
block|,
name|T_UINT
block|,
name|OFF
argument_list|(
name|ewidth
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"eheight"
block|,
name|T_UINT
block|,
name|OFF
argument_list|(
name|eheight
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"bpp"
block|,
name|T_UINT
block|,
name|OFF
argument_list|(
name|bpp
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"ref_count"
block|,
name|T_USHORT
block|,
name|OFF
argument_list|(
name|ref_count
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"dirty"
block|,
name|T_INT
block|,
literal|0
block|,
name|RO
block|}
block|,
block|{
literal|"shadow"
block|,
name|T_INT
block|,
literal|0
block|,
name|RO
block|}
block|,
block|{
literal|"drawable"
block|,
name|T_INT
block|,
name|OFF
argument_list|(
name|drawable
argument_list|)
block|,
name|RO
block|}
block|,
block|{
name|NULL
block|}
comment|/* Sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_undef
undef|#
directive|undef
name|OFF
end_undef

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|tile_getattr (self,name)
name|tile_getattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|)
name|tileobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|PyObject
modifier|*
name|rv
decl_stmt|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"dirty"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|self
operator|->
name|tile
operator|->
name|dirty
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"shadow"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|self
operator|->
name|tile
operator|->
name|shadow
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"drawable"
argument_list|)
condition|)
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newdrwobject
argument_list|(
name|self
operator|->
name|tile
operator|->
name|drawable
argument_list|,
literal|0
argument_list|)
return|;
name|rv
operator|=
name|PyMember_Get
argument_list|(
operator|(
name|char
operator|*
operator|)
name|self
operator|->
name|tile
argument_list|,
name|tile_memberlist
argument_list|,
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|rv
condition|)
return|return
name|rv
return|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return
name|Py_FindMethod
argument_list|(
name|tile_methods
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|self
argument_list|,
name|name
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|tile_repr (self)
name|tile_repr
parameter_list|(
name|self
parameter_list|)
name|tileobject
modifier|*
name|self
decl_stmt|;
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
if|if
condition|(
name|self
operator|->
name|tile
operator|->
name|shadow
condition|)
name|s
operator|=
name|PyString_FromString
argument_list|(
literal|"<shadow tile for drawable "
argument_list|)
expr_stmt|;
else|else
name|s
operator|=
name|PyString_FromString
argument_list|(
literal|"<tile for drawable "
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_drawable_name
argument_list|(
name|self
operator|->
name|tile
operator|->
name|drawable
operator|->
name|id
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
literal|">"
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|tile_length (self)
name|tile_length
parameter_list|(
name|self
parameter_list|)
name|tileobject
modifier|*
name|self
decl_stmt|;
block|{
return|return
name|self
operator|->
name|tile
operator|->
name|ewidth
operator|*
name|self
operator|->
name|tile
operator|->
name|eheight
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|tile_subscript (self,sub)
name|tile_subscript
parameter_list|(
name|self
parameter_list|,
name|sub
parameter_list|)
name|tileobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|sub
decl_stmt|;
block|{
name|GTile
modifier|*
name|tile
init|=
name|self
operator|->
name|tile
decl_stmt|;
name|int
name|bpp
init|=
name|tile
operator|->
name|bpp
decl_stmt|;
name|long
name|x
decl_stmt|,
name|y
decl_stmt|;
if|if
condition|(
name|PyInt_Check
argument_list|(
name|sub
argument_list|)
condition|)
block|{
name|x
operator|=
name|PyInt_AsLong
argument_list|(
name|sub
argument_list|)
expr_stmt|;
if|if
condition|(
name|x
operator|<
literal|0
operator|||
name|x
operator|>=
name|tile
operator|->
name|ewidth
operator|*
name|tile
operator|->
name|eheight
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"index out of range"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|PyString_FromStringAndSize
argument_list|(
name|tile
operator|->
name|data
operator|+
name|bpp
operator|*
name|x
argument_list|,
name|bpp
argument_list|)
return|;
block|}
if|if
condition|(
name|PyTuple_Check
argument_list|(
name|sub
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|sub
argument_list|,
literal|"ll"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|x
operator|<
literal|0
operator|||
name|y
operator|<
literal|0
operator|||
name|x
operator|>=
name|tile
operator|->
name|ewidth
operator|||
name|y
operator|>=
name|tile
operator|->
name|eheight
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"index out of range"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|PyString_FromStringAndSize
argument_list|(
name|tile
operator|->
name|data
operator|+
name|bpp
operator|*
operator|(
name|x
operator|+
name|y
operator|*
name|tile
operator|->
name|ewidth
operator|)
argument_list|,
name|bpp
argument_list|)
return|;
block|}
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"tile subscript not int or 2-tuple"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|tile_ass_sub (self,v,w)
name|tile_ass_sub
parameter_list|(
name|self
parameter_list|,
name|v
parameter_list|,
name|w
parameter_list|)
name|tileobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|v
decl_stmt|,
decl|*
name|w
decl_stmt|;
end_function

begin_block
block|{
name|GTile
modifier|*
name|tile
init|=
name|self
operator|->
name|tile
decl_stmt|;
name|int
name|bpp
init|=
name|tile
operator|->
name|bpp
decl_stmt|,
name|i
decl_stmt|;
name|long
name|x
decl_stmt|,
name|y
decl_stmt|;
name|char
modifier|*
name|pix
decl_stmt|,
modifier|*
name|data
decl_stmt|;
if|if
condition|(
name|w
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can not delete pixels in tile"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|w
argument_list|)
operator|&&
name|PyString_Size
argument_list|(
name|w
argument_list|)
operator|==
name|bpp
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"invalid subscript"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|pix
operator|=
name|PyString_AsString
argument_list|(
name|w
argument_list|)
expr_stmt|;
if|if
condition|(
name|PyInt_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
name|x
operator|=
name|PyInt_AsLong
argument_list|(
name|v
argument_list|)
expr_stmt|;
if|if
condition|(
name|x
operator|<
literal|0
operator|||
name|x
operator|>=
name|tile
operator|->
name|ewidth
operator|*
name|tile
operator|->
name|eheight
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"index out of range"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|data
operator|=
name|tile
operator|->
name|data
operator|+
name|x
operator|*
name|bpp
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bpp
condition|;
name|i
operator|++
control|)
name|data
index|[
name|i
index|]
operator|=
name|pix
index|[
name|i
index|]
expr_stmt|;
name|tile
operator|->
name|dirty
operator|=
name|TRUE
expr_stmt|;
return|return
literal|0
return|;
block|}
if|if
condition|(
name|PyTuple_Check
argument_list|(
name|v
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|v
argument_list|,
literal|"ll"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
condition|)
return|return
operator|-
literal|1
return|;
if|if
condition|(
name|x
operator|<
literal|0
operator|||
name|y
operator|<
literal|0
operator|||
name|x
operator|>=
name|tile
operator|->
name|ewidth
operator|||
name|y
operator|>=
name|tile
operator|->
name|eheight
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"index out of range"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|data
operator|=
name|tile
operator|->
name|data
operator|+
name|bpp
operator|*
operator|(
name|x
operator|+
name|y
operator|*
name|tile
operator|->
name|ewidth
operator|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|bpp
condition|;
name|i
operator|++
control|)
name|data
index|[
name|i
index|]
operator|=
name|pix
index|[
name|i
index|]
expr_stmt|;
name|tile
operator|->
name|dirty
operator|=
name|TRUE
expr_stmt|;
return|return
literal|0
return|;
block|}
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"tile subscript not int or 2-tuple"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
end_block

begin_decl_stmt
DECL|variable|tile_as_mapping
specifier|static
name|PyMappingMethods
name|tile_as_mapping
init|=
block|{
operator|(
name|inquiry
operator|)
name|tile_length
block|,
comment|/*length*/
operator|(
name|binaryfunc
operator|)
name|tile_subscript
block|,
comment|/*subscript*/
operator|(
name|objobjargproc
operator|)
name|tile_ass_sub
block|,
comment|/*ass_sub*/
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|Tiletype
specifier|static
name|PyTypeObject
name|Tiletype
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
operator|&
name|PyType_Type
argument_list|)
literal|0
block|,
comment|/*ob_size*/
literal|"Tile"
block|,
comment|/*tp_name*/
sizeof|sizeof
argument_list|(
name|tileobject
argument_list|)
block|,
comment|/*tp_basicsize*/
literal|0
block|,
comment|/*tp_itemsize*/
comment|/* methods */
operator|(
name|destructor
operator|)
name|tile_dealloc
block|,
comment|/*tp_dealloc*/
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/*tp_print*/
operator|(
name|getattrfunc
operator|)
name|tile_getattr
block|,
comment|/*tp_getattr*/
operator|(
name|setattrfunc
operator|)
literal|0
block|,
comment|/*tp_setattr*/
operator|(
name|cmpfunc
operator|)
literal|0
block|,
comment|/*tp_compare*/
operator|(
name|reprfunc
operator|)
name|tile_repr
block|,
comment|/*tp_repr*/
literal|0
block|,
comment|/*tp_as_number*/
literal|0
block|,
comment|/*tp_as_sequence*/
operator|&
name|tile_as_mapping
block|,
comment|/*tp_as_mapping*/
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/*tp_hash*/
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/*tp_call*/
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/*tp_str*/
comment|/* Space for future expansion */
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
name|NULL
comment|/* Documentation string */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* End of code for Tile objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pr_resize (self,args)
name|pr_resize
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|probject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|x
decl_stmt|,
name|y
decl_stmt|,
name|w
decl_stmt|,
name|h
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iiii:resize"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|w
argument_list|,
operator|&
name|h
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_pixel_rgn_resize
argument_list|(
operator|&
operator|(
name|self
operator|->
name|pr
operator|)
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|w
argument_list|,
name|h
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|pr_methods
specifier|static
name|struct
name|PyMethodDef
name|pr_methods
index|[]
init|=
block|{
block|{
literal|"resize"
block|,
operator|(
name|PyCFunction
operator|)
name|pr_resize
block|,
name|METH_VARARGS
block|}
block|,
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* ---------- */
end_comment

begin_function
specifier|static
name|probject
modifier|*
DECL|function|newprobject (drawable,x,y,width,height,dirty,shadow)
name|newprobject
parameter_list|(
name|drawable
parameter_list|,
name|x
parameter_list|,
name|y
parameter_list|,
name|width
parameter_list|,
name|height
parameter_list|,
name|dirty
parameter_list|,
name|shadow
parameter_list|)
name|drwobject
modifier|*
name|drawable
decl_stmt|;
name|int
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|,
name|dirty
decl_stmt|,
name|shadow
decl_stmt|;
block|{
name|probject
modifier|*
name|self
decl_stmt|;
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|probject
argument_list|,
operator|&
name|Prtype
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|gimp_pixel_rgn_init
argument_list|(
operator|&
operator|(
name|self
operator|->
name|pr
operator|)
argument_list|,
name|drawable
operator|->
name|drawable
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|dirty
argument_list|,
name|shadow
argument_list|)
expr_stmt|;
name|self
operator|->
name|drawable
operator|=
name|drawable
expr_stmt|;
name|Py_INCREF
argument_list|(
name|drawable
argument_list|)
expr_stmt|;
return|return
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pr_dealloc (self)
name|pr_dealloc
parameter_list|(
name|self
parameter_list|)
name|probject
modifier|*
name|self
decl_stmt|;
block|{
name|Py_DECREF
argument_list|(
name|self
operator|->
name|drawable
argument_list|)
expr_stmt|;
name|PyMem_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* Code to access pr objects as mappings */
end_comment

begin_function
specifier|static
name|int
DECL|function|pr_length (self)
name|pr_length
parameter_list|(
name|self
parameter_list|)
name|probject
modifier|*
name|self
decl_stmt|;
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"Can't get size of pixel region."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pr_subscript (self,key)
name|pr_subscript
parameter_list|(
name|self
parameter_list|,
name|key
parameter_list|)
name|probject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|key
decl_stmt|;
block|{
name|GPixelRgn
modifier|*
name|pr
init|=
operator|&
operator|(
name|self
operator|->
name|pr
operator|)
decl_stmt|;
name|int
name|bpp
init|=
name|pr
operator|->
name|bpp
decl_stmt|;
name|PyObject
modifier|*
name|x
decl_stmt|,
modifier|*
name|y
decl_stmt|;
name|int
name|x1
decl_stmt|,
name|y1
decl_stmt|,
name|x2
decl_stmt|,
name|y2
decl_stmt|,
name|xs
decl_stmt|,
name|ys
decl_stmt|;
if|if
condition|(
operator|!
name|PyTuple_Check
argument_list|(
name|key
argument_list|)
operator|||
name|PyTuple_Size
argument_list|(
name|key
argument_list|)
operator|!=
literal|2
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"subscript must be a 2-tuple."
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|key
argument_list|,
literal|"OO"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|PyInt_Check
argument_list|(
name|x
argument_list|)
condition|)
block|{
name|x1
operator|=
name|PyInt_AsLong
argument_list|(
name|x
argument_list|)
expr_stmt|;
if|if
condition|(
name|pr
operator|->
name|x
operator|>
name|x1
operator|||
name|x1
operator|>=
name|pr
operator|->
name|x
operator|+
name|pr
operator|->
name|w
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"x subscript out of range"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|PyInt_Check
argument_list|(
name|y
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|bpp
index|]
decl_stmt|;
name|y1
operator|=
name|PyInt_AsLong
argument_list|(
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|pr
operator|->
name|y
operator|>
name|y1
operator|||
name|y1
operator|>=
name|pr
operator|->
name|y
operator|+
name|pr
operator|->
name|h
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"y subscript out of range"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|gimp_pixel_rgn_get_pixel
argument_list|(
name|pr
argument_list|,
name|buf
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|)
expr_stmt|;
return|return
name|PyString_FromStringAndSize
argument_list|(
name|buf
argument_list|,
name|bpp
argument_list|)
return|;
block|}
elseif|else
if|if
condition|(
name|PySlice_Check
argument_list|(
name|y
argument_list|)
condition|)
if|if
condition|(
name|PySlice_GetIndices
argument_list|(
operator|(
name|PySliceObject
operator|*
operator|)
name|y
argument_list|,
name|pr
operator|->
name|y
operator|+
name|pr
operator|->
name|h
argument_list|,
operator|&
name|y1
argument_list|,
operator|&
name|y2
argument_list|,
operator|&
name|ys
argument_list|)
operator|||
operator|(
name|y1
operator|!=
literal|0
operator|&&
name|pr
operator|->
name|y
operator|>
name|y1
operator|)
operator|||
name|pr
operator|->
name|y
operator|>
name|y2
operator|||
name|ys
operator|!=
literal|1
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"invalid y slice"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
else|else
block|{
name|char
name|buf
index|[
name|bpp
operator|*
operator|(
name|y2
operator|-
name|y1
operator|)
index|]
decl_stmt|;
if|if
condition|(
name|y1
operator|==
literal|0
condition|)
name|y1
operator|=
name|pr
operator|->
name|y
expr_stmt|;
name|gimp_pixel_rgn_get_col
argument_list|(
name|pr
argument_list|,
name|buf
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|y2
operator|-
name|y1
argument_list|)
expr_stmt|;
return|return
name|PyString_FromStringAndSize
argument_list|(
name|buf
argument_list|,
name|bpp
operator|*
operator|(
name|y2
operator|-
name|y1
operator|)
argument_list|)
return|;
block|}
else|else
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"invalid y subscript"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
block|}
elseif|else
if|if
condition|(
name|PySlice_Check
argument_list|(
name|x
argument_list|)
condition|)
block|{
if|if
condition|(
name|PySlice_GetIndices
argument_list|(
operator|(
name|PySliceObject
operator|*
operator|)
name|x
argument_list|,
name|pr
operator|->
name|x
operator|+
name|pr
operator|->
name|w
argument_list|,
operator|&
name|x1
argument_list|,
operator|&
name|x2
argument_list|,
operator|&
name|xs
argument_list|)
operator|||
operator|(
name|x1
operator|!=
literal|0
operator|&&
name|pr
operator|->
name|x
operator|>
name|x1
operator|)
operator|||
name|pr
operator|->
name|x
operator|>
name|x2
operator|||
name|xs
operator|!=
literal|1
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"invalid x slice"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|x1
operator|==
literal|0
condition|)
name|x1
operator|=
name|pr
operator|->
name|x
expr_stmt|;
if|if
condition|(
name|PyInt_Check
argument_list|(
name|y
argument_list|)
condition|)
block|{
name|char
name|buf
index|[
name|bpp
operator|*
operator|(
name|x2
operator|-
name|x1
operator|)
index|]
decl_stmt|;
name|y1
operator|=
name|PyInt_AsLong
argument_list|(
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|pr
operator|->
name|y
operator|>
name|y1
operator|||
name|y1
operator|>=
name|pr
operator|->
name|y
operator|+
name|pr
operator|->
name|h
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"y subscript out of range"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|gimp_pixel_rgn_get_row
argument_list|(
name|pr
argument_list|,
name|buf
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|x2
operator|-
name|x1
argument_list|)
expr_stmt|;
return|return
name|PyString_FromStringAndSize
argument_list|(
name|buf
argument_list|,
name|bpp
operator|*
operator|(
name|x2
operator|-
name|x1
operator|)
argument_list|)
return|;
block|}
elseif|else
if|if
condition|(
name|PySlice_Check
argument_list|(
name|y
argument_list|)
condition|)
if|if
condition|(
name|PySlice_GetIndices
argument_list|(
operator|(
name|PySliceObject
operator|*
operator|)
name|y
argument_list|,
name|pr
operator|->
name|y
operator|+
name|pr
operator|->
name|h
argument_list|,
operator|&
name|y1
argument_list|,
operator|&
name|y2
argument_list|,
operator|&
name|ys
argument_list|)
operator|||
operator|(
name|y1
operator|!=
literal|0
operator|&&
name|pr
operator|->
name|y
operator|)
operator|>
name|y1
operator|||
name|pr
operator|->
name|y
operator|>
name|y2
operator|||
name|ys
operator|!=
literal|1
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"invalid y slice"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
else|else
block|{
name|char
name|buf
index|[
name|bpp
operator|*
operator|(
name|x2
operator|-
name|x1
operator|)
operator|*
operator|(
name|y2
operator|-
name|y1
operator|)
index|]
decl_stmt|;
if|if
condition|(
name|y1
operator|==
literal|0
condition|)
name|y1
operator|=
name|pr
operator|->
name|y
expr_stmt|;
name|gimp_pixel_rgn_get_rect
argument_list|(
name|pr
argument_list|,
name|buf
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|x2
operator|-
name|x1
argument_list|,
name|y2
operator|-
name|y1
argument_list|)
expr_stmt|;
return|return
name|PyString_FromStringAndSize
argument_list|(
name|buf
argument_list|,
name|bpp
operator|*
operator|(
name|x2
operator|-
name|x1
operator|)
operator|*
operator|(
name|y2
operator|-
name|y1
operator|)
argument_list|)
return|;
block|}
else|else
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"invalid y subscript"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
block|}
else|else
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"invalid x subscript"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|pr_ass_sub (self,v,w)
name|pr_ass_sub
parameter_list|(
name|self
parameter_list|,
name|v
parameter_list|,
name|w
parameter_list|)
name|probject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|v
decl_stmt|,
decl|*
name|w
decl_stmt|;
end_function

begin_block
block|{
name|GPixelRgn
modifier|*
name|pr
init|=
operator|&
operator|(
name|self
operator|->
name|pr
operator|)
decl_stmt|;
name|int
name|bpp
init|=
name|pr
operator|->
name|bpp
decl_stmt|;
name|PyObject
modifier|*
name|x
decl_stmt|,
modifier|*
name|y
decl_stmt|;
name|char
modifier|*
name|buf
decl_stmt|;
name|int
name|len
decl_stmt|,
name|x1
decl_stmt|,
name|x2
decl_stmt|,
name|xs
decl_stmt|,
name|y1
decl_stmt|,
name|y2
decl_stmt|,
name|ys
decl_stmt|;
if|if
condition|(
name|w
operator|==
name|NULL
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"can't delete subscripts."
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyString_Check
argument_list|(
name|w
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"must assign string to subscript"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyTuple_Check
argument_list|(
name|v
argument_list|)
operator|||
name|PyTuple_Size
argument_list|(
name|v
argument_list|)
operator|!=
literal|2
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"subscript must be a 2-tuple"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|v
argument_list|,
literal|"OO"
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|)
condition|)
return|return
operator|-
literal|1
return|;
name|buf
operator|=
name|PyString_AsString
argument_list|(
name|w
argument_list|)
expr_stmt|;
name|len
operator|=
name|PyString_Size
argument_list|(
name|w
argument_list|)
expr_stmt|;
if|if
condition|(
name|PyInt_Check
argument_list|(
name|x
argument_list|)
condition|)
block|{
name|x1
operator|=
name|PyInt_AsLong
argument_list|(
name|x
argument_list|)
expr_stmt|;
if|if
condition|(
name|pr
operator|->
name|x
operator|>
name|x1
operator|||
name|x1
operator|>=
name|pr
operator|->
name|x
operator|+
name|pr
operator|->
name|w
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"x subscript out of range"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
name|PyInt_Check
argument_list|(
name|y
argument_list|)
condition|)
block|{
name|y1
operator|=
name|PyInt_AsLong
argument_list|(
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|pr
operator|->
name|y
operator|>
name|y1
operator|||
name|y1
operator|>=
name|pr
operator|->
name|y
operator|+
name|pr
operator|->
name|h
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"y subscript out of range"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
name|len
operator|!=
name|bpp
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"string is wrong length"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_pixel_rgn_set_pixel
argument_list|(
name|pr
argument_list|,
name|buf
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
elseif|else
if|if
condition|(
name|PySlice_Check
argument_list|(
name|y
argument_list|)
condition|)
block|{
if|if
condition|(
name|PySlice_GetIndices
argument_list|(
operator|(
name|PySliceObject
operator|*
operator|)
name|y
argument_list|,
name|pr
operator|->
name|y
operator|+
name|pr
operator|->
name|h
argument_list|,
operator|&
name|y1
argument_list|,
operator|&
name|y2
argument_list|,
operator|&
name|ys
argument_list|)
operator|||
operator|(
name|y1
operator|!=
literal|0
operator|&&
name|pr
operator|->
name|y
operator|>
name|y1
operator|)
operator|||
name|pr
operator|->
name|y
operator|>
name|y2
operator|||
name|ys
operator|!=
literal|1
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"invalid y slice"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
name|y1
operator|==
literal|0
condition|)
name|y1
operator|=
name|pr
operator|->
name|y
expr_stmt|;
if|if
condition|(
name|len
operator|!=
name|bpp
operator|*
operator|(
name|y2
operator|-
name|y1
operator|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"string is wrong length"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_pixel_rgn_set_col
argument_list|(
name|pr
argument_list|,
name|buf
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|y2
operator|-
name|y1
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
else|else
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"invalid y subscript"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
block|}
elseif|else
if|if
condition|(
name|PySlice_Check
argument_list|(
name|x
argument_list|)
condition|)
block|{
if|if
condition|(
name|PySlice_GetIndices
argument_list|(
operator|(
name|PySliceObject
operator|*
operator|)
name|x
argument_list|,
name|pr
operator|->
name|x
operator|+
name|pr
operator|->
name|w
argument_list|,
operator|&
name|x1
argument_list|,
operator|&
name|x2
argument_list|,
operator|&
name|xs
argument_list|)
operator|||
operator|(
name|x1
operator|!=
literal|0
operator|&&
name|pr
operator|->
name|x
operator|>
name|x1
operator|)
operator|||
name|pr
operator|->
name|x
operator|>
name|x2
operator|||
name|xs
operator|!=
literal|1
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"invalid x slice"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
name|x1
operator|==
literal|0
condition|)
name|x1
operator|=
name|pr
operator|->
name|x
expr_stmt|;
if|if
condition|(
name|PyInt_Check
argument_list|(
name|y
argument_list|)
condition|)
block|{
name|y1
operator|=
name|PyInt_AsLong
argument_list|(
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|pr
operator|->
name|y
operator|>
name|y1
operator|||
name|y1
operator|>=
name|pr
operator|->
name|y
operator|+
name|pr
operator|->
name|h
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"y subscript out of range"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
name|len
operator|!=
name|bpp
operator|*
operator|(
name|x2
operator|-
name|x1
operator|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"string is wrong length"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_pixel_rgn_set_row
argument_list|(
name|pr
argument_list|,
name|buf
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|x2
operator|-
name|x1
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
elseif|else
if|if
condition|(
name|PySlice_Check
argument_list|(
name|y
argument_list|)
condition|)
block|{
if|if
condition|(
name|PySlice_GetIndices
argument_list|(
operator|(
name|PySliceObject
operator|*
operator|)
name|y
argument_list|,
name|pr
operator|->
name|y
operator|+
name|pr
operator|->
name|h
argument_list|,
operator|&
name|y1
argument_list|,
operator|&
name|y2
argument_list|,
operator|&
name|ys
argument_list|)
operator|||
operator|(
name|y1
operator|!=
literal|0
operator|&&
name|pr
operator|->
name|y
operator|>
name|y1
operator|)
operator|||
name|pr
operator|->
name|y
operator|>
name|y2
operator|||
name|ys
operator|!=
literal|1
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_IndexError
argument_list|,
literal|"invalid y slice"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
if|if
condition|(
name|y1
operator|==
literal|0
condition|)
name|y1
operator|=
name|pr
operator|->
name|y
expr_stmt|;
if|if
condition|(
name|len
operator|!=
name|bpp
operator|*
operator|(
name|x2
operator|-
name|x1
operator|)
operator|*
operator|(
name|y2
operator|-
name|y1
operator|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"string is wrong length"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
name|gimp_pixel_rgn_set_rect
argument_list|(
name|pr
argument_list|,
name|buf
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|x2
operator|-
name|x1
argument_list|,
name|y2
operator|-
name|y1
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
else|else
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"invalid y subscript"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
block|}
else|else
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"invalid x subscript"
argument_list|)
expr_stmt|;
return|return
operator|-
literal|1
return|;
block|}
return|return
operator|-
literal|1
return|;
block|}
end_block

begin_decl_stmt
DECL|variable|pr_as_mapping
specifier|static
name|PyMappingMethods
name|pr_as_mapping
init|=
block|{
operator|(
name|inquiry
operator|)
name|pr_length
block|,
comment|/*mp_length*/
operator|(
name|binaryfunc
operator|)
name|pr_subscript
block|,
comment|/*mp_subscript*/
operator|(
name|objobjargproc
operator|)
name|pr_ass_sub
block|,
comment|/*mp_ass_subscript*/
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_define
DECL|macro|OFF (x)
define|#
directive|define
name|OFF
parameter_list|(
name|x
parameter_list|)
value|offsetof(GPixelRgn, x)
end_define

begin_decl_stmt
DECL|variable|pr_memberlist
specifier|static
name|struct
name|memberlist
name|pr_memberlist
index|[]
init|=
block|{
block|{
literal|"drawable"
block|,
name|T_INT
block|,
name|OFF
argument_list|(
name|drawable
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"bpp"
block|,
name|T_UINT
block|,
name|OFF
argument_list|(
name|bpp
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"rowstride"
block|,
name|T_UINT
block|,
name|OFF
argument_list|(
name|rowstride
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"x"
block|,
name|T_UINT
block|,
name|OFF
argument_list|(
name|x
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"y"
block|,
name|T_UINT
block|,
name|OFF
argument_list|(
name|y
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"w"
block|,
name|T_UINT
block|,
name|OFF
argument_list|(
name|w
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"h"
block|,
name|T_UINT
block|,
name|OFF
argument_list|(
name|h
argument_list|)
block|,
name|RO
block|}
block|,
block|{
literal|"dirty"
block|,
name|T_UINT
block|,
literal|0
comment|/*bitfield*/
block|,
name|RO
block|}
block|,
block|{
literal|"shadow"
block|,
name|T_UINT
block|,
literal|0
comment|/*bitfield*/
block|,
name|RO
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_undef
undef|#
directive|undef
name|OFF
end_undef

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pr_getattr (self,name)
name|pr_getattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|)
name|probject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|PyObject
modifier|*
name|rv
decl_stmt|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"drawable"
argument_list|)
condition|)
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newdrwobject
argument_list|(
name|self
operator|->
name|pr
operator|.
name|drawable
argument_list|,
literal|0
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"dirty"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|self
operator|->
name|pr
operator|.
name|dirty
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"shadow"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|self
operator|->
name|pr
operator|.
name|shadow
argument_list|)
return|;
name|rv
operator|=
name|PyMember_Get
argument_list|(
operator|(
name|char
operator|*
operator|)
operator|&
operator|(
name|self
operator|->
name|pr
operator|)
argument_list|,
name|pr_memberlist
argument_list|,
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|rv
condition|)
return|return
name|rv
return|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return
name|Py_FindMethod
argument_list|(
name|pr_methods
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|self
argument_list|,
name|name
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pr_repr (self)
name|pr_repr
parameter_list|(
name|self
parameter_list|)
name|probject
modifier|*
name|self
decl_stmt|;
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|PyString_FromString
argument_list|(
literal|"<pixel region for drawable "
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_drawable_name
argument_list|(
name|self
operator|->
name|pr
operator|.
name|drawable
operator|->
name|id
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
literal|">"
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|Prtype
specifier|static
name|PyTypeObject
name|Prtype
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
operator|&
name|PyType_Type
argument_list|)
literal|0
block|,
comment|/*ob_size*/
literal|"PixelRegion"
block|,
comment|/*tp_name*/
sizeof|sizeof
argument_list|(
name|probject
argument_list|)
block|,
comment|/*tp_basicsize*/
literal|0
block|,
comment|/*tp_itemsize*/
comment|/* methods */
operator|(
name|destructor
operator|)
name|pr_dealloc
block|,
comment|/*tp_dealloc*/
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/*tp_print*/
operator|(
name|getattrfunc
operator|)
name|pr_getattr
block|,
comment|/*tp_getattr*/
operator|(
name|setattrfunc
operator|)
literal|0
block|,
comment|/*tp_setattr*/
operator|(
name|cmpfunc
operator|)
literal|0
block|,
comment|/*tp_compare*/
operator|(
name|reprfunc
operator|)
name|pr_repr
block|,
comment|/*tp_repr*/
literal|0
block|,
comment|/*tp_as_number*/
literal|0
block|,
comment|/*tp_as_sequence*/
operator|&
name|pr_as_mapping
block|,
comment|/*tp_as_mapping*/
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/*tp_hash*/
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/*tp_call*/
operator|(
name|reprfunc
operator|)
literal|0
block|,
comment|/*tp_str*/
comment|/* Space for future expansion */
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
name|NULL
comment|/* Documentation string */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* End of code for PixelRegion objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
end_ifdef

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|para_copy (self,args)
name|para_copy
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|paraobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":copy"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newparaobject
argument_list|(
name|parasite_copy
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|para_is_type (self,args)
name|para_is_type
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|paraobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:is_type"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|parasite_is_type
argument_list|(
name|self
operator|->
name|para
argument_list|,
name|name
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|para_has_flag (self,args)
name|para_has_flag
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|paraobject
modifier|*
name|self
decl_stmt|;
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|flag
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:has_flag"
argument_list|,
operator|&
name|flag
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|parasite_has_flag
argument_list|(
name|self
operator|->
name|para
argument_list|,
name|flag
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|para_methods
specifier|static
name|struct
name|PyMethodDef
name|para_methods
index|[]
init|=
block|{
block|{
literal|"copy"
block|,
operator|(
name|PyCFunction
operator|)
name|para_copy
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"is_type"
block|,
operator|(
name|PyCFunction
operator|)
name|para_is_type
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"has_flag"
block|,
operator|(
name|PyCFunction
operator|)
name|para_has_flag
block|,
name|METH_VARARGS
block|}
block|,
block|{
name|NULL
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|paraobject
modifier|*
DECL|function|newparaobject (para)
name|newparaobject
parameter_list|(
name|para
parameter_list|)
name|Parasite
modifier|*
name|para
decl_stmt|;
block|{
name|paraobject
modifier|*
name|self
decl_stmt|;
if|if
condition|(
operator|!
name|para
condition|)
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
operator|(
name|paraobject
operator|*
operator|)
name|Py_None
return|;
block|}
name|self
operator|=
name|PyObject_NEW
argument_list|(
name|paraobject
argument_list|,
operator|&
name|Paratype
argument_list|)
expr_stmt|;
if|if
condition|(
name|self
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|self
operator|->
name|para
operator|=
name|para
expr_stmt|;
return|return
name|self
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|para_dealloc (self)
name|para_dealloc
parameter_list|(
name|self
parameter_list|)
name|paraobject
modifier|*
name|self
decl_stmt|;
block|{
name|parasite_free
argument_list|(
name|self
operator|->
name|para
argument_list|)
expr_stmt|;
name|PyMem_DEL
argument_list|(
name|self
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|para_getattr (self,name)
name|para_getattr
parameter_list|(
name|self
parameter_list|,
name|name
parameter_list|)
name|paraobject
modifier|*
name|self
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
block|{
name|PyObject
modifier|*
name|rv
decl_stmt|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"__members__"
argument_list|)
condition|)
block|{
if|#
directive|if
name|GIMP_CHECK_VERSION
argument_list|(
literal|1
operator|,
literal|1
operator|,
literal|5
argument_list|)
return|return
name|Py_BuildValue
argument_list|(
literal|"[sssss]"
argument_list|,
literal|"data"
argument_list|,
literal|"flags"
argument_list|,
literal|"is_persistent"
argument_list|,
literal|"is_undoable"
argument_list|,
literal|"name"
argument_list|)
return|;
else|#
directive|else
return|return
name|Py_BuildValue
argument_list|(
literal|"[ssss]"
argument_list|,
literal|"data"
argument_list|,
literal|"flags"
argument_list|,
literal|"is_persistent"
argument_list|,
literal|"name"
argument_list|)
return|;
endif|#
directive|endif
block|}
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_persistent"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|parasite_is_persistent
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|)
return|;
if|#
directive|if
name|GIMP_CHECK_VERSION
argument_list|(
literal|1
operator|,
literal|1
operator|,
literal|5
argument_list|)
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"is_undoable"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|parasite_is_undoable
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|)
return|;
endif|#
directive|endif
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"flags"
argument_list|)
condition|)
return|return
name|PyInt_FromLong
argument_list|(
name|parasite_flags
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"name"
argument_list|)
condition|)
return|return
name|PyString_FromString
argument_list|(
name|parasite_name
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|)
return|;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|name
argument_list|,
literal|"data"
argument_list|)
condition|)
return|return
name|PyString_FromStringAndSize
argument_list|(
name|parasite_data
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|,
name|parasite_data_size
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|)
return|;
return|return
name|Py_FindMethod
argument_list|(
name|para_methods
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|self
argument_list|,
name|name
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|para_repr (self)
name|para_repr
parameter_list|(
name|self
parameter_list|)
name|paraobject
modifier|*
name|self
decl_stmt|;
block|{
name|PyObject
modifier|*
name|s
decl_stmt|;
name|s
operator|=
name|PyString_FromString
argument_list|(
literal|"<parasite "
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
name|parasite_name
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|s
argument_list|,
name|PyString_FromString
argument_list|(
literal|">"
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|para_str (self)
name|para_str
parameter_list|(
name|self
parameter_list|)
name|paraobject
modifier|*
name|self
decl_stmt|;
block|{
return|return
name|PyString_FromStringAndSize
argument_list|(
name|parasite_data
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|,
name|parasite_data_size
argument_list|(
name|self
operator|->
name|para
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|Paratype
specifier|static
name|PyTypeObject
name|Paratype
init|=
block|{
name|PyObject_HEAD_INIT
argument_list|(
operator|&
name|PyType_Type
argument_list|)
literal|0
block|,
comment|/*ob_size*/
literal|"Parasite"
block|,
comment|/*tp_name*/
sizeof|sizeof
argument_list|(
name|paraobject
argument_list|)
block|,
comment|/*tp_basicsize*/
literal|0
block|,
comment|/*tp_itemsize*/
comment|/* methods */
operator|(
name|destructor
operator|)
name|para_dealloc
block|,
comment|/*tp_dealloc*/
operator|(
name|printfunc
operator|)
literal|0
block|,
comment|/*tp_print*/
operator|(
name|getattrfunc
operator|)
name|para_getattr
block|,
comment|/*tp_getattr*/
operator|(
name|setattrfunc
operator|)
literal|0
block|,
comment|/*tp_setattr*/
operator|(
name|cmpfunc
operator|)
literal|0
block|,
comment|/*tp_compare*/
operator|(
name|reprfunc
operator|)
name|para_repr
block|,
comment|/*tp_repr*/
literal|0
block|,
comment|/*tp_as_number*/
literal|0
block|,
comment|/*tp_as_sequence*/
literal|0
block|,
comment|/*tp_as_mapping*/
operator|(
name|hashfunc
operator|)
literal|0
block|,
comment|/*tp_hash*/
operator|(
name|ternaryfunc
operator|)
literal|0
block|,
comment|/*tp_call*/
operator|(
name|reprfunc
operator|)
name|para_str
block|,
comment|/*tp_str*/
comment|/* Space for future expansion */
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
literal|0L
block|,
name|NULL
comment|/* Documentation string */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* End of code for Parasite objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_endif
endif|#
directive|endif
end_endif

begin_decl_stmt
DECL|variable|PLUG_IN_INFO
name|GPlugInInfo
name|PLUG_IN_INFO
init|=
block|{
name|NULL
block|,
comment|/* init_proc */
name|NULL
block|,
comment|/* quit_proc */
name|NULL
block|,
comment|/* query_proc */
name|NULL
comment|/* run_proc */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|callbacks
specifier|static
name|PyObject
modifier|*
name|callbacks
index|[]
init|=
block|{
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

begin_function
DECL|function|pygimp_init_proc ()
specifier|static
name|void
name|pygimp_init_proc
parameter_list|()
block|{
name|PyObject
modifier|*
name|r
decl_stmt|;
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|callbacks
index|[
literal|0
index|]
argument_list|,
literal|"()"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|pygimp_quit_proc ()
specifier|static
name|void
name|pygimp_quit_proc
parameter_list|()
block|{
name|PyObject
modifier|*
name|r
decl_stmt|;
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|callbacks
index|[
literal|1
index|]
argument_list|,
literal|"()"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|pygimp_query_proc ()
specifier|static
name|void
name|pygimp_query_proc
parameter_list|()
block|{
name|PyObject
modifier|*
name|r
decl_stmt|;
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|callbacks
index|[
literal|2
index|]
argument_list|,
literal|"()"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|pygimp_run_proc (char * name,int nparams,GParam * params,int * nreturn_vals,GParam ** return_vals)
specifier|static
name|void
name|pygimp_run_proc
parameter_list|(
name|char
modifier|*
name|name
parameter_list|,
name|int
name|nparams
parameter_list|,
name|GParam
modifier|*
name|params
parameter_list|,
name|int
modifier|*
name|nreturn_vals
parameter_list|,
name|GParam
modifier|*
modifier|*
name|return_vals
parameter_list|)
block|{
name|PyObject
modifier|*
name|args
decl_stmt|,
modifier|*
name|ret
decl_stmt|;
name|GParamDef
modifier|*
name|pd
decl_stmt|,
modifier|*
name|rv
decl_stmt|;
name|char
modifier|*
name|b
decl_stmt|,
modifier|*
name|h
decl_stmt|,
modifier|*
name|a
decl_stmt|,
modifier|*
name|c
decl_stmt|,
modifier|*
name|d
decl_stmt|;
name|int
name|t
decl_stmt|,
name|np
decl_stmt|,
name|nrv
decl_stmt|;
name|gimp_query_procedure
argument_list|(
name|name
argument_list|,
operator|&
name|b
argument_list|,
operator|&
name|h
argument_list|,
operator|&
name|a
argument_list|,
operator|&
name|c
argument_list|,
operator|&
name|d
argument_list|,
operator|&
name|t
argument_list|,
operator|&
name|np
argument_list|,
operator|&
name|nrv
argument_list|,
operator|&
name|pd
argument_list|,
operator|&
name|rv
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|b
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|h
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|a
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|c
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|d
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|pd
argument_list|)
expr_stmt|;
if|#
directive|if
name|PG_DEBUG
operator|>
literal|0
name|fprintf
argument_list|(
name|stderr
argument_list|,
literal|"Params for %s:"
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|print_GParam
argument_list|(
name|nparams
argument_list|,
name|params
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|args
operator|=
name|GParam_to_tuple
argument_list|(
name|nparams
argument_list|,
name|params
argument_list|)
expr_stmt|;
if|if
condition|(
name|args
operator|==
name|NULL
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
literal|1
expr_stmt|;
operator|*
name|return_vals
operator|=
name|g_new
argument_list|(
name|GParam
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|PARAM_STATUS
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|STATUS_CALLING_ERROR
expr_stmt|;
return|return;
block|}
name|ret
operator|=
name|PyObject_CallFunction
argument_list|(
name|callbacks
index|[
literal|3
index|]
argument_list|,
literal|"(sO)"
argument_list|,
name|name
argument_list|,
name|args
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|==
name|NULL
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
literal|1
expr_stmt|;
operator|*
name|return_vals
operator|=
name|g_new
argument_list|(
name|GParam
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|PARAM_STATUS
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|STATUS_EXECUTION_ERROR
expr_stmt|;
return|return;
block|}
operator|*
name|return_vals
operator|=
name|tuple_to_GParam
argument_list|(
name|ret
argument_list|,
name|rv
argument_list|,
name|nrv
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|rv
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|return_vals
operator|==
name|NULL
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
literal|1
expr_stmt|;
operator|*
name|return_vals
operator|=
name|g_new
argument_list|(
name|GParam
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|PARAM_STATUS
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|STATUS_EXECUTION_ERROR
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|ret
argument_list|)
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
name|nrv
operator|+
literal|1
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|PARAM_STATUS
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|STATUS_SUCCESS
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Main (self,args)
name|gimp_Main
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|PyObject
modifier|*
name|av
decl_stmt|;
name|int
name|argc
decl_stmt|,
name|i
decl_stmt|;
name|char
modifier|*
modifier|*
name|argv
decl_stmt|;
name|PyObject
modifier|*
name|ip
decl_stmt|,
modifier|*
name|qp
decl_stmt|,
modifier|*
name|query
decl_stmt|,
modifier|*
name|rp
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"OOOO:main"
argument_list|,
operator|&
name|ip
argument_list|,
operator|&
name|qp
argument_list|,
operator|&
name|query
argument_list|,
operator|&
name|rp
argument_list|)
condition|)
return|return
name|NULL
return|;
DECL|macro|Arg_Check (v)
define|#
directive|define
name|Arg_Check
parameter_list|(
name|v
parameter_list|)
value|(PyCallable_Check(v) || (v) == Py_None)
if|if
condition|(
operator|!
name|Arg_Check
argument_list|(
name|ip
argument_list|)
operator|||
operator|!
name|Arg_Check
argument_list|(
name|qp
argument_list|)
operator|||
operator|!
name|Arg_Check
argument_list|(
name|query
argument_list|)
operator|||
operator|!
name|Arg_Check
argument_list|(
name|rp
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"arguments must be callable."
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|ip
operator|!=
name|Py_None
condition|)
block|{
name|callbacks
index|[
literal|0
index|]
operator|=
name|ip
expr_stmt|;
name|PLUG_IN_INFO
operator|.
name|init_proc
operator|=
name|pygimp_init_proc
expr_stmt|;
block|}
if|if
condition|(
name|qp
operator|!=
name|Py_None
condition|)
block|{
name|callbacks
index|[
literal|1
index|]
operator|=
name|qp
expr_stmt|;
name|PLUG_IN_INFO
operator|.
name|quit_proc
operator|=
name|pygimp_quit_proc
expr_stmt|;
block|}
if|if
condition|(
name|query
operator|!=
name|Py_None
condition|)
block|{
name|callbacks
index|[
literal|2
index|]
operator|=
name|query
expr_stmt|;
name|PLUG_IN_INFO
operator|.
name|query_proc
operator|=
name|pygimp_query_proc
expr_stmt|;
block|}
if|if
condition|(
name|rp
operator|!=
name|Py_None
condition|)
block|{
name|callbacks
index|[
literal|3
index|]
operator|=
name|rp
expr_stmt|;
name|PLUG_IN_INFO
operator|.
name|run_proc
operator|=
name|pygimp_run_proc
expr_stmt|;
block|}
name|av
operator|=
name|PySys_GetObject
argument_list|(
literal|"argv"
argument_list|)
expr_stmt|;
name|argc
operator|=
name|PyList_Size
argument_list|(
name|av
argument_list|)
expr_stmt|;
name|argv
operator|=
name|g_new
argument_list|(
name|char
operator|*
argument_list|,
name|argc
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|argc
condition|;
name|i
operator|++
control|)
name|argv
index|[
name|i
index|]
operator|=
name|g_strdup
argument_list|(
name|PyString_AsString
argument_list|(
name|PyList_GetItem
argument_list|(
name|av
argument_list|,
name|i
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|gimp_main
argument_list|(
name|argc
argument_list|,
name|argv
argument_list|)
expr_stmt|;
if|if
condition|(
name|argv
operator|!=
name|NULL
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|argc
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|argv
index|[
name|i
index|]
operator|!=
name|NULL
condition|)
name|g_free
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|argv
argument_list|)
expr_stmt|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Quit (self,args)
name|gimp_Quit
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":quit"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_quit
argument_list|()
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Set_data (self,args)
name|gimp_Set_data
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|id
decl_stmt|,
modifier|*
name|data
decl_stmt|;
name|int
name|bytes
decl_stmt|,
name|nreturn_vals
decl_stmt|;
name|GParam
modifier|*
name|return_vals
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ss#:set_data"
argument_list|,
operator|&
name|id
argument_list|,
operator|&
name|data
argument_list|,
operator|&
name|bytes
argument_list|)
condition|)
return|return
name|NULL
return|;
name|return_vals
operator|=
name|gimp_run_procedure
argument_list|(
literal|"gimp_procedural_db_set_data"
argument_list|,
operator|&
name|nreturn_vals
argument_list|,
name|PARAM_STRING
argument_list|,
name|id
argument_list|,
name|PARAM_INT32
argument_list|,
name|bytes
argument_list|,
name|PARAM_INT8ARRAY
argument_list|,
name|data
argument_list|,
name|PARAM_END
argument_list|)
expr_stmt|;
if|if
condition|(
name|return_vals
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|!=
name|STATUS_SUCCESS
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"error occurred while storing"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|gimp_destroy_params
argument_list|(
name|return_vals
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Get_data (self,args)
name|gimp_Get_data
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|id
decl_stmt|;
name|int
name|nreturn_vals
decl_stmt|;
name|GParam
modifier|*
name|return_vals
decl_stmt|;
name|PyObject
modifier|*
name|s
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:get_data"
argument_list|,
operator|&
name|id
argument_list|)
condition|)
return|return
name|NULL
return|;
name|return_vals
operator|=
name|gimp_run_procedure
argument_list|(
literal|"gimp_procedural_db_get_data"
argument_list|,
operator|&
name|nreturn_vals
argument_list|,
name|PARAM_STRING
argument_list|,
name|id
argument_list|,
name|PARAM_END
argument_list|)
expr_stmt|;
if|if
condition|(
name|return_vals
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|!=
name|STATUS_SUCCESS
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|ErrorObject
argument_list|,
literal|"no data for id"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|s
operator|=
name|PyString_FromStringAndSize
argument_list|(
operator|(
name|char
operator|*
operator|)
name|return_vals
index|[
literal|2
index|]
operator|.
name|data
operator|.
name|d_int8array
argument_list|,
name|return_vals
index|[
literal|1
index|]
operator|.
name|data
operator|.
name|d_int32
argument_list|)
expr_stmt|;
name|gimp_destroy_params
argument_list|(
name|return_vals
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Progress_init (self,args)
name|gimp_Progress_init
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|msg
init|=
name|NULL
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"|s:progress_init"
argument_list|,
operator|&
name|msg
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_progress_init
argument_list|(
name|msg
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Progress_update (self,args)
name|gimp_Progress_update
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|double
name|p
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"d:progress_update"
argument_list|,
operator|&
name|p
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_progress_update
argument_list|(
name|p
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Query_images (self,args)
name|gimp_Query_images
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|gint32
modifier|*
name|imgs
decl_stmt|;
name|int
name|nimgs
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":query_images"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|imgs
operator|=
name|gimp_query_images
argument_list|(
operator|&
name|nimgs
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|nimgs
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nimgs
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newimgobject
argument_list|(
name|imgs
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Install_procedure (self,args)
name|gimp_Install_procedure
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|blurb
decl_stmt|,
modifier|*
name|help
decl_stmt|,
modifier|*
name|author
decl_stmt|,
modifier|*
name|copyright
decl_stmt|,
modifier|*
name|date
decl_stmt|,
modifier|*
name|menu_path
decl_stmt|,
modifier|*
name|image_types
decl_stmt|,
modifier|*
name|n
decl_stmt|,
modifier|*
name|d
decl_stmt|;
name|GParamDef
modifier|*
name|params
decl_stmt|,
modifier|*
name|return_vals
decl_stmt|;
name|int
name|type
decl_stmt|,
name|nparams
decl_stmt|,
name|nreturn_vals
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|pars
decl_stmt|,
modifier|*
name|rets
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sssssszziOO:install_procedure"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|blurb
argument_list|,
operator|&
name|help
argument_list|,
operator|&
name|author
argument_list|,
operator|&
name|copyright
argument_list|,
operator|&
name|date
argument_list|,
operator|&
name|menu_path
argument_list|,
operator|&
name|image_types
argument_list|,
operator|&
name|type
argument_list|,
operator|&
name|pars
argument_list|,
operator|&
name|rets
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|pars
argument_list|)
operator|||
operator|!
name|PySequence_Check
argument_list|(
name|rets
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"last two args must be sequences"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|nparams
operator|=
name|PySequence_Length
argument_list|(
name|pars
argument_list|)
expr_stmt|;
name|nreturn_vals
operator|=
name|PySequence_Length
argument_list|(
name|rets
argument_list|)
expr_stmt|;
name|params
operator|=
name|g_new
argument_list|(
name|GParamDef
argument_list|,
name|nparams
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nparams
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|PySequence_GetItem
argument_list|(
name|pars
argument_list|,
name|i
argument_list|)
argument_list|,
literal|"iss"
argument_list|,
operator|&
operator|(
name|params
index|[
name|i
index|]
operator|.
name|type
operator|)
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|d
argument_list|)
condition|)
block|{
name|g_free
argument_list|(
name|params
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|params
index|[
name|i
index|]
operator|.
name|name
operator|=
name|g_strdup
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|params
index|[
name|i
index|]
operator|.
name|description
operator|=
name|g_strdup
argument_list|(
name|d
argument_list|)
expr_stmt|;
block|}
name|return_vals
operator|=
name|g_new
argument_list|(
name|GParamDef
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nreturn_vals
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|PySequence_GetItem
argument_list|(
name|rets
argument_list|,
name|i
argument_list|)
argument_list|,
literal|"iss"
argument_list|,
operator|&
operator|(
name|return_vals
index|[
name|i
index|]
operator|.
name|type
operator|)
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|d
argument_list|)
condition|)
block|{
name|g_free
argument_list|(
name|params
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|return_vals
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|return_vals
index|[
name|i
index|]
operator|.
name|name
operator|=
name|g_strdup
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|return_vals
index|[
name|i
index|]
operator|.
name|description
operator|=
name|g_strdup
argument_list|(
name|d
argument_list|)
expr_stmt|;
block|}
name|gimp_install_procedure
argument_list|(
name|name
argument_list|,
name|blurb
argument_list|,
name|help
argument_list|,
name|author
argument_list|,
name|copyright
argument_list|,
name|date
argument_list|,
name|menu_path
argument_list|,
name|image_types
argument_list|,
name|type
argument_list|,
name|nparams
argument_list|,
name|nreturn_vals
argument_list|,
name|params
argument_list|,
name|return_vals
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Install_temp_proc (self,args)
name|gimp_Install_temp_proc
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|blurb
decl_stmt|,
modifier|*
name|help
decl_stmt|,
modifier|*
name|author
decl_stmt|,
modifier|*
name|copyright
decl_stmt|,
modifier|*
name|date
decl_stmt|,
modifier|*
name|menu_path
decl_stmt|,
modifier|*
name|image_types
decl_stmt|,
modifier|*
name|n
decl_stmt|,
modifier|*
name|d
decl_stmt|;
name|GParamDef
modifier|*
name|params
decl_stmt|,
modifier|*
name|return_vals
decl_stmt|;
name|int
name|type
decl_stmt|,
name|nparams
decl_stmt|,
name|nreturn_vals
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|pars
decl_stmt|,
modifier|*
name|rets
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sssssszziOO:install_temp_proc"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|blurb
argument_list|,
operator|&
name|help
argument_list|,
operator|&
name|author
argument_list|,
operator|&
name|copyright
argument_list|,
operator|&
name|date
argument_list|,
operator|&
name|menu_path
argument_list|,
operator|&
name|image_types
argument_list|,
operator|&
name|type
argument_list|,
operator|&
name|pars
argument_list|,
operator|&
name|rets
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|pars
argument_list|)
operator|||
operator|!
name|PySequence_Check
argument_list|(
name|rets
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"last two args must be sequences"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|nparams
operator|=
name|PySequence_Length
argument_list|(
name|pars
argument_list|)
expr_stmt|;
name|nreturn_vals
operator|=
name|PySequence_Length
argument_list|(
name|rets
argument_list|)
expr_stmt|;
name|params
operator|=
name|g_new
argument_list|(
name|GParamDef
argument_list|,
name|nparams
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nparams
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|PySequence_GetItem
argument_list|(
name|pars
argument_list|,
name|i
argument_list|)
argument_list|,
literal|"iss"
argument_list|,
operator|&
operator|(
name|params
index|[
name|i
index|]
operator|.
name|type
operator|)
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|d
argument_list|)
condition|)
block|{
name|g_free
argument_list|(
name|params
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|params
index|[
name|i
index|]
operator|.
name|name
operator|=
name|g_strdup
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|params
index|[
name|i
index|]
operator|.
name|description
operator|=
name|g_strdup
argument_list|(
name|d
argument_list|)
expr_stmt|;
block|}
name|return_vals
operator|=
name|g_new
argument_list|(
name|GParamDef
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nreturn_vals
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|PySequence_GetItem
argument_list|(
name|rets
argument_list|,
name|i
argument_list|)
argument_list|,
literal|"iss"
argument_list|,
operator|&
operator|(
name|return_vals
index|[
name|i
index|]
operator|.
name|type
operator|)
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|d
argument_list|)
condition|)
block|{
name|g_free
argument_list|(
name|params
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|return_vals
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|return_vals
index|[
name|i
index|]
operator|.
name|name
operator|=
name|g_strdup
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|return_vals
index|[
name|i
index|]
operator|.
name|description
operator|=
name|g_strdup
argument_list|(
name|d
argument_list|)
expr_stmt|;
block|}
name|gimp_install_temp_proc
argument_list|(
name|name
argument_list|,
name|blurb
argument_list|,
name|help
argument_list|,
name|author
argument_list|,
name|copyright
argument_list|,
name|date
argument_list|,
name|menu_path
argument_list|,
name|image_types
argument_list|,
name|type
argument_list|,
name|nparams
argument_list|,
name|nreturn_vals
argument_list|,
name|params
argument_list|,
name|return_vals
argument_list|,
name|pygimp_run_proc
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Uninstall_temp_proc (self,args)
name|gimp_Uninstall_temp_proc
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:uninstall_temp_proc"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_uninstall_temp_proc
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Register_magic_load_handler (self,args)
name|gimp_Register_magic_load_handler
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|extensions
decl_stmt|,
modifier|*
name|prefixes
decl_stmt|,
modifier|*
name|magics
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ssss:register_magic_load_handler"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|extensions
argument_list|,
operator|&
name|prefixes
argument_list|,
operator|&
name|magics
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_register_magic_load_handler
argument_list|(
name|name
argument_list|,
name|extensions
argument_list|,
name|prefixes
argument_list|,
name|magics
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Register_load_handler (self,args)
name|gimp_Register_load_handler
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|extensions
decl_stmt|,
modifier|*
name|prefixes
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sss:register_load_handler"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|extensions
argument_list|,
operator|&
name|prefixes
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_register_load_handler
argument_list|(
name|name
argument_list|,
name|extensions
argument_list|,
name|prefixes
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Register_save_handler (self,args)
name|gimp_Register_save_handler
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|extensions
decl_stmt|,
modifier|*
name|prefixes
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sss:register_save_handler"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|extensions
argument_list|,
operator|&
name|prefixes
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_register_save_handler
argument_list|(
name|name
argument_list|,
name|extensions
argument_list|,
name|prefixes
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Gamma (self,args)
name|gimp_Gamma
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":gamma"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyFloat_FromDouble
argument_list|(
name|gimp_gamma
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Install_cmap (self,args)
name|gimp_Install_cmap
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":install_cmap"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_install_cmap
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Use_xshm (self,args)
name|gimp_Use_xshm
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":use_xshm"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_use_xshm
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Color_cube (self,args)
name|gimp_Color_cube
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":color_cube"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyString_FromString
argument_list|(
name|gimp_color_cube
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Gtkrc (self,args)
name|gimp_Gtkrc
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":gtkrc"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyString_FromString
argument_list|(
name|gimp_gtkrc
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Get_background (self,args)
name|gimp_Get_background
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|guchar
name|r
decl_stmt|,
name|g
decl_stmt|,
name|b
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":get_background"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_palette_get_background
argument_list|(
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(iii)"
argument_list|,
operator|(
name|int
operator|)
name|r
argument_list|,
operator|(
name|int
operator|)
name|g
argument_list|,
operator|(
name|int
operator|)
name|b
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Get_foreground (self,args)
name|gimp_Get_foreground
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|guchar
name|r
decl_stmt|,
name|g
decl_stmt|,
name|b
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":get_foreground"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_palette_get_foreground
argument_list|(
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(iii)"
argument_list|,
operator|(
name|int
operator|)
name|r
argument_list|,
operator|(
name|int
operator|)
name|g
argument_list|,
operator|(
name|int
operator|)
name|b
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Set_background (self,args)
name|gimp_Set_background
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|r
decl_stmt|,
name|g
decl_stmt|,
name|b
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"(iii):set_background"
argument_list|,
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iii:set_background"
argument_list|,
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
condition|)
return|return
name|NULL
return|;
block|}
name|gimp_palette_set_background
argument_list|(
name|r
argument_list|,
name|g
argument_list|,
name|b
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Set_foreground (self,args)
name|gimp_Set_foreground
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|r
decl_stmt|,
name|g
decl_stmt|,
name|b
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"(iii):set_foreground"
argument_list|,
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iii:set_foreground"
argument_list|,
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
condition|)
return|return
name|NULL
return|;
block|}
name|gimp_palette_set_foreground
argument_list|(
name|r
argument_list|,
name|g
argument_list|,
name|b
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Gradients_get_list (self,args)
name|gimp_Gradients_get_list
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
modifier|*
name|list
decl_stmt|;
name|int
name|num
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":gradients_get_list"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|list
operator|=
name|gimp_gradients_get_list
argument_list|(
operator|&
name|num
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|PyString_FromString
argument_list|(
name|list
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|list
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Gradients_get_active (self,args)
name|gimp_Gradients_get_active
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":gradients_get_active"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyString_FromString
argument_list|(
name|gimp_gradients_get_active
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Gradients_set_active (self,args)
name|gimp_Gradients_set_active
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|char
modifier|*
name|actv
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:gradients_set_active"
argument_list|,
operator|&
name|actv
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_gradients_set_active
argument_list|(
name|actv
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Gradients_sample_uniform (self,args)
name|gimp_Gradients_sample_uniform
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|num
decl_stmt|,
name|i
decl_stmt|,
name|j
decl_stmt|;
name|double
modifier|*
name|samp
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:gradients_sample_uniform"
argument_list|,
operator|&
name|num
argument_list|)
condition|)
return|return
name|NULL
return|;
name|samp
operator|=
name|gimp_gradients_sample_uniform
argument_list|(
name|num
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
operator|,
name|j
operator|+=
literal|4
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|Py_BuildValue
argument_list|(
literal|"(dddd)"
argument_list|,
name|samp
index|[
name|j
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|1
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|2
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|3
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|samp
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Gradients_sample_custom (self,args)
name|gimp_Gradients_sample_custom
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|;
comment|/* Not used */
name|PyObject
modifier|*
name|args
decl_stmt|;
block|{
name|int
name|num
decl_stmt|,
name|i
decl_stmt|,
name|j
decl_stmt|;
name|double
modifier|*
name|pos
decl_stmt|,
modifier|*
name|samp
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|,
modifier|*
name|item
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O:gradients_sample_custom"
argument_list|,
operator|&
name|ret
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|ret
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"second arg must be a sequence"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|num
operator|=
name|PySequence_Length
argument_list|(
name|ret
argument_list|)
expr_stmt|;
name|pos
operator|=
name|g_new
argument_list|(
name|gdouble
argument_list|,
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
control|)
block|{
name|item
operator|=
name|PySequence_GetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|PyFloat_Check
argument_list|(
name|item
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"second arg must be a sequence of floats"
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|pos
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|pos
index|[
name|i
index|]
operator|=
name|PyFloat_AsDouble
argument_list|(
name|item
argument_list|)
expr_stmt|;
block|}
name|samp
operator|=
name|gimp_gradients_sample_custom
argument_list|(
name|num
argument_list|,
name|pos
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|pos
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
operator|,
name|j
operator|+=
literal|4
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|Py_BuildValue
argument_list|(
literal|"(dddd)"
argument_list|,
name|samp
index|[
name|j
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|1
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|2
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|3
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|samp
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_image (self,args)
name|gimp_image
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|unsigned
name|int
name|width
decl_stmt|,
name|height
decl_stmt|;
name|GImageType
name|type
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"iii:image"
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|,
operator|&
name|type
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newimgobject
argument_list|(
name|gimp_image_new
argument_list|(
name|width
argument_list|,
name|height
argument_list|,
name|type
argument_list|)
argument_list|)
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_layer (self,args)
name|gimp_layer
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|drwobject
modifier|*
name|drw
decl_stmt|;
name|imgobject
modifier|*
name|img
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
name|unsigned
name|int
name|width
decl_stmt|,
name|height
decl_stmt|;
name|GDrawableType
name|type
decl_stmt|;
name|double
name|opacity
decl_stmt|;
name|GLayerMode
name|mode
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!siiidi:layer"
argument_list|,
operator|&
name|Imgtype
argument_list|,
operator|&
name|img
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|,
operator|&
name|type
argument_list|,
operator|&
name|opacity
argument_list|,
operator|&
name|mode
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newlayobject
argument_list|(
name|gimp_layer_new
argument_list|(
name|img
operator|->
name|ID
argument_list|,
name|name
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|type
argument_list|,
name|opacity
argument_list|,
name|mode
argument_list|)
argument_list|)
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_channel (self,args)
name|gimp_channel
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|drwobject
modifier|*
name|drw
decl_stmt|;
name|imgobject
modifier|*
name|img
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
name|unsigned
name|int
name|width
decl_stmt|,
name|height
decl_stmt|,
name|r
decl_stmt|,
name|g
decl_stmt|,
name|b
decl_stmt|;
name|double
name|opacity
decl_stmt|;
name|unsigned
name|char
name|colour
index|[
literal|3
index|]
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!siid(iii):channel"
argument_list|,
operator|&
name|Imgtype
argument_list|,
operator|&
name|img
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|,
operator|&
name|opacity
argument_list|,
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
condition|)
return|return
name|NULL
return|;
name|colour
index|[
literal|0
index|]
operator|=
name|r
operator|&
literal|0xff
expr_stmt|;
name|colour
index|[
literal|1
index|]
operator|=
name|g
operator|&
literal|0xff
expr_stmt|;
name|colour
index|[
literal|2
index|]
operator|=
name|b
operator|&
literal|0xff
expr_stmt|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newchnobject
argument_list|(
name|gimp_channel_new
argument_list|(
name|img
operator|->
name|ID
argument_list|,
name|name
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|opacity
argument_list|,
name|colour
argument_list|)
argument_list|)
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_display (self,args)
name|gimp_display
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|imgobject
modifier|*
name|img
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:display"
argument_list|,
operator|&
name|Imgtype
argument_list|,
operator|&
name|img
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newdispobject
argument_list|(
name|gimp_display_new
argument_list|(
name|img
operator|->
name|ID
argument_list|)
argument_list|)
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_delete (self,args)
name|gimp_delete
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|imgobject
modifier|*
name|img
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O:delete"
argument_list|,
operator|&
name|img
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|img_check
argument_list|(
name|img
argument_list|)
condition|)
name|gimp_image_delete
argument_list|(
name|img
operator|->
name|ID
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|lay_check
argument_list|(
name|img
argument_list|)
condition|)
name|gimp_layer_delete
argument_list|(
name|img
operator|->
name|ID
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|chn_check
argument_list|(
name|img
argument_list|)
condition|)
name|gimp_channel_delete
argument_list|(
name|img
operator|->
name|ID
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|disp_check
argument_list|(
name|img
argument_list|)
condition|)
name|gimp_display_delete
argument_list|(
name|img
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Displays_flush (self,args)
name|gimp_Displays_flush
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":flush"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_displays_flush
argument_list|()
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Tile_cache_size (self,args)
name|gimp_Tile_cache_size
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|unsigned
name|long
name|k
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"l:tile_cache_size"
argument_list|,
operator|&
name|k
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_tile_cache_size
argument_list|(
name|k
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Tile_cache_ntiles (self,args)
name|gimp_Tile_cache_ntiles
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|unsigned
name|long
name|n
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"l:tile_cache_ntiles"
argument_list|,
operator|&
name|n
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_tile_cache_ntiles
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Tile_width (self,args)
name|gimp_Tile_width
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
if|if
condition|(
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":tile_width"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_tile_width
argument_list|()
argument_list|)
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Tile_height (self,args)
name|gimp_Tile_height
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
if|if
condition|(
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":tile_height"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_tile_height
argument_list|()
argument_list|)
return|;
block|}
end_block

begin_function_decl
name|void
name|gimp_extension_ack
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|gimp_extension_process
parameter_list|(
name|guint
name|timeout
parameter_list|)
function_decl|;
end_function_decl

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Extension_ack (self,args)
name|gimp_Extension_ack
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":extension_ack"
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_extension_ack
argument_list|()
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Extension_process (self,args)
name|gimp_Extension_process
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|int
name|timeout
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:extension_process"
argument_list|,
operator|&
name|timeout
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_extension_process
argument_list|(
name|timeout
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_ifdef
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
end_ifdef

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|new_parasite (self,args)
name|new_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|data
decl_stmt|;
name|int
name|flags
decl_stmt|,
name|size
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sis#:parasite"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|flags
argument_list|,
operator|&
name|data
argument_list|,
operator|&
name|size
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newparaobject
argument_list|(
name|parasite_new
argument_list|(
name|name
argument_list|,
name|flags
argument_list|,
name|size
argument_list|,
name|data
argument_list|)
argument_list|)
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Find_parasite (self,args)
name|gimp_Find_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:find_parasite"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newparaobject
argument_list|(
name|gimp_parasite_find
argument_list|(
name|name
argument_list|)
argument_list|)
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Attach_parasite (self,args)
name|gimp_Attach_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|paraobject
modifier|*
name|parasite
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:attach_parasite"
argument_list|,
operator|&
name|Paratype
argument_list|,
operator|&
name|parasite
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_parasite_attach
argument_list|(
name|parasite
operator|->
name|para
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Attach_new_parasite (self,args)
name|gimp_Attach_new_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|data
decl_stmt|;
name|int
name|flags
decl_stmt|,
name|size
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sis#:attach_new_parasite"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|flags
argument_list|,
operator|&
name|data
argument_list|,
operator|&
name|size
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_attach_new_parasite
argument_list|(
name|name
argument_list|,
name|flags
argument_list|,
name|size
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Detach_parasite (self,args)
name|gimp_Detach_parasite
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:detach_parasite"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_parasite_detach
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_endif
endif|#
directive|endif
end_endif

begin_ifdef
ifdef|#
directive|ifdef
name|GIMP_HAVE_DEFAULT_DISPLAY
end_ifdef

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|gimp_Default_display (self,args)
name|gimp_Default_display
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|":default_display"
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newdispobject
argument_list|(
name|gimp_default_display
argument_list|()
argument_list|)
return|;
block|}
end_block

begin_endif
endif|#
directive|endif
end_endif

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|id2image (self,args)
name|id2image
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|int
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:_id2image"
argument_list|,
operator|&
name|id
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|id
operator|>=
literal|0
condition|)
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newimgobject
argument_list|(
name|id
argument_list|)
return|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|id2drawable (self,args)
name|id2drawable
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|int
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:_id2drawable"
argument_list|,
operator|&
name|id
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|id
operator|>=
literal|0
condition|)
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newdrwobject
argument_list|(
name|NULL
argument_list|,
name|id
argument_list|)
return|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|id2display (self,args)
name|id2display
parameter_list|(
name|self
parameter_list|,
name|args
parameter_list|)
name|PyObject
modifier|*
name|self
decl_stmt|,
decl|*
name|args
decl_stmt|;
end_function

begin_block
block|{
name|int
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:_id2display"
argument_list|,
operator|&
name|id
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|id
operator|>=
literal|0
condition|)
return|return
operator|(
name|PyObject
operator|*
operator|)
name|newdispobject
argument_list|(
name|id
argument_list|)
return|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_block

begin_comment
comment|/* List of methods defined in the module */
end_comment

begin_decl_stmt
DECL|variable|gimp_methods
specifier|static
name|struct
name|PyMethodDef
name|gimp_methods
index|[]
init|=
block|{
block|{
literal|"main"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Main
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"quit"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Quit
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_data"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Set_data
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_data"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Get_data
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"progress_init"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Progress_init
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"progress_update"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Progress_update
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"query_images"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Query_images
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"install_procedure"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Install_procedure
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"install_temp_proc"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Install_temp_proc
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"uninstall_temp_proc"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Uninstall_temp_proc
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"register_magic_load_handler"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Register_magic_load_handler
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"register_load_handler"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Register_load_handler
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"register_save_handler"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Register_save_handler
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gamma"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Gamma
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"install_cmap"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Install_cmap
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"use_xshm"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Use_xshm
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"color_cube"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Color_cube
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"colour_cube"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Color_cube
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gtkrc"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Gtkrc
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_background"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Get_background
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_foreground"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Get_foreground
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_background"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Set_background
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_foreground"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Set_foreground
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradients_get_list"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Gradients_get_list
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradients_get_active"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Gradients_get_active
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradients_set_active"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Gradients_set_active
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradients_sample_uniform"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Gradients_sample_uniform
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradients_sample_custom"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Gradients_sample_custom
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"image"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_image
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"layer"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_layer
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"channel"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_channel
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"display"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_display
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"delete"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_delete
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"displays_flush"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Displays_flush
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"tile_cache_size"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Tile_cache_size
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"tile_cache_ntiles"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Tile_cache_ntiles
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"tile_width"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Tile_width
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"tile_height"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Tile_height
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"extension_ack"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Extension_ack
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"extension_process"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Extension_process
block|,
name|METH_VARARGS
block|}
block|,
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
block|{
literal|"parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|new_parasite
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"find_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Find_parasite
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"attach_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Attach_parasite
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"attach_new_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Attach_new_parasite
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"detach_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Detach_parasite
block|,
name|METH_VARARGS
block|}
block|,
endif|#
directive|endif
ifdef|#
directive|ifdef
name|GIMP_HAVE_DEFAULT_DISPLAY
block|{
literal|"default_display"
block|,
operator|(
name|PyCFunction
operator|)
name|gimp_Default_display
block|,
name|METH_VARARGS
block|}
block|,
endif|#
directive|endif
block|{
literal|"_id2image"
block|,
operator|(
name|PyCFunction
operator|)
name|id2image
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"_id2drawable"
block|,
operator|(
name|PyCFunction
operator|)
name|id2drawable
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"_id2display"
block|,
operator|(
name|PyCFunction
operator|)
name|id2display
block|,
name|METH_VARARGS
block|}
block|,
block|{
name|NULL
block|,
operator|(
name|PyCFunction
operator|)
name|NULL
block|,
literal|0
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Initialization function for the module (*must* be called initgimp) */
end_comment

begin_decl_stmt
DECL|variable|gimp_module_documentation
specifier|static
name|char
name|gimp_module_documentation
index|[]
init|=
literal|""
decl_stmt|;
end_decl_stmt

begin_function
name|void
DECL|function|initgimp ()
name|initgimp
parameter_list|()
block|{
name|PyObject
modifier|*
name|m
decl_stmt|,
modifier|*
name|d
decl_stmt|;
name|PyObject
modifier|*
name|i
decl_stmt|;
comment|/* Create the module and add the functions */
name|m
operator|=
name|Py_InitModule4
argument_list|(
literal|"gimp"
argument_list|,
name|gimp_methods
argument_list|,
name|gimp_module_documentation
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|NULL
argument_list|,
name|PYTHON_API_VERSION
argument_list|)
expr_stmt|;
comment|/* Add some symbolic constants to the module */
name|d
operator|=
name|PyModule_GetDict
argument_list|(
name|m
argument_list|)
expr_stmt|;
name|ErrorObject
operator|=
name|PyString_FromString
argument_list|(
literal|"gimp.error"
argument_list|)
expr_stmt|;
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"error"
argument_list|,
name|ErrorObject
argument_list|)
expr_stmt|;
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"pdb"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|newpdbobject
argument_list|()
argument_list|)
expr_stmt|;
comment|/* export the types used in gimpmodule */
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"ImageType"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|Imgtype
argument_list|)
expr_stmt|;
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"LayerType"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|Laytype
argument_list|)
expr_stmt|;
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"ChannelType"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|Chntype
argument_list|)
expr_stmt|;
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"DisplayType"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|Disptype
argument_list|)
expr_stmt|;
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"TileType"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|Tiletype
argument_list|)
expr_stmt|;
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"PixelRegionType"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|Prtype
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|GIMP_HAVE_PARASITES
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"ParasiteType"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|Paratype
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"major_version"
argument_list|,
name|i
operator|=
name|PyInt_FromLong
argument_list|(
name|gimp_major_version
argument_list|)
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|i
argument_list|)
expr_stmt|;
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"minor_version"
argument_list|,
name|i
operator|=
name|PyInt_FromLong
argument_list|(
name|gimp_minor_version
argument_list|)
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|i
argument_list|)
expr_stmt|;
name|PyDict_SetItemString
argument_list|(
name|d
argument_list|,
literal|"micro_version"
argument_list|,
name|i
operator|=
name|PyInt_FromLong
argument_list|(
name|gimp_micro_version
argument_list|)
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|i
argument_list|)
expr_stmt|;
comment|/* Check for errors */
if|if
condition|(
name|PyErr_Occurred
argument_list|()
condition|)
name|Py_FatalError
argument_list|(
literal|"can't initialize module gimp"
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

