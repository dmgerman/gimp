begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* -*- Mode: C; c-basic-offset: 4 -*-  * Gimp-Python - allows the writing of Gimp plugins in Python.  * Copyright (C) 1997-2002  James Henstridge<james@daa.com.au>  *  * This program is free software: you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 3 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program.  If not, see<http://www.gnu.org/licenses/>.  */
end_comment

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_CONFIG_H
end_ifdef

begin_include
include|#
directive|include
file|<config.h>
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_undef
undef|#
directive|undef
name|GIMP_DISABLE_DEPRECATED
end_undef

begin_include
include|#
directive|include
file|"pygimp.h"
end_include

begin_include
include|#
directive|include
file|"pygimpcolor-api.h"
end_include

begin_include
include|#
directive|include
file|<sysmodule.h>
end_include

begin_include
include|#
directive|include
file|<glib-object.h>
end_include

begin_include
include|#
directive|include
file|<pygobject.h>
end_include

begin_include
include|#
directive|include
file|"pygimp-util.h"
end_include

begin_include
include|#
directive|include
file|"pygimp-intl.h"
end_include

begin_decl_stmt
DECL|variable|pygimp_error
name|PyObject
modifier|*
name|pygimp_error
decl_stmt|;
end_decl_stmt

begin_ifndef
ifndef|#
directive|ifndef
name|PG_DEBUG
end_ifndef

begin_define
DECL|macro|PG_DEBUG
define|#
directive|define
name|PG_DEBUG
value|0
end_define

begin_endif
endif|#
directive|endif
end_endif

begin_comment
comment|/* End of code for pdbFunc objects */
end_comment

begin_comment
comment|/* -------------------------------------------------------- */
end_comment

begin_decl_stmt
DECL|variable|PLUG_IN_INFO
name|GimpPlugInInfo
name|PLUG_IN_INFO
init|=
block|{
name|NULL
block|,
comment|/* init_proc */
name|NULL
block|,
comment|/* quit_proc */
name|NULL
block|,
comment|/* query_proc */
name|NULL
comment|/* run_proc */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|callbacks
specifier|static
name|PyObject
modifier|*
name|callbacks
index|[]
init|=
block|{
name|NULL
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

begin_typedef
DECL|typedef|ProgressData
typedef|typedef
name|struct
name|_ProgressData
name|ProgressData
typedef|;
end_typedef

begin_struct
DECL|struct|_ProgressData
struct|struct
name|_ProgressData
block|{
DECL|member|start
DECL|member|end
DECL|member|text
DECL|member|value
name|PyObject
modifier|*
name|start
decl_stmt|,
modifier|*
name|end
decl_stmt|,
modifier|*
name|text
decl_stmt|,
modifier|*
name|value
decl_stmt|;
DECL|member|user_data
name|PyObject
modifier|*
name|user_data
decl_stmt|;
block|}
struct|;
end_struct

begin_function
specifier|static
name|void
DECL|function|pygimp_init_proc (void)
name|pygimp_init_proc
parameter_list|(
name|void
parameter_list|)
block|{
name|PyObject
modifier|*
name|r
decl_stmt|;
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|callbacks
index|[
literal|0
index|]
argument_list|,
literal|"()"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pygimp_quit_proc (void)
name|pygimp_quit_proc
parameter_list|(
name|void
parameter_list|)
block|{
name|PyObject
modifier|*
name|r
decl_stmt|;
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|callbacks
index|[
literal|1
index|]
argument_list|,
literal|"()"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pygimp_query_proc (void)
name|pygimp_query_proc
parameter_list|(
name|void
parameter_list|)
block|{
name|PyObject
modifier|*
name|r
decl_stmt|;
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|callbacks
index|[
literal|2
index|]
argument_list|,
literal|"()"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pygimp_run_proc (const char * name,int nparams,const GimpParam * params,int * nreturn_vals,GimpParam ** return_vals)
name|pygimp_run_proc
parameter_list|(
specifier|const
name|char
modifier|*
name|name
parameter_list|,
name|int
name|nparams
parameter_list|,
specifier|const
name|GimpParam
modifier|*
name|params
parameter_list|,
name|int
modifier|*
name|nreturn_vals
parameter_list|,
name|GimpParam
modifier|*
modifier|*
name|return_vals
parameter_list|)
block|{
name|PyObject
modifier|*
name|args
decl_stmt|,
modifier|*
name|ret
decl_stmt|;
name|GimpParamDef
modifier|*
name|pd
decl_stmt|,
modifier|*
name|rv
decl_stmt|;
name|GimpPDBProcType
name|t
decl_stmt|;
name|char
modifier|*
name|b
decl_stmt|,
modifier|*
name|h
decl_stmt|,
modifier|*
name|a
decl_stmt|,
modifier|*
name|c
decl_stmt|,
modifier|*
name|d
decl_stmt|;
name|int
name|np
decl_stmt|,
name|nrv
decl_stmt|;
name|gimp_procedural_db_proc_info
argument_list|(
name|name
argument_list|,
operator|&
name|b
argument_list|,
operator|&
name|h
argument_list|,
operator|&
name|a
argument_list|,
operator|&
name|c
argument_list|,
operator|&
name|d
argument_list|,
operator|&
name|t
argument_list|,
operator|&
name|np
argument_list|,
operator|&
name|nrv
argument_list|,
operator|&
name|pd
argument_list|,
operator|&
name|rv
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|b
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|h
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|a
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|c
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|d
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|pd
argument_list|)
expr_stmt|;
if|#
directive|if
name|PG_DEBUG
operator|>
literal|0
name|g_printerr
argument_list|(
literal|"Params for %s:"
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|print_GParam
argument_list|(
name|nparams
argument_list|,
name|params
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|args
operator|=
name|pygimp_param_to_tuple
argument_list|(
name|nparams
argument_list|,
name|params
argument_list|)
expr_stmt|;
if|if
condition|(
name|args
operator|==
name|NULL
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
literal|1
expr_stmt|;
operator|*
name|return_vals
operator|=
name|g_new
argument_list|(
name|GimpParam
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|GIMP_PDB_STATUS
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|GIMP_PDB_CALLING_ERROR
expr_stmt|;
return|return;
block|}
name|ret
operator|=
name|PyObject_CallFunction
argument_list|(
name|callbacks
index|[
literal|3
index|]
argument_list|,
literal|"(sO)"
argument_list|,
name|name
argument_list|,
name|args
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|args
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|==
name|NULL
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
literal|1
expr_stmt|;
operator|*
name|return_vals
operator|=
name|g_new
argument_list|(
name|GimpParam
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|GIMP_PDB_STATUS
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|GIMP_PDB_EXECUTION_ERROR
expr_stmt|;
return|return;
block|}
operator|*
name|return_vals
operator|=
name|pygimp_param_from_tuple
argument_list|(
name|ret
argument_list|,
name|rv
argument_list|,
name|nrv
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|rv
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|return_vals
operator|==
name|NULL
condition|)
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
literal|1
expr_stmt|;
operator|*
name|return_vals
operator|=
name|g_new
argument_list|(
name|GimpParam
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|GIMP_PDB_STATUS
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|GIMP_PDB_EXECUTION_ERROR
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|ret
argument_list|)
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
name|nrv
operator|+
literal|1
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|GIMP_PDB_STATUS
expr_stmt|;
operator|(
operator|*
name|return_vals
operator|)
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|GIMP_PDB_SUCCESS
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_main (PyObject * self,PyObject * args)
name|pygimp_main
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyObject
modifier|*
name|av
decl_stmt|;
name|int
name|argc
decl_stmt|,
name|i
decl_stmt|;
name|char
modifier|*
modifier|*
name|argv
decl_stmt|;
name|PyObject
modifier|*
name|ip
decl_stmt|;
comment|// init proc
name|PyObject
modifier|*
name|qp
decl_stmt|;
comment|// quit proc
name|PyObject
modifier|*
name|query
decl_stmt|;
comment|// query proc
name|PyObject
modifier|*
name|rp
decl_stmt|;
comment|// run proc
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"OOOO:main"
argument_list|,
operator|&
name|ip
argument_list|,
operator|&
name|qp
argument_list|,
operator|&
name|query
argument_list|,
operator|&
name|rp
argument_list|)
condition|)
return|return
name|NULL
return|;
DECL|macro|Arg_Check (v)
define|#
directive|define
name|Arg_Check
parameter_list|(
name|v
parameter_list|)
value|(PyCallable_Check(v) || (v) == Py_None)
if|if
condition|(
operator|!
name|Arg_Check
argument_list|(
name|ip
argument_list|)
operator|||
operator|!
name|Arg_Check
argument_list|(
name|qp
argument_list|)
operator|||
operator|!
name|Arg_Check
argument_list|(
name|query
argument_list|)
operator|||
operator|!
name|Arg_Check
argument_list|(
name|rp
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"arguments must be callable"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
undef|#
directive|undef
name|Arg_Check
if|if
condition|(
name|query
operator|==
name|Py_None
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"a query procedure must be provided"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|ip
operator|!=
name|Py_None
condition|)
block|{
name|callbacks
index|[
literal|0
index|]
operator|=
name|ip
expr_stmt|;
name|PLUG_IN_INFO
operator|.
name|init_proc
operator|=
name|pygimp_init_proc
expr_stmt|;
block|}
if|if
condition|(
name|qp
operator|!=
name|Py_None
condition|)
block|{
name|callbacks
index|[
literal|1
index|]
operator|=
name|qp
expr_stmt|;
name|PLUG_IN_INFO
operator|.
name|quit_proc
operator|=
name|pygimp_quit_proc
expr_stmt|;
block|}
if|if
condition|(
name|query
operator|!=
name|Py_None
condition|)
block|{
name|callbacks
index|[
literal|2
index|]
operator|=
name|query
expr_stmt|;
name|PLUG_IN_INFO
operator|.
name|query_proc
operator|=
name|pygimp_query_proc
expr_stmt|;
block|}
if|if
condition|(
name|rp
operator|!=
name|Py_None
condition|)
block|{
name|callbacks
index|[
literal|3
index|]
operator|=
name|rp
expr_stmt|;
name|PLUG_IN_INFO
operator|.
name|run_proc
operator|=
name|pygimp_run_proc
expr_stmt|;
block|}
name|av
operator|=
name|PySys_GetObject
argument_list|(
literal|"argv"
argument_list|)
expr_stmt|;
name|argc
operator|=
name|PyList_Size
argument_list|(
name|av
argument_list|)
expr_stmt|;
name|argv
operator|=
name|g_new
argument_list|(
name|char
operator|*
argument_list|,
name|argc
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|argc
condition|;
name|i
operator|++
control|)
name|argv
index|[
name|i
index|]
operator|=
name|g_strdup
argument_list|(
name|PyString_AsString
argument_list|(
name|PyList_GetItem
argument_list|(
name|av
argument_list|,
name|i
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|gimp_main
argument_list|(
operator|&
name|PLUG_IN_INFO
argument_list|,
name|argc
argument_list|,
name|argv
argument_list|)
expr_stmt|;
if|if
condition|(
name|argv
operator|!=
name|NULL
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|argc
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|argv
index|[
name|i
index|]
operator|!=
name|NULL
condition|)
name|g_free
argument_list|(
name|argv
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|argv
argument_list|)
expr_stmt|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_quit (PyObject * self)
name|pygimp_quit
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|gimp_quit
argument_list|()
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_message (PyObject * self,PyObject * args)
name|pygimp_message
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|msg
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:message"
argument_list|,
operator|&
name|msg
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_message
argument_list|(
name|msg
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_exit (PyObject * self,PyObject * args,PyObject * kwargs)
name|pygimp_exit
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|gboolean
name|force
init|=
name|FALSE
decl_stmt|;
name|int
name|nreturn_vals
decl_stmt|;
name|GimpParam
modifier|*
name|return_vals
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"force"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"|i:exit"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|force
argument_list|)
condition|)
return|return
name|NULL
return|;
name|return_vals
operator|=
name|gimp_run_procedure
argument_list|(
literal|"gimp-quit"
argument_list|,
operator|&
name|nreturn_vals
argument_list|,
name|GIMP_PDB_INT32
argument_list|,
name|force
argument_list|,
name|GIMP_PDB_END
argument_list|)
expr_stmt|;
if|if
condition|(
name|return_vals
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|!=
name|GIMP_PDB_SUCCESS
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"error while exiting"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|gimp_destroy_params
argument_list|(
name|return_vals
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_set_data (PyObject * self,PyObject * args)
name|pygimp_set_data
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|id
decl_stmt|,
modifier|*
name|data
decl_stmt|;
name|int
name|bytes
decl_stmt|,
name|nreturn_vals
decl_stmt|;
name|GimpParam
modifier|*
name|return_vals
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ss#:set_data"
argument_list|,
operator|&
name|id
argument_list|,
operator|&
name|data
argument_list|,
operator|&
name|bytes
argument_list|)
condition|)
return|return
name|NULL
return|;
name|return_vals
operator|=
name|gimp_run_procedure
argument_list|(
literal|"gimp-procedural-db-set-data"
argument_list|,
operator|&
name|nreturn_vals
argument_list|,
name|GIMP_PDB_STRING
argument_list|,
name|id
argument_list|,
name|GIMP_PDB_INT32
argument_list|,
name|bytes
argument_list|,
name|GIMP_PDB_INT8ARRAY
argument_list|,
name|data
argument_list|,
name|GIMP_PDB_END
argument_list|)
expr_stmt|;
if|if
condition|(
name|return_vals
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|!=
name|GIMP_PDB_SUCCESS
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"error occurred while storing"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|gimp_destroy_params
argument_list|(
name|return_vals
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_get_data (PyObject * self,PyObject * args)
name|pygimp_get_data
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|id
decl_stmt|;
name|int
name|nreturn_vals
decl_stmt|;
name|GimpParam
modifier|*
name|return_vals
decl_stmt|;
name|PyObject
modifier|*
name|s
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:get_data"
argument_list|,
operator|&
name|id
argument_list|)
condition|)
return|return
name|NULL
return|;
name|return_vals
operator|=
name|gimp_run_procedure
argument_list|(
literal|"gimp-procedural-db-get-data"
argument_list|,
operator|&
name|nreturn_vals
argument_list|,
name|GIMP_PDB_STRING
argument_list|,
name|id
argument_list|,
name|GIMP_PDB_END
argument_list|)
expr_stmt|;
if|if
condition|(
name|return_vals
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|!=
name|GIMP_PDB_SUCCESS
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"no data for id"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|s
operator|=
name|PyString_FromStringAndSize
argument_list|(
operator|(
name|char
operator|*
operator|)
name|return_vals
index|[
literal|2
index|]
operator|.
name|data
operator|.
name|d_int8array
argument_list|,
name|return_vals
index|[
literal|1
index|]
operator|.
name|data
operator|.
name|d_int32
argument_list|)
expr_stmt|;
name|gimp_destroy_params
argument_list|(
name|return_vals
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
return|return
name|s
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_progress_init (PyObject * self,PyObject * args)
name|pygimp_progress_init
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|msg
init|=
name|NULL
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"|s:progress_init"
argument_list|,
operator|&
name|msg
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_progress_init
argument_list|(
name|msg
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_progress_update (PyObject * self,PyObject * args)
name|pygimp_progress_update
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|double
name|p
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"d:progress_update"
argument_list|,
operator|&
name|p
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_progress_update
argument_list|(
name|p
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pygimp_progress_start (const gchar * message,gboolean cancelable,gpointer data)
name|pygimp_progress_start
parameter_list|(
specifier|const
name|gchar
modifier|*
name|message
parameter_list|,
name|gboolean
name|cancelable
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|ProgressData
modifier|*
name|pdata
init|=
name|data
decl_stmt|;
name|PyObject
modifier|*
name|r
decl_stmt|;
if|if
condition|(
name|pdata
operator|->
name|user_data
condition|)
block|{
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|pdata
operator|->
name|start
argument_list|,
literal|"siO"
argument_list|,
name|message
argument_list|,
name|cancelable
argument_list|,
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
block|}
else|else
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|pdata
operator|->
name|start
argument_list|,
literal|"si"
argument_list|,
name|message
argument_list|,
name|cancelable
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pygimp_progress_end (gpointer data)
name|pygimp_progress_end
parameter_list|(
name|gpointer
name|data
parameter_list|)
block|{
name|ProgressData
modifier|*
name|pdata
init|=
name|data
decl_stmt|;
name|PyObject
modifier|*
name|r
decl_stmt|;
if|if
condition|(
name|pdata
operator|->
name|user_data
condition|)
block|{
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|pdata
operator|->
name|end
argument_list|,
literal|"O"
argument_list|,
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
block|}
else|else
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|pdata
operator|->
name|end
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pygimp_progress_text (const gchar * message,gpointer data)
name|pygimp_progress_text
parameter_list|(
specifier|const
name|gchar
modifier|*
name|message
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|ProgressData
modifier|*
name|pdata
init|=
name|data
decl_stmt|;
name|PyObject
modifier|*
name|r
decl_stmt|;
if|if
condition|(
name|pdata
operator|->
name|user_data
condition|)
block|{
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|pdata
operator|->
name|text
argument_list|,
literal|"sO"
argument_list|,
name|message
argument_list|,
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
block|}
else|else
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|pdata
operator|->
name|text
argument_list|,
literal|"s"
argument_list|,
name|message
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|pygimp_progress_value (gdouble percentage,gpointer data)
name|pygimp_progress_value
parameter_list|(
name|gdouble
name|percentage
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|ProgressData
modifier|*
name|pdata
init|=
name|data
decl_stmt|;
name|PyObject
modifier|*
name|r
decl_stmt|;
if|if
condition|(
name|pdata
operator|->
name|user_data
condition|)
block|{
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|pdata
operator|->
name|value
argument_list|,
literal|"dO"
argument_list|,
name|percentage
argument_list|,
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
block|}
else|else
name|r
operator|=
name|PyObject_CallFunction
argument_list|(
name|pdata
operator|->
name|value
argument_list|,
literal|"d"
argument_list|,
name|percentage
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|r
condition|)
block|{
name|PyErr_Print
argument_list|()
expr_stmt|;
name|PyErr_Clear
argument_list|()
expr_stmt|;
return|return;
block|}
name|Py_DECREF
argument_list|(
name|r
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_progress_install (PyObject * self,PyObject * args,PyObject * kwargs)
name|pygimp_progress_install
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|GimpProgressVtable
name|vtable
init|=
block|{
literal|0
block|, }
decl_stmt|;
specifier|const
name|gchar
modifier|*
name|ret
decl_stmt|;
name|ProgressData
modifier|*
name|pdata
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"start"
block|,
literal|"end"
block|,
literal|"text"
block|,
literal|"value"
block|,
literal|"data"
block|,
name|NULL
block|}
decl_stmt|;
name|pdata
operator|=
name|g_new0
argument_list|(
name|ProgressData
argument_list|,
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"OOOO|O:progress_install"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|pdata
operator|->
name|start
argument_list|,
operator|&
name|pdata
operator|->
name|end
argument_list|,
operator|&
name|pdata
operator|->
name|text
argument_list|,
operator|&
name|pdata
operator|->
name|value
argument_list|,
operator|&
name|pdata
operator|->
name|user_data
argument_list|)
condition|)
goto|goto
name|cleanup
goto|;
DECL|macro|PROCESS_FUNC (n)
define|#
directive|define
name|PROCESS_FUNC
parameter_list|(
name|n
parameter_list|)
value|G_STMT_START {                                  \     if (!PyCallable_Check(pdata->n)) {                                  \         PyErr_SetString(pygimp_error, #n "argument must be callable");  \         goto cleanup;                                                   \     }                                                                   \     Py_INCREF(pdata->n);                                                \ } G_STMT_END
name|PROCESS_FUNC
argument_list|(
name|start
argument_list|)
expr_stmt|;
name|PROCESS_FUNC
argument_list|(
name|end
argument_list|)
expr_stmt|;
name|PROCESS_FUNC
argument_list|(
name|text
argument_list|)
expr_stmt|;
name|PROCESS_FUNC
argument_list|(
name|value
argument_list|)
expr_stmt|;
name|Py_XINCREF
argument_list|(
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
undef|#
directive|undef
name|PROCESS_FUNC
name|vtable
operator|.
name|start
operator|=
name|pygimp_progress_start
expr_stmt|;
name|vtable
operator|.
name|end
operator|=
name|pygimp_progress_end
expr_stmt|;
name|vtable
operator|.
name|set_text
operator|=
name|pygimp_progress_text
expr_stmt|;
name|vtable
operator|.
name|set_value
operator|=
name|pygimp_progress_value
expr_stmt|;
name|ret
operator|=
name|gimp_progress_install_vtable
argument_list|(
operator|&
name|vtable
argument_list|,
name|pdata
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|ret
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"error occurred while installing progress functions"
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|start
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|end
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|text
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|value
argument_list|)
expr_stmt|;
goto|goto
name|cleanup
goto|;
block|}
return|return
name|PyString_FromString
argument_list|(
name|ret
argument_list|)
return|;
name|cleanup
label|:
name|g_free
argument_list|(
name|pdata
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_progress_uninstall (PyObject * self,PyObject * args)
name|pygimp_progress_uninstall
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|ProgressData
modifier|*
name|pdata
decl_stmt|;
name|gchar
modifier|*
name|callback
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:progress_uninstall"
argument_list|,
operator|&
name|callback
argument_list|)
condition|)
return|return
name|NULL
return|;
name|pdata
operator|=
name|gimp_progress_uninstall
argument_list|(
name|callback
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|pdata
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"error occurred while uninstalling progress functions"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|start
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|end
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|text
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|pdata
operator|->
name|value
argument_list|)
expr_stmt|;
name|Py_XDECREF
argument_list|(
name|pdata
operator|->
name|user_data
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|pdata
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_image_list (PyObject * self)
name|pygimp_image_list
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|gint32
modifier|*
name|imgs
decl_stmt|;
name|int
name|nimgs
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|imgs
operator|=
name|gimp_image_list
argument_list|(
operator|&
name|nimgs
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|nimgs
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nimgs
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
name|pygimp_image_new
argument_list|(
name|imgs
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|imgs
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_install_procedure (PyObject * self,PyObject * args)
name|pygimp_install_procedure
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|blurb
decl_stmt|,
modifier|*
name|help
decl_stmt|,
modifier|*
name|author
decl_stmt|,
modifier|*
name|copyright
decl_stmt|,
modifier|*
name|date
decl_stmt|,
modifier|*
name|menu_path
decl_stmt|,
modifier|*
name|image_types
decl_stmt|,
modifier|*
name|n
decl_stmt|,
modifier|*
name|d
decl_stmt|;
name|GimpParamDef
modifier|*
name|params
decl_stmt|,
modifier|*
name|return_vals
decl_stmt|;
name|int
name|type
decl_stmt|,
name|nparams
decl_stmt|,
name|nreturn_vals
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|pars
decl_stmt|,
modifier|*
name|rets
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sssssszziOO:install_procedure"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|blurb
argument_list|,
operator|&
name|help
argument_list|,
operator|&
name|author
argument_list|,
operator|&
name|copyright
argument_list|,
operator|&
name|date
argument_list|,
operator|&
name|menu_path
argument_list|,
operator|&
name|image_types
argument_list|,
operator|&
name|type
argument_list|,
operator|&
name|pars
argument_list|,
operator|&
name|rets
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|pars
argument_list|)
operator|||
operator|!
name|PySequence_Check
argument_list|(
name|rets
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"last two args must be sequences"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|nparams
operator|=
name|PySequence_Length
argument_list|(
name|pars
argument_list|)
expr_stmt|;
name|nreturn_vals
operator|=
name|PySequence_Length
argument_list|(
name|rets
argument_list|)
expr_stmt|;
name|params
operator|=
name|g_new
argument_list|(
name|GimpParamDef
argument_list|,
name|nparams
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nparams
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|PySequence_GetItem
argument_list|(
name|pars
argument_list|,
name|i
argument_list|)
argument_list|,
literal|"iss"
argument_list|,
operator|&
operator|(
name|params
index|[
name|i
index|]
operator|.
name|type
operator|)
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|d
argument_list|)
condition|)
block|{
name|g_free
argument_list|(
name|params
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|params
index|[
name|i
index|]
operator|.
name|name
operator|=
name|g_strdup
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|params
index|[
name|i
index|]
operator|.
name|description
operator|=
name|g_strdup
argument_list|(
name|d
argument_list|)
expr_stmt|;
block|}
name|return_vals
operator|=
name|g_new
argument_list|(
name|GimpParamDef
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nreturn_vals
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|PySequence_GetItem
argument_list|(
name|rets
argument_list|,
name|i
argument_list|)
argument_list|,
literal|"iss"
argument_list|,
operator|&
operator|(
name|return_vals
index|[
name|i
index|]
operator|.
name|type
operator|)
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|d
argument_list|)
condition|)
block|{
name|g_free
argument_list|(
name|params
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|return_vals
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|return_vals
index|[
name|i
index|]
operator|.
name|name
operator|=
name|g_strdup
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|return_vals
index|[
name|i
index|]
operator|.
name|description
operator|=
name|g_strdup
argument_list|(
name|d
argument_list|)
expr_stmt|;
block|}
name|gimp_install_procedure
argument_list|(
name|name
argument_list|,
name|blurb
argument_list|,
name|help
argument_list|,
name|author
argument_list|,
name|copyright
argument_list|,
name|date
argument_list|,
name|menu_path
argument_list|,
name|image_types
argument_list|,
name|type
argument_list|,
name|nparams
argument_list|,
name|nreturn_vals
argument_list|,
name|params
argument_list|,
name|return_vals
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_install_temp_proc (PyObject * self,PyObject * args)
name|pygimp_install_temp_proc
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|blurb
decl_stmt|,
modifier|*
name|help
decl_stmt|,
modifier|*
name|author
decl_stmt|,
modifier|*
name|copyright
decl_stmt|,
modifier|*
name|date
decl_stmt|,
modifier|*
name|menu_path
decl_stmt|,
modifier|*
name|image_types
decl_stmt|,
modifier|*
name|n
decl_stmt|,
modifier|*
name|d
decl_stmt|;
name|GimpParamDef
modifier|*
name|params
decl_stmt|,
modifier|*
name|return_vals
decl_stmt|;
name|int
name|type
decl_stmt|,
name|nparams
decl_stmt|,
name|nreturn_vals
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|pars
decl_stmt|,
modifier|*
name|rets
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sssssszziOO:install_temp_proc"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|blurb
argument_list|,
operator|&
name|help
argument_list|,
operator|&
name|author
argument_list|,
operator|&
name|copyright
argument_list|,
operator|&
name|date
argument_list|,
operator|&
name|menu_path
argument_list|,
operator|&
name|image_types
argument_list|,
operator|&
name|type
argument_list|,
operator|&
name|pars
argument_list|,
operator|&
name|rets
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|pars
argument_list|)
operator|||
operator|!
name|PySequence_Check
argument_list|(
name|rets
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"last two args must be sequences"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|nparams
operator|=
name|PySequence_Length
argument_list|(
name|pars
argument_list|)
expr_stmt|;
name|nreturn_vals
operator|=
name|PySequence_Length
argument_list|(
name|rets
argument_list|)
expr_stmt|;
name|params
operator|=
name|g_new
argument_list|(
name|GimpParamDef
argument_list|,
name|nparams
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nparams
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|PySequence_GetItem
argument_list|(
name|pars
argument_list|,
name|i
argument_list|)
argument_list|,
literal|"iss"
argument_list|,
operator|&
operator|(
name|params
index|[
name|i
index|]
operator|.
name|type
operator|)
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|d
argument_list|)
condition|)
block|{
name|g_free
argument_list|(
name|params
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|params
index|[
name|i
index|]
operator|.
name|name
operator|=
name|g_strdup
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|params
index|[
name|i
index|]
operator|.
name|description
operator|=
name|g_strdup
argument_list|(
name|d
argument_list|)
expr_stmt|;
block|}
name|return_vals
operator|=
name|g_new
argument_list|(
name|GimpParamDef
argument_list|,
name|nreturn_vals
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nreturn_vals
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|PySequence_GetItem
argument_list|(
name|rets
argument_list|,
name|i
argument_list|)
argument_list|,
literal|"iss"
argument_list|,
operator|&
operator|(
name|return_vals
index|[
name|i
index|]
operator|.
name|type
operator|)
argument_list|,
operator|&
name|n
argument_list|,
operator|&
name|d
argument_list|)
condition|)
block|{
name|g_free
argument_list|(
name|params
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|return_vals
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|return_vals
index|[
name|i
index|]
operator|.
name|name
operator|=
name|g_strdup
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|return_vals
index|[
name|i
index|]
operator|.
name|description
operator|=
name|g_strdup
argument_list|(
name|d
argument_list|)
expr_stmt|;
block|}
name|gimp_install_temp_proc
argument_list|(
name|name
argument_list|,
name|blurb
argument_list|,
name|help
argument_list|,
name|author
argument_list|,
name|copyright
argument_list|,
name|date
argument_list|,
name|menu_path
argument_list|,
name|image_types
argument_list|,
name|type
argument_list|,
name|nparams
argument_list|,
name|nreturn_vals
argument_list|,
name|params
argument_list|,
name|return_vals
argument_list|,
name|pygimp_run_proc
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_uninstall_temp_proc (PyObject * self,PyObject * args)
name|pygimp_uninstall_temp_proc
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:uninstall_temp_proc"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_uninstall_temp_proc
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_register_magic_load_handler (PyObject * self,PyObject * args)
name|pygimp_register_magic_load_handler
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|extensions
decl_stmt|,
modifier|*
name|prefixes
decl_stmt|,
modifier|*
name|magics
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ssss:register_magic_load_handler"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|extensions
argument_list|,
operator|&
name|prefixes
argument_list|,
operator|&
name|magics
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_register_magic_load_handler
argument_list|(
name|name
argument_list|,
name|extensions
argument_list|,
name|prefixes
argument_list|,
name|magics
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_register_load_handler (PyObject * self,PyObject * args)
name|pygimp_register_load_handler
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|extensions
decl_stmt|,
modifier|*
name|prefixes
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sss:register_load_handler"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|extensions
argument_list|,
operator|&
name|prefixes
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_register_load_handler
argument_list|(
name|name
argument_list|,
name|extensions
argument_list|,
name|prefixes
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_register_save_handler (PyObject * self,PyObject * args)
name|pygimp_register_save_handler
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|extensions
decl_stmt|,
modifier|*
name|prefixes
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sss:register_save_handler"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|extensions
argument_list|,
operator|&
name|prefixes
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_register_save_handler
argument_list|(
name|name
argument_list|,
name|extensions
argument_list|,
name|prefixes
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_domain_register (PyObject * self,PyObject * args)
name|pygimp_domain_register
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|path
init|=
name|NULL
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s|s:domain_register"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|path
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_plugin_domain_register
argument_list|(
name|name
argument_list|,
name|path
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_menu_register (PyObject * self,PyObject * args)
name|pygimp_menu_register
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|path
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"ss:menu_register"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|path
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_plugin_menu_register
argument_list|(
name|name
argument_list|,
name|path
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_gamma (PyObject * self)
name|pygimp_gamma
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyFloat_FromDouble
argument_list|(
name|gimp_gamma
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_gtkrc (PyObject * self)
name|pygimp_gtkrc
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyString_FromString
argument_list|(
name|gimp_gtkrc
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_personal_rc_file (PyObject * self,PyObject * args,PyObject * kwargs)
name|pygimp_personal_rc_file
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|char
modifier|*
name|basename
decl_stmt|,
modifier|*
name|filename
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"basename"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"s:personal_rc_file"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|basename
argument_list|)
condition|)
return|return
name|NULL
return|;
name|filename
operator|=
name|gimp_personal_rc_file
argument_list|(
name|basename
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyString_FromString
argument_list|(
name|filename
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|filename
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_context_push (PyObject * self)
name|pygimp_context_push
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|gimp_context_push
argument_list|()
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_context_pop (PyObject * self)
name|pygimp_context_pop
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|gimp_context_pop
argument_list|()
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_get_background (PyObject * self)
name|pygimp_get_background
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|GimpRGB
name|rgb
decl_stmt|;
name|gimp_context_get_background
argument_list|(
operator|&
name|rgb
argument_list|)
expr_stmt|;
return|return
name|pygimp_rgb_new
argument_list|(
operator|&
name|rgb
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_get_foreground (PyObject * self)
name|pygimp_get_foreground
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|GimpRGB
name|rgb
decl_stmt|;
name|gimp_context_get_foreground
argument_list|(
operator|&
name|rgb
argument_list|)
expr_stmt|;
return|return
name|pygimp_rgb_new
argument_list|(
operator|&
name|rgb
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_set_background (PyObject * self,PyObject * args)
name|pygimp_set_background
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyObject
modifier|*
name|color
decl_stmt|;
name|GimpRGB
name|rgb
decl_stmt|;
if|if
condition|(
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O:set_background"
argument_list|,
operator|&
name|color
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|pygimp_rgb_from_pyobject
argument_list|(
name|color
argument_list|,
operator|&
name|rgb
argument_list|)
condition|)
return|return
name|NULL
return|;
block|}
else|else
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|pygimp_rgb_from_pyobject
argument_list|(
name|args
argument_list|,
operator|&
name|rgb
argument_list|)
condition|)
return|return
name|NULL
return|;
block|}
name|gimp_context_set_background
argument_list|(
operator|&
name|rgb
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_set_foreground (PyObject * self,PyObject * args)
name|pygimp_set_foreground
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyObject
modifier|*
name|color
decl_stmt|;
name|GimpRGB
name|rgb
decl_stmt|;
if|if
condition|(
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O:set_foreground"
argument_list|,
operator|&
name|color
argument_list|)
condition|)
block|{
if|if
condition|(
operator|!
name|pygimp_rgb_from_pyobject
argument_list|(
name|color
argument_list|,
operator|&
name|rgb
argument_list|)
condition|)
return|return
name|NULL
return|;
block|}
else|else
block|{
name|PyErr_Clear
argument_list|()
expr_stmt|;
if|if
condition|(
operator|!
name|pygimp_rgb_from_pyobject
argument_list|(
name|args
argument_list|,
operator|&
name|rgb
argument_list|)
condition|)
return|return
name|NULL
return|;
block|}
name|gimp_context_set_foreground
argument_list|(
operator|&
name|rgb
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_gradients_get_list (PyObject * self,PyObject * args,PyObject * kwargs)
name|pygimp_gradients_get_list
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|char
modifier|*
modifier|*
name|list
decl_stmt|,
modifier|*
name|filter
init|=
name|NULL
decl_stmt|;
name|int
name|num
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"filter"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"|s:gradients_get_list"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|filter
argument_list|)
condition|)
return|return
name|NULL
return|;
name|list
operator|=
name|gimp_gradients_get_list
argument_list|(
name|filter
argument_list|,
operator|&
name|num
argument_list|)
expr_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
control|)
block|{
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|PyString_FromString
argument_list|(
name|list
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|list
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|g_free
argument_list|(
name|list
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_context_get_gradient (PyObject * self)
name|pygimp_context_get_gradient
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|name
operator|=
name|gimp_context_get_gradient
argument_list|()
expr_stmt|;
name|ret
operator|=
name|PyString_FromString
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|name
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_gradients_get_gradient (PyObject * self)
name|pygimp_gradients_get_gradient
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
if|if
condition|(
name|PyErr_Warn
argument_list|(
name|PyExc_DeprecationWarning
argument_list|,
literal|"use gimp.context_get_gradient"
argument_list|)
operator|<
literal|0
condition|)
return|return
name|NULL
return|;
return|return
name|pygimp_context_get_gradient
argument_list|(
name|self
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_context_set_gradient (PyObject * self,PyObject * args)
name|pygimp_context_set_gradient
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|actv
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:gradients_set_gradient"
argument_list|,
operator|&
name|actv
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_context_set_gradient
argument_list|(
name|actv
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_gradients_set_gradient (PyObject * self,PyObject * args)
name|pygimp_gradients_set_gradient
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
if|if
condition|(
name|PyErr_Warn
argument_list|(
name|PyExc_DeprecationWarning
argument_list|,
literal|"use gimp.context_set_gradient"
argument_list|)
operator|<
literal|0
condition|)
return|return
name|NULL
return|;
return|return
name|pygimp_context_set_gradient
argument_list|(
name|self
argument_list|,
name|args
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_gradient_get_uniform_samples (PyObject * self,PyObject * args)
name|pygimp_gradient_get_uniform_samples
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|num
decl_stmt|,
name|reverse
init|=
name|FALSE
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
name|int
name|nsamp
decl_stmt|;
name|double
modifier|*
name|samp
decl_stmt|;
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"si|i:gradient_get_uniform_samples"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|num
argument_list|,
operator|&
name|reverse
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_gradient_get_uniform_samples
argument_list|(
name|name
argument_list|,
name|num
argument_list|,
name|reverse
argument_list|,
operator|&
name|nsamp
argument_list|,
operator|&
name|samp
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"gradient_get_uniform_samples failed"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|ret
operator|=
name|PyList_New
argument_list|(
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
operator|,
name|j
operator|+=
literal|4
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|Py_BuildValue
argument_list|(
literal|"(dddd)"
argument_list|,
name|samp
index|[
name|j
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|1
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|2
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|3
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|samp
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_gradient_get_custom_samples (PyObject * self,PyObject * args)
name|pygimp_gradient_get_custom_samples
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|num
decl_stmt|,
name|reverse
init|=
name|FALSE
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|;
name|int
name|nsamp
decl_stmt|;
name|double
modifier|*
name|pos
decl_stmt|,
modifier|*
name|samp
decl_stmt|;
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|,
modifier|*
name|item
decl_stmt|;
name|gboolean
name|success
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sO|i:gradient_get_custom_samples"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|ret
argument_list|,
operator|&
name|reverse
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|PySequence_Check
argument_list|(
name|ret
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"second arg must be a sequence"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|num
operator|=
name|PySequence_Length
argument_list|(
name|ret
argument_list|)
expr_stmt|;
name|pos
operator|=
name|g_new
argument_list|(
name|gdouble
argument_list|,
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
control|)
block|{
name|item
operator|=
name|PySequence_GetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|PyFloat_Check
argument_list|(
name|item
argument_list|)
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"second arg must be a sequence of floats"
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|pos
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|pos
index|[
name|i
index|]
operator|=
name|PyFloat_AsDouble
argument_list|(
name|item
argument_list|)
expr_stmt|;
block|}
name|success
operator|=
name|gimp_gradient_get_custom_samples
argument_list|(
name|name
argument_list|,
name|num
argument_list|,
name|pos
argument_list|,
name|reverse
argument_list|,
operator|&
name|nsamp
argument_list|,
operator|&
name|samp
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|pos
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|success
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"gradient_get_custom_samples failed"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|ret
operator|=
name|PyList_New
argument_list|(
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
operator|,
name|j
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
operator|,
name|j
operator|+=
literal|4
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|Py_BuildValue
argument_list|(
literal|"(dddd)"
argument_list|,
name|samp
index|[
name|j
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|1
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|2
index|]
argument_list|,
name|samp
index|[
name|j
operator|+
literal|3
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|samp
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_gradients_sample_uniform (PyObject * self,PyObject * args)
name|pygimp_gradients_sample_uniform
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
name|PyObject
modifier|*
name|arg_list
decl_stmt|,
modifier|*
name|str
decl_stmt|,
modifier|*
name|new_args
decl_stmt|,
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
name|PyErr_Warn
argument_list|(
name|PyExc_DeprecationWarning
argument_list|,
literal|"use gimp.gradient_get_uniform_samples"
argument_list|)
operator|<
literal|0
condition|)
return|return
name|NULL
return|;
name|arg_list
operator|=
name|PySequence_List
argument_list|(
name|args
argument_list|)
expr_stmt|;
name|name
operator|=
name|gimp_context_get_gradient
argument_list|()
expr_stmt|;
name|str
operator|=
name|PyString_FromString
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|PyList_Insert
argument_list|(
name|arg_list
argument_list|,
literal|0
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|Py_XDECREF
argument_list|(
name|str
argument_list|)
expr_stmt|;
name|new_args
operator|=
name|PyList_AsTuple
argument_list|(
name|arg_list
argument_list|)
expr_stmt|;
name|Py_XDECREF
argument_list|(
name|arg_list
argument_list|)
expr_stmt|;
name|ret
operator|=
name|pygimp_gradient_get_uniform_samples
argument_list|(
name|self
argument_list|,
name|new_args
argument_list|)
expr_stmt|;
name|Py_XDECREF
argument_list|(
name|new_args
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_gradients_sample_custom (PyObject * self,PyObject * args)
name|pygimp_gradients_sample_custom
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
name|PyObject
modifier|*
name|arg_list
decl_stmt|,
modifier|*
name|str
decl_stmt|,
modifier|*
name|new_args
decl_stmt|,
modifier|*
name|ret
decl_stmt|;
if|if
condition|(
name|PyErr_Warn
argument_list|(
name|PyExc_DeprecationWarning
argument_list|,
literal|"use gimp.gradient_get_custom_samples"
argument_list|)
operator|<
literal|0
condition|)
return|return
name|NULL
return|;
name|arg_list
operator|=
name|PySequence_List
argument_list|(
name|args
argument_list|)
expr_stmt|;
name|name
operator|=
name|gimp_context_get_gradient
argument_list|()
expr_stmt|;
name|str
operator|=
name|PyString_FromString
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|PyList_Insert
argument_list|(
name|arg_list
argument_list|,
literal|0
argument_list|,
name|str
argument_list|)
expr_stmt|;
name|Py_XDECREF
argument_list|(
name|str
argument_list|)
expr_stmt|;
name|new_args
operator|=
name|PyList_AsTuple
argument_list|(
name|arg_list
argument_list|)
expr_stmt|;
name|Py_XDECREF
argument_list|(
name|arg_list
argument_list|)
expr_stmt|;
name|ret
operator|=
name|pygimp_gradient_get_custom_samples
argument_list|(
name|self
argument_list|,
name|new_args
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_delete (PyObject * self,PyObject * args)
name|pygimp_delete
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpImage
modifier|*
name|img
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O:delete"
argument_list|,
operator|&
name|img
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|pygimp_image_check
argument_list|(
name|img
argument_list|)
condition|)
name|gimp_image_delete
argument_list|(
name|img
operator|->
name|ID
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|pygimp_drawable_check
argument_list|(
name|img
argument_list|)
condition|)
name|gimp_item_delete
argument_list|(
name|img
operator|->
name|ID
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|pygimp_display_check
argument_list|(
name|img
argument_list|)
condition|)
name|gimp_display_delete
argument_list|(
name|img
operator|->
name|ID
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_displays_flush (PyObject * self)
name|pygimp_displays_flush
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|gimp_displays_flush
argument_list|()
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_displays_reconnect (PyObject * self,PyObject * args)
name|pygimp_displays_reconnect
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpImage
modifier|*
name|old_img
decl_stmt|,
modifier|*
name|new_img
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!O!:displays_reconnect"
argument_list|,
operator|&
name|PyGimpImage_Type
argument_list|,
operator|&
name|old_img
argument_list|,
operator|&
name|PyGimpImage_Type
argument_list|,
operator|&
name|new_img
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_displays_reconnect
argument_list|(
name|old_img
operator|->
name|ID
argument_list|,
name|new_img
operator|->
name|ID
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not reconnect the displays of image (ID %d) "
literal|"to image (ID %d)"
argument_list|,
name|old_img
operator|->
name|ID
argument_list|,
name|new_img
operator|->
name|ID
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_tile_cache_size (PyObject * self,PyObject * args)
name|pygimp_tile_cache_size
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|unsigned
name|long
name|k
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"l:tile_cache_size"
argument_list|,
operator|&
name|k
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_tile_cache_size
argument_list|(
name|k
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_tile_cache_ntiles (PyObject * self,PyObject * args)
name|pygimp_tile_cache_ntiles
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|unsigned
name|long
name|n
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"l:tile_cache_ntiles"
argument_list|,
operator|&
name|n
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_tile_cache_ntiles
argument_list|(
name|n
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_tile_width (PyObject * self)
name|pygimp_tile_width
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_tile_width
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_tile_height (PyObject * self)
name|pygimp_tile_height
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_tile_height
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_extension_ack (PyObject * self)
name|pygimp_extension_ack
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|gimp_extension_ack
argument_list|()
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_extension_enable (PyObject * self)
name|pygimp_extension_enable
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|gimp_extension_enable
argument_list|()
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_extension_process (PyObject * self,PyObject * args)
name|pygimp_extension_process
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|guint
name|timeout
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"I:extension_process"
argument_list|,
operator|&
name|timeout
argument_list|)
condition|)
return|return
name|NULL
return|;
name|gimp_extension_process
argument_list|(
name|timeout
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_parasite_find (PyObject * self,PyObject * args)
name|pygimp_parasite_find
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:parasite_find"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
return|return
name|pygimp_parasite_new
argument_list|(
name|gimp_get_parasite
argument_list|(
name|name
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_parasite_attach (PyObject * self,PyObject * args)
name|pygimp_parasite_attach
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|PyGimpParasite
modifier|*
name|parasite
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"O!:parasite_attach"
argument_list|,
operator|&
name|PyGimpParasite_Type
argument_list|,
operator|&
name|parasite
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_attach_parasite
argument_list|(
name|parasite
operator|->
name|para
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not attach parasite '%s'"
argument_list|,
name|gimp_parasite_name
argument_list|(
name|parasite
operator|->
name|para
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_attach_new_parasite (PyObject * self,PyObject * args)
name|pygimp_attach_new_parasite
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|GimpParasite
modifier|*
name|parasite
decl_stmt|;
name|char
modifier|*
name|name
decl_stmt|,
modifier|*
name|data
decl_stmt|;
name|int
name|flags
decl_stmt|,
name|size
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"sis#:attach_new_parasite"
argument_list|,
operator|&
name|name
argument_list|,
operator|&
name|flags
argument_list|,
operator|&
name|data
argument_list|,
operator|&
name|size
argument_list|)
condition|)
return|return
name|NULL
return|;
name|parasite
operator|=
name|gimp_parasite_new
argument_list|(
name|name
argument_list|,
name|flags
argument_list|,
name|size
argument_list|,
name|data
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|gimp_attach_parasite
argument_list|(
name|parasite
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not attach new parasite '%s'"
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|gimp_parasite_free
argument_list|(
name|parasite
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|gimp_parasite_free
argument_list|(
name|parasite
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_parasite_detach (PyObject * self,PyObject * args)
name|pygimp_parasite_detach
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|char
modifier|*
name|name
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"s:parasite_detach"
argument_list|,
operator|&
name|name
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
operator|!
name|gimp_detach_parasite
argument_list|(
name|name
argument_list|)
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not detach parasite '%s'"
argument_list|,
name|name
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_parasite_list (PyObject * self)
name|pygimp_parasite_list
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
name|gint
name|num_parasites
decl_stmt|;
name|gchar
modifier|*
modifier|*
name|parasites
decl_stmt|;
name|parasites
operator|=
name|gimp_get_parasite_list
argument_list|(
operator|&
name|num_parasites
argument_list|)
expr_stmt|;
if|if
condition|(
name|parasites
condition|)
block|{
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|gint
name|i
decl_stmt|;
name|ret
operator|=
name|PyTuple_New
argument_list|(
name|num_parasites
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_parasites
condition|;
name|i
operator|++
control|)
block|{
name|PyTuple_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|PyString_FromString
argument_list|(
name|parasites
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|parasites
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|g_free
argument_list|(
name|parasites
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not list parasites"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_show_tool_tips (PyObject * self)
name|pygimp_show_tool_tips
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_show_tool_tips
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_show_help_button (PyObject * self)
name|pygimp_show_help_button
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyBool_FromLong
argument_list|(
name|gimp_show_help_button
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_check_size (PyObject * self)
name|pygimp_check_size
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_check_size
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_check_type (PyObject * self)
name|pygimp_check_type
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_check_type
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_default_display (PyObject * self)
name|pygimp_default_display
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|pygimp_display_new
argument_list|(
name|gimp_default_display
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_wm_class (PyObject * self)
name|pygimp_wm_class
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyString_FromString
argument_list|(
name|gimp_wm_class
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_display_name (PyObject * self)
name|pygimp_display_name
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyString_FromString
argument_list|(
name|gimp_display_name
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_monitor_number (PyObject * self)
name|pygimp_monitor_number
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyInt_FromLong
argument_list|(
name|gimp_monitor_number
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_get_progname (PyObject * self)
name|pygimp_get_progname
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
return|return
name|PyString_FromString
argument_list|(
name|gimp_get_progname
argument_list|()
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_user_directory (PyObject * self,PyObject * args,PyObject * kwargs)
name|pygimp_user_directory
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|GimpUserDirectory
name|type
decl_stmt|;
specifier|const
name|char
modifier|*
name|user_dir
decl_stmt|;
name|PyObject
modifier|*
name|py_type
decl_stmt|,
modifier|*
name|ret
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"type"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"O:user_directory"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|py_type
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|pyg_enum_get_value
argument_list|(
name|GIMP_TYPE_USER_DIRECTORY
argument_list|,
name|py_type
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|type
argument_list|)
condition|)
return|return
name|NULL
return|;
name|user_dir
operator|=
name|gimp_user_directory
argument_list|(
name|type
argument_list|)
expr_stmt|;
if|if
condition|(
name|user_dir
condition|)
block|{
name|ret
operator|=
name|PyString_FromString
argument_list|(
name|user_dir
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
name|ret
operator|=
name|Py_None
expr_stmt|;
block|}
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_fonts_refresh (PyObject * self)
name|pygimp_fonts_refresh
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|)
block|{
if|if
condition|(
operator|!
name|gimp_fonts_refresh
argument_list|()
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not refresh fonts"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_checks_get_shades (PyObject * self,PyObject * args,PyObject * kwargs)
name|pygimp_checks_get_shades
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|int
name|type
decl_stmt|;
name|guchar
name|light
decl_stmt|,
name|dark
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"type"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"i:checks_get_shades"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|type
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|type
operator|<
name|GIMP_CHECK_TYPE_LIGHT_CHECKS
operator|||
name|type
operator|>
name|GIMP_CHECK_TYPE_BLACK_ONLY
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|PyExc_ValueError
argument_list|,
literal|"Invalid check type"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|gimp_checks_get_shades
argument_list|(
name|type
argument_list|,
operator|&
name|light
argument_list|,
operator|&
name|dark
argument_list|)
expr_stmt|;
return|return
name|Py_BuildValue
argument_list|(
literal|"(ii)"
argument_list|,
name|light
argument_list|,
name|dark
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_fonts_get_list (PyObject * self,PyObject * args,PyObject * kwargs)
name|pygimp_fonts_get_list
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|char
modifier|*
modifier|*
name|list
decl_stmt|,
modifier|*
name|filter
init|=
name|NULL
decl_stmt|;
name|int
name|num
decl_stmt|,
name|i
decl_stmt|;
name|PyObject
modifier|*
name|ret
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"filter"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"|s:fonts_get_list"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|filter
argument_list|)
condition|)
return|return
name|NULL
return|;
name|list
operator|=
name|gimp_fonts_get_list
argument_list|(
name|filter
argument_list|,
operator|&
name|num
argument_list|)
expr_stmt|;
if|if
condition|(
name|num
operator|==
literal|0
condition|)
block|{
name|PyErr_SetString
argument_list|(
name|pygimp_error
argument_list|,
literal|"could not get font list"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|ret
operator|=
name|PyList_New
argument_list|(
name|num
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num
condition|;
name|i
operator|++
control|)
block|{
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|PyString_FromString
argument_list|(
name|list
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|list
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
name|g_free
argument_list|(
name|list
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|vectors_to_objects (int num_vectors,int * vectors)
name|vectors_to_objects
parameter_list|(
name|int
name|num_vectors
parameter_list|,
name|int
modifier|*
name|vectors
parameter_list|)
block|{
name|PyObject
modifier|*
name|ret
decl_stmt|;
name|int
name|i
decl_stmt|;
name|ret
operator|=
name|PyList_New
argument_list|(
name|num_vectors
argument_list|)
expr_stmt|;
if|if
condition|(
name|ret
operator|==
name|NULL
condition|)
goto|goto
name|done
goto|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|num_vectors
condition|;
name|i
operator|++
control|)
name|PyList_SetItem
argument_list|(
name|ret
argument_list|,
name|i
argument_list|,
name|pygimp_vectors_new
argument_list|(
name|vectors
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
name|done
label|:
name|g_free
argument_list|(
name|vectors
argument_list|)
expr_stmt|;
return|return
name|ret
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_vectors_import_from_file (PyObject * self,PyObject * args,PyObject * kwargs)
name|pygimp_vectors_import_from_file
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|PyGimpImage
modifier|*
name|img
decl_stmt|;
name|PyObject
modifier|*
name|py_file
decl_stmt|;
name|gboolean
name|merge
init|=
name|FALSE
decl_stmt|,
name|scale
init|=
name|FALSE
decl_stmt|;
name|int
modifier|*
name|vectors
decl_stmt|,
name|num_vectors
decl_stmt|;
name|gboolean
name|success
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"image"
block|,
literal|"svg_file"
block|,
literal|"merge"
block|,
literal|"scale"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"O!O|ii:vectors_import_from_file"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|PyGimpImage_Type
argument_list|,
operator|&
name|img
argument_list|,
operator|&
name|py_file
argument_list|,
operator|&
name|merge
argument_list|,
operator|&
name|scale
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|PyString_Check
argument_list|(
name|py_file
argument_list|)
condition|)
block|{
name|success
operator|=
name|gimp_vectors_import_from_file
argument_list|(
name|img
operator|->
name|ID
argument_list|,
name|PyString_AsString
argument_list|(
name|py_file
argument_list|)
argument_list|,
name|merge
argument_list|,
name|scale
argument_list|,
operator|&
name|num_vectors
argument_list|,
operator|&
name|vectors
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|PyObject
modifier|*
name|chunk_size
decl_stmt|,
modifier|*
name|buffer
decl_stmt|,
modifier|*
name|read_method
decl_stmt|;
name|chunk_size
operator|=
name|PyInt_FromLong
argument_list|(
literal|16
operator|*
literal|1024
argument_list|)
expr_stmt|;
if|if
condition|(
name|chunk_size
operator|==
name|NULL
condition|)
return|return
name|NULL
return|;
name|buffer
operator|=
name|PyString_FromString
argument_list|(
literal|""
argument_list|)
expr_stmt|;
if|if
condition|(
name|buffer
operator|==
name|NULL
condition|)
block|{
name|Py_DECREF
argument_list|(
name|chunk_size
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|read_method
operator|=
name|PyString_FromString
argument_list|(
literal|"read"
argument_list|)
expr_stmt|;
if|if
condition|(
name|read_method
operator|==
name|NULL
operator|||
operator|!
name|PyCallable_Check
argument_list|(
name|read_method
argument_list|)
condition|)
block|{
name|Py_XDECREF
argument_list|(
name|read_method
argument_list|)
expr_stmt|;
name|PyErr_SetString
argument_list|(
name|PyExc_TypeError
argument_list|,
literal|"svg_file must be an object that has a \"read\" "
literal|"method, or a filename (str)"
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
while|while
condition|(
literal|1
condition|)
block|{
name|PyObject
modifier|*
name|chunk
decl_stmt|;
name|chunk
operator|=
name|PyObject_CallMethodObjArgs
argument_list|(
name|py_file
argument_list|,
name|read_method
argument_list|,
name|chunk_size
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|chunk
operator|||
operator|!
name|PyString_Check
argument_list|(
name|chunk
argument_list|)
condition|)
block|{
name|Py_XDECREF
argument_list|(
name|chunk
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|chunk_size
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|buffer
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|read_method
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
if|if
condition|(
name|PyString_GET_SIZE
argument_list|(
name|chunk
argument_list|)
operator|!=
literal|0
condition|)
block|{
name|PyString_ConcatAndDel
argument_list|(
operator|&
name|buffer
argument_list|,
name|chunk
argument_list|)
expr_stmt|;
if|if
condition|(
name|buffer
operator|==
name|NULL
condition|)
block|{
name|Py_DECREF
argument_list|(
name|chunk_size
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|read_method
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
block|}
else|else
block|{
name|Py_DECREF
argument_list|(
name|chunk
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
name|success
operator|=
name|gimp_vectors_import_from_string
argument_list|(
name|img
operator|->
name|ID
argument_list|,
name|PyString_AsString
argument_list|(
name|buffer
argument_list|)
argument_list|,
name|PyString_Size
argument_list|(
name|buffer
argument_list|)
argument_list|,
name|merge
argument_list|,
name|scale
argument_list|,
operator|&
name|num_vectors
argument_list|,
operator|&
name|vectors
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|chunk_size
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|buffer
argument_list|)
expr_stmt|;
name|Py_DECREF
argument_list|(
name|read_method
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|success
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"Vectors import failed: %s"
argument_list|,
name|gimp_get_pdb_error
argument_list|()
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|vectors_to_objects
argument_list|(
name|num_vectors
argument_list|,
name|vectors
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|pygimp_vectors_import_from_string (PyObject * self,PyObject * args,PyObject * kwargs)
name|pygimp_vectors_import_from_string
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|,
name|PyObject
modifier|*
name|kwargs
parameter_list|)
block|{
name|PyGimpImage
modifier|*
name|img
decl_stmt|;
specifier|const
name|char
modifier|*
name|svg_string
decl_stmt|;
name|int
name|length
decl_stmt|;
name|gboolean
name|merge
init|=
name|FALSE
decl_stmt|,
name|scale
init|=
name|FALSE
decl_stmt|;
name|int
modifier|*
name|vectors
decl_stmt|,
name|num_vectors
decl_stmt|;
name|gboolean
name|success
decl_stmt|;
specifier|static
name|char
modifier|*
name|kwlist
index|[]
init|=
block|{
literal|"image"
block|,
literal|"svg_string"
block|,
literal|"merge"
block|,
literal|"scale"
block|,
name|NULL
block|}
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTupleAndKeywords
argument_list|(
name|args
argument_list|,
name|kwargs
argument_list|,
literal|"O!s#|ii:vectors_import_from_string"
argument_list|,
name|kwlist
argument_list|,
operator|&
name|PyGimpImage_Type
argument_list|,
operator|&
name|img
argument_list|,
operator|&
name|svg_string
argument_list|,
operator|&
name|length
argument_list|,
operator|&
name|merge
argument_list|,
operator|&
name|scale
argument_list|)
condition|)
return|return
name|NULL
return|;
name|success
operator|=
name|gimp_vectors_import_from_string
argument_list|(
name|img
operator|->
name|ID
argument_list|,
name|svg_string
argument_list|,
name|length
argument_list|,
name|merge
argument_list|,
name|scale
argument_list|,
operator|&
name|num_vectors
argument_list|,
operator|&
name|vectors
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|success
condition|)
block|{
name|PyErr_Format
argument_list|(
name|pygimp_error
argument_list|,
literal|"Vectors import failed: %s"
argument_list|,
name|gimp_get_pdb_error
argument_list|()
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|vectors_to_objects
argument_list|(
name|num_vectors
argument_list|,
name|vectors
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|id2image (PyObject * self,PyObject * args)
name|id2image
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:_id2image"
argument_list|,
operator|&
name|id
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|id
operator|>=
literal|0
condition|)
return|return
name|pygimp_image_new
argument_list|(
name|id
argument_list|)
return|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|id2drawable (PyObject * self,PyObject * args)
name|id2drawable
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:_id2drawable"
argument_list|,
operator|&
name|id
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|id
operator|>=
literal|0
condition|)
return|return
name|pygimp_drawable_new
argument_list|(
name|NULL
argument_list|,
name|id
argument_list|)
return|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|id2display (PyObject * self,PyObject * args)
name|id2display
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:_id2display"
argument_list|,
operator|&
name|id
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|id
operator|>=
literal|0
condition|)
return|return
name|pygimp_display_new
argument_list|(
name|id
argument_list|)
return|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_function
specifier|static
name|PyObject
modifier|*
DECL|function|id2vectors (PyObject * self,PyObject * args)
name|id2vectors
parameter_list|(
name|PyObject
modifier|*
name|self
parameter_list|,
name|PyObject
modifier|*
name|args
parameter_list|)
block|{
name|int
name|id
decl_stmt|;
if|if
condition|(
operator|!
name|PyArg_ParseTuple
argument_list|(
name|args
argument_list|,
literal|"i:_id2vectors"
argument_list|,
operator|&
name|id
argument_list|)
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|id
operator|>=
literal|0
condition|)
return|return
name|pygimp_vectors_new
argument_list|(
name|id
argument_list|)
return|;
name|Py_INCREF
argument_list|(
name|Py_None
argument_list|)
expr_stmt|;
return|return
name|Py_None
return|;
block|}
end_function

begin_comment
comment|/* List of methods defined in the module */
end_comment

begin_decl_stmt
DECL|variable|gimp_methods
specifier|static
name|struct
name|PyMethodDef
name|gimp_methods
index|[]
init|=
block|{
block|{
literal|"main"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_main
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"quit"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_quit
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"message"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_message
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"exit"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_exit
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"set_data"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_set_data
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"get_data"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_get_data
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"progress_init"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_progress_init
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"progress_update"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_progress_update
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"progress_install"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_progress_install
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"progress_uninstall"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_progress_uninstall
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"image_list"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_image_list
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"install_procedure"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_install_procedure
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"install_temp_proc"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_install_temp_proc
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"uninstall_temp_proc"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_uninstall_temp_proc
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"register_magic_load_handler"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_register_magic_load_handler
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"register_load_handler"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_register_load_handler
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"register_save_handler"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_register_save_handler
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"domain_register"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_domain_register
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"menu_register"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_menu_register
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gamma"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_gamma
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"gtkrc"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_gtkrc
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"personal_rc_file"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_personal_rc_file
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"context_push"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_context_push
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"context_pop"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_context_pop
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"get_background"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_get_background
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"get_foreground"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_get_foreground
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"set_background"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_set_background
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"set_foreground"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_set_foreground
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradients_get_list"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_gradients_get_list
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"context_get_gradient"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_context_get_gradient
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"context_set_gradient"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_context_set_gradient
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradients_get_gradient"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_gradients_get_gradient
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"gradients_set_gradient"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_gradients_set_gradient
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradient_get_uniform_samples"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_gradient_get_uniform_samples
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradient_get_custom_samples"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_gradient_get_custom_samples
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradients_sample_uniform"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_gradients_sample_uniform
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"gradients_sample_custom"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_gradients_sample_custom
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"delete"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_delete
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"displays_flush"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_displays_flush
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"displays_reconnect"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_displays_reconnect
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"tile_cache_size"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_tile_cache_size
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"tile_cache_ntiles"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_tile_cache_ntiles
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"tile_width"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_tile_width
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"tile_height"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_tile_height
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"extension_ack"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_extension_ack
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"extension_enable"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_extension_enable
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"extension_process"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_extension_process
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_find"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_parasite_find
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_attach"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_parasite_attach
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"attach_new_parasite"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_attach_new_parasite
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_detach"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_parasite_detach
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"parasite_list"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_parasite_list
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"show_tool_tips"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_show_tool_tips
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"show_help_button"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_show_help_button
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"check_size"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_check_size
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"check_type"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_check_type
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"default_display"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_default_display
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"wm_class"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_wm_class
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"display_name"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_display_name
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"monitor_number"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_monitor_number
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"get_progname"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_get_progname
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"user_directory"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_user_directory
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"fonts_refresh"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_fonts_refresh
block|,
name|METH_NOARGS
block|}
block|,
block|{
literal|"fonts_get_list"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_fonts_get_list
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"checks_get_shades"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_checks_get_shades
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"vectors_import_from_file"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_vectors_import_from_file
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"vectors_import_from_string"
block|,
operator|(
name|PyCFunction
operator|)
name|pygimp_vectors_import_from_string
block|,
name|METH_VARARGS
operator||
name|METH_KEYWORDS
block|}
block|,
block|{
literal|"_id2image"
block|,
operator|(
name|PyCFunction
operator|)
name|id2image
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"_id2drawable"
block|,
operator|(
name|PyCFunction
operator|)
name|id2drawable
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"_id2display"
block|,
operator|(
name|PyCFunction
operator|)
name|id2display
block|,
name|METH_VARARGS
block|}
block|,
block|{
literal|"_id2vectors"
block|,
operator|(
name|PyCFunction
operator|)
name|id2vectors
block|,
name|METH_VARARGS
block|}
block|,
block|{
name|NULL
block|,
operator|(
name|PyCFunction
operator|)
name|NULL
block|,
literal|0
block|,
name|NULL
block|}
comment|/* sentinel */
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|pygimp_api_functions
specifier|static
name|struct
name|_PyGimp_Functions
name|pygimp_api_functions
init|=
block|{
operator|&
name|PyGimpImage_Type
block|,
name|pygimp_image_new
block|,
operator|&
name|PyGimpDisplay_Type
block|,
name|pygimp_display_new
block|,
operator|&
name|PyGimpItem_Type
block|,
name|pygimp_item_new
block|,
operator|&
name|PyGimpDrawable_Type
block|,
name|pygimp_drawable_new
block|,
operator|&
name|PyGimpLayer_Type
block|,
name|pygimp_layer_new
block|,
operator|&
name|PyGimpChannel_Type
block|,
name|pygimp_channel_new
block|,
operator|&
name|PyGimpVectors_Type
block|,
name|pygimp_vectors_new
block|, }
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* Initialization function for the module (*must* be called initgimp) */
end_comment

begin_decl_stmt
DECL|variable|gimp_module_documentation
specifier|static
name|char
name|gimp_module_documentation
index|[]
init|=
literal|"This module provides interfaces to allow you to write gimp plugins"
decl_stmt|;
end_decl_stmt

begin_function_decl
name|void
name|initgimp
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|PyMODINIT_FUNC
DECL|function|initgimp (void)
name|initgimp
parameter_list|(
name|void
parameter_list|)
block|{
name|PyObject
modifier|*
name|m
decl_stmt|;
name|PyGimpPDB_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpPDB_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpPDB_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpPDB_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpPDBFunction_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpPDBFunction_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpPDBFunction_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpPDBFunction_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpImage_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpImage_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpImage_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpImage_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpDisplay_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpDisplay_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpDisplay_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpDisplay_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpLayer_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpLayer_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpLayer_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpLayer_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpChannel_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpChannel_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpChannel_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpChannel_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpTile_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpTile_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpTile_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpPixelRgn_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpPixelRgn_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpPixelRgn_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpParasite_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpParasite_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpParasite_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpParasite_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpVectorsStroke_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpVectorsStroke_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpVectorsStroke_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpVectorsStroke_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpVectorsBezierStroke_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpVectorsBezierStroke_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpVectorsBezierStroke_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpVectorsBezierStroke_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpVectors_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpVectors_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpVectors_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpVectors_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|PyGimpPixelFetcher_Type
operator|.
name|ob_type
operator|=
operator|&
name|PyType_Type
expr_stmt|;
name|PyGimpPixelFetcher_Type
operator|.
name|tp_alloc
operator|=
name|PyType_GenericAlloc
expr_stmt|;
name|PyGimpPixelFetcher_Type
operator|.
name|tp_new
operator|=
name|PyType_GenericNew
expr_stmt|;
if|if
condition|(
name|PyType_Ready
argument_list|(
operator|&
name|PyGimpPixelFetcher_Type
argument_list|)
operator|<
literal|0
condition|)
return|return;
name|pygimp_init_pygobject
argument_list|()
expr_stmt|;
name|init_pygimpcolor
argument_list|()
expr_stmt|;
comment|/* initialize i18n support */
name|bindtextdomain
argument_list|(
name|GETTEXT_PACKAGE
literal|"-python"
argument_list|,
name|gimp_locale_directory
argument_list|()
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|HAVE_BIND_TEXTDOMAIN_CODESET
name|bind_textdomain_codeset
argument_list|(
name|GETTEXT_PACKAGE
literal|"-python"
argument_list|,
literal|"UTF-8"
argument_list|)
expr_stmt|;
endif|#
directive|endif
comment|/* set the default python encoding to utf-8 */
name|PyUnicode_SetDefaultEncoding
argument_list|(
literal|"utf-8"
argument_list|)
expr_stmt|;
comment|/* Create the module and add the functions */
name|m
operator|=
name|Py_InitModule4
argument_list|(
literal|"gimp"
argument_list|,
name|gimp_methods
argument_list|,
name|gimp_module_documentation
argument_list|,
name|NULL
argument_list|,
name|PYTHON_API_VERSION
argument_list|)
expr_stmt|;
comment|/* Add some symbolic constants to the module */
name|pygimp_error
operator|=
name|PyErr_NewException
argument_list|(
literal|"gimp.error"
argument_list|,
name|PyExc_RuntimeError
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"error"
argument_list|,
name|pygimp_error
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"pdb"
argument_list|,
name|pygimp_pdb_new
argument_list|()
argument_list|)
expr_stmt|;
comment|/* export the types used in gimpmodule */
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpImage_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"Image"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpImage_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpItem_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"Item"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpItem_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpDrawable_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"Drawable"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpDrawable_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpLayer_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"Layer"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpLayer_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpChannel_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"Channel"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpChannel_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpDisplay_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"Display"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpDisplay_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpTile_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"Tile"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpTile_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpPixelRgn_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"PixelRgn"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpPixelRgn_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpParasite_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"Parasite"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpParasite_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpVectorsBezierStroke_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"VectorsBezierStroke"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpVectorsBezierStroke_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpVectors_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"Vectors"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpVectors_Type
argument_list|)
expr_stmt|;
name|Py_INCREF
argument_list|(
operator|&
name|PyGimpPixelFetcher_Type
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"PixelFetcher"
argument_list|,
operator|(
name|PyObject
operator|*
operator|)
operator|&
name|PyGimpPixelFetcher_Type
argument_list|)
expr_stmt|;
comment|/* for other modules */
name|pygimp_api_functions
operator|.
name|pygimp_error
operator|=
name|pygimp_error
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"_PyGimp_API"
argument_list|,
name|PyCObject_FromVoidPtr
argument_list|(
operator|&
name|pygimp_api_functions
argument_list|,
name|NULL
argument_list|)
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"version"
argument_list|,
name|Py_BuildValue
argument_list|(
literal|"(iii)"
argument_list|,
name|gimp_major_version
argument_list|,
name|gimp_minor_version
argument_list|,
name|gimp_micro_version
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Some environment constants */
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"directory"
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_directory
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"data_directory"
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_data_directory
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"locale_directory"
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_locale_directory
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"sysconf_directory"
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_sysconf_directory
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|PyModule_AddObject
argument_list|(
name|m
argument_list|,
literal|"plug_in_directory"
argument_list|,
name|PyString_FromString
argument_list|(
name|gimp_plug_in_directory
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
comment|/* Check for errors */
if|if
condition|(
name|PyErr_Occurred
argument_list|()
condition|)
name|Py_FatalError
argument_list|(
literal|"can't initialize module gimp"
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

