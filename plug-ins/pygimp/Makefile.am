## Process this file with automake to produce Makefile.in

libgimpui = $(top_builddir)/libgimp/libgimpui-$(GIMP_API_VERSION).la
libgimpconfig = $(top_builddir)/libgimpconfig/libgimpconfig-$(GIMP_API_VERSION).la
libgimpwidgets = $(top_builddir)/libgimpwidgets/libgimpwidgets-$(GIMP_API_VERSION).la
libgimp = $(top_builddir)/libgimp/libgimp-$(GIMP_API_VERSION).la
libgimpcolor = $(top_builddir)/libgimpcolor/libgimpcolor-$(GIMP_API_VERSION).la
libgimpbase = $(top_builddir)/libgimpbase/libgimpbase-$(GIMP_API_VERSION).la
libgimpprocbrowser = $(top_builddir)/plug-ins/dbbrowser/libgimpprocbrowser.la
libgimpmath = $(top_builddir)/libgimpmath/libgimpmath-$(GIMP_API_VERSION).la

SUBDIRS = plug-ins

if PLATFORM_WIN32
no_undefined = -no-undefined
path_separator = ;
else
path_separator = :
endif

AM_CFLAGS = $(PYGIMP_EXTRA_CFLAGS)

INCLUDES = -I$(top_srcdir) $(PYTHON_INCLUDES) $(PYGTK_CFLAGS) $(GTK_CFLAGS)

pygimpbase = python

pygimpdir = $(gimpplugindir)/python

pygimp_LTLIBRARIES = gimp.la _gimpenums.la gimpcolor.la gimpprocbrowser.la

gimp_la_SOURCES = \
	gimpmodule.c		\
	pygimp-display.c	\
	pygimp-drawable.c	\
	pygimp-image.c		\
	pygimp-parasite.c	\
	pygimp-pdb.c		\
	pygimp-tile.c		\
	pygimp.h		\
	pygimp-api.h

gimp_la_LDFLAGS = -module -avoid-version $(no_undefined) \
	-export-symbols-regex initgimp

gimp_la_LIBADD = \
	$(libgimp)		\
	$(libgimpcolor)		\
	$(libgimpbase)		\
	$(GLIB_LIBS)		\
	$(PYLINK_LIBS)		\
	$(RT_LIBS)

_gimpenums_la_SOURCES = \
	gimpenumsmodule.c

_gimpenums_la_LDFLAGS = -module -avoid-version $(no_undefined) \
	-export-symbols-regex init_gimpenums

_gimpenums_la_LIBADD = \
	$(libgimp)		\
	$(libgimpcolor)		\
	$(libgimpbase)		\
	$(GLIB_LIBS)		\
	$(PYLINK_LIBS)		\
	$(RT_LIBS)

gimpcolor_la_SOURCES = \
	gimpcolormodule.c	\
	pygimp-rgb.c		\
	pygimpcolor.h

gimpcolor_la_LDFLAGS = -module -avoid-version $(no_undefined) \
	-export-symbols-regex initgimpcolor

gimpcolor_la_LIBADD = \
	$(libgimpcolor)	\
	$(GLIB_LIBS)	\
	$(PYLINK_LIBS)

gimpprocbrowser_la_SOURCES = \
	procbrowser.c

gimpprocbrowser_la_LDFLAGS = -module -avoid-version $(no_undefined) \
	-export-symbols-regex initgimpprocbrowser

gimpprocbrowser_la_LIBADD = \
	$(libgimpprocbrowser)	\
	$(libgimpui)		\
	$(libgimpwidgets)	\
	$(libgimpconfig)	\
	$(libgimpmath)		\
	$(libgimp)		\
	$(libgimpcolor)		\
	$(libgimpbase)		\
	$(GTK_LIBS)		\
	$(PYLINK_LIBS)		\
	$(RT_LIBS)		\
	$(INTLLIBS)

pygimp_PYTHON = \
	gimpplugin.py	\
	gimpenums.py	\
	gimpshelf.py	\
	gimpui.py	\
	gimpfu.py

pygimp_DATA = pygimp-logo.png

pyenvdir = $(gimpplugindir)/environ
pyinterpdir = $(gimpplugindir)/interpreters

pyenvfile = $(pyenvdir)/pygimp.env
pyinterpfile = $(pyinterpdir)/pygimp.interp

install-env-file:
	$(mkinstalldirs) '$(DESTDIR)$(pyenvdir)'
	echo '$(path_separator) PYTHONPATH=$${gimp_plug_in_dir}/$(pygimpbase)' > '$(DESTDIR)$(pyenvfile)'

install-interp-file:
	$(mkinstalldirs) '$(DESTDIR)$(pyinterpdir)'
	echo 'python=$(PYBIN_PATH)' > '$(DESTDIR)$(pyinterpfile)'
	echo '/usr/bin/python=$(PYBIN_PATH)' >> '$(DESTDIR)$(pyinterpfile)'
	echo ':Python:E::py::python:' >> '$(DESTDIR)$(pyinterpfile)'

install-data-local: install-env-file install-interp-file

uninstall-local:
	rm -f '$(DESTDIR)$(pyenvfile)' '$(DESTDIR)$(pyinterpfile)'

EXTRA_DIST = \
	$(pygimp_DATA)	\
	makefile.msc
