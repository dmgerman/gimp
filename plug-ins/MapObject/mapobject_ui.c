begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/**************************************************************/
end_comment

begin_comment
comment|/* Dialog creation and updaters, callbacks and event-handlers */
end_comment

begin_comment
comment|/**************************************************************/
end_comment

begin_include
include|#
directive|include
file|"mapobject_ui.h"
end_include

begin_include
include|#
directive|include
file|"mapobject_pixmaps.h"
end_include

begin_decl_stmt
specifier|extern
name|MapObjectValues
name|mapvals
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|appwin
name|GckApplicationWindow
modifier|*
name|appwin
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|color_select_diag
name|GtkWidget
modifier|*
name|color_select_diag
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|options_note_book
name|GtkNotebook
modifier|*
name|options_note_book
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|tooltips
name|GtkTooltips
modifier|*
name|tooltips
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gc
name|GdkGC
modifier|*
name|gc
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|previewarea
DECL|variable|pointlightwid
DECL|variable|dirlightwid
name|GtkWidget
modifier|*
name|previewarea
decl_stmt|,
modifier|*
name|pointlightwid
decl_stmt|,
modifier|*
name|dirlightwid
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|xentry
DECL|variable|yentry
DECL|variable|zentry
name|GtkWidget
modifier|*
name|xentry
decl_stmt|,
modifier|*
name|yentry
decl_stmt|,
modifier|*
name|zentry
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|box_page
DECL|variable|cylinder_page
name|GtkWidget
modifier|*
name|box_page
init|=
name|NULL
decl_stmt|,
modifier|*
name|cylinder_page
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|old_light_color
name|GckRGB
name|old_light_color
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|color_dialog_id
name|gint
name|color_dialog_id
init|=
operator|-
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|left_button_pressed
DECL|variable|light_hit
name|guint
name|left_button_pressed
init|=
name|FALSE
decl_stmt|,
name|light_hit
init|=
name|FALSE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|blackpixel
DECL|variable|whitepixel
name|guint32
name|blackpixel
decl_stmt|,
name|whitepixel
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|angle_scale_vals
name|GckScaleValues
name|angle_scale_vals
init|=
block|{
literal|180
block|,
literal|0.0
block|,
operator|-
literal|180.0
block|,
literal|180.0
block|,
literal|0.1
block|,
literal|1.0
block|,
literal|1.0
block|,
name|GTK_UPDATE_CONTINUOUS
block|,
name|TRUE
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|scale_scale_vals
name|GckScaleValues
name|scale_scale_vals
init|=
block|{
literal|180
block|,
literal|0.5
block|,
literal|0.01
block|,
literal|5.0
block|,
literal|0.05
block|,
literal|0.05
block|,
literal|0.05
block|,
name|GTK_UPDATE_CONTINUOUS
block|,
name|TRUE
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|cyl_scale_vals
name|GckScaleValues
name|cyl_scale_vals
init|=
block|{
literal|180
block|,
literal|0.5
block|,
literal|0.01
block|,
literal|2.0
block|,
literal|0.05
block|,
literal|0.05
block|,
literal|0.05
block|,
name|GTK_UPDATE_CONTINUOUS
block|,
name|TRUE
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|sample_scale_vals
name|GckScaleValues
name|sample_scale_vals
init|=
block|{
literal|128
block|,
literal|3.0
block|,
literal|1.0
block|,
literal|6.0
block|,
literal|1.0
block|,
literal|1.0
block|,
literal|1.0
block|,
name|GTK_UPDATE_CONTINUOUS
block|,
name|TRUE
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|light_labels
name|gchar
modifier|*
name|light_labels
index|[]
init|=
block|{
literal|"Point light"
block|,
literal|"Directional light"
block|,
literal|"No light"
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|map_labels
name|gchar
modifier|*
name|map_labels
index|[]
init|=
block|{
literal|"Plane"
block|,
literal|"Sphere"
block|,
literal|"Box"
block|,
literal|"Cylinder"
block|,
name|NULL
block|}
decl_stmt|;
end_decl_stmt

begin_comment
comment|/**********/
end_comment

begin_comment
comment|/* Protos */
end_comment

begin_comment
comment|/**********/
end_comment

begin_function_decl
name|void
name|create_main_dialog
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|create_main_notebook
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/**************************/
end_comment

begin_comment
comment|/* Callbacks and updaters */
end_comment

begin_comment
comment|/**************************/
end_comment

begin_function_decl
name|gint
name|preview_events
parameter_list|(
name|GtkWidget
modifier|*
name|area
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|update_slider
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|update_angle_sliders
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|update_light_pos_entries
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|xyzval_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkEntry
modifier|*
name|entry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|entry_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkEntry
modifier|*
name|entry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|angle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkScale
modifier|*
name|scale
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|scale_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkScale
modifier|*
name|scale
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|togglegrid_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|toggletile_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|toggleanti_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|toggletips_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|toggletrans_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|lightmenu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|preview_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|apply_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|exit_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|color_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|color_cancel_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|light_color_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|color_changed_callback
parameter_list|(
name|GtkColorSelection
modifier|*
name|colorsel
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gint
name|color_delete_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gint
name|box_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|box_drawable_callback
parameter_list|(
name|gint32
name|id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|gint
name|cylinder_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|cylinder_drawable_callback
parameter_list|(
name|gint32
name|id
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|GtkWidget
modifier|*
name|create_options_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|GtkWidget
modifier|*
name|create_light_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|GtkWidget
modifier|*
name|create_material_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|GtkWidget
modifier|*
name|create_orientation_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|GtkWidget
modifier|*
name|create_box_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|GtkWidget
modifier|*
name|create_cylinder_page
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/******************/
end_comment

begin_comment
comment|/* Implementation */
end_comment

begin_comment
comment|/******************/
end_comment

begin_comment
comment|/**********************************************************/
end_comment

begin_comment
comment|/* Update entry fields that affect the preview parameters */
end_comment

begin_comment
comment|/**********************************************************/
end_comment

begin_function
DECL|function|xyzval_update (GtkWidget * widget,GtkEntry * entry)
name|void
name|xyzval_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkEntry
modifier|*
name|entry
parameter_list|)
block|{
name|gdouble
modifier|*
name|valueptr
decl_stmt|;
name|gdouble
name|value
decl_stmt|;
name|valueptr
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
name|value
operator|=
name|atof
argument_list|(
name|gtk_entry_get_text
argument_list|(
name|entry
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|valueptr
operator|=
name|value
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
name|TRUE
condition|)
name|draw_preview_wireframe
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*********************/
end_comment

begin_comment
comment|/* Std. entry update */
end_comment

begin_comment
comment|/*********************/
end_comment

begin_function
DECL|function|entry_update (GtkWidget * widget,GtkEntry * entry)
name|void
name|entry_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkEntry
modifier|*
name|entry
parameter_list|)
block|{
name|gdouble
modifier|*
name|valueptr
decl_stmt|;
name|gdouble
name|value
decl_stmt|;
name|valueptr
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
name|value
operator|=
name|atof
argument_list|(
name|gtk_entry_get_text
argument_list|(
name|entry
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|valueptr
operator|=
name|value
expr_stmt|;
block|}
end_function

begin_comment
comment|/***************************************************/
end_comment

begin_comment
comment|/* Update angle sliders (redraw grid if necessary) */
end_comment

begin_comment
comment|/***************************************************/
end_comment

begin_function
DECL|function|angle_update (GtkWidget * widget,GtkScale * scale)
name|void
name|angle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkScale
modifier|*
name|scale
parameter_list|)
block|{
name|gdouble
modifier|*
name|valueptr
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adjustment
decl_stmt|;
name|valueptr
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
name|adjustment
operator|=
name|gtk_range_get_adjustment
argument_list|(
name|GTK_RANGE
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|valueptr
operator|=
operator|(
name|gdouble
operator|)
name|adjustment
operator|->
name|value
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
name|TRUE
condition|)
name|draw_preview_wireframe
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/***************************************************/
end_comment

begin_comment
comment|/* Update scale sliders (redraw grid if necessary) */
end_comment

begin_comment
comment|/***************************************************/
end_comment

begin_function
DECL|function|boxscale_update (GtkWidget * widget,GtkScale * scale)
name|void
name|boxscale_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkScale
modifier|*
name|scale
parameter_list|)
block|{
name|gdouble
modifier|*
name|valueptr
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adjustment
decl_stmt|;
name|valueptr
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
name|adjustment
operator|=
name|gtk_range_get_adjustment
argument_list|(
name|GTK_RANGE
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|valueptr
operator|=
operator|(
name|gdouble
operator|)
name|adjustment
operator|->
name|value
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
name|TRUE
condition|)
name|draw_preview_wireframe
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
DECL|function|cylinderradius_update (GtkWidget * widget,GtkScale * scale)
name|void
name|cylinderradius_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkScale
modifier|*
name|scale
parameter_list|)
block|{
name|gdouble
modifier|*
name|valueptr
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adjustment
decl_stmt|;
name|valueptr
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
name|adjustment
operator|=
name|gtk_range_get_adjustment
argument_list|(
name|GTK_RANGE
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|valueptr
operator|=
operator|(
name|gdouble
operator|)
name|adjustment
operator|->
name|value
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
name|TRUE
condition|)
name|draw_preview_wireframe
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
DECL|function|cylinderlength_update (GtkWidget * widget,GtkScale * scale)
name|void
name|cylinderlength_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkScale
modifier|*
name|scale
parameter_list|)
block|{
name|gdouble
modifier|*
name|valueptr
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adjustment
decl_stmt|;
name|valueptr
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
name|adjustment
operator|=
name|gtk_range_get_adjustment
argument_list|(
name|GTK_RANGE
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|valueptr
operator|=
operator|(
name|gdouble
operator|)
name|adjustment
operator|->
name|value
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
name|TRUE
condition|)
name|draw_preview_wireframe
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
DECL|function|update_light_pos_entries (void)
name|void
name|update_light_pos_entries
parameter_list|(
name|void
parameter_list|)
block|{
name|gchar
name|entrytext
index|[
literal|64
index|]
decl_stmt|;
name|sprintf
argument_list|(
name|entrytext
argument_list|,
literal|"%f"
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|xentry
argument_list|)
argument_list|,
name|entrytext
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|entrytext
argument_list|,
literal|"%f"
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|yentry
argument_list|)
argument_list|,
name|entrytext
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|entrytext
argument_list|,
literal|"%f"
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|zentry
argument_list|)
argument_list|,
name|entrytext
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|update_slider (void)
name|void
name|update_slider
parameter_list|(
name|void
parameter_list|)
block|{ }
end_function

begin_function
DECL|function|update_angle_sliders (void)
name|void
name|update_angle_sliders
parameter_list|(
name|void
parameter_list|)
block|{ }
end_function

begin_comment
comment|/*********************/
end_comment

begin_comment
comment|/* Std. scale update */
end_comment

begin_comment
comment|/*********************/
end_comment

begin_function
DECL|function|scale_update (GtkWidget * widget,GtkScale * scale)
name|void
name|scale_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkScale
modifier|*
name|scale
parameter_list|)
block|{
name|gdouble
modifier|*
name|valueptr
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adjustment
decl_stmt|;
name|valueptr
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
name|adjustment
operator|=
name|gtk_range_get_adjustment
argument_list|(
name|GTK_RANGE
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
operator|*
name|valueptr
operator|=
operator|(
name|gdouble
operator|)
name|adjustment
operator|->
name|value
expr_stmt|;
block|}
end_function

begin_comment
comment|/**********************/
end_comment

begin_comment
comment|/* Std. toggle update */
end_comment

begin_comment
comment|/**********************/
end_comment

begin_function
DECL|function|toggle_update (GtkWidget * widget,GtkCheckButton * button)
name|void
name|toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
block|{
name|gint
modifier|*
name|value
decl_stmt|;
name|value
operator|=
operator|(
name|gint
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
operator|*
name|value
operator|=
operator|!
operator|(
operator|*
name|value
operator|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/***************************/
end_comment

begin_comment
comment|/* Show grid toggle update */
end_comment

begin_comment
comment|/***************************/
end_comment

begin_function
DECL|function|togglegrid_update (GtkWidget * widget,GtkCheckButton * button)
name|void
name|togglegrid_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
block|{
name|gint
modifier|*
name|value
decl_stmt|;
name|value
operator|=
operator|(
name|gint
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
operator|*
name|value
operator|=
operator|!
operator|(
operator|*
name|value
operator|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
name|TRUE
operator|&&
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|==
operator|-
literal|1
condition|)
name|draw_preview_wireframe
argument_list|()
expr_stmt|;
elseif|else
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
name|FALSE
operator|&&
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|!=
operator|-
literal|1
condition|)
block|{
name|gck_gc_set_foreground
argument_list|(
name|appwin
operator|->
name|visinfo
argument_list|,
name|gc
argument_list|,
literal|255
argument_list|,
literal|255
argument_list|,
literal|255
argument_list|)
expr_stmt|;
name|gck_gc_set_background
argument_list|(
name|appwin
operator|->
name|visinfo
argument_list|,
name|gc
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gdk_gc_set_function
argument_list|(
name|gc
argument_list|,
name|GDK_INVERT
argument_list|)
expr_stmt|;
name|clear_wireframe
argument_list|()
expr_stmt|;
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|=
operator|-
literal|1
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/****************************/
end_comment

begin_comment
comment|/* Tile image toggle update */
end_comment

begin_comment
comment|/****************************/
end_comment

begin_function
DECL|function|toggletile_update (GtkWidget * widget,GtkCheckButton * button)
name|void
name|toggletile_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
block|{
name|gint
modifier|*
name|value
decl_stmt|;
name|value
operator|=
operator|(
name|gint
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
operator|*
name|value
operator|=
operator|!
operator|(
operator|*
name|value
operator|)
expr_stmt|;
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|=
operator|-
literal|1
expr_stmt|;
block|}
end_function

begin_comment
comment|/******************************/
end_comment

begin_comment
comment|/* Antialiasing toggle update */
end_comment

begin_comment
comment|/******************************/
end_comment

begin_function
DECL|function|toggleanti_update (GtkWidget * widget,GtkCheckButton * button)
name|void
name|toggleanti_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
block|{
name|gint
modifier|*
name|value
decl_stmt|;
name|value
operator|=
operator|(
name|gint
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
operator|*
name|value
operator|=
operator|!
operator|(
operator|*
name|value
operator|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/**************************/
end_comment

begin_comment
comment|/* Tooltips toggle update */
end_comment

begin_comment
comment|/**************************/
end_comment

begin_function
DECL|function|toggletips_update (GtkWidget * widget,GtkCheckButton * button)
name|void
name|toggletips_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
block|{
name|gint
modifier|*
name|value
decl_stmt|;
name|value
operator|=
operator|(
name|gint
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
operator|*
name|value
operator|=
operator|!
operator|(
operator|*
name|value
operator|)
expr_stmt|;
if|if
condition|(
name|tooltips
operator|!=
name|NULL
condition|)
block|{
if|if
condition|(
name|mapvals
operator|.
name|tooltips_enabled
operator|==
name|TRUE
condition|)
name|gtk_tooltips_enable
argument_list|(
name|tooltips
argument_list|)
expr_stmt|;
else|else
name|gtk_tooltips_disable
argument_list|(
name|tooltips
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/****************************************/
end_comment

begin_comment
comment|/* Transparent background toggle update */
end_comment

begin_comment
comment|/****************************************/
end_comment

begin_function
DECL|function|toggletrans_update (GtkWidget * widget,GtkCheckButton * button)
name|void
name|toggletrans_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkCheckButton
modifier|*
name|button
parameter_list|)
block|{
name|gint
modifier|*
name|value
decl_stmt|;
name|value
operator|=
operator|(
name|gint
operator|*
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|)
expr_stmt|;
operator|*
name|value
operator|=
operator|!
operator|(
operator|*
name|value
operator|)
expr_stmt|;
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|=
operator|-
literal|1
expr_stmt|;
block|}
end_function

begin_comment
comment|/*****************************************/
end_comment

begin_comment
comment|/* Main window light type menu callback. */
end_comment

begin_comment
comment|/*****************************************/
end_comment

begin_function
DECL|function|lightmenu_callback (GtkWidget * widget,gpointer client_data)
name|void
name|lightmenu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|=
operator|(
name|gint
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"_GckOptionMenuItemID"
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|POINT_LIGHT
condition|)
block|{
name|gtk_widget_hide
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|==
name|DIRECTIONAL_LIGHT
condition|)
block|{
name|gtk_widget_hide
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gtk_widget_hide
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
name|gtk_widget_hide
argument_list|(
name|dirlightwid
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/***************************************/
end_comment

begin_comment
comment|/* Main window map type menu callback. */
end_comment

begin_comment
comment|/***************************************/
end_comment

begin_function
DECL|function|mapmenu_callback (GtkWidget * widget,gpointer client_data)
name|void
name|mapmenu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|mapvals
operator|.
name|maptype
operator|=
operator|(
name|MapType
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"_GckOptionMenuItemID"
argument_list|)
expr_stmt|;
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
name|TRUE
operator|&&
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|==
operator|-
literal|1
condition|)
name|draw_preview_wireframe
argument_list|()
expr_stmt|;
elseif|else
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
name|FALSE
operator|&&
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|!=
operator|-
literal|1
condition|)
block|{
name|gck_gc_set_foreground
argument_list|(
name|appwin
operator|->
name|visinfo
argument_list|,
name|gc
argument_list|,
literal|255
argument_list|,
literal|255
argument_list|,
literal|255
argument_list|)
expr_stmt|;
name|gck_gc_set_background
argument_list|(
name|appwin
operator|->
name|visinfo
argument_list|,
name|gc
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gdk_gc_set_function
argument_list|(
name|gc
argument_list|,
name|GDK_INVERT
argument_list|)
expr_stmt|;
name|clear_wireframe
argument_list|()
expr_stmt|;
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|=
operator|-
literal|1
expr_stmt|;
block|}
if|if
condition|(
name|mapvals
operator|.
name|maptype
operator|==
name|MAP_BOX
condition|)
block|{
if|if
condition|(
name|box_page
operator|==
name|NULL
condition|)
block|{
name|box_page
operator|=
name|create_box_page
argument_list|()
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Box"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|box_page
argument_list|,
name|label
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|box_page
operator|!=
name|NULL
condition|)
block|{
name|gtk_notebook_remove_page
argument_list|(
name|options_note_book
argument_list|,
name|g_list_length
argument_list|(
name|options_note_book
operator|->
name|children
argument_list|)
operator|-
literal|1
argument_list|)
expr_stmt|;
name|box_page
operator|=
name|NULL
expr_stmt|;
block|}
if|if
condition|(
name|mapvals
operator|.
name|maptype
operator|==
name|MAP_CYLINDER
condition|)
block|{
if|if
condition|(
name|cylinder_page
operator|==
name|NULL
condition|)
block|{
name|cylinder_page
operator|=
name|create_cylinder_page
argument_list|()
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Cylinder"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|cylinder_page
argument_list|,
name|label
argument_list|)
expr_stmt|;
block|}
block|}
elseif|else
if|if
condition|(
name|cylinder_page
operator|!=
name|NULL
condition|)
block|{
name|gtk_notebook_remove_page
argument_list|(
name|options_note_book
argument_list|,
name|g_list_length
argument_list|(
name|options_note_book
operator|->
name|children
argument_list|)
operator|-
literal|1
argument_list|)
expr_stmt|;
name|cylinder_page
operator|=
name|NULL
expr_stmt|;
block|}
block|}
block|}
end_function

begin_comment
comment|/******************************************/
end_comment

begin_comment
comment|/* Main window "Preview!" button callback */
end_comment

begin_comment
comment|/******************************************/
end_comment

begin_function
DECL|function|preview_callback (GtkWidget * widget,gpointer client_data)
name|void
name|preview_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|=
operator|-
literal|1
expr_stmt|;
block|}
end_function

begin_comment
comment|/*********************************************/
end_comment

begin_comment
comment|/* Main window "-" (zoom in) button callback */
end_comment

begin_comment
comment|/*********************************************/
end_comment

begin_function
DECL|function|zoomout_callback (GtkWidget * widget,gpointer client_data)
name|void
name|zoomout_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
if|if
condition|(
name|mapvals
operator|.
name|preview_zoom_factor
operator|<
literal|2
condition|)
block|{
name|mapvals
operator|.
name|preview_zoom_factor
operator|++
expr_stmt|;
if|if
condition|(
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|!=
operator|-
literal|1
condition|)
name|clear_wireframe
argument_list|()
expr_stmt|;
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*********************************************/
end_comment

begin_comment
comment|/* Main window "+" (zoom out) button callback */
end_comment

begin_comment
comment|/*********************************************/
end_comment

begin_function
DECL|function|zoomin_callback (GtkWidget * widget,gpointer client_data)
name|void
name|zoomin_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
if|if
condition|(
name|mapvals
operator|.
name|preview_zoom_factor
operator|>
literal|0
condition|)
block|{
name|mapvals
operator|.
name|preview_zoom_factor
operator|--
expr_stmt|;
if|if
condition|(
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|!=
operator|-
literal|1
condition|)
name|clear_wireframe
argument_list|()
expr_stmt|;
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/**********************************************/
end_comment

begin_comment
comment|/* Main window "Apply" button callback.       */
end_comment

begin_comment
comment|/* Render to GIMP image, close down and exit. */
end_comment

begin_comment
comment|/**********************************************/
end_comment

begin_function
DECL|function|apply_callback (GtkWidget * widget,gpointer client_data)
name|void
name|apply_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
if|if
condition|(
name|preview_rgb_data
operator|!=
name|NULL
condition|)
name|free
argument_list|(
name|preview_rgb_data
argument_list|)
expr_stmt|;
if|if
condition|(
name|image
operator|!=
name|NULL
condition|)
name|gdk_image_destroy
argument_list|(
name|image
argument_list|)
expr_stmt|;
name|gtk_object_unref
argument_list|(
name|GTK_OBJECT
argument_list|(
name|tooltips
argument_list|)
argument_list|)
expr_stmt|;
name|gck_application_window_destroy
argument_list|(
name|appwin
argument_list|)
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
name|compute_image
argument_list|()
expr_stmt|;
name|gtk_main_quit
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*************************************************************/
end_comment

begin_comment
comment|/* Main window "Cancel" button callback. Shut down and exit. */
end_comment

begin_comment
comment|/*************************************************************/
end_comment

begin_function
DECL|function|exit_callback (GtkWidget * widget,gpointer client_data)
name|void
name|exit_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
if|if
condition|(
name|preview_rgb_data
operator|!=
name|NULL
condition|)
name|free
argument_list|(
name|preview_rgb_data
argument_list|)
expr_stmt|;
if|if
condition|(
name|image
operator|!=
name|NULL
condition|)
name|gdk_image_destroy
argument_list|(
name|image
argument_list|)
expr_stmt|;
if|if
condition|(
name|backbuf
operator|.
name|image
operator|!=
name|NULL
condition|)
name|gdk_image_destroy
argument_list|(
name|backbuf
operator|.
name|image
argument_list|)
expr_stmt|;
name|gtk_object_unref
argument_list|(
name|GTK_OBJECT
argument_list|(
name|tooltips
argument_list|)
argument_list|)
expr_stmt|;
name|gck_application_window_destroy
argument_list|(
name|appwin
argument_list|)
expr_stmt|;
name|gtk_main_quit
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/*************************************/
end_comment

begin_comment
comment|/* Color dialog "Ok" button callback */
end_comment

begin_comment
comment|/*************************************/
end_comment

begin_function
DECL|function|color_ok_callback (GtkWidget * widget,gpointer client_data)
name|void
name|color_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|gtk_widget_destroy
argument_list|(
name|color_select_diag
argument_list|)
expr_stmt|;
name|color_select_diag
operator|=
name|NULL
expr_stmt|;
block|}
end_function

begin_comment
comment|/********************************************/
end_comment

begin_comment
comment|/* Color dialog "Cancel" button callback.   */
end_comment

begin_comment
comment|/* Close dialog& restore old color values. */
end_comment

begin_comment
comment|/********************************************/
end_comment

begin_function
DECL|function|color_changed_callback (GtkColorSelection * colorsel,gpointer client_data)
name|void
name|color_changed_callback
parameter_list|(
name|GtkColorSelection
modifier|*
name|colorsel
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|gdouble
name|color
index|[
literal|3
index|]
decl_stmt|;
name|gtk_color_selection_get_color
argument_list|(
name|colorsel
argument_list|,
name|color
argument_list|)
expr_stmt|;
name|mapvals
operator|.
name|lightsource
operator|.
name|color
operator|.
name|r
operator|=
name|color
index|[
literal|0
index|]
expr_stmt|;
name|mapvals
operator|.
name|lightsource
operator|.
name|color
operator|.
name|g
operator|=
name|color
index|[
literal|1
index|]
expr_stmt|;
name|mapvals
operator|.
name|lightsource
operator|.
name|color
operator|.
name|b
operator|=
name|color
index|[
literal|2
index|]
expr_stmt|;
block|}
end_function

begin_function
DECL|function|color_delete_callback (GtkWidget * widget,GdkEvent * event,gpointer client_data)
name|gint
name|color_delete_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|color_select_diag
operator|=
name|NULL
expr_stmt|;
return|return
operator|(
name|FALSE
operator|)
return|;
block|}
end_function

begin_function
DECL|function|color_cancel_callback (GtkWidget * widget,gpointer client_data)
name|void
name|color_cancel_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|gtk_widget_destroy
argument_list|(
name|color_select_diag
argument_list|)
expr_stmt|;
name|color_select_diag
operator|=
name|NULL
expr_stmt|;
block|}
end_function

begin_function
DECL|function|light_color_callback (GtkWidget * widget,gpointer client_data)
name|void
name|light_color_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|GtkColorSelectionDialog
modifier|*
name|csd
decl_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|lightsource
operator|.
name|type
operator|!=
name|NO_LIGHT
operator|&&
name|color_select_diag
operator|==
name|NULL
condition|)
block|{
name|color_select_diag
operator|=
name|gtk_color_selection_dialog_new
argument_list|(
literal|"Select lightsource color"
argument_list|)
expr_stmt|;
name|gtk_window_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|color_select_diag
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|color_select_diag
argument_list|)
expr_stmt|;
name|csd
operator|=
name|GTK_COLOR_SELECTION_DIALOG
argument_list|(
name|color_select_diag
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|csd
argument_list|)
argument_list|,
literal|"delete_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|color_delete_callback
argument_list|,
operator|(
name|gpointer
operator|)
name|color_select_diag
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|csd
operator|->
name|ok_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|color_ok_callback
argument_list|,
operator|(
name|gpointer
operator|)
name|color_select_diag
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|csd
operator|->
name|cancel_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|color_cancel_callback
argument_list|,
operator|(
name|gpointer
operator|)
name|color_select_diag
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|csd
operator|->
name|colorsel
argument_list|)
argument_list|,
literal|"color_changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|color_changed_callback
argument_list|,
operator|(
name|gpointer
operator|)
name|color_select_diag
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
DECL|function|box_constrain (gint32 image_id,gint32 drawable_id,gpointer data)
name|gint
name|box_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
name|drawable_id
operator|==
operator|-
literal|1
condition|)
return|return
operator|(
name|TRUE
operator|)
return|;
return|return
operator|(
name|gimp_drawable_color
argument_list|(
name|drawable_id
argument_list|)
operator|&&
operator|!
name|gimp_drawable_is_indexed
argument_list|(
name|drawable_id
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
DECL|function|box_drawable_callback (gint32 id,gpointer data)
name|void
name|box_drawable_callback
parameter_list|(
name|gint32
name|id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gint
name|i
decl_stmt|;
name|i
operator|=
operator|(
name|gint
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|data
argument_list|)
argument_list|,
literal|"_mapwid_id"
argument_list|)
expr_stmt|;
name|mapvals
operator|.
name|boxmap_id
index|[
name|i
index|]
operator|=
name|id
expr_stmt|;
block|}
end_function

begin_function
DECL|function|cylinder_constrain (gint32 image_id,gint32 drawable_id,gpointer data)
name|gint
name|cylinder_constrain
parameter_list|(
name|gint32
name|image_id
parameter_list|,
name|gint32
name|drawable_id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
name|drawable_id
operator|==
operator|-
literal|1
condition|)
return|return
operator|(
name|TRUE
operator|)
return|;
return|return
operator|(
name|gimp_drawable_color
argument_list|(
name|drawable_id
argument_list|)
operator|&&
operator|!
name|gimp_drawable_is_indexed
argument_list|(
name|drawable_id
argument_list|)
operator|)
return|;
block|}
end_function

begin_function
DECL|function|cylinder_drawable_callback (gint32 id,gpointer data)
name|void
name|cylinder_drawable_callback
parameter_list|(
name|gint32
name|id
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gint
name|i
decl_stmt|;
name|i
operator|=
operator|(
name|gint
operator|)
name|gtk_object_get_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|data
argument_list|)
argument_list|,
literal|"_mapwid_id"
argument_list|)
expr_stmt|;
name|mapvals
operator|.
name|cylindermap_id
index|[
name|i
index|]
operator|=
name|id
expr_stmt|;
block|}
end_function

begin_comment
comment|/******************************/
end_comment

begin_comment
comment|/* Preview area event handler */
end_comment

begin_comment
comment|/******************************/
end_comment

begin_function
DECL|function|preview_events (GtkWidget * area,GdkEvent * event)
name|gint
name|preview_events
parameter_list|(
name|GtkWidget
modifier|*
name|area
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|)
block|{
name|HVect
name|pos
decl_stmt|;
comment|/*  HMatrix RotMat;   gdouble a,b,c; */
switch|switch
condition|(
name|event
operator|->
name|type
condition|)
block|{
case|case
name|GDK_EXPOSE
case|:
comment|/* Is this the first exposure? */
comment|/* =========================== */
if|if
condition|(
operator|!
name|gc
condition|)
block|{
name|gc
operator|=
name|gdk_gc_new
argument_list|(
name|area
operator|->
name|window
argument_list|)
expr_stmt|;
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|draw_preview_image
argument_list|(
name|FALSE
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|showgrid
operator|==
literal|1
operator|&&
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|!=
operator|-
literal|1
condition|)
name|draw_preview_wireframe
argument_list|()
expr_stmt|;
block|}
break|break;
case|case
name|GDK_ENTER_NOTIFY
case|:
break|break;
case|case
name|GDK_LEAVE_NOTIFY
case|:
break|break;
case|case
name|GDK_BUTTON_PRESS
case|:
name|light_hit
operator|=
name|check_light_hit
argument_list|(
name|event
operator|->
name|button
operator|.
name|x
argument_list|,
name|event
operator|->
name|button
operator|.
name|y
argument_list|)
expr_stmt|;
if|if
condition|(
name|light_hit
operator|==
name|FALSE
condition|)
block|{
name|pos
operator|.
name|x
operator|=
operator|-
operator|(
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|button
operator|.
name|x
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_WIDTH
operator|-
literal|1.0
operator|)
expr_stmt|;
name|pos
operator|.
name|y
operator|=
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|button
operator|.
name|y
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_HEIGHT
operator|-
literal|1.0
expr_stmt|;
comment|/*ArcBall_Mouse(pos);             ArcBall_BeginDrag(); */
block|}
name|left_button_pressed
operator|=
name|TRUE
expr_stmt|;
break|break;
case|case
name|GDK_BUTTON_RELEASE
case|:
if|if
condition|(
name|light_hit
operator|==
name|TRUE
condition|)
name|draw_preview_image
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
else|else
block|{
name|pos
operator|.
name|x
operator|=
operator|-
operator|(
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|button
operator|.
name|x
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_WIDTH
operator|-
literal|1.0
operator|)
expr_stmt|;
name|pos
operator|.
name|y
operator|=
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|button
operator|.
name|y
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_HEIGHT
operator|-
literal|1.0
expr_stmt|;
comment|/*ArcBall_Mouse(pos);             ArcBall_EndDrag(); */
block|}
name|left_button_pressed
operator|=
name|FALSE
expr_stmt|;
break|break;
case|case
name|GDK_MOTION_NOTIFY
case|:
if|if
condition|(
name|left_button_pressed
operator|==
name|TRUE
condition|)
block|{
if|if
condition|(
name|light_hit
operator|==
name|TRUE
condition|)
block|{
name|update_light
argument_list|(
name|event
operator|->
name|motion
operator|.
name|x
argument_list|,
name|event
operator|->
name|motion
operator|.
name|y
argument_list|)
expr_stmt|;
name|update_light_pos_entries
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|pos
operator|.
name|x
operator|=
operator|-
operator|(
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|motion
operator|.
name|x
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_WIDTH
operator|-
literal|1.0
operator|)
expr_stmt|;
name|pos
operator|.
name|y
operator|=
literal|2.0
operator|*
operator|(
name|gdouble
operator|)
name|event
operator|->
name|motion
operator|.
name|y
operator|/
operator|(
name|gdouble
operator|)
name|PREVIEW_HEIGHT
operator|-
literal|1.0
expr_stmt|;
comment|/*                ArcBall_Mouse(pos);                 ArcBall_Update();                 ArcBall_Values(&a,&b,&c);                 Alpha+=RadToDeg(-a);                 Beta+RadToDeg(-b);                 Gamma+=RadToDeg(-c);                 if (Alpha>180) Alpha-=360;                 if (Alpha<-180) Alpha+=360;                 if (Beta>180) Beta-=360;                 if (Beta<-180) Beta+=360;                 if (Gamma>180) Gamma-=360;                 if (Gamma<-180) Gamma+=360;             	  UpdateAngleSliders(); */
block|}
block|}
break|break;
default|default:
break|break;
block|}
return|return
operator|(
name|FALSE
operator|)
return|;
block|}
end_function

begin_comment
comment|/*******************************/
end_comment

begin_comment
comment|/* Create general options page */
end_comment

begin_comment
comment|/*******************************/
end_comment

begin_function
DECL|function|create_options_page (void)
name|GtkWidget
modifier|*
name|create_options_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|,
modifier|*
name|frame
decl_stmt|,
modifier|*
name|vbox
decl_stmt|,
modifier|*
name|hbox
decl_stmt|,
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|toggletile
decl_stmt|,
modifier|*
name|toggleanti
decl_stmt|;
name|GtkWidget
modifier|*
name|toggletrans
decl_stmt|,
modifier|*
name|toggleimage
decl_stmt|,
modifier|*
name|toggletips
decl_stmt|;
name|GtkWidget
modifier|*
name|widget1
decl_stmt|,
modifier|*
name|widget2
decl_stmt|;
name|page
operator|=
name|gck_vbox_new
argument_list|(
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
literal|"General options"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gck_auto_show
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
name|widget1
operator|=
name|gck_option_menu_new
argument_list|(
literal|"Map to:"
argument_list|,
name|vbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
name|map_labels
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|mapmenu_callback
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gck_auto_show
argument_list|(
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|widget1
argument_list|)
argument_list|,
name|mapvals
operator|.
name|maptype
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"Type of object to map to"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|vbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|toggletrans
operator|=
name|gck_checkbutton_new
argument_list|(
literal|"Transparent background"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|transparent_background
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|toggletrans_update
argument_list|)
expr_stmt|;
name|toggletile
operator|=
name|gck_checkbutton_new
argument_list|(
literal|"Tile source image"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|tiled
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|toggletile_update
argument_list|)
expr_stmt|;
name|toggleimage
operator|=
name|gck_checkbutton_new
argument_list|(
literal|"Create new image"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|create_new_image
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|toggle_update
argument_list|)
expr_stmt|;
name|toggletips
operator|=
name|gck_checkbutton_new
argument_list|(
literal|"Enable tooltips"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|tooltips_enabled
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|toggletips_update
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|toggletrans
argument_list|,
literal|"Make image transparent outside object"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|toggletile
argument_list|,
literal|"Tile source image: useful for infinite planes"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|toggleimage
argument_list|,
literal|"Create a new image when applying filter"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|toggletips
argument_list|,
literal|"Enable/disable tooltip messages"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toggletrans
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|transparent_background
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toggletile
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|tiled
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toggleimage
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|create_new_image
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toggletips
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|tooltips_enabled
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggletrans
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggletile
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggleimage
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggletips
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
literal|"Antialiasing options"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|toggleanti
operator|=
name|gck_checkbutton_new
argument_list|(
literal|"Enable antialiasing"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|antialiasing
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|toggleanti_update
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toggleanti
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|antialiasing
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|toggleanti
argument_list|,
literal|"Enable/disable jagged edges removal (antialiasing)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gck_hbox_new
argument_list|(
name|vbox
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggleanti
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
name|NULL
argument_list|,
name|vbox
argument_list|,
name|GTK_SHADOW_NONE
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"Depth:"
argument_list|,
name|frame
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
name|GCK_ALIGN_BOTTOM
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
name|NULL
argument_list|,
name|vbox
argument_list|,
name|GTK_SHADOW_NONE
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"Treshold:"
argument_list|,
name|frame
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
name|GCK_ALIGN_CENTERED
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|widget1
operator|=
name|gck_hscale_new
argument_list|(
name|NULL
argument_list|,
name|vbox
argument_list|,
operator|&
name|sample_scale_vals
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|scale_update
argument_list|)
expr_stmt|;
name|widget2
operator|=
name|gck_entryfield_new
argument_list|(
name|NULL
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|pixeltreshold
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|maxdepth
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget2
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|pixeltreshold
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"Antialiasing quality. Higher is better, but slower"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget2
argument_list|,
literal|"Stop when pixel differences are smaller than this value"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/******************************/
end_comment

begin_comment
comment|/* Create light settings page */
end_comment

begin_comment
comment|/******************************/
end_comment

begin_function
DECL|function|create_light_page (void)
name|GtkWidget
modifier|*
name|create_light_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|,
modifier|*
name|frame
decl_stmt|,
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|widget1
decl_stmt|,
modifier|*
name|widget2
decl_stmt|,
modifier|*
name|widget3
decl_stmt|;
name|page
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
literal|"Light settings"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|frame
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gck_auto_show
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
name|widget1
operator|=
name|gck_option_menu_new
argument_list|(
literal|"Lightsource type:"
argument_list|,
name|vbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
name|light_labels
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|lightmenu_callback
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|widget1
argument_list|)
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|type
argument_list|)
expr_stmt|;
name|gck_auto_show
argument_list|(
name|FALSE
argument_list|)
expr_stmt|;
name|widget2
operator|=
name|gck_pushbutton_new
argument_list|(
literal|"Lightsource color"
argument_list|,
name|vbox
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|light_color_callback
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"Type of light source to apply"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget2
argument_list|,
literal|"Set light source color (white is default)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|pointlightwid
operator|=
name|gck_frame_new
argument_list|(
literal|"Position"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|pointlightwid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|xentry
operator|=
name|gck_entryfield_new
argument_list|(
literal|"X:"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|yentry
operator|=
name|gck_entryfield_new
argument_list|(
literal|"Y:"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|zentry
operator|=
name|gck_entryfield_new
argument_list|(
literal|"Z:"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|xentry
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|x
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|yentry
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|y
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|zentry
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|position
operator|.
name|z
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|xentry
argument_list|,
literal|"Light source X position in XYZ space"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|yentry
argument_list|,
literal|"Light source Y position in XYZ space"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|zentry
argument_list|,
literal|"Light source Z position in XYZ space"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|xentry
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|yentry
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|zentry
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pointlightwid
argument_list|)
expr_stmt|;
name|dirlightwid
operator|=
name|gck_frame_new
argument_list|(
literal|"Direction vector"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|dirlightwid
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|widget1
operator|=
name|gck_entryfield_new
argument_list|(
literal|"X:"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|x
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|widget2
operator|=
name|gck_entryfield_new
argument_list|(
literal|"Y:"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|y
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|widget3
operator|=
name|gck_entryfield_new
argument_list|(
literal|"Z:"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|z
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"Light source X direction in XYZ space"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget2
argument_list|,
literal|"Light source Y direction in XYZ space"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget3
argument_list|,
literal|"Light source Z direction in XYZ space"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|x
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget2
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|y
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget3
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|lightsource
operator|.
name|direction
operator|.
name|z
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget3
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/*********************************/
end_comment

begin_comment
comment|/* Create material settings page */
end_comment

begin_comment
comment|/*********************************/
end_comment

begin_function
DECL|function|create_material_page (void)
name|GtkWidget
modifier|*
name|create_material_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|,
modifier|*
name|frame
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|label1
decl_stmt|,
modifier|*
name|label2
decl_stmt|,
modifier|*
name|label3
decl_stmt|;
name|GtkWidget
modifier|*
name|widget1
decl_stmt|,
modifier|*
name|widget2
decl_stmt|,
modifier|*
name|widget3
decl_stmt|;
name|GdkPixmap
modifier|*
name|image
decl_stmt|;
name|GdkBitmap
modifier|*
name|mask
decl_stmt|;
name|GtkStyle
modifier|*
name|style
decl_stmt|;
name|GtkWidget
modifier|*
name|pixmap
decl_stmt|;
name|page
operator|=
name|gck_vbox_new
argument_list|(
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
literal|"Intensity levels"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|label1
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"Ambient:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
name|GCK_ALIGN_CENTERED
argument_list|)
expr_stmt|;
name|label2
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"Diffuse:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
name|GCK_ALIGN_CENTERED
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|widget1
operator|=
name|gck_entryfield_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|ambient_int
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|widget2
operator|=
name|gck_entryfield_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|diffuse_int
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget2
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|style
operator|=
name|gtk_widget_get_style
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|amb1_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|amb2_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|diffint1_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|diffint2_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"Amount of original color to show where no direct light falls"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget2
argument_list|,
literal|"Intensity of original color when lit by a light source"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|material
operator|.
name|ambient_int
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget2
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|material
operator|.
name|diffuse_int
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
literal|"Reflectivity"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|4
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|label1
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"Diffuse:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
name|GCK_ALIGN_CENTERED
argument_list|)
expr_stmt|;
name|label2
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"Specular:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
name|GCK_ALIGN_CENTERED
argument_list|)
expr_stmt|;
name|label3
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"Hightlight:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
name|GCK_ALIGN_CENTERED
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|widget1
operator|=
name|gck_entryfield_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|diffuse_ref
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|widget2
operator|=
name|gck_entryfield_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|specular_ref
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|widget3
operator|=
name|gck_entryfield_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
name|mapvals
operator|.
name|material
operator|.
name|highlight
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget2
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget3
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"Higher values makes the object reflect more light (appear lighter)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget2
argument_list|,
literal|"Controls how intense the highlights will be"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget3
argument_list|,
literal|"Higher values makes the highlights more focused"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|material
operator|.
name|diffuse_ref
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget2
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|material
operator|.
name|specular_ref
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget3
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|material
operator|.
name|highlight
argument_list|)
expr_stmt|;
name|style
operator|=
name|gtk_widget_get_style
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|diffref1_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|diffref2_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|specref1_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|specref2_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|high1_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|image
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|appwin
operator|->
name|widget
operator|->
name|window
argument_list|,
operator|&
name|mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|high2_xpm
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|image
argument_list|,
name|mask
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|pixmap
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label3
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget3
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/****************************************/
end_comment

begin_comment
comment|/* Create orientation and position page */
end_comment

begin_comment
comment|/****************************************/
end_comment

begin_function
DECL|function|create_orientation_page (void)
name|GtkWidget
modifier|*
name|create_orientation_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|,
modifier|*
name|frame
decl_stmt|,
modifier|*
name|vbox
decl_stmt|,
modifier|*
name|label
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|widget1
decl_stmt|,
modifier|*
name|widget2
decl_stmt|,
modifier|*
name|widget3
decl_stmt|;
name|page
operator|=
name|gck_vbox_new
argument_list|(
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
literal|"Position and orientation"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|widget1
operator|=
name|gck_entryfield_new
argument_list|(
literal|"X pos.:"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|position
operator|.
name|x
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|xyzval_update
argument_list|)
expr_stmt|;
name|widget2
operator|=
name|gck_entryfield_new
argument_list|(
literal|"Y pos.:"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|position
operator|.
name|y
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|xyzval_update
argument_list|)
expr_stmt|;
name|widget3
operator|=
name|gck_entryfield_new
argument_list|(
literal|"Z pos.:"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|position
operator|.
name|z
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|xyzval_update
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"Object X position in XYZ space (0.5 is center)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget2
argument_list|,
literal|"Object Y position in XYZ space (0.5 is center)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget3
argument_list|,
literal|"Object Z position in XYZ space (0.5 is center)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|position
operator|.
name|x
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget2
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|position
operator|.
name|y
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget3
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|position
operator|.
name|z
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget3
argument_list|)
expr_stmt|;
comment|/* Rotation scales */
comment|/* =============== */
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"XRot:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"YRot:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"ZRot:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|angle_scale_vals
operator|.
name|value
operator|=
name|mapvals
operator|.
name|alpha
expr_stmt|;
name|widget1
operator|=
name|gck_hscale_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
operator|&
name|angle_scale_vals
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|angle_update
argument_list|)
expr_stmt|;
name|angle_scale_vals
operator|.
name|value
operator|=
name|mapvals
operator|.
name|beta
expr_stmt|;
name|widget2
operator|=
name|gck_hscale_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
operator|&
name|angle_scale_vals
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|angle_update
argument_list|)
expr_stmt|;
name|angle_scale_vals
operator|.
name|value
operator|=
name|mapvals
operator|.
name|gamma
expr_stmt|;
name|widget3
operator|=
name|gck_hscale_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
operator|&
name|angle_scale_vals
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|angle_update
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget3
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget3
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|alpha
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget2
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|beta
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget3
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|gamma
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"Rotation angle about X axis"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget2
argument_list|,
literal|"Rotation angle about Y axis"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget3
argument_list|,
literal|"Rotation angle about Z axis"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_function
DECL|function|create_box_page (void)
name|GtkWidget
modifier|*
name|create_box_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|,
modifier|*
name|frame
decl_stmt|,
modifier|*
name|vbox
decl_stmt|,
modifier|*
name|label
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|widget1
decl_stmt|,
modifier|*
name|widget2
decl_stmt|,
modifier|*
name|widget3
decl_stmt|,
modifier|*
name|scale_table
decl_stmt|;
name|gint
name|i
decl_stmt|;
name|gchar
modifier|*
name|labels
index|[
literal|6
index|]
init|=
block|{
literal|"Front:"
block|,
literal|"Back:"
block|,
literal|"Top:"
block|,
literal|"Bottom:"
block|,
literal|"Left:"
block|,
literal|"Right:"
block|}
decl_stmt|;
name|page
operator|=
name|gck_vbox_new
argument_list|(
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
literal|"Map images to box faces"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|6
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|/* Option menues */
comment|/* ============= */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|6
condition|;
name|i
operator|++
control|)
block|{
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
name|labels
index|[
name|i
index|]
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|i
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|widget1
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|i
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"_mapwid_id"
argument_list|,
operator|(
name|gpointer
operator|)
name|i
argument_list|)
expr_stmt|;
name|widget2
operator|=
name|gimp_drawable_menu_new
argument_list|(
name|box_constrain
argument_list|,
name|box_drawable_callback
argument_list|,
operator|(
name|gpointer
operator|)
name|widget1
argument_list|,
name|mapvals
operator|.
name|boxmap_id
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|widget1
argument_list|)
argument_list|,
name|widget2
argument_list|)
expr_stmt|;
block|}
comment|/* Scale scales */
comment|/* ============ */
name|scale_table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|scale_table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"XScale:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"YScale:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"ZScale:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|scale_scale_vals
operator|.
name|value
operator|=
name|mapvals
operator|.
name|scale
operator|.
name|x
expr_stmt|;
name|widget1
operator|=
name|gck_hscale_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
operator|&
name|scale_scale_vals
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|boxscale_update
argument_list|)
expr_stmt|;
name|scale_scale_vals
operator|.
name|value
operator|=
name|mapvals
operator|.
name|scale
operator|.
name|y
expr_stmt|;
name|widget2
operator|=
name|gck_hscale_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
operator|&
name|scale_scale_vals
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|boxscale_update
argument_list|)
expr_stmt|;
name|scale_scale_vals
operator|.
name|value
operator|=
name|mapvals
operator|.
name|scale
operator|.
name|z
expr_stmt|;
name|widget3
operator|=
name|gck_hscale_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
operator|&
name|scale_scale_vals
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|boxscale_update
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|widget1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|widget2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|widget3
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget3
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|scale
operator|.
name|x
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget2
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|scale
operator|.
name|y
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget3
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|scale
operator|.
name|z
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"X scale (size)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget2
argument_list|,
literal|"Y scale (size)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget3
argument_list|,
literal|"Z scale (size)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale_table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_function
DECL|function|create_cylinder_page (void)
name|GtkWidget
modifier|*
name|create_cylinder_page
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|,
modifier|*
name|frame
decl_stmt|,
modifier|*
name|vbox
decl_stmt|,
modifier|*
name|label
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|widget1
decl_stmt|,
modifier|*
name|widget2
decl_stmt|,
modifier|*
name|scale_table
decl_stmt|;
name|gint
name|i
decl_stmt|;
name|gchar
modifier|*
name|labels
index|[
literal|6
index|]
init|=
block|{
literal|"Top:"
block|,
literal|"Bottom:"
block|}
decl_stmt|;
name|page
operator|=
name|gck_vbox_new
argument_list|(
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
literal|"Images for the cap faces"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|/* Option menues */
comment|/* ============= */
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|2
condition|;
name|i
operator|++
control|)
block|{
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
name|labels
index|[
name|i
index|]
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|i
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|widget1
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|widget1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|i
argument_list|,
name|i
operator|+
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"_mapwid_id"
argument_list|,
operator|(
name|gpointer
operator|)
name|i
argument_list|)
expr_stmt|;
name|widget2
operator|=
name|gimp_drawable_menu_new
argument_list|(
name|cylinder_constrain
argument_list|,
name|cylinder_drawable_callback
argument_list|,
operator|(
name|gpointer
operator|)
name|widget1
argument_list|,
name|mapvals
operator|.
name|cylindermap_id
index|[
name|i
index|]
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|widget1
argument_list|)
argument_list|,
name|widget2
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gck_frame_new
argument_list|(
literal|"Size"
argument_list|,
name|page
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|scale_table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|scale_table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"Radius:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|label
operator|=
name|gck_label_aligned_new
argument_list|(
literal|"Length:"
argument_list|,
name|NULL
argument_list|,
name|GCK_ALIGN_RIGHT
argument_list|,
literal|0.7
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|cyl_scale_vals
operator|.
name|value
operator|=
name|mapvals
operator|.
name|cylinder_radius
expr_stmt|;
name|widget1
operator|=
name|gck_hscale_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
operator|&
name|cyl_scale_vals
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|cylinderradius_update
argument_list|)
expr_stmt|;
name|cyl_scale_vals
operator|.
name|value
operator|=
name|mapvals
operator|.
name|cylinder_length
expr_stmt|;
name|widget2
operator|=
name|gck_hscale_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|,
operator|&
name|cyl_scale_vals
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|cylinderlength_update
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|widget1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|scale_table
argument_list|)
argument_list|,
name|widget2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget1
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|widget2
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget1
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|cylinder_radius
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget2
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|(
name|gpointer
operator|)
operator|&
name|mapvals
operator|.
name|cylinder_length
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget1
argument_list|,
literal|"Cylinder radius"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|widget2
argument_list|,
literal|"Cylinder length"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale_table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|page
argument_list|)
expr_stmt|;
return|return
name|page
return|;
block|}
end_function

begin_comment
comment|/****************************/
end_comment

begin_comment
comment|/* Create notbook and pages */
end_comment

begin_comment
comment|/****************************/
end_comment

begin_function
DECL|function|create_main_notebook (GtkWidget * container)
name|void
name|create_main_notebook
parameter_list|(
name|GtkWidget
modifier|*
name|container
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|page
decl_stmt|,
modifier|*
name|label
decl_stmt|;
name|gck_auto_show
argument_list|(
name|FALSE
argument_list|)
expr_stmt|;
name|options_note_book
operator|=
name|GTK_NOTEBOOK
argument_list|(
name|gtk_notebook_new
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|container
argument_list|)
argument_list|,
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_options_page
argument_list|()
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Options"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_light_page
argument_list|()
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Light"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_material_page
argument_list|()
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Material"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|page
operator|=
name|create_orientation_page
argument_list|()
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Orientation"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|page
argument_list|,
name|label
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|maptype
operator|==
name|MAP_BOX
condition|)
block|{
name|box_page
operator|=
name|create_box_page
argument_list|()
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Box"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|box_page
argument_list|,
name|label
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|mapvals
operator|.
name|maptype
operator|==
name|MAP_CYLINDER
condition|)
block|{
name|cylinder_page
operator|=
name|create_cylinder_page
argument_list|()
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Cylinder"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|options_note_book
argument_list|,
name|cylinder_page
argument_list|,
name|label
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_show
argument_list|(
name|GTK_WIDGET
argument_list|(
name|options_note_book
argument_list|)
argument_list|)
expr_stmt|;
name|gck_auto_show
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*****************************************************/
end_comment

begin_comment
comment|/* Create and show main dialog. Uses the plugin_ui.c */
end_comment

begin_comment
comment|/* routines when possible, gtk itself when not.      */
end_comment

begin_comment
comment|/*****************************************************/
end_comment

begin_function
DECL|function|create_main_dialog (void)
name|void
name|create_main_dialog
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|main_vbox
decl_stmt|,
modifier|*
name|main_workbox
decl_stmt|,
modifier|*
name|actionbox
decl_stmt|,
modifier|*
name|workbox1
decl_stmt|,
modifier|*
name|workbox1b
decl_stmt|,
modifier|*
name|workbox2
decl_stmt|,
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|applybutton
decl_stmt|,
modifier|*
name|cancelbutton
decl_stmt|,
modifier|*
name|helpbutton
decl_stmt|,
modifier|*
name|hbox
decl_stmt|,
modifier|*
name|gridtoggle
decl_stmt|;
name|GtkWidget
modifier|*
name|wid
decl_stmt|;
name|appwin
operator|=
name|gck_application_window_new
argument_list|(
literal|"Map to object"
argument_list|)
expr_stmt|;
name|gtk_widget_realize
argument_list|(
name|appwin
operator|->
name|widget
argument_list|)
expr_stmt|;
name|tooltips
operator|=
name|gtk_tooltips_new
argument_list|()
expr_stmt|;
comment|/* Main manager widget */
comment|/* =================== */
name|main_vbox
operator|=
name|gck_vbox_new
argument_list|(
name|appwin
operator|->
name|widget
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|8
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* Work area manager widget */
comment|/* ======================== */
name|main_workbox
operator|=
name|gck_hbox_new
argument_list|(
name|main_vbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|/* Action area manager widget */
comment|/* ========================== */
name|gck_hseparator_new
argument_list|(
name|main_vbox
argument_list|)
expr_stmt|;
name|actionbox
operator|=
name|gck_hbox_new
argument_list|(
name|main_vbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|/* Add Ok, Cancel and Help buttons to the action area */
comment|/* ================================================== */
name|applybutton
operator|=
name|gck_pushbutton_new
argument_list|(
literal|"Apply"
argument_list|,
name|actionbox
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|5
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|apply_callback
argument_list|)
expr_stmt|;
name|cancelbutton
operator|=
name|gck_pushbutton_new
argument_list|(
literal|"Cancel"
argument_list|,
name|actionbox
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|5
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|exit_callback
argument_list|)
expr_stmt|;
name|helpbutton
operator|=
name|gck_pushbutton_new
argument_list|(
literal|"Help"
argument_list|,
name|actionbox
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|5
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|applybutton
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|cancelbutton
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|helpbutton
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_widget_grab_default
argument_list|(
name|applybutton
argument_list|)
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|helpbutton
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|applybutton
argument_list|,
literal|"Apply filter with current settings"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|cancelbutton
argument_list|,
literal|"Close filter without doing anything"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/* Split the workarea in two */
comment|/* ========================= */
name|frame
operator|=
name|gck_frame_new
argument_list|(
name|NULL
argument_list|,
name|main_workbox
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|workbox1
operator|=
name|gck_vbox_new
argument_list|(
name|frame
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|workbox2
operator|=
name|gck_vbox_new
argument_list|(
name|main_workbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* Add preview widget and various buttons to the first part */
comment|/* ======================================================== */
name|frame
operator|=
name|gck_frame_new
argument_list|(
name|NULL
argument_list|,
name|workbox1
argument_list|,
name|GTK_SHADOW_IN
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|previewarea
operator|=
name|gck_drawing_area_new
argument_list|(
name|frame
argument_list|,
name|PREVIEW_WIDTH
argument_list|,
name|PREVIEW_HEIGHT
argument_list|,
name|GDK_EXPOSURE_MASK
operator||
name|GDK_BUTTON1_MOTION_MASK
operator||
name|GDK_BUTTON_PRESS_MASK
operator||
name|GDK_BUTTON_RELEASE_MASK
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|preview_events
argument_list|)
expr_stmt|;
name|workbox1b
operator|=
name|gck_vbox_new
argument_list|(
name|workbox1
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gck_hbox_new
argument_list|(
name|workbox1b
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|wid
operator|=
name|gck_pushbutton_new
argument_list|(
literal|"Preview!"
argument_list|,
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|preview_callback
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|wid
argument_list|,
literal|"Recompute preview image"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gck_hbox_new
argument_list|(
name|hbox
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|wid
operator|=
name|gck_pushbutton_new
argument_list|(
literal|"+"
argument_list|,
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|zoomin_callback
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|wid
argument_list|,
literal|"Zoom in (make image bigger)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|wid
operator|=
name|gck_pushbutton_new
argument_list|(
literal|"-"
argument_list|,
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|zoomout_callback
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|wid
argument_list|,
literal|"Zoom out (make image smaller)"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gck_vbox_new
argument_list|(
name|workbox1b
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gridtoggle
operator|=
name|gck_checkbutton_new
argument_list|(
literal|"Show preview wireframe"
argument_list|,
name|vbox
argument_list|,
name|mapvals
operator|.
name|showgrid
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|togglegrid_update
argument_list|)
expr_stmt|;
name|gtk_object_set_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gridtoggle
argument_list|)
argument_list|,
literal|"ValuePtr"
argument_list|,
operator|&
name|mapvals
operator|.
name|showgrid
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tip
argument_list|(
name|tooltips
argument_list|,
name|gridtoggle
argument_list|,
literal|"Show/hide preview wireframe"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|create_main_notebook
argument_list|(
name|workbox2
argument_list|)
expr_stmt|;
comment|/* Endmarkers for line table */
comment|/* ========================= */
name|linetab
index|[
literal|0
index|]
operator|.
name|x1
operator|=
operator|-
literal|1
expr_stmt|;
comment|/* Phew :) Now lets check out the result of this mess */
comment|/* ================================================== */
name|gtk_widget_show
argument_list|(
name|appwin
operator|->
name|widget
argument_list|)
expr_stmt|;
name|gck_cursor_set
argument_list|(
name|previewarea
operator|->
name|window
argument_list|,
name|GDK_HAND2
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_colors
argument_list|(
name|tooltips
argument_list|,
name|gck_rgb_to_gdkcolor
argument_list|(
name|appwin
operator|->
name|visinfo
argument_list|,
literal|255
argument_list|,
literal|255
argument_list|,
literal|220
argument_list|)
argument_list|,
name|gck_rgb_to_gdkcolor
argument_list|(
name|appwin
operator|->
name|visinfo
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|mapvals
operator|.
name|tooltips_enabled
operator|==
name|FALSE
condition|)
name|gtk_tooltips_disable
argument_list|(
name|tooltips
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

