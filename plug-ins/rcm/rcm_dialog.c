begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 1995 Spencer Kimball and Peter Mattis  *  * This is a plug-in for the GIMP.  *  * Colormap-Rotation plug-in. Exchanges two color ranges.  *  * Copyright (C) 1999 Sven Anders (anderss@fmi.uni-passau.de)  *                    Based on code from Pavel Grinfeld (pavel@ml.com)  *  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------  * Change log:  *   * Version 2.0, 04 April 1999.  *  Nearly complete rewrite, made plug-in stable.  *  (Works with GIMP 1.1 and GTK+ 1.2)  *  * Version 1.0, 27 March 1997.  *  Initial (unstable) release by Pavel Grinfeld  *  *---------------------------------------------------------------------------*/
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<gtk/gtk.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimp.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimpui.h>
end_include

begin_include
include|#
directive|include
file|"libgimp/stdplugins-intl.h"
end_include

begin_include
include|#
directive|include
file|"rcm.h"
end_include

begin_include
include|#
directive|include
file|"rcm_misc.h"
end_include

begin_include
include|#
directive|include
file|"rcm_pixmaps.h"
end_include

begin_include
include|#
directive|include
file|"rcm_gdk.h"
end_include

begin_include
include|#
directive|include
file|"rcm_callback.h"
end_include

begin_include
include|#
directive|include
file|"rcm_dialog.h"
end_include

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* Defines */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_define
DECL|macro|INITIAL_ALPHA
define|#
directive|define
name|INITIAL_ALPHA
value|0
end_define

begin_define
DECL|macro|INITIAL_BETA
define|#
directive|define
name|INITIAL_BETA
value|G_PI_2
end_define

begin_define
DECL|macro|INITIAL_GRAY_SAT
define|#
directive|define
name|INITIAL_GRAY_SAT
value|0.0
end_define

begin_define
DECL|macro|INITIAL_GRAY_RSAT
define|#
directive|define
name|INITIAL_GRAY_RSAT
value|0.0
end_define

begin_define
DECL|macro|INITIAL_GRAY_HUE
define|#
directive|define
name|INITIAL_GRAY_HUE
value|0.0
end_define

begin_define
DECL|macro|RANGE_ADJUST_MASK
define|#
directive|define
name|RANGE_ADJUST_MASK
value|GDK_EXPOSURE_MASK | \                           GDK_ENTER_NOTIFY_MASK | \                           GDK_BUTTON_PRESS_MASK | \                           GDK_BUTTON_RELEASE_MASK | \                           GDK_BUTTON1_MOTION_MASK | \                           GDK_POINTER_MOTION_HINT_MASK
end_define

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* Previews: create one preview */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_function
name|void
DECL|function|rcm_create_one_preview (GtkWidget ** preview,GtkWidget ** frame,int previewWidth,int previewHeight)
name|rcm_create_one_preview
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|preview
parameter_list|,
name|GtkWidget
modifier|*
modifier|*
name|frame
parameter_list|,
name|int
name|previewWidth
parameter_list|,
name|int
name|previewHeight
parameter_list|)
block|{
operator|*
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|frame
argument_list|)
expr_stmt|;
operator|*
name|preview
operator|=
name|gtk_preview_new
argument_list|(
name|GTK_PREVIEW_COLOR
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
operator|*
name|preview
argument_list|)
argument_list|,
name|previewWidth
argument_list|,
name|previewHeight
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|preview
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
operator|*
name|preview
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* Previews */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_function
name|GtkWidget
modifier|*
DECL|function|rcm_create_previews (void)
name|rcm_create_previews
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|blabel
decl_stmt|,
modifier|*
name|alabel
decl_stmt|,
modifier|*
name|bframe
decl_stmt|,
modifier|*
name|aframe
decl_stmt|,
modifier|*
name|table
decl_stmt|;
comment|/* Previews: create the previews */
name|rcm_create_one_preview
argument_list|(
operator|&
name|Current
operator|.
name|Bna
operator|->
name|before
argument_list|,
operator|&
name|bframe
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|width
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|rcm_create_one_preview
argument_list|(
operator|&
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
operator|&
name|aframe
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|width
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
comment|/* Previews: frame */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Preview"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|alabel
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Rotated"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|alabel
argument_list|)
expr_stmt|;
name|blabel
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Original"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|blabel
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|blabel
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|bframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|alabel
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|aframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* Main: Create one pixmap button */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_function
name|void
DECL|function|rcm_create_pixmap_button (GtkWidget ** label,GtkWidget ** xpm_button,GtkWidget ** label_box,GtkSignalFunc callback,gpointer data,gchar * text,GtkWidget * parent,gint pos)
name|rcm_create_pixmap_button
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|label
parameter_list|,
name|GtkWidget
modifier|*
modifier|*
name|xpm_button
parameter_list|,
name|GtkWidget
modifier|*
modifier|*
name|label_box
parameter_list|,
name|GtkSignalFunc
name|callback
parameter_list|,
name|gpointer
name|data
parameter_list|,
name|gchar
modifier|*
name|text
parameter_list|,
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|gint
name|pos
parameter_list|)
block|{
comment|/* create button */
operator|*
name|xpm_button
operator|=
name|gtk_button_new
argument_list|()
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
operator|*
name|xpm_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
name|callback
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|xpm_button
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|parent
argument_list|)
argument_list|,
operator|*
name|xpm_button
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|pos
argument_list|,
name|pos
operator|+
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|4
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|/* create hbox */
operator|*
name|label_box
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|label_box
argument_list|)
expr_stmt|;
comment|/* create label */
operator|*
name|label
operator|=
name|gtk_label_new
argument_list|(
name|text
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|label
argument_list|)
expr_stmt|;
comment|/* put label and pixmap in hbox */
name|gtk_box_pack_end
argument_list|(
name|GTK_BOX
argument_list|(
operator|*
name|label_box
argument_list|)
argument_list|,
operator|*
name|label
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* create hbox in button */
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
operator|*
name|xpm_button
argument_list|)
argument_list|,
operator|*
name|label_box
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* Set buttons pixmaps */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_function
name|void
DECL|function|rcm_set_pixmaps (RcmCircle * circle)
name|rcm_set_pixmaps
parameter_list|(
name|RcmCircle
modifier|*
name|circle
parameter_list|)
block|{
name|rcm_set_pixmap
argument_list|(
operator|&
name|circle
operator|->
name|cw_ccw_pixmap
argument_list|,
name|circle
operator|->
name|cw_ccw_button
operator|->
name|parent
argument_list|,
name|circle
operator|->
name|cw_ccw_box
argument_list|,
name|rcm_cw
argument_list|)
expr_stmt|;
name|rcm_set_pixmap
argument_list|(
operator|&
name|circle
operator|->
name|a_b_pixmap
argument_list|,
name|circle
operator|->
name|a_b_button
operator|->
name|parent
argument_list|,
name|circle
operator|->
name|a_b_box
argument_list|,
name|rcm_a_b
argument_list|)
expr_stmt|;
name|rcm_set_pixmap
argument_list|(
operator|&
name|circle
operator|->
name|f360_pixmap
argument_list|,
name|circle
operator|->
name|f360_button
operator|->
name|parent
argument_list|,
name|circle
operator|->
name|f360_box
argument_list|,
name|rcm_360
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* Main: One circles with values and buttons */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_function
name|RcmCircle
modifier|*
DECL|function|rcm_create_one_circle (gint height,gchar * label_content)
name|rcm_create_one_circle
parameter_list|(
name|gint
name|height
parameter_list|,
name|gchar
modifier|*
name|label_content
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|button_table
decl_stmt|,
modifier|*
name|legend_table
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|label_box
decl_stmt|,
modifier|*
name|xpm_button
decl_stmt|,
modifier|*
name|entry
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|RcmCircle
modifier|*
name|st
decl_stmt|;
name|st
operator|=
name|g_new
argument_list|(
name|RcmCircle
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|st
operator|->
name|action_flag
operator|=
name|VIRGIN
expr_stmt|;
name|st
operator|->
name|angle
operator|=
name|g_new
argument_list|(
name|RcmAngle
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|alpha
operator|=
name|INITIAL_ALPHA
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|beta
operator|=
name|INITIAL_BETA
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|cw_ccw
operator|=
literal|1
expr_stmt|;
comment|/** Main: Circle: create (main) frame **/
name|st
operator|->
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|label_content
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|st
operator|->
name|frame
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|frame
argument_list|)
expr_stmt|;
comment|/** Main: Circle: create frame& preview **/
comment|/* create frame */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
comment|/* create preview */
name|st
operator|->
name|preview
operator|=
name|gtk_preview_new
argument_list|(
name|GTK_PREVIEW_COLOR
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
name|height
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|preview
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|st
operator|->
name|preview
argument_list|)
expr_stmt|;
comment|/* set signals */
name|gtk_widget_set_events
argument_list|(
name|st
operator|->
name|preview
argument_list|,
name|RANGE_ADJUST_MASK
argument_list|)
expr_stmt|;
name|gtk_signal_connect_after
argument_list|(
name|GTK_OBJECT
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
literal|"expose_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_expose_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_button_press_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
literal|"button_release_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_release_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
literal|"motion_notify_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_motion_notify_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|rcm_render_circle
argument_list|(
name|st
operator|->
name|preview
argument_list|,
name|SUM
argument_list|,
name|MARGIN
argument_list|)
expr_stmt|;
comment|/** Main: Circle: create table for buttons **/
name|button_table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button_table
argument_list|)
expr_stmt|;
comment|/** Main: Circle: Buttons **/
name|rcm_create_pixmap_button
argument_list|(
operator|&
name|label
argument_list|,
operator|&
name|xpm_button
argument_list|,
operator|&
name|label_box
argument_list|,
name|rcm_cw_ccw
argument_list|,
name|st
argument_list|,
operator|(
name|st
operator|->
name|angle
operator|->
name|cw_ccw
operator|>
literal|0
operator|)
condition|?
name|_
argument_list|(
literal|"Switch to clockwise"
argument_list|)
else|:
name|_
argument_list|(
literal|"Switch to c/clockwise"
argument_list|)
argument_list|,
name|button_table
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|st
operator|->
name|cw_ccw_pixmap
operator|=
name|NULL
expr_stmt|;
name|st
operator|->
name|cw_ccw_button
operator|=
name|xpm_button
expr_stmt|;
name|st
operator|->
name|cw_ccw_box
operator|=
name|label_box
expr_stmt|;
name|st
operator|->
name|cw_ccw_label
operator|=
name|label
expr_stmt|;
name|rcm_create_pixmap_button
argument_list|(
operator|&
name|label
argument_list|,
operator|&
name|xpm_button
argument_list|,
operator|&
name|label_box
argument_list|,
name|rcm_a_to_b
argument_list|,
name|st
argument_list|,
name|_
argument_list|(
literal|"Change order of arrows"
argument_list|)
argument_list|,
name|button_table
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|st
operator|->
name|a_b_pixmap
operator|=
name|NULL
expr_stmt|;
name|st
operator|->
name|a_b_box
operator|=
name|label_box
expr_stmt|;
name|st
operator|->
name|a_b_button
operator|=
name|xpm_button
expr_stmt|;
name|rcm_create_pixmap_button
argument_list|(
operator|&
name|label
argument_list|,
operator|&
name|xpm_button
argument_list|,
operator|&
name|label_box
argument_list|,
name|rcm_360_degrees
argument_list|,
name|st
argument_list|,
name|_
argument_list|(
literal|"Select all"
argument_list|)
argument_list|,
name|button_table
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|st
operator|->
name|f360_pixmap
operator|=
name|NULL
expr_stmt|;
name|st
operator|->
name|f360_box
operator|=
name|label_box
expr_stmt|;
name|st
operator|->
name|f360_button
operator|=
name|xpm_button
expr_stmt|;
comment|/** Main: Circle: Legend **/
name|legend_table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|legend_table
argument_list|)
expr_stmt|;
comment|/* spinbutton 1 */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"From"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|5
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|alpha
operator|=
name|INITIAL_ALPHA
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|angle
operator|->
name|alpha
argument_list|,
literal|0.0
argument_list|,
literal|2.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|st
operator|->
name|alpha_entry
operator|=
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|entry
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_alpha
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|2
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|/* label */
name|st
operator|->
name|alpha_units_label
operator|=
name|gtk_label_new
argument_list|(
name|rcm_units_string
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|alpha_units_label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|st
operator|->
name|alpha_units_label
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|4
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|/* spinbutton 2 */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"to"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|4
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|beta
operator|=
name|INITIAL_BETA
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|angle
operator|->
name|beta
argument_list|,
literal|0.0
argument_list|,
literal|2.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|st
operator|->
name|beta_entry
operator|=
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|entry
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_beta
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|4
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|2
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|/* label */
name|st
operator|->
name|beta_units_label
operator|=
name|gtk_label_new
argument_list|(
name|rcm_units_string
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|beta_units_label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|st
operator|->
name|beta_units_label
argument_list|,
literal|5
argument_list|,
literal|6
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|4
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|/* Main: Circle: create table for Preview / Buttons / Legend */
name|st
operator|->
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|frame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|button_table
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|legend_table
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|/* add table to (main) frame */
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|st
operator|->
name|frame
argument_list|)
argument_list|,
name|st
operator|->
name|table
argument_list|)
expr_stmt|;
return|return
name|st
return|;
block|}
end_function

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* Main */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_function
name|GtkWidget
modifier|*
DECL|function|rcm_create_main (void)
name|rcm_create_main
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|Current
operator|.
name|From
operator|=
name|rcm_create_one_circle
argument_list|(
name|SUM
argument_list|,
name|_
argument_list|(
literal|"From"
argument_list|)
argument_list|)
expr_stmt|;
name|Current
operator|.
name|To
operator|=
name|rcm_create_one_circle
argument_list|(
name|SUM
argument_list|,
name|_
argument_list|(
literal|"To"
argument_list|)
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|Current
operator|.
name|From
operator|->
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|Current
operator|.
name|To
operator|->
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
return|return
name|vbox
return|;
block|}
end_function

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* Misc: Gray */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_function
name|RcmGray
modifier|*
DECL|function|rcm_create_gray (void)
name|rcm_create_gray
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|preview
decl_stmt|,
modifier|*
name|as_or_to_frame
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|,
modifier|*
name|previewframe
decl_stmt|,
modifier|*
name|legend_table
decl_stmt|;
name|GtkWidget
modifier|*
name|mini_table
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|entry
decl_stmt|;
name|GtkWidget
modifier|*
name|gray_sat_frame
decl_stmt|;
name|GtkWidget
modifier|*
name|radio_box
decl_stmt|,
modifier|*
name|button
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|RcmGray
modifier|*
name|st
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|st
operator|=
name|g_new
argument_list|(
name|RcmGray
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|st
operator|->
name|hue
operator|=
literal|0
expr_stmt|;
name|st
operator|->
name|satur
operator|=
literal|0
expr_stmt|;
name|st
operator|->
name|action_flag
operator|=
name|VIRGIN
expr_stmt|;
comment|/** Gray **/
name|st
operator|->
name|frame
operator|=
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Gray"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
comment|/* Gray: Circle: Circle (Preview) */
name|previewframe
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|previewframe
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|previewframe
argument_list|)
expr_stmt|;
name|st
operator|->
name|preview
operator|=
name|preview
operator|=
name|gtk_preview_new
argument_list|(
name|GTK_PREVIEW_COLOR
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|preview
argument_list|)
argument_list|,
name|GRAY_SUM
argument_list|,
name|GRAY_SUM
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|preview
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|previewframe
argument_list|)
argument_list|,
name|preview
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|preview
argument_list|,
name|RANGE_ADJUST_MASK
argument_list|)
expr_stmt|;
name|gtk_signal_connect_after
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"expose_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_gray_expose_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_gray_button_press_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"button_release_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_gray_release_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"motion_notify_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_gray_motion_notify_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
comment|/* Gray: Circle: Legend */
name|legend_table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|legend_table
argument_list|)
expr_stmt|;
comment|/* Gray: Circle: Spinbutton 1 */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Hue:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|st
operator|->
name|hue
operator|=
name|INITIAL_GRAY_HUE
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|hue
argument_list|,
literal|0.0
argument_list|,
literal|2.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|st
operator|->
name|hue_entry
operator|=
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|entry
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|entry
argument_list|,
literal|75
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_hue
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
comment|/* Gray: Circle: units label */
name|st
operator|->
name|hue_units_label
operator|=
name|gtk_label_new
argument_list|(
name|rcm_units_string
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|st
operator|->
name|hue_units_label
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|hue_units_label
argument_list|)
expr_stmt|;
comment|/* Gray: Circle: Spinbutton 2 */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Saturation:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|st
operator|->
name|satur
operator|=
name|INITIAL_GRAY_SAT
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|satur
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|st
operator|->
name|satur_entry
operator|=
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|entry
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|entry
argument_list|,
literal|75
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_satur
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
comment|/** Gray: Operation-Mode **/
name|as_or_to_frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Mode"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|as_or_to_frame
argument_list|)
expr_stmt|;
name|radio_box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|as_or_to_frame
argument_list|)
argument_list|,
name|radio_box
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|radio_box
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|radio_box
argument_list|)
expr_stmt|;
comment|/* Gray: Operation-Mode: two radio buttons */
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Treat as this"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Gray_to_from
operator|==
name|GRAY_FROM
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_gray_from
argument_list|,
operator|&
operator|(
name|Current
operator|.
name|Gray_to_from
operator|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Change to this"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Gray_to_from
operator|==
name|GRAY_TO
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_gray_to
argument_list|,
operator|&
operator|(
name|Current
operator|.
name|Gray_to_from
operator|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
comment|/** Gray: What is gray? **/
name|gray_sat_frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"What is Gray?"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gray_sat_frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Saturation"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"<="
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|st
operator|->
name|gray_sat
operator|=
name|INITIAL_GRAY_RSAT
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|gray_sat
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|st
operator|->
name|gray_sat_entry
operator|=
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|entry
argument_list|,
literal|75
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_gray_sat
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gray_sat_frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
comment|/** add all frames to table **/
comment|/* add preview and legend to table */
name|mini_table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|mini_table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|mini_table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|mini_table
argument_list|)
argument_list|,
name|previewframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_SHRINK
argument_list|,
name|GTK_SHRINK
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|mini_table
argument_list|)
argument_list|,
name|legend_table
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_SHRINK
argument_list|,
name|GTK_SHRINK
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* add mini_table& two frames to table */
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|mini_table
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|as_or_to_frame
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|gray_sat_frame
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
comment|/* update circle (preview) */
name|rcm_render_circle
argument_list|(
name|preview
argument_list|,
name|GRAY_SUM
argument_list|,
name|GRAY_MARGIN
argument_list|)
expr_stmt|;
return|return
name|st
return|;
block|}
end_function

begin_comment
comment|/*----------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* Misc */
end_comment

begin_comment
comment|/*----------------------------------------------------------------------------*/
end_comment

begin_function
name|GtkWidget
modifier|*
DECL|function|rcm_create_misc (void)
name|rcm_create_misc
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|units_frame
decl_stmt|,
modifier|*
name|units_vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|preview_frame
decl_stmt|,
modifier|*
name|preview_vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|item
decl_stmt|,
modifier|*
name|menu
decl_stmt|,
modifier|*
name|root
decl_stmt|,
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GSList
modifier|*
name|units_group
init|=
name|NULL
decl_stmt|;
name|GSList
modifier|*
name|preview_group
init|=
name|NULL
decl_stmt|;
comment|/** Misc: Gray circle **/
name|Current
operator|.
name|Gray
operator|=
name|rcm_create_gray
argument_list|()
expr_stmt|;
comment|/** Misc: Used unit selection **/
name|units_frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Units"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|units_frame
argument_list|)
expr_stmt|;
name|units_vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|units_frame
argument_list|)
argument_list|,
name|units_vbox
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|units_vbox
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|units_vbox
argument_list|)
expr_stmt|;
comment|/* Misc: Used unit selection: 3 radio buttons */
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|units_group
argument_list|,
name|_
argument_list|(
literal|"Radians"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|units_vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Units
operator|==
name|RADIANS
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_radians
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|units_group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|units_group
argument_list|,
name|_
argument_list|(
literal|"Radians/Pi"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|units_vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Units
operator|==
name|RADIANS_OVER_PI
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_radians_over_PI
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|units_group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|units_group
argument_list|,
name|_
argument_list|(
literal|"Degrees"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|units_vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Units
operator|==
name|DEGREES
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_degrees
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/** Misc: Preview settings **/
comment|/* Misc: Preview settings: Continuous update ?! */
name|preview_frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Preview"
argument_list|)
argument_list|)
expr_stmt|;
name|preview_vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|preview_vbox
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|preview_vbox
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|preview_frame
argument_list|)
argument_list|,
name|preview_vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|preview_frame
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Continuous update"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|preview_vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_state
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|Current
operator|.
name|RealTime
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
operator|(
name|GtkSignalFunc
operator|)
name|rcm_preview_as_you_drag
argument_list|,
operator|&
operator|(
name|Current
operator|.
name|RealTime
operator|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
comment|/* Misc: Preview settings: Area */
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|preview_vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Area:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|label
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* create menu entries */
name|menu
operator|=
name|gtk_menu_new
argument_list|()
expr_stmt|;
name|item
operator|=
name|gtk_radio_menu_item_new_with_label
argument_list|(
name|preview_group
argument_list|,
name|_
argument_list|(
literal|"Entire Image"
argument_list|)
argument_list|)
expr_stmt|;
name|preview_group
operator|=
name|gtk_radio_menu_item_group
argument_list|(
name|GTK_RADIO_MENU_ITEM
argument_list|(
name|item
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_entire_image
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|item
operator|=
name|gtk_radio_menu_item_new_with_label
argument_list|(
name|preview_group
argument_list|,
name|_
argument_list|(
literal|"Selection"
argument_list|)
argument_list|)
expr_stmt|;
name|preview_group
operator|=
name|gtk_radio_menu_item_group
argument_list|(
name|GTK_RADIO_MENU_ITEM
argument_list|(
name|item
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_selection
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|item
operator|=
name|gtk_radio_menu_item_new_with_label
argument_list|(
name|preview_group
argument_list|,
name|_
argument_list|(
literal|"Context"
argument_list|)
argument_list|)
expr_stmt|;
name|preview_group
operator|=
name|gtk_radio_menu_item_group
argument_list|(
name|GTK_RADIO_MENU_ITEM
argument_list|(
name|item
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_selection_in_context
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/* create (options) menu */
name|root
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|root
argument_list|)
argument_list|,
name|menu
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|root
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|root
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|root
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|/** add frames (gray/preview/units) to table **/
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|Current
operator|.
name|Gray
operator|->
name|frame
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|preview_frame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|units_frame
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
return|return
name|table
return|;
block|}
end_function

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_comment
comment|/* create and call main dialog */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------*/
end_comment

begin_function
name|gint
DECL|function|rcm_dialog (void)
name|rcm_dialog
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|,
modifier|*
name|dlg
decl_stmt|,
modifier|*
name|hbox
decl_stmt|,
modifier|*
name|notebook
decl_stmt|;
name|GtkWidget
modifier|*
name|previews
decl_stmt|,
modifier|*
name|mains
decl_stmt|,
modifier|*
name|miscs
decl_stmt|;
name|guchar
modifier|*
name|color_cube
decl_stmt|;
name|gchar
modifier|*
modifier|*
name|argv
decl_stmt|;
name|gint
name|argc
decl_stmt|;
name|argc
operator|=
literal|1
expr_stmt|;
name|argv
operator|=
name|g_new
argument_list|(
name|gchar
operator|*
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|argv
index|[
literal|0
index|]
operator|=
name|g_strdup
argument_list|(
literal|"rcm"
argument_list|)
expr_stmt|;
name|Current
operator|.
name|Bna
operator|=
name|g_new
argument_list|(
name|RcmBna
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|/* init GTK and install colormap */
name|gtk_init
argument_list|(
operator|&
name|argc
argument_list|,
operator|&
name|argv
argument_list|)
expr_stmt|;
name|gtk_rc_parse
argument_list|(
name|gimp_gtkrc
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_preview_set_gamma
argument_list|(
name|gimp_gamma
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_preview_set_install_cmap
argument_list|(
name|gimp_install_cmap
argument_list|()
argument_list|)
expr_stmt|;
name|color_cube
operator|=
name|gimp_color_cube
argument_list|()
expr_stmt|;
name|gtk_preview_set_color_cube
argument_list|(
name|color_cube
index|[
literal|0
index|]
argument_list|,
name|color_cube
index|[
literal|1
index|]
argument_list|,
name|color_cube
index|[
literal|2
index|]
argument_list|,
name|color_cube
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|gtk_widget_set_default_visual
argument_list|(
name|gtk_preview_get_visual
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_widget_set_default_colormap
argument_list|(
name|gtk_preview_get_cmap
argument_list|()
argument_list|)
expr_stmt|;
comment|/* Create dialog */
name|dlg
operator|=
name|gimp_dialog_new
argument_list|(
name|_
argument_list|(
literal|"Colormap Rotation"
argument_list|)
argument_list|,
literal|"rcm"
argument_list|,
name|gimp_plugin_help_func
argument_list|,
literal|"filters/rcm.html"
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"OK"
argument_list|)
argument_list|,
name|rcm_ok_callback
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|_
argument_list|(
literal|"Cancel"
argument_list|)
argument_list|,
name|gtk_widget_destroy
argument_list|,
name|NULL
argument_list|,
literal|1
argument_list|,
name|NULL
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|Current
operator|.
name|Bna
operator|->
name|dlg
operator|=
name|dlg
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gtk_main_quit
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/* Create sub-dialogs */
name|Current
operator|.
name|reduced
operator|=
name|rcm_reduce_image
argument_list|(
name|Current
operator|.
name|drawable
argument_list|,
name|Current
operator|.
name|mask
argument_list|,
name|MAX_PREVIEW_SIZE
argument_list|,
name|ENTIRE_IMAGE
argument_list|)
expr_stmt|;
name|previews
operator|=
name|rcm_create_previews
argument_list|()
expr_stmt|;
name|mains
operator|=
name|rcm_create_main
argument_list|()
expr_stmt|;
name|miscs
operator|=
name|rcm_create_misc
argument_list|()
expr_stmt|;
name|Current
operator|.
name|Bna
operator|->
name|bna_frame
operator|=
name|previews
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|before
argument_list|,
name|ORIGINAL
argument_list|)
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
name|CURRENT
argument_list|)
expr_stmt|;
comment|/* H-Box */
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|hbox
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|previews
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* Notebook */
name|notebook
operator|=
name|gtk_notebook_new
argument_list|()
expr_stmt|;
name|gtk_notebook_set_tab_pos
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|notebook
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|notebook
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|mains
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|table
argument_list|,
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Main"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|miscs
argument_list|,
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Misc"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|rcm_set_pixmaps
argument_list|(
name|Current
operator|.
name|From
argument_list|)
expr_stmt|;
name|rcm_set_pixmaps
argument_list|(
name|Current
operator|.
name|To
argument_list|)
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
name|gtk_main
argument_list|()
expr_stmt|;
return|return
name|Current
operator|.
name|Success
return|;
block|}
end_function

end_unit

