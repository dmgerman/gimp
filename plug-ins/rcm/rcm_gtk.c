begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|"rcm.h"
end_include

begin_decl_stmt
DECL|variable|gray_preview
name|GtkWidget
modifier|*
name|gray_preview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|RcmParams
name|Current
decl_stmt|;
end_decl_stmt

begin_comment
comment|/********************************************************/
end_comment

begin_comment
comment|/*********************** Callbacks **********************/
end_comment

begin_comment
comment|/********************************************************/
end_comment

begin_function
name|void
DECL|function|rcm_close_callback (GtkWidget * widget,gpointer data)
name|rcm_close_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gtk_main_quit
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_ok_callback (GtkWidget * widget,gpointer data)
name|rcm_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gtk_widget_destroy
argument_list|(
name|GTK_WIDGET
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
name|Current
operator|.
name|Success
operator|=
literal|1
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_preview_what (GtkWidget * button,gpointer data)
name|rcm_preview_what
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
if|if
condition|(
operator|!
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
return|return;
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|data
argument_list|,
literal|"Entire Image"
argument_list|)
condition|)
name|Current
operator|.
name|Slctn
operator|=
name|ENTIRE_IMAGE
expr_stmt|;
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|data
argument_list|,
literal|"Selection Only"
argument_list|)
condition|)
name|Current
operator|.
name|Slctn
operator|=
name|SELECTION
expr_stmt|;
elseif|else
if|if
condition|(
operator|!
name|strcmp
argument_list|(
name|data
argument_list|,
literal|"Selection In Context"
argument_list|)
condition|)
name|Current
operator|.
name|Slctn
operator|=
name|SELECTION_IN_CONTEXT
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_360_degrees (GtkWidget * button,RcmCircle * circle)
name|rcm_360_degrees
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|RcmCircle
modifier|*
name|circle
parameter_list|)
block|{
name|circle
operator|->
name|action_flag
operator|=
name|DO_NOTHING
expr_stmt|;
name|gtk_widget_draw
argument_list|(
name|circle
operator|->
name|preview
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|circle
operator|->
name|angle
operator|->
name|beta
operator|=
name|circle
operator|->
name|angle
operator|->
name|alpha
operator|-
name|circle
operator|->
name|angle
operator|->
name|cw_ccw
operator|*
literal|0.001
expr_stmt|;
name|rcm_draw_arrows
argument_list|(
name|circle
operator|->
name|preview
operator|->
name|window
argument_list|,
name|circle
operator|->
name|preview
operator|->
name|style
operator|->
name|black_gc
argument_list|,
name|circle
operator|->
name|angle
argument_list|)
expr_stmt|;
name|circle
operator|->
name|action_flag
operator|=
name|VIRGIN
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
name|CURRENT
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_cw_ccw (GtkWidget * button,RcmCircle * circle)
name|rcm_cw_ccw
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|RcmCircle
modifier|*
name|circle
parameter_list|)
block|{
name|circle
operator|->
name|angle
operator|->
name|cw_ccw
operator|*=
operator|-
literal|1
expr_stmt|;
name|pmg_set_xpm_in_button_label
argument_list|(
name|circle
operator|->
name|cw_ccw_xpm_button
argument_list|,
operator|(
name|circle
operator|->
name|angle
operator|->
name|cw_ccw
operator|>
literal|0
operator|)
condition|?
literal|"/home/pavel/rcm/rcm_cw.xpm"
else|:
literal|"/home/pavel/rcm/rcm_ccw.xpm"
argument_list|)
expr_stmt|;
name|gtk_label_set
argument_list|(
name|GTK_LABEL
argument_list|(
name|circle
operator|->
name|cw_ccw_xpm_button
operator|->
name|additional_label
argument_list|)
argument_list|,
operator|(
name|circle
operator|->
name|angle
operator|->
name|cw_ccw
operator|>
literal|0
operator|)
condition|?
literal|"Clockwise"
else|:
literal|"C/Clockwise"
argument_list|)
expr_stmt|;
name|rcm_a_to_b
argument_list|(
name|button
argument_list|,
name|circle
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_a_to_b (GtkWidget * button,RcmCircle * circle)
name|rcm_a_to_b
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|RcmCircle
modifier|*
name|circle
parameter_list|)
block|{
name|circle
operator|->
name|action_flag
operator|=
name|DO_NOTHING
expr_stmt|;
name|gtk_widget_draw
argument_list|(
name|circle
operator|->
name|preview
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|SWAP
argument_list|(
name|circle
operator|->
name|angle
operator|->
name|alpha
argument_list|,
name|circle
operator|->
name|angle
operator|->
name|beta
argument_list|)
expr_stmt|;
name|rcm_draw_arrows
argument_list|(
name|circle
operator|->
name|preview
operator|->
name|window
argument_list|,
name|circle
operator|->
name|preview
operator|->
name|style
operator|->
name|black_gc
argument_list|,
name|circle
operator|->
name|angle
argument_list|)
expr_stmt|;
name|circle
operator|->
name|action_flag
operator|=
name|VIRGIN
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
name|CURRENT
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_preview_as_you_drag (GtkWidget * button,gpointer * value)
name|rcm_preview_as_you_drag
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
modifier|*
name|value
parameter_list|)
block|{
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
name|Current
operator|.
name|RealTime
operator|=
name|TRUE
expr_stmt|;
else|else
name|Current
operator|.
name|RealTime
operator|=
name|FALSE
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_switch_to_degrees (GtkWidget * button,gpointer * value)
name|rcm_switch_to_degrees
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
modifier|*
name|value
parameter_list|)
block|{
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
name|rcm_update_entries
argument_list|(
name|Current
operator|.
name|Units
operator|=
name|DEGREES
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_switch_to_radians (GtkWidget * button,gpointer * value)
name|rcm_switch_to_radians
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
modifier|*
name|value
parameter_list|)
block|{
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
name|rcm_update_entries
argument_list|(
name|Current
operator|.
name|Units
operator|=
name|RADIANS
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_switch_to_radians_over_PI (GtkWidget * button,gpointer * value)
name|rcm_switch_to_radians_over_PI
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
modifier|*
name|value
parameter_list|)
block|{
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
name|rcm_update_entries
argument_list|(
name|Current
operator|.
name|Units
operator|=
name|RADIANS_OVER_PI
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|rcm_switch_to_gray_to (GtkWidget * button,gpointer * value)
name|void
name|rcm_switch_to_gray_to
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
modifier|*
name|value
parameter_list|)
block|{
if|if
condition|(
operator|!
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
condition|)
return|return;
name|Current
operator|.
name|Gray_to_from
operator|=
name|GRAY_TO
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
name|CURRENT
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|rcm_switch_to_gray_from (GtkWidget * button,gpointer * value)
name|void
name|rcm_switch_to_gray_from
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
modifier|*
name|value
parameter_list|)
block|{
if|if
condition|(
operator|!
operator|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
operator|)
condition|)
return|return;
name|Current
operator|.
name|Gray_to_from
operator|=
name|GRAY_FROM
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
name|CURRENT
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|rcm_change_preview ()
name|rcm_change_preview
parameter_list|()
block|{
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|before
argument_list|)
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|width
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|)
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|width
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|before
argument_list|,
name|ORIGINAL
argument_list|)
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
name|CURRENT
argument_list|)
expr_stmt|;
comment|/*     gtk_container_check_resize(GTK_CONTAINER(Current.Bna->bna_frame), NULL);     */
name|gtk_widget_draw
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|before
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_draw
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|rcm_selection_in_context (GtkWidget * button,gpointer * value)
name|void
name|rcm_selection_in_context
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
modifier|*
name|value
parameter_list|)
block|{
name|Current
operator|.
name|reduced
operator|=
name|Reduce_The_Image
argument_list|(
name|Current
operator|.
name|drawable
argument_list|,
name|Current
operator|.
name|mask
argument_list|,
name|MAX_PREVIEW_SIZE
argument_list|,
name|SELECTION_IN_CONTEXT
argument_list|)
expr_stmt|;
name|rcm_change_preview
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
DECL|function|rcm_selection (GtkWidget * button,gpointer * value)
name|void
name|rcm_selection
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
modifier|*
name|value
parameter_list|)
block|{
name|Current
operator|.
name|reduced
operator|=
name|Reduce_The_Image
argument_list|(
name|Current
operator|.
name|drawable
argument_list|,
name|Current
operator|.
name|mask
argument_list|,
name|MAX_PREVIEW_SIZE
argument_list|,
name|SELECTION
argument_list|)
expr_stmt|;
name|rcm_change_preview
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
DECL|function|rcm_entire_image (GtkWidget * button,gpointer * value)
name|void
name|rcm_entire_image
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|gpointer
modifier|*
name|value
parameter_list|)
block|{
name|Current
operator|.
name|reduced
operator|=
name|Reduce_The_Image
argument_list|(
name|Current
operator|.
name|drawable
argument_list|,
name|Current
operator|.
name|mask
argument_list|,
name|MAX_PREVIEW_SIZE
argument_list|,
name|ENTIRE_IMAGE
argument_list|)
expr_stmt|;
name|rcm_change_preview
argument_list|()
expr_stmt|;
block|}
end_function

begin_comment
comment|/********************************************************/
end_comment

begin_comment
comment|/********************* Build Helpers ********************/
end_comment

begin_comment
comment|/********************************************************/
end_comment

begin_function
name|GtkWidget
modifier|*
DECL|function|rcm_label_in_a_table (GtkWidget * table,guchar * string,gint x_spot,gint y_spot)
name|rcm_label_in_a_table
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|guchar
modifier|*
name|string
parameter_list|,
name|gint
name|x_spot
parameter_list|,
name|gint
name|y_spot
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|label
init|=
name|gtk_label_new
argument_list|(
name|string
argument_list|)
decl_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
name|x_spot
argument_list|,
name|x_spot
operator|+
literal|1
argument_list|,
name|y_spot
argument_list|,
name|y_spot
operator|+
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
name|label
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|rcm_button_in_a_table (GtkWidget * table,guchar * string,int x_spot,int y_spot,GtkSignalFunc * function,gpointer * data)
name|rcm_button_in_a_table
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|guchar
modifier|*
name|string
parameter_list|,
name|int
name|x_spot
parameter_list|,
name|int
name|y_spot
parameter_list|,
name|GtkSignalFunc
modifier|*
name|function
parameter_list|,
name|gpointer
modifier|*
name|data
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
init|=
name|gtk_button_new_with_label
argument_list|(
name|string
argument_list|)
decl_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|function
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|button
argument_list|,
name|x_spot
argument_list|,
name|x_spot
operator|+
literal|1
argument_list|,
name|y_spot
argument_list|,
name|y_spot
operator|+
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
name|button
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|rcm_entry_in_a_table (GtkWidget * table,float value,gint x_spot,gint y_spot,GtkSignalFunc func,gpointer data)
name|rcm_entry_in_a_table
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|float
name|value
parameter_list|,
name|gint
name|x_spot
parameter_list|,
name|gint
name|y_spot
parameter_list|,
name|GtkSignalFunc
name|func
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|entry
init|=
name|gtk_entry_new
argument_list|()
decl_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|GTK_WIDGET
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|42
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|rcm_float_in_an_entry
argument_list|(
name|entry
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|entry
argument_list|,
name|x_spot
argument_list|,
name|x_spot
operator|+
literal|1
argument_list|,
name|y_spot
argument_list|,
name|y_spot
operator|+
literal|1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
name|func
argument_list|,
name|data
argument_list|)
expr_stmt|;
return|return
name|entry
return|;
block|}
end_function

begin_function
name|void
DECL|function|Check_Button_In_A_Box (GtkWidget * vbox,guchar * label,GtkSignalFunc function,gpointer data,gint clicked)
name|Check_Button_In_A_Box
parameter_list|(
name|GtkWidget
modifier|*
name|vbox
parameter_list|,
name|guchar
modifier|*
name|label
parameter_list|,
name|GtkSignalFunc
name|function
parameter_list|,
name|gpointer
name|data
parameter_list|,
name|gint
name|clicked
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_state
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|clicked
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|function
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|GSList
modifier|*
DECL|function|Button_In_A_Box (GtkWidget * vbox,GSList * group,guchar * label,GtkSignalFunc function,gpointer data,int clicked)
name|Button_In_A_Box
parameter_list|(
name|GtkWidget
modifier|*
name|vbox
parameter_list|,
name|GSList
modifier|*
name|group
parameter_list|,
name|guchar
modifier|*
name|label
parameter_list|,
name|GtkSignalFunc
name|function
parameter_list|,
name|gpointer
name|data
parameter_list|,
name|int
name|clicked
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|label
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|clicked
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|function
argument_list|,
name|data
argument_list|)
expr_stmt|;
return|return
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
return|;
block|}
end_function

begin_comment
comment|/********************************************************/
end_comment

begin_comment
comment|/********************* The 3 Frames *********************/
end_comment

begin_comment
comment|/********************************************************/
end_comment

begin_function
name|GtkWidget
modifier|*
DECL|function|rcm_create_bna ()
name|rcm_create_bna
parameter_list|()
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|blabel
decl_stmt|,
modifier|*
name|alabel
decl_stmt|,
modifier|*
name|bframe
decl_stmt|,
modifier|*
name|aframe
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|Current
operator|.
name|Bna
operator|->
name|before
argument_list|,
operator|&
name|bframe
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|width
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|height
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|Create_A_Preview
argument_list|(
operator|&
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
operator|&
name|aframe
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|width
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|height
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|/* All the previews */
name|alabel
operator|=
name|gtk_label_new
argument_list|(
literal|"Rotated:"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|alabel
argument_list|)
expr_stmt|;
name|blabel
operator|=
name|gtk_label_new
argument_list|(
literal|"Original:"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|blabel
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|4
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|blabel
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|bframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|alabel
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|aframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
name|RcmGray
modifier|*
DECL|function|rcm_create_gray ()
name|rcm_create_gray
parameter_list|()
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|preview
decl_stmt|,
modifier|*
name|as_or_to_frame
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|,
modifier|*
name|previewframe
decl_stmt|,
modifier|*
name|legend_table
decl_stmt|;
name|GtkWidget
modifier|*
name|gray_sat_frame
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|RcmGray
modifier|*
name|st
init|=
name|g_new
argument_list|(
name|RcmGray
argument_list|,
literal|1
argument_list|)
decl_stmt|;
name|st
operator|->
name|hue
operator|=
literal|0
expr_stmt|;
name|st
operator|->
name|satur
operator|=
literal|0
expr_stmt|;
name|st
operator|->
name|action_flag
operator|=
name|VIRGIN
expr_stmt|;
name|st
operator|->
name|frame
operator|=
name|frame
operator|=
name|gtk_frame_new
argument_list|(
literal|"Gray"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|table
decl_stmt|,
modifier|*
name|entry
decl_stmt|;
name|gray_sat_frame
operator|=
name|gtk_frame_new
argument_list|(
literal|"What is Gray?"
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gray_sat_frame
argument_list|)
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gray_sat_frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Sat<="
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|st
operator|->
name|gray_sat_entry
operator|=
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|GTK_WIDGET
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|42
argument_list|,
literal|20
argument_list|)
expr_stmt|;
name|rcm_float_in_an_entry
argument_list|(
name|entry
argument_list|,
name|st
operator|->
name|gray_sat
operator|=
name|INITIAL_GRAY_SAT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_gray_sat
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gray_sat_frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
block|}
block|{
name|previewframe
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|previewframe
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|previewframe
argument_list|)
expr_stmt|;
name|st
operator|->
name|preview
operator|=
name|preview
operator|=
name|gtk_preview_new
argument_list|(
name|GTK_PREVIEW_COLOR
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|preview
argument_list|)
argument_list|,
name|GRAY_SUM
argument_list|,
name|GRAY_SUM
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|preview
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|previewframe
argument_list|)
argument_list|,
name|preview
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|preview
argument_list|,
name|RANGE_ADJUST_MASK
argument_list|)
expr_stmt|;
name|gtk_signal_connect_after
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"expose_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_gray_expose_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_gray_button_press_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"button_release_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_gray_release_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|"motion_notify_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_gray_motion_notify_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
block|}
block|{
name|legend_table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|5
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|legend_table
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|legend_table
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|rcm_label_in_a_table
argument_list|(
name|legend_table
argument_list|,
literal|"H:"
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|st
operator|->
name|hue_entry
operator|=
name|rcm_entry_in_a_table
argument_list|(
name|legend_table
argument_list|,
name|st
operator|->
name|hue
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_hue
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|st
operator|->
name|hue_units_label
operator|=
name|rcm_label_in_a_table
argument_list|(
name|legend_table
argument_list|,
name|rcm_units_string
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|rcm_label_in_a_table
argument_list|(
name|legend_table
argument_list|,
literal|"  S:"
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|st
operator|->
name|satur_entry
operator|=
name|rcm_entry_in_a_table
argument_list|(
name|legend_table
argument_list|,
name|st
operator|->
name|satur
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_satur
argument_list|,
name|st
argument_list|)
expr_stmt|;
block|}
block|{
name|GtkWidget
modifier|*
name|box
decl_stmt|;
name|as_or_to_frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|as_or_to_frame
argument_list|)
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|as_or_to_frame
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|as_or_to_frame
argument_list|)
argument_list|,
name|box
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|box
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|box
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|group
argument_list|,
literal|"Treat As This"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_gray_from
argument_list|,
operator|&
operator|(
name|Current
operator|.
name|Gray_to_from
operator|)
argument_list|,
name|Current
operator|.
name|Gray_to_from
operator|==
name|GRAY_FROM
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|box
argument_list|,
name|group
argument_list|,
literal|"Change To This"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_gray_to
argument_list|,
operator|&
operator|(
name|Current
operator|.
name|Gray_to_from
operator|)
argument_list|,
name|Current
operator|.
name|Gray_to_from
operator|==
name|GRAY_TO
argument_list|)
expr_stmt|;
block|}
block|{
name|GtkWidget
modifier|*
name|mini_frame
decl_stmt|,
modifier|*
name|mini_table
decl_stmt|;
name|mini_frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|mini_frame
argument_list|)
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|mini_frame
argument_list|)
expr_stmt|;
name|mini_table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|mini_table
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|mini_frame
argument_list|)
argument_list|,
name|mini_table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|mini_table
argument_list|)
argument_list|,
name|previewframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|mini_table
argument_list|)
argument_list|,
name|legend_table
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|mini_frame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|as_or_to_frame
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|gray_sat_frame
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|rcm_render_circle_preview
argument_list|(
name|preview
argument_list|,
name|GRAY_SUM
argument_list|,
name|GRAY_MARGIN
argument_list|)
expr_stmt|;
return|return
name|st
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|rcm_create_misc ()
name|rcm_create_misc
parameter_list|()
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|label
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|units_frame
decl_stmt|,
modifier|*
name|units_vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|misc_frame
decl_stmt|,
modifier|*
name|misc_vbox
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|Current
operator|.
name|Gray
operator|=
name|rcm_create_gray
argument_list|()
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|/* All the previews */
name|units_frame
operator|=
name|gtk_frame_new
argument_list|(
literal|"Units"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|units_frame
argument_list|)
expr_stmt|;
name|units_vbox
operator|=
name|gtk_vbox_new
argument_list|(
literal|3
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|units_frame
argument_list|)
argument_list|,
name|units_vbox
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|units_vbox
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|units_vbox
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|units_vbox
argument_list|,
name|group
argument_list|,
literal|"Radians"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_radians
argument_list|,
name|NULL
argument_list|,
name|Current
operator|.
name|Units
operator|==
name|RADIANS
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|units_vbox
argument_list|,
name|group
argument_list|,
literal|"Radiand/PI"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_radians_over_PI
argument_list|,
name|NULL
argument_list|,
name|Current
operator|.
name|Units
operator|==
name|RADIANS_OVER_PI
argument_list|)
expr_stmt|;
name|group
operator|=
name|Button_In_A_Box
argument_list|(
name|units_vbox
argument_list|,
name|group
argument_list|,
literal|"Degrees"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_switch_to_degrees
argument_list|,
name|NULL
argument_list|,
name|Current
operator|.
name|Units
operator|==
name|DEGREES
argument_list|)
expr_stmt|;
name|misc_frame
operator|=
name|gtk_frame_new
argument_list|(
literal|"Very Misc"
argument_list|)
expr_stmt|;
name|misc_vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|misc_frame
argument_list|)
argument_list|,
name|misc_vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|misc_frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|misc_vbox
argument_list|)
expr_stmt|;
name|Check_Button_In_A_Box
argument_list|(
name|misc_vbox
argument_list|,
literal|"Preview as you Drag"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_preview_as_you_drag
argument_list|,
operator|&
operator|(
name|Current
operator|.
name|RealTime
operator|)
argument_list|,
name|Current
operator|.
name|RealTime
argument_list|)
expr_stmt|;
block|{
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|GtkWidget
modifier|*
name|item
decl_stmt|,
modifier|*
name|menu
decl_stmt|,
modifier|*
name|root
decl_stmt|,
modifier|*
name|hbox
decl_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|misc_vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Preview"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|label
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|menu
operator|=
name|gtk_menu_new
argument_list|()
expr_stmt|;
name|item
operator|=
name|gtk_radio_menu_item_new_with_label
argument_list|(
name|group
argument_list|,
literal|"Entire Image"
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_menu_item_group
argument_list|(
name|GTK_RADIO_MENU_ITEM
argument_list|(
name|item
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_entire_image
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|item
operator|=
name|gtk_radio_menu_item_new_with_label
argument_list|(
name|group
argument_list|,
literal|"Selection"
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_menu_item_group
argument_list|(
name|GTK_RADIO_MENU_ITEM
argument_list|(
name|item
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_selection
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|item
operator|=
name|gtk_radio_menu_item_new_with_label
argument_list|(
name|group
argument_list|,
literal|"Context"
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_menu_item_group
argument_list|(
name|GTK_RADIO_MENU_ITEM
argument_list|(
name|item
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|item
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|item
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|item
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_selection_in_context
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|root
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|root
argument_list|)
argument_list|,
name|menu
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|root
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|root
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|root
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|Current
operator|.
name|Gray
operator|->
name|frame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|5
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|misc_frame
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|5
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|units_frame
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|5
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|rcm_create_from_to ()
name|rcm_create_from_to
parameter_list|()
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|blabel
decl_stmt|,
modifier|*
name|alabel
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|Current
operator|.
name|From
operator|=
name|rcm_create_square_preview
argument_list|(
name|SUM
argument_list|,
literal|"From:"
argument_list|)
expr_stmt|;
name|Current
operator|.
name|To
operator|=
name|rcm_create_square_preview
argument_list|(
name|SUM
argument_list|,
literal|"To:"
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_ETCHED_IN
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
comment|/* All the previews */
name|alabel
operator|=
name|gtk_label_new
argument_list|(
literal|"To:"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|alabel
argument_list|)
expr_stmt|;
comment|/* gtk_misc_set_alignment(GTK_MISC(alabel), 0.0, 0.5); */
name|blabel
operator|=
name|gtk_label_new
argument_list|(
literal|"From:"
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|blabel
argument_list|)
expr_stmt|;
comment|/* gtk_misc_set_alignment(GTK_MISC(blabel), 0.0, 0.5); */
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|Current
operator|.
name|From
operator|->
name|table
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|Current
operator|.
name|To
operator|->
name|table
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
name|void
DECL|function|Create_A_Preview (GtkWidget ** preview,GtkWidget ** frame,int previewWidth,int previewHeight,int colorfulness)
name|Create_A_Preview
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|preview
parameter_list|,
name|GtkWidget
modifier|*
modifier|*
name|frame
parameter_list|,
name|int
name|previewWidth
parameter_list|,
name|int
name|previewHeight
parameter_list|,
name|int
name|colorfulness
parameter_list|)
block|{
operator|*
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|frame
argument_list|)
expr_stmt|;
operator|*
name|preview
operator|=
name|gtk_preview_new
argument_list|(
name|colorfulness
condition|?
name|GTK_PREVIEW_COLOR
else|:
name|GTK_PREVIEW_GRAYSCALE
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
operator|*
name|preview
argument_list|)
argument_list|,
name|previewWidth
argument_list|,
name|previewHeight
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|preview
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
operator|*
name|frame
argument_list|)
argument_list|,
operator|*
name|preview
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|RcmCircle
modifier|*
DECL|function|rcm_create_square_preview (gint height,gchar * label_content)
name|rcm_create_square_preview
parameter_list|(
name|gint
name|height
parameter_list|,
name|gchar
modifier|*
name|label_content
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|frame
decl_stmt|,
modifier|*
name|button_table
decl_stmt|,
modifier|*
name|legend_table
decl_stmt|;
name|RcmCircle
modifier|*
name|st
init|=
name|g_new
argument_list|(
name|RcmCircle
argument_list|,
literal|1
argument_list|)
decl_stmt|;
name|st
operator|->
name|action_flag
operator|=
name|VIRGIN
expr_stmt|;
name|st
operator|->
name|angle
operator|=
name|g_new
argument_list|(
name|RcmAngle
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|alpha
operator|=
name|INITIAL_ALPHA
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|beta
operator|=
name|INITIAL_BETA
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|cw_ccw
operator|=
literal|1
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|st
operator|->
name|preview
operator|=
name|gtk_preview_new
argument_list|(
name|GTK_PREVIEW_COLOR
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
name|height
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|preview
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|st
operator|->
name|preview
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|st
operator|->
name|preview
argument_list|,
name|RANGE_ADJUST_MASK
argument_list|)
expr_stmt|;
name|gtk_signal_connect_after
argument_list|(
name|GTK_OBJECT
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
literal|"expose_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_expose_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_button_press_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
literal|"button_release_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_release_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|st
operator|->
name|preview
argument_list|)
argument_list|,
literal|"motion_notify_event"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_motion_notify_event
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|rcm_render_circle_preview
argument_list|(
name|st
operator|->
name|preview
argument_list|,
name|SUM
argument_list|,
name|MARGIN
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|label_content
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
block|{
name|PmgButtonLabelXpm
modifier|*
name|xpm_button
decl_stmt|;
name|button_table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button_table
argument_list|)
expr_stmt|;
name|st
operator|->
name|cw_ccw_xpm_button
operator|=
name|xpm_button
operator|=
name|pmg_button_label_xpm_new
argument_list|(
name|gtk_window_new
argument_list|(
literal|0
argument_list|)
argument_list|,
operator|(
name|st
operator|->
name|angle
operator|->
name|cw_ccw
operator|>
literal|0
operator|)
condition|?
name|RCM_XPM_DIR
literal|"rcm_cw.xpm"
else|:
name|RCM_XPM_DIR
literal|"rcm_ccw.xpm"
argument_list|,
literal|"Switch To"
argument_list|,
operator|(
name|st
operator|->
name|angle
operator|->
name|cw_ccw
operator|>
literal|0
operator|)
condition|?
literal|"Clockwise"
else|:
literal|"C/Clockwise"
argument_list|,
literal|'h'
argument_list|,
operator|(
name|GtkSignalFunc
operator|*
operator|)
name|rcm_cw_ccw
argument_list|,
operator|(
name|gpointer
operator|)
name|st
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|button_table
argument_list|)
argument_list|,
name|xpm_button
operator|->
name|button
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|xpm_button
operator|=
name|pmg_button_label_xpm_new
argument_list|(
name|gtk_window_new
argument_list|(
literal|0
argument_list|)
argument_list|,
name|RCM_XPM_DIR
literal|"rcm_a_b.xpm"
argument_list|,
literal|"Switch Order"
argument_list|,
literal|"Of Arrows"
argument_list|,
literal|'h'
argument_list|,
operator|(
name|GtkSignalFunc
operator|*
operator|)
name|rcm_a_to_b
argument_list|,
operator|(
name|gpointer
operator|)
name|st
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|button_table
argument_list|)
argument_list|,
name|xpm_button
operator|->
name|button
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|xpm_button
operator|=
name|pmg_button_label_xpm_new
argument_list|(
name|gtk_window_new
argument_list|(
literal|0
argument_list|)
argument_list|,
name|RCM_XPM_DIR
literal|"rcm_360.xpm"
argument_list|,
literal|"Select The"
argument_list|,
literal|"Entire Range"
argument_list|,
literal|'h'
argument_list|,
operator|(
name|GtkSignalFunc
operator|*
operator|)
name|rcm_360_degrees
argument_list|,
operator|(
name|gpointer
operator|)
name|st
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|button_table
argument_list|)
argument_list|,
name|xpm_button
operator|->
name|button
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|5
argument_list|,
literal|2
argument_list|)
expr_stmt|;
block|}
name|legend_table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|legend_table
argument_list|)
expr_stmt|;
name|rcm_label_in_a_table
argument_list|(
name|legend_table
argument_list|,
literal|"From "
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|st
operator|->
name|alpha_entry
operator|=
name|rcm_entry_in_a_table
argument_list|(
name|legend_table
argument_list|,
name|st
operator|->
name|angle
operator|->
name|alpha
operator|*
name|rcm_units_factor
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_alpha
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|st
operator|->
name|alpha_units_label
operator|=
name|rcm_label_in_a_table
argument_list|(
name|legend_table
argument_list|,
name|rcm_units_string
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|rcm_label_in_a_table
argument_list|(
name|legend_table
argument_list|,
literal|"  to "
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|st
operator|->
name|beta_entry
operator|=
name|rcm_entry_in_a_table
argument_list|(
name|legend_table
argument_list|,
name|st
operator|->
name|angle
operator|->
name|beta
operator|*
name|rcm_units_factor
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_set_beta
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|st
operator|->
name|beta_units_label
operator|=
name|rcm_label_in_a_table
argument_list|(
name|legend_table
argument_list|,
name|rcm_units_string
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|st
operator|->
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|frame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|button_table
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|legend_table
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|10
argument_list|)
expr_stmt|;
return|return
name|st
return|;
block|}
end_function

begin_comment
comment|/***********************************************************/
end_comment

begin_comment
comment|/********************  MAIN DIALOG  ************************/
end_comment

begin_comment
comment|/***********************************************************/
end_comment

begin_function
name|gint
DECL|function|rcm_dialog ()
name|rcm_dialog
parameter_list|()
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|,
modifier|*
name|dlg
decl_stmt|,
modifier|*
name|circles
decl_stmt|,
modifier|*
name|bna
decl_stmt|,
modifier|*
name|misc
decl_stmt|;
name|GtkWidget
modifier|*
name|OKbutton
decl_stmt|,
modifier|*
name|CANCELbutton
decl_stmt|;
name|GtkWidget
modifier|*
name|buttonTable
decl_stmt|;
name|guchar
modifier|*
name|color_cube
decl_stmt|;
name|gchar
modifier|*
modifier|*
name|argv
decl_stmt|;
name|gint
name|argc
decl_stmt|;
name|argc
operator|=
literal|1
expr_stmt|;
name|argv
operator|=
name|g_new
argument_list|(
name|gchar
operator|*
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|argv
index|[
literal|0
index|]
operator|=
name|g_strdup
argument_list|(
literal|"rcm"
argument_list|)
expr_stmt|;
name|gtk_init
argument_list|(
operator|&
name|argc
argument_list|,
operator|&
name|argv
argument_list|)
expr_stmt|;
name|gtk_rc_parse
argument_list|(
name|gimp_gtkrc
argument_list|()
argument_list|)
expr_stmt|;
name|Current
operator|.
name|Bna
operator|=
name|g_new
argument_list|(
name|RcmBna
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_preview_set_gamma
argument_list|(
name|gimp_gamma
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_preview_set_install_cmap
argument_list|(
name|gimp_install_cmap
argument_list|()
argument_list|)
expr_stmt|;
name|color_cube
operator|=
name|gimp_color_cube
argument_list|()
expr_stmt|;
name|gtk_preview_set_color_cube
argument_list|(
name|color_cube
index|[
literal|0
index|]
argument_list|,
name|color_cube
index|[
literal|1
index|]
argument_list|,
name|color_cube
index|[
literal|2
index|]
argument_list|,
name|color_cube
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|gtk_widget_set_default_visual
argument_list|(
name|gtk_preview_get_visual
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_widget_set_default_colormap
argument_list|(
name|gtk_preview_get_cmap
argument_list|()
argument_list|)
expr_stmt|;
name|Current
operator|.
name|Bna
operator|->
name|dlg
operator|=
name|dlg
operator|=
name|gtk_dialog_new
argument_list|()
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"Colormap Rotation"
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_close_callback
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|OKbutton
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"OK"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|OKbutton
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|OKbutton
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|rcm_ok_callback
argument_list|,
name|dlg
argument_list|)
expr_stmt|;
name|gtk_widget_grab_default
argument_list|(
name|OKbutton
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|OKbutton
argument_list|)
expr_stmt|;
name|CANCELbutton
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"Cancel"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|CANCELbutton
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|CANCELbutton
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtk_widget_destroy
argument_list|,
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|CANCELbutton
argument_list|)
expr_stmt|;
name|buttonTable
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|4
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|buttonTable
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|buttonTable
argument_list|)
argument_list|,
literal|3
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|buttonTable
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|buttonTable
argument_list|)
argument_list|,
name|OKbutton
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|buttonTable
argument_list|)
argument_list|,
name|CANCELbutton
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|buttonTable
argument_list|)
expr_stmt|;
comment|/*************************************************************/
name|Current
operator|.
name|reduced
operator|=
name|Reduce_The_Image
argument_list|(
name|Current
operator|.
name|drawable
argument_list|,
name|Current
operator|.
name|mask
argument_list|,
name|MAX_PREVIEW_SIZE
argument_list|,
name|ENTIRE_IMAGE
argument_list|)
expr_stmt|;
name|circles
operator|=
name|rcm_create_from_to
argument_list|()
expr_stmt|;
name|Current
operator|.
name|Bna
operator|->
name|bna_frame
operator|=
name|bna
operator|=
name|rcm_create_bna
argument_list|()
expr_stmt|;
name|misc
operator|=
name|rcm_create_misc
argument_list|()
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|before
argument_list|,
name|ORIGINAL
argument_list|)
expr_stmt|;
name|rcm_render_preview
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
name|CURRENT
argument_list|)
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|notebook
decl_stmt|;
name|notebook
operator|=
name|gtk_notebook_new
argument_list|()
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|notebook
argument_list|)
argument_list|,
literal|10
argument_list|)
expr_stmt|;
name|gtk_notebook_set_tab_pos
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|notebook
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|notebook
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|bna
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|circles
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|table
argument_list|,
name|gtk_label_new
argument_list|(
literal|"        Main            "
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|misc
argument_list|,
name|gtk_label_new
argument_list|(
literal|"        Misc            "
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_show
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
name|gtk_main
argument_list|()
expr_stmt|;
return|return
name|Current
operator|.
name|Success
return|;
block|}
end_function

end_unit

