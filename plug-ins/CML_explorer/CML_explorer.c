begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* The GIMP -- an image manipulation program  * Copyright (C) 1995 Spencer Kimball and Peter Mattis  *  * CML_explorer.c -- This is a plug-in for The GIMP 1.0  * Time-stamp:<1997/11/22 23:54:47 narazaki@InetQ.or.jp>  * Copyright (C) 1997 Shuji Narazaki<narazaki@InetQ.or.jp>  * Version: 1.0.11  * URL: http://www.inetq.or.jp/~narazaki/TheGIMP/  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.  *  * Comment:  *  CML is the abbreviation of Coupled-Map Lattice that is a model of  *  complex systems, proposed by a physicist[1,2].  *  *  Similar models are summaried as follows:  *  *			Value	 Time	  Space  *  Coupled-Map Lattice	cont.	 discrete discrete  *  Celluar Automata	discrete discrete discrete  *  Diffrential Eq.	cont.	 cont.	  cont.  *  *  (But this program uses a parameter: hold-rate to avoid very fast changes.  *  Thus time is rather continuous than discrete.  *  Yes, this change to model changes the output completely.)  *  *  References:  *  1. Kunihiko Kaneko, Period-doubling of kind-antikink patterns,  *     quasi-periodicity in antiferro-like structures and spatial  *     intermittency in coupled map lattices -- Toward a prelude to a  *     "field theory of chaos", Prog. Theor. Phys. 72 (1984) 480.  *  *  2. Kunihiko Kaneko ed., Theory and Applications of Coupled Map  *     Lattices (Wiley, 1993).  *  *  About Parameter File:  *  I assume that the possible longest line in CMP parameter file is 1023.  *  Please read CML_save_to_file_callback if you want know details of syntax.  *  *  Format version 1.0 starts with:  *    ; This is a parameter file for CML_explorer  *    ; File format version: 1.0  *    ;  *    	Hue  *  *  The old format for CML_explorer included in gimp-0.99.[89] is:  *    ; CML parameter file (version: 1.0)  *    ;	Hue  *  * (This file format is interpreted as format version 0.99 now.)  *  * Thanks:  *  This version contains patches from:  *    Tim Mooney<mooney@dogbert.cc.ndsu.NoDak.edu>  *    Sean P Cier<scier@andrew.cmu.edu>  *    David Mosberger-Tang<davidm@azstarnet.com>  *    Michael Sweet<mike@easysw.com>  *  */
end_comment

begin_include
include|#
directive|include
file|"gtk/gtk.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/gimp.h"
end_include

begin_include
include|#
directive|include
file|<errno.h>
end_include

begin_include
include|#
directive|include
file|<math.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<sys/stat.h>
end_include

begin_include
include|#
directive|include
file|<time.h>
end_include

begin_comment
comment|/* for seed of random number */
end_comment

begin_define
DECL|macro|PARAM_FILE_FORMAT_VERSION
define|#
directive|define
name|PARAM_FILE_FORMAT_VERSION
value|1.0
end_define

begin_define
DECL|macro|PLUG_IN_NAME
define|#
directive|define
name|PLUG_IN_NAME
value|"plug_in_CML_explorer"
end_define

begin_define
DECL|macro|SHORT_NAME
define|#
directive|define
name|SHORT_NAME
value|"CML_explorer"
end_define

begin_define
DECL|macro|PROGRESS_NAME
define|#
directive|define
name|PROGRESS_NAME
value|"CML_explorer: evoluting..."
end_define

begin_define
DECL|macro|MENU_POSITION
define|#
directive|define
name|MENU_POSITION
value|"<Image>/Filters/Render/CML explorer"
end_define

begin_define
DECL|macro|VERBOSE_DIALOGS
define|#
directive|define
name|VERBOSE_DIALOGS
value|1
end_define

begin_define
DECL|macro|MAIN_FUNCTION
define|#
directive|define
name|MAIN_FUNCTION
value|CML
end_define

begin_define
DECL|macro|INTERFACE
define|#
directive|define
name|INTERFACE
value|CML_explorer_interface
end_define

begin_define
DECL|macro|DIALOG
define|#
directive|define
name|DIALOG
value|CML_explorer_dialog
end_define

begin_define
DECL|macro|VALS
define|#
directive|define
name|VALS
value|CML_explorer_vals
end_define

begin_define
DECL|macro|OK_CALLBACK
define|#
directive|define
name|OK_CALLBACK
value|CML_explorer_ok_callback
end_define

begin_define
DECL|macro|PROGRESS_UPDATE_NUM
define|#
directive|define
name|PROGRESS_UPDATE_NUM
value|100
end_define

begin_define
DECL|macro|CML_LINE_SIZE
define|#
directive|define
name|CML_LINE_SIZE
value|1024
end_define

begin_define
DECL|macro|TILE_CACHE_SIZE
define|#
directive|define
name|TILE_CACHE_SIZE
value|32
end_define

begin_comment
comment|/* gtkWrapper */
end_comment

begin_comment
comment|/* gtkW is the abbreviation of gtk Wrapper */
end_comment

begin_define
DECL|macro|GTKW_ENTRY_WIDTH
define|#
directive|define
name|GTKW_ENTRY_WIDTH
value|60
end_define

begin_define
DECL|macro|GTKW_SCALE_WIDTH
define|#
directive|define
name|GTKW_SCALE_WIDTH
value|130
end_define

begin_define
DECL|macro|GTKW_PREVIEW_WIDTH
define|#
directive|define
name|GTKW_PREVIEW_WIDTH
value|64
end_define

begin_define
DECL|macro|GTKW_PREVIEW_HEIGHT
define|#
directive|define
name|GTKW_PREVIEW_HEIGHT
value|220
end_define

begin_define
DECL|macro|GTKW_BORDER_WIDTH
define|#
directive|define
name|GTKW_BORDER_WIDTH
value|3
end_define

begin_define
DECL|macro|GTKW_FLOAT_MIN_ERROR
define|#
directive|define
name|GTKW_FLOAT_MIN_ERROR
value|0.000001
end_define

begin_define
DECL|macro|GTKW_ENTRY_BUFFER_SIZE
define|#
directive|define
name|GTKW_ENTRY_BUFFER_SIZE
value|32
end_define

begin_comment
comment|/* gtkW type */
end_comment

begin_typedef
typedef|typedef
struct|struct
DECL|struct|__anon29a1736b0108
block|{
DECL|member|widget
name|GtkWidget
modifier|*
name|widget
decl_stmt|;
DECL|member|value
name|gpointer
name|value
decl_stmt|;
DECL|member|updater
name|void
function_decl|(
modifier|*
name|updater
function_decl|)
parameter_list|()
function_decl|;
DECL|typedef|gtkW_widget_table
block|}
name|gtkW_widget_table
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
DECL|struct|__anon29a1736b0208
block|{
DECL|member|name
name|guchar
modifier|*
name|name
decl_stmt|;
DECL|member|data
name|gpointer
name|data
decl_stmt|;
DECL|typedef|gtkW_menu_item
block|}
name|gtkW_menu_item
typedef|;
end_typedef

begin_comment
comment|/* gtkW global variables */
end_comment

begin_decl_stmt
DECL|variable|gtkW_border_width
name|gint
name|gtkW_border_width
init|=
name|GTKW_BORDER_WIDTH
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gtkW_border_height
name|gint
name|gtkW_border_height
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gtkW_homogeneous_layout
name|gint
name|gtkW_homogeneous_layout
init|=
name|FALSE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gtkW_frame_shadow_type
name|gint
name|gtkW_frame_shadow_type
init|=
name|GTK_SHADOW_ETCHED_IN
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gtkW_align_x
name|gint
name|gtkW_align_x
init|=
name|GTK_FILL
operator||
name|GTK_EXPAND
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gtkW_align_y
name|gint
name|gtkW_align_y
init|=
name|GTK_FILL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gtkW_tooltips_color_allocated
name|gint
name|gtkW_tooltips_color_allocated
init|=
name|FALSE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|tooltips_foreground
DECL|variable|tooltips_background
name|GdkColor
name|tooltips_foreground
decl_stmt|,
name|tooltips_background
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* gtkW callback */
end_comment

begin_function_decl
specifier|static
name|void
name|gtkW_close_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_iscale_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_ientry_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_dscale_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_dentry_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_dscale_entry_change_value
parameter_list|(
name|gtkW_widget_table
modifier|*
name|wtable
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_iscale_entry_change_value
parameter_list|(
name|gtkW_widget_table
modifier|*
name|wtable
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_menu_change_value
parameter_list|(
name|gtkW_widget_table
modifier|*
name|wtable
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_menu_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_toggle_change_value
parameter_list|(
name|gtkW_widget_table
modifier|*
name|wtable
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* gtkW method */
end_comment

begin_function_decl
name|GtkWidget
modifier|*
name|gtkW_check_button_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|GtkSignalFunc
name|update
parameter_list|,
name|gint
modifier|*
name|value
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_dialog_new
parameter_list|(
name|guchar
modifier|*
name|name
parameter_list|,
name|GtkSignalFunc
name|ok_callback
parameter_list|,
name|GtkSignalFunc
name|close_callback
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_frame_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_hbox_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gtkW_message_dialog
parameter_list|(
name|gint
name|gtk_was_initialized
parameter_list|,
name|guchar
modifier|*
name|message
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_message_dialog_new
parameter_list|(
name|guchar
modifier|*
name|name
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_table_add_button
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|gchar
modifier|*
name|name
parameter_list|,
name|gint
name|x0
parameter_list|,
name|gint
name|x1
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|callback
parameter_list|,
name|gpointer
name|value
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_table_add_dscale_entry
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|gchar
modifier|*
name|name
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|scale_update
parameter_list|,
name|GtkSignalFunc
name|entry_update
parameter_list|,
name|gdouble
modifier|*
name|value
parameter_list|,
name|gdouble
name|min
parameter_list|,
name|gdouble
name|max
parameter_list|,
name|gdouble
name|step
parameter_list|,
name|gpointer
name|table_entry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_table_add_iscale_entry
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|gchar
modifier|*
name|name
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|scale_update
parameter_list|,
name|GtkSignalFunc
name|entry_update
parameter_list|,
name|gint
modifier|*
name|value
parameter_list|,
name|gdouble
name|min
parameter_list|,
name|gdouble
name|max
parameter_list|,
name|gdouble
name|step
parameter_list|,
name|gpointer
name|table_entry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_table_add_menu
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|imenu_update
parameter_list|,
name|gint
modifier|*
name|val
parameter_list|,
name|gtkW_menu_item
modifier|*
name|item
parameter_list|,
name|gint
name|item_num
parameter_list|,
name|gpointer
name|table_entry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_table_add_toggle
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|update
parameter_list|,
name|gint
modifier|*
name|value
parameter_list|,
name|gpointer
name|widget_entry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_table_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|gint
name|col
parameter_list|,
name|gint
name|row
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_vbox_add_button
parameter_list|(
name|GtkWidget
modifier|*
name|vbox
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|GtkSignalFunc
name|update
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|gtkW_vbox_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkTooltips
modifier|*
name|gtkW_tooltips_new
parameter_list|(
name|GtkWidget
modifier|*
name|frame
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/* end of GtkW */
end_comment

begin_define
DECL|macro|RANDOM
define|#
directive|define
name|RANDOM
value|((gdouble) ((double) rand ()/((double) RAND_MAX)))
end_define

begin_define
DECL|macro|CANNONIZE (p,x)
define|#
directive|define
name|CANNONIZE
parameter_list|(
name|p
parameter_list|,
name|x
parameter_list|)
value|(255*(((p).range_h - (p).range_l)*(x) + (p).range_l))
end_define

begin_define
DECL|macro|HCANNONIZE (p,x)
define|#
directive|define
name|HCANNONIZE
parameter_list|(
name|p
parameter_list|,
name|x
parameter_list|)
value|(254*(((p).range_h - (p).range_l)*(x) + (p).range_l))
end_define

begin_define
DECL|macro|POS_IN_TORUS (i,size)
define|#
directive|define
name|POS_IN_TORUS
parameter_list|(
name|i
parameter_list|,
name|size
parameter_list|)
value|((i< 0) ? size + i : ((size<= i) ? i - size : i))
end_define

begin_decl_stmt
DECL|variable|function_menu
name|gtkW_menu_item
name|function_menu
index|[]
init|=
block|{
DECL|macro|CML_KEEP_VALUES
define|#
directive|define
name|CML_KEEP_VALUES
value|0
block|{
literal|"Keep image's values"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_KEEP_FIRST
define|#
directive|define
name|CML_KEEP_FIRST
value|1
block|{
literal|"Keep the first value"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_FILL
define|#
directive|define
name|CML_FILL
value|2
block|{
literal|"Fill with parameter k"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_LOGIST
define|#
directive|define
name|CML_LOGIST
value|3
block|{
literal|"k{x(1-x)}^p"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_LOGIST_STEP
define|#
directive|define
name|CML_LOGIST_STEP
value|4
block|{
literal|"k{x(1-x)}^p stepped"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_POWER
define|#
directive|define
name|CML_POWER
value|5
block|{
literal|"kx^p"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_POWER_STEP
define|#
directive|define
name|CML_POWER_STEP
value|6
block|{
literal|"kx^p stepped"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_REV_POWER
define|#
directive|define
name|CML_REV_POWER
value|7
block|{
literal|"k(1 - x^p)"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_REV_POWER_STEP
define|#
directive|define
name|CML_REV_POWER_STEP
value|8
block|{
literal|"k(1 - x^p) stepped"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_DELTA
define|#
directive|define
name|CML_DELTA
value|9
block|{
literal|"Delta function"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_DELTA_STEP
define|#
directive|define
name|CML_DELTA_STEP
value|10
block|{
literal|"Delta function stepped"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_SIN_CURVE
define|#
directive|define
name|CML_SIN_CURVE
value|11
block|{
literal|"sin^p-based function"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_SIN_CURVE_STEP
define|#
directive|define
name|CML_SIN_CURVE_STEP
value|12
block|{
literal|"sin^p, stepped"
block|,
name|NULL
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|composition_menu
name|gtkW_menu_item
name|composition_menu
index|[]
init|=
block|{
DECL|macro|COMP_NONE
define|#
directive|define
name|COMP_NONE
value|0
block|{
literal|"None"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MAX_LINEAR
define|#
directive|define
name|COMP_MAX_LINEAR
value|1
block|{
literal|"Max (x, -)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MAX_LINEAR_P1
define|#
directive|define
name|COMP_MAX_LINEAR_P1
value|2
block|{
literal|"Max (x+d, -)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MAX_LINEAR_M1
define|#
directive|define
name|COMP_MAX_LINEAR_M1
value|3
block|{
literal|"Max (x-d, -)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MIN_LINEAR
define|#
directive|define
name|COMP_MIN_LINEAR
value|4
block|{
literal|"Mix (x, -)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MIN_LINEAR_P1
define|#
directive|define
name|COMP_MIN_LINEAR_P1
value|5
block|{
literal|"Min (x+d, -)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MIN_LINEAR_M1
define|#
directive|define
name|COMP_MIN_LINEAR_M1
value|6
block|{
literal|"Min (x-d, -)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MAX_LINEAR_P1L
define|#
directive|define
name|COMP_MAX_LINEAR_P1L
value|7
block|{
literal|"Max (x+d, -), (x< 0.5)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MAX_LINEAR_P1U
define|#
directive|define
name|COMP_MAX_LINEAR_P1U
value|8
block|{
literal|"Max (x+d, -), (0.5< x)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MAX_LINEAR_M1L
define|#
directive|define
name|COMP_MAX_LINEAR_M1L
value|9
block|{
literal|"Max (x-d, -), (x< 0.5)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MAX_LINEAR_M1U
define|#
directive|define
name|COMP_MAX_LINEAR_M1U
value|10
block|{
literal|"Max (x-d, -), (0.5< x)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MIN_LINEAR_P1L
define|#
directive|define
name|COMP_MIN_LINEAR_P1L
value|11
block|{
literal|"Min (x+d, -), (x< 0.5)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MIN_LINEAR_P1U
define|#
directive|define
name|COMP_MIN_LINEAR_P1U
value|12
block|{
literal|"Min (x+d, -), (0.5< x)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MIN_LINEAR_M1L
define|#
directive|define
name|COMP_MIN_LINEAR_M1L
value|13
block|{
literal|"Min (x-d, -), (x< 0.5)"
block|,
name|NULL
block|}
block|,
DECL|macro|COMP_MIN_LINEAR_M1U
define|#
directive|define
name|COMP_MIN_LINEAR_M1U
value|14
block|{
literal|"Min (x-d, -), (0.5< x)"
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|arrange_menu
name|gtkW_menu_item
name|arrange_menu
index|[]
init|=
block|{
DECL|macro|STANDARD
define|#
directive|define
name|STANDARD
value|0
block|{
literal|"Standard"
block|,
name|NULL
block|}
block|,
DECL|macro|AVERAGE
define|#
directive|define
name|AVERAGE
value|1
block|{
literal|"Use average value"
block|,
name|NULL
block|}
block|,
DECL|macro|ANTILOG
define|#
directive|define
name|ANTILOG
value|2
block|{
literal|"Use reverse value"
block|,
name|NULL
block|}
block|,
DECL|macro|RAND_POWER0
define|#
directive|define
name|RAND_POWER0
value|3
block|{
literal|"With random power (0,10)"
block|,
name|NULL
block|}
block|,
DECL|macro|RAND_POWER1
define|#
directive|define
name|RAND_POWER1
value|4
block|{
literal|"With random power (0,1)"
block|,
name|NULL
block|}
block|,
DECL|macro|RAND_POWER2
define|#
directive|define
name|RAND_POWER2
value|5
block|{
literal|"With gradient power (0,1)"
block|,
name|NULL
block|}
block|,
DECL|macro|MULTIPLY_RANDOM0
define|#
directive|define
name|MULTIPLY_RANDOM0
value|6
block|{
literal|"Multiply rand. value (0,1)"
block|,
name|NULL
block|}
block|,
DECL|macro|MULTIPLY_RANDOM1
define|#
directive|define
name|MULTIPLY_RANDOM1
value|7
block|{
literal|"Multiply rand. value (0,2)"
block|,
name|NULL
block|}
block|,
DECL|macro|MULTIPLY_GRADIENT
define|#
directive|define
name|MULTIPLY_GRADIENT
value|8
block|{
literal|"Multiply gradient (0,1)"
block|,
name|NULL
block|}
block|,
DECL|macro|RAND_AND_P
define|#
directive|define
name|RAND_AND_P
value|9
block|{
literal|"With p and random (0,1)"
block|,
name|NULL
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|initial_value_menu
name|gtkW_menu_item
name|initial_value_menu
index|[]
init|=
block|{
block|{
literal|"All black"
block|,
name|NULL
block|}
block|,
comment|/* 0 */
block|{
literal|"All gray"
block|,
name|NULL
block|}
block|,
comment|/* 1 */
block|{
literal|"All white"
block|,
name|NULL
block|}
block|,
comment|/* 2 */
block|{
literal|"The first row of the image"
block|,
name|NULL
block|}
block|,
comment|/* 3 */
block|{
literal|"Continuous gradient"
block|,
name|NULL
block|}
block|,
comment|/* 4 */
block|{
literal|"Continuous grad. w/o gap"
block|,
name|NULL
block|}
block|,
comment|/* 5 */
DECL|macro|CML_INITIAL_RANDOM_INDEPENDENT
define|#
directive|define
name|CML_INITIAL_RANDOM_INDEPENDENT
value|6
block|{
literal|"Random, ch. independent"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_INITIAL_RANDOM_SHARED
define|#
directive|define
name|CML_INITIAL_RANDOM_SHARED
value|7
block|{
literal|"Random shared"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_INITIAL_RANDOM_FROM_SEED
define|#
directive|define
name|CML_INITIAL_RANDOM_FROM_SEED
value|8
block|{
literal|"Randoms from seed"
block|,
name|NULL
block|}
block|,
DECL|macro|CML_INITIAL_RANDOM_FROM_SEED_SHARED
define|#
directive|define
name|CML_INITIAL_RANDOM_FROM_SEED_SHARED
value|9
block|{
literal|"Randoms from seed (shared)"
block|,
name|NULL
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_define
DECL|macro|CML_PARAM_NUM
define|#
directive|define
name|CML_PARAM_NUM
value|15
end_define

begin_typedef
typedef|typedef
struct|struct
DECL|struct|__anon29a1736b0308
block|{
DECL|member|function
name|gint
name|function
decl_stmt|;
DECL|member|composition
name|gint
name|composition
decl_stmt|;
DECL|member|arrange
name|gint
name|arrange
decl_stmt|;
DECL|member|cyclic_range
name|gint
name|cyclic_range
decl_stmt|;
DECL|member|mod_rate
name|gdouble
name|mod_rate
decl_stmt|;
comment|/* diff / old-value */
DECL|member|env_sensitivity
name|gdouble
name|env_sensitivity
decl_stmt|;
comment|/* self-diff : env-diff */
DECL|member|diffusion_dist
name|gint
name|diffusion_dist
decl_stmt|;
DECL|member|ch_sensitivity
name|gdouble
name|ch_sensitivity
decl_stmt|;
DECL|member|range_num
name|gint
name|range_num
decl_stmt|;
DECL|member|power
name|gdouble
name|power
decl_stmt|;
DECL|member|parameter_k
name|gdouble
name|parameter_k
decl_stmt|;
DECL|member|range_l
name|gdouble
name|range_l
decl_stmt|;
DECL|member|range_h
name|gdouble
name|range_h
decl_stmt|;
DECL|member|mutation_rate
name|gdouble
name|mutation_rate
decl_stmt|;
DECL|member|mutation_dist
name|gdouble
name|mutation_dist
decl_stmt|;
DECL|typedef|CML_PARAM
block|}
name|CML_PARAM
typedef|;
end_typedef

begin_typedef
typedef|typedef
struct|struct
DECL|struct|__anon29a1736b0408
block|{
DECL|member|hue
name|CML_PARAM
name|hue
decl_stmt|;
DECL|member|sat
name|CML_PARAM
name|sat
decl_stmt|;
DECL|member|val
name|CML_PARAM
name|val
decl_stmt|;
DECL|member|initial_value
name|gint
name|initial_value
decl_stmt|;
DECL|member|scale
name|gint
name|scale
decl_stmt|;
DECL|member|start_offset
name|gint
name|start_offset
decl_stmt|;
DECL|member|seed
name|gint
name|seed
decl_stmt|;
DECL|member|last_file_name
name|guchar
name|last_file_name
index|[
literal|256
index|]
decl_stmt|;
DECL|typedef|ValueType
block|}
name|ValueType
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|VALS
specifier|static
name|ValueType
name|VALS
init|=
block|{
comment|/* function     composition  arra    cyc chng sens diff cor  n  pow   k   (l,h) rnd dist */
block|{
name|CML_SIN_CURVE
block|,
name|COMP_NONE
block|,
name|STANDARD
block|,
literal|1
block|,
literal|0.5
block|,
literal|0.7
block|,
literal|2
block|,
literal|0.0
block|,
literal|1
block|,
literal|1.0
block|,
literal|1.0
block|,
literal|0
block|,
literal|1
block|,
literal|0.0
block|,
literal|0.1
block|}
block|,
block|{
name|CML_FILL
block|,
name|COMP_NONE
block|,
name|STANDARD
block|,
literal|0
block|,
literal|0.6
block|,
literal|0.1
block|,
literal|2
block|,
literal|0.0
block|,
literal|1
block|,
literal|1.4
block|,
literal|0.9
block|,
literal|0
block|,
literal|0.9
block|,
literal|0.0
block|,
literal|0.1
block|}
block|,
block|{
name|CML_FILL
block|,
name|COMP_NONE
block|,
name|STANDARD
block|,
literal|0
block|,
literal|0.5
block|,
literal|0.2
block|,
literal|2
block|,
literal|0.0
block|,
literal|1
block|,
literal|2.0
block|,
literal|1.0
block|,
literal|0
block|,
literal|0.9
block|,
literal|0.0
block|,
literal|0.1
block|}
block|,
literal|6
block|,
comment|/* random value 1 */
literal|1
block|,
comment|/* scale */
literal|0
block|,
comment|/* start_offset */
literal|0
block|,
comment|/* seed */
literal|""
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|channel_menu
name|gtkW_menu_item
name|channel_menu
index|[]
init|=
block|{
block|{
literal|"Hue"
block|,
operator|(
name|gpointer
operator|)
operator|&
name|VALS
operator|.
name|hue
block|}
block|,
block|{
literal|"Saturation"
block|,
operator|(
name|gpointer
operator|)
operator|&
name|VALS
operator|.
name|sat
block|}
block|,
block|{
literal|"Value"
block|,
operator|(
name|gpointer
operator|)
operator|&
name|VALS
operator|.
name|val
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|sload_menu
name|gtkW_menu_item
name|sload_menu
index|[]
init|=
block|{
block|{
literal|"NULL"
block|,
name|NULL
block|}
block|,
block|{
literal|"Hue"
block|,
name|NULL
block|}
block|,
block|{
literal|"Saturation"
block|,
name|NULL
block|}
block|,
block|{
literal|"Value"
block|,
name|NULL
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_function_decl
specifier|static
name|void
name|query
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|run
parameter_list|(
name|char
modifier|*
name|name
parameter_list|,
name|int
name|nparams
parameter_list|,
name|GParam
modifier|*
name|param
parameter_list|,
name|int
modifier|*
name|nreturn_vals
parameter_list|,
name|GParam
modifier|*
modifier|*
name|return_vals
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GStatusType
name|MAIN_FUNCTION
parameter_list|(
name|gint
name|preview_p
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_compute_next_step
parameter_list|(
name|gint
name|size
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|h
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|s
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|v
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|hn
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|sn
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|vn
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|haux
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|saux
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|vaux
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gdouble
name|CML_next_value
parameter_list|(
name|gdouble
modifier|*
name|vec
parameter_list|,
name|gint
name|pos
parameter_list|,
name|gint
name|size
parameter_list|,
name|gdouble
name|c1
parameter_list|,
name|gdouble
name|c2
parameter_list|,
name|CML_PARAM
modifier|*
name|param
parameter_list|,
name|gdouble
name|aux
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|rgb_to_hsv
parameter_list|(
name|int
modifier|*
name|r
parameter_list|,
name|int
modifier|*
name|g
parameter_list|,
name|int
modifier|*
name|b
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|hsv_to_rgb
parameter_list|(
name|int
modifier|*
name|h
parameter_list|,
name|int
modifier|*
name|s
parameter_list|,
name|int
modifier|*
name|v
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gdouble
name|logistic_function
parameter_list|(
name|CML_PARAM
modifier|*
name|param
parameter_list|,
name|gdouble
name|x
parameter_list|,
name|gdouble
name|power
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|DIALOG
parameter_list|()
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|CML_dialog_sub_panel_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|CML_PARAM
modifier|*
name|param
parameter_list|,
name|gint
name|channel_id
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GtkWidget
modifier|*
name|CML_dialog_advanced_panel_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
name|void
name|preview_update
parameter_list|()
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|function_graph_new
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_set_or_randomize_seed_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_copy_parameters_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_initial_value_sensitives_update
parameter_list|()
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_menu_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_initial_value_menu_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|OK_CALLBACK
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_save_to_file_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_execute_save_to_file
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|force_overwrite
parameter_list|(
name|char
modifier|*
name|filename
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_overwrite_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_preview_update_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_load_from_file_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|CML_load_parameter_file
parameter_list|(
name|guchar
modifier|*
name|filename
parameter_list|,
name|gint
name|interactive_mode
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|CML_execute_load_from_file
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|parse_line_to_gint
parameter_list|(
name|FILE
modifier|*
name|file
parameter_list|,
name|gint
modifier|*
name|flag
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gdouble
name|parse_line_to_gdouble
parameter_list|(
name|FILE
modifier|*
name|file
parameter_list|,
name|gint
modifier|*
name|flag
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
DECL|variable|PLUG_IN_INFO
name|GPlugInInfo
name|PLUG_IN_INFO
init|=
block|{
name|NULL
block|,
comment|/* init_proc  */
name|NULL
block|,
comment|/* quit_proc */
name|query
block|,
comment|/* query_proc */
name|run
block|,
comment|/* run_proc */
block|}
decl_stmt|;
end_decl_stmt

begin_typedef
typedef|typedef
struct|struct
DECL|struct|__anon29a1736b0508
block|{
DECL|member|run
name|gint
name|run
decl_stmt|;
DECL|typedef|Interface
block|}
name|Interface
typedef|;
end_typedef

begin_decl_stmt
DECL|variable|INTERFACE
specifier|static
name|Interface
name|INTERFACE
init|=
block|{
name|FALSE
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|preview
name|GtkWidget
modifier|*
name|preview
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|widget_pointers
name|gtkW_widget_table
name|widget_pointers
index|[
literal|4
index|]
index|[
name|CML_PARAM_NUM
index|]
decl_stmt|;
end_decl_stmt

begin_typedef
typedef|typedef
struct|struct
DECL|struct|__anon29a1736b0608
block|{
DECL|member|widget
name|GtkWidget
modifier|*
name|widget
decl_stmt|;
DECL|member|logic
name|gint
name|logic
decl_stmt|;
DECL|typedef|CML_sensitive_widget_table
block|}
name|CML_sensitive_widget_table
typedef|;
end_typedef

begin_define
DECL|macro|RANDOM_SENSITIVES_NUM
define|#
directive|define
name|RANDOM_SENSITIVES_NUM
value|5
end_define

begin_decl_stmt
DECL|variable|random_sensitives
name|CML_sensitive_widget_table
name|random_sensitives
index|[
name|RANDOM_SENSITIVES_NUM
index|]
init|=
block|{
block|{
name|NULL
block|,
literal|0
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|}
block|,
block|{
name|NULL
block|,
literal|0
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_id
name|gint
name|drawable_id
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|copy_source
name|gint
name|copy_source
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|copy_destination
name|gint
name|copy_destination
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|selective_load_source
name|gint
name|selective_load_source
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|selective_load_destination
name|gint
name|selective_load_destination
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|CML_preview_defer
name|gint
name|CML_preview_defer
init|=
name|FALSE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|overwritable
name|gint
name|overwritable
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|mem_chank0
name|gdouble
modifier|*
name|mem_chank0
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|mem_chank0_size
name|gint
name|mem_chank0_size
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|mem_chank1
name|guchar
modifier|*
name|mem_chank1
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|mem_chank1_size
name|gint
name|mem_chank1_size
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|mem_chank2
name|guchar
modifier|*
name|mem_chank2
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|mem_chank2_size
name|gint
name|mem_chank2_size
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_expr_stmt
name|MAIN
argument_list|()
expr_stmt|;
end_expr_stmt

begin_function
specifier|static
name|void
DECL|function|query ()
name|query
parameter_list|()
block|{
specifier|static
name|GParamDef
name|args
index|[]
init|=
block|{
block|{
name|PARAM_INT32
block|,
literal|"run_mode"
block|,
literal|"Interactive, non-interactive"
block|}
block|,
block|{
name|PARAM_IMAGE
block|,
literal|"image"
block|,
literal|"Input image (not used)"
block|}
block|,
block|{
name|PARAM_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"Input drawable"
block|}
block|,
block|{
name|PARAM_STRING
block|,
literal|"parameter_file_name"
block|,
literal|"the name of paremter file. CML_explorer makes an image with its settings."
block|}
block|,   }
decl_stmt|;
specifier|static
name|GParamDef
modifier|*
name|return_vals
init|=
name|NULL
decl_stmt|;
specifier|static
name|int
name|nargs
init|=
sizeof|sizeof
argument_list|(
name|args
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|args
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
specifier|static
name|int
name|nreturn_vals
init|=
literal|0
decl_stmt|;
name|gimp_install_procedure
argument_list|(
name|PLUG_IN_NAME
argument_list|,
literal|"Make an image of Coupled-Map Lattice"
argument_list|,
literal|"Make an image of Coupled-Map Lattice (CML). CML is a kind of Cellula Automata on continuous (value) domain. In RUN_NONINTERACTIVE, the name of a prameter file is passed as the 4th arg. You can control CML_explorer via parameter file."
argument_list|,
comment|/*  Or do you want to call me with over 50 args? */
literal|"Shuji Narazaki (narazaki@InetQ.or.jp); http://www.inetq.or.jp/~narazaki/TheGIMP/"
argument_list|,
literal|"Shuji Narazaki"
argument_list|,
literal|"1997"
argument_list|,
name|MENU_POSITION
argument_list|,
literal|"RGB*, GRAY*"
argument_list|,
name|PROC_PLUG_IN
argument_list|,
name|nargs
argument_list|,
name|nreturn_vals
argument_list|,
name|args
argument_list|,
name|return_vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|run (char * name,int nparams,GParam * param,int * nreturn_vals,GParam ** return_vals)
name|run
parameter_list|(
name|char
modifier|*
name|name
parameter_list|,
name|int
name|nparams
parameter_list|,
name|GParam
modifier|*
name|param
parameter_list|,
name|int
modifier|*
name|nreturn_vals
parameter_list|,
name|GParam
modifier|*
modifier|*
name|return_vals
parameter_list|)
block|{
name|GParam
modifier|*
name|values
decl_stmt|;
name|GStatusType
name|status
init|=
name|STATUS_EXECUTION_ERROR
decl_stmt|;
name|GRunModeType
name|run_mode
decl_stmt|;
name|values
operator|=
name|g_new
argument_list|(
name|GParam
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|run_mode
operator|=
name|param
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_int32
expr_stmt|;
name|drawable_id
operator|=
name|param
index|[
literal|2
index|]
operator|.
name|data
operator|.
name|d_drawable
expr_stmt|;
operator|*
name|nreturn_vals
operator|=
literal|1
expr_stmt|;
operator|*
name|return_vals
operator|=
name|values
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|PARAM_STATUS
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|status
expr_stmt|;
switch|switch
condition|(
name|run_mode
condition|)
block|{
case|case
name|RUN_INTERACTIVE
case|:
name|gimp_get_data
argument_list|(
name|PLUG_IN_NAME
argument_list|,
operator|&
name|VALS
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|DIALOG
argument_list|()
condition|)
return|return;
ifdef|#
directive|ifdef
name|INTERACTIVE_DIALOG
else|else
name|status
operator|=
name|STATUS_SUCCESS
expr_stmt|;
endif|#
directive|endif
break|break;
case|case
name|RUN_NONINTERACTIVE
case|:
block|{
name|guchar
modifier|*
name|filename
init|=
name|param
index|[
literal|3
index|]
operator|.
name|data
operator|.
name|d_string
decl_stmt|;
if|if
condition|(
operator|!
name|CML_load_parameter_file
argument_list|(
name|filename
argument_list|,
name|FALSE
argument_list|)
condition|)
return|return;
break|break;
block|}
case|case
name|RUN_WITH_LAST_VALS
case|:
name|gimp_get_data
argument_list|(
name|PLUG_IN_NAME
argument_list|,
operator|&
name|VALS
argument_list|)
expr_stmt|;
break|break;
block|}
name|gimp_tile_cache_ntiles
argument_list|(
name|TILE_CACHE_SIZE
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|INTERACTIVE_DIALOG
if|if
condition|(
name|run_mode
operator|!=
name|RUN_INTERACTIVE
condition|)
name|status
operator|=
name|MAIN_FUNCTION
argument_list|(
name|FALSE
argument_list|)
expr_stmt|;
else|#
directive|else
name|status
operator|=
name|MAIN_FUNCTION
argument_list|(
name|FALSE
argument_list|)
expr_stmt|;
endif|#
directive|endif
if|if
condition|(
name|run_mode
operator|!=
name|RUN_NONINTERACTIVE
condition|)
name|gimp_displays_flush
argument_list|()
expr_stmt|;
if|if
condition|(
name|run_mode
operator|==
name|RUN_INTERACTIVE
operator|&&
name|status
operator|==
name|STATUS_SUCCESS
condition|)
name|gimp_set_data
argument_list|(
name|PLUG_IN_NAME
argument_list|,
operator|&
name|VALS
argument_list|,
sizeof|sizeof
argument_list|(
name|ValueType
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|mem_chank0
condition|)
name|g_free
argument_list|(
name|mem_chank0
argument_list|)
expr_stmt|;
if|if
condition|(
name|mem_chank1
condition|)
name|g_free
argument_list|(
name|mem_chank1
argument_list|)
expr_stmt|;
if|if
condition|(
name|mem_chank2
condition|)
name|g_free
argument_list|(
name|mem_chank2
argument_list|)
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|type
operator|=
name|PARAM_STATUS
expr_stmt|;
name|values
index|[
literal|0
index|]
operator|.
name|data
operator|.
name|d_status
operator|=
name|status
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|GStatusType
DECL|function|MAIN_FUNCTION (gint preview_p)
name|MAIN_FUNCTION
parameter_list|(
name|gint
name|preview_p
parameter_list|)
block|{
name|GDrawable
modifier|*
name|drawable
init|=
name|NULL
decl_stmt|;
name|GPixelRgn
name|dest_rgn
decl_stmt|,
name|src_rgn
decl_stmt|;
name|guchar
modifier|*
name|dest_buffer
init|=
name|NULL
decl_stmt|;
name|guchar
modifier|*
name|src_buffer
init|=
name|NULL
decl_stmt|;
name|gint
name|x1
decl_stmt|,
name|x2
decl_stmt|,
name|y1
decl_stmt|,
name|y2
decl_stmt|;
name|gint
name|dx
decl_stmt|,
name|dy
decl_stmt|;
name|gint
name|dest_has_alpha
init|=
name|FALSE
decl_stmt|;
name|gint
name|dest_is_gray
init|=
name|FALSE
decl_stmt|;
name|gint
name|src_has_alpha
init|=
name|FALSE
decl_stmt|;
name|gint
name|src_is_gray
init|=
name|FALSE
decl_stmt|;
name|gint
name|total
decl_stmt|,
name|processed
init|=
literal|0
decl_stmt|;
name|gint
name|keep_height
init|=
literal|1
decl_stmt|;
name|gint
name|cell_num
decl_stmt|,
name|width_by_pixel
decl_stmt|,
name|height_by_pixel
decl_stmt|;
name|gint
name|index
decl_stmt|;
name|gint
name|src_bpp
decl_stmt|,
name|src_bpl
decl_stmt|;
name|gint
name|dest_bpp
decl_stmt|,
name|dest_bpl
decl_stmt|;
name|gdouble
modifier|*
name|hues
decl_stmt|,
modifier|*
name|sats
decl_stmt|,
modifier|*
name|vals
decl_stmt|;
name|gdouble
modifier|*
name|newh
decl_stmt|,
modifier|*
name|news
decl_stmt|,
modifier|*
name|newv
decl_stmt|;
name|gdouble
modifier|*
name|haux
decl_stmt|,
modifier|*
name|saux
decl_stmt|,
modifier|*
name|vaux
decl_stmt|;
comment|/* open THE drawable */
name|drawable
operator|=
name|gimp_drawable_get
argument_list|(
name|drawable_id
argument_list|)
expr_stmt|;
name|gimp_drawable_mask_bounds
argument_list|(
name|drawable_id
argument_list|,
operator|&
name|x1
argument_list|,
operator|&
name|y1
argument_list|,
operator|&
name|x2
argument_list|,
operator|&
name|y2
argument_list|)
expr_stmt|;
name|src_has_alpha
operator|=
name|dest_has_alpha
operator|=
name|gimp_drawable_has_alpha
argument_list|(
name|drawable_id
argument_list|)
expr_stmt|;
name|src_is_gray
operator|=
name|dest_is_gray
operator|=
name|gimp_drawable_gray
argument_list|(
name|drawable_id
argument_list|)
expr_stmt|;
name|src_bpp
operator|=
name|dest_bpp
operator|=
operator|(
name|src_is_gray
condition|?
literal|1
else|:
literal|3
operator|)
operator|+
operator|(
name|src_has_alpha
condition|?
literal|1
else|:
literal|0
operator|)
expr_stmt|;
if|if
condition|(
name|preview_p
condition|)
block|{
name|dest_has_alpha
operator|=
name|FALSE
expr_stmt|;
name|dest_is_gray
operator|=
name|FALSE
expr_stmt|;
name|dest_bpp
operator|=
literal|3
expr_stmt|;
if|if
condition|(
name|GTKW_PREVIEW_WIDTH
operator|<
name|x2
operator|-
name|x1
condition|)
comment|/* preview< drawable (selection) */
name|x2
operator|=
name|x1
operator|+
name|GTKW_PREVIEW_WIDTH
expr_stmt|;
if|if
condition|(
name|GTKW_PREVIEW_HEIGHT
operator|<
name|y2
operator|-
name|y1
condition|)
name|y2
operator|=
name|y1
operator|+
name|GTKW_PREVIEW_HEIGHT
expr_stmt|;
block|}
name|width_by_pixel
operator|=
name|x2
operator|-
name|x1
expr_stmt|;
name|height_by_pixel
operator|=
name|y2
operator|-
name|y1
expr_stmt|;
name|dest_bpl
operator|=
name|width_by_pixel
operator|*
name|dest_bpp
expr_stmt|;
name|src_bpl
operator|=
name|width_by_pixel
operator|*
name|src_bpp
expr_stmt|;
name|cell_num
operator|=
operator|(
name|width_by_pixel
operator|-
literal|1
operator|)
operator|/
name|VALS
operator|.
name|scale
operator|+
literal|1
expr_stmt|;
name|total
operator|=
name|height_by_pixel
operator|*
name|width_by_pixel
expr_stmt|;
name|keep_height
operator|=
name|VALS
operator|.
name|scale
expr_stmt|;
comment|/* configure reusable memories */
if|if
condition|(
name|mem_chank0_size
operator|<
literal|9
operator|*
name|cell_num
operator|*
sizeof|sizeof
argument_list|(
name|gdouble
argument_list|)
condition|)
block|{
if|if
condition|(
name|mem_chank0
condition|)
name|g_free
argument_list|(
name|mem_chank0
argument_list|)
expr_stmt|;
name|mem_chank0_size
operator|=
literal|9
operator|*
name|cell_num
operator|*
sizeof|sizeof
argument_list|(
name|gdouble
argument_list|)
expr_stmt|;
name|mem_chank0
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|g_malloc
argument_list|(
name|mem_chank0_size
argument_list|)
expr_stmt|;
block|}
name|hues
operator|=
name|mem_chank0
expr_stmt|;
name|sats
operator|=
name|mem_chank0
operator|+
name|cell_num
expr_stmt|;
name|vals
operator|=
name|mem_chank0
operator|+
literal|2
operator|*
name|cell_num
expr_stmt|;
name|newh
operator|=
name|mem_chank0
operator|+
literal|3
operator|*
name|cell_num
expr_stmt|;
name|news
operator|=
name|mem_chank0
operator|+
literal|4
operator|*
name|cell_num
expr_stmt|;
name|newv
operator|=
name|mem_chank0
operator|+
literal|5
operator|*
name|cell_num
expr_stmt|;
name|haux
operator|=
name|mem_chank0
operator|+
literal|6
operator|*
name|cell_num
expr_stmt|;
name|saux
operator|=
name|mem_chank0
operator|+
literal|7
operator|*
name|cell_num
expr_stmt|;
name|vaux
operator|=
name|mem_chank0
operator|+
literal|8
operator|*
name|cell_num
expr_stmt|;
if|if
condition|(
name|mem_chank1_size
operator|<
name|src_bpl
operator|*
name|keep_height
condition|)
block|{
if|if
condition|(
name|mem_chank1
condition|)
name|g_free
argument_list|(
name|mem_chank1
argument_list|)
expr_stmt|;
name|mem_chank1_size
operator|=
name|src_bpl
operator|*
name|keep_height
expr_stmt|;
name|mem_chank1
operator|=
operator|(
name|guchar
operator|*
operator|)
name|g_malloc
argument_list|(
name|mem_chank1_size
argument_list|)
expr_stmt|;
block|}
name|src_buffer
operator|=
name|mem_chank1
expr_stmt|;
if|if
condition|(
name|mem_chank2_size
operator|<
name|dest_bpl
operator|*
name|keep_height
condition|)
block|{
if|if
condition|(
name|mem_chank2
condition|)
name|g_free
argument_list|(
name|mem_chank2
argument_list|)
expr_stmt|;
name|mem_chank2_size
operator|=
name|dest_bpl
operator|*
name|keep_height
expr_stmt|;
name|mem_chank2
operator|=
operator|(
name|guchar
operator|*
operator|)
name|g_malloc
argument_list|(
name|mem_chank2_size
argument_list|)
expr_stmt|;
block|}
name|dest_buffer
operator|=
name|mem_chank2
expr_stmt|;
if|if
condition|(
operator|!
name|preview_p
condition|)
name|gimp_pixel_rgn_init
argument_list|(
operator|&
name|dest_rgn
argument_list|,
name|drawable
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|width_by_pixel
argument_list|,
name|height_by_pixel
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gimp_pixel_rgn_init
argument_list|(
operator|&
name|src_rgn
argument_list|,
name|drawable
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|width_by_pixel
argument_list|,
name|height_by_pixel
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Note: Why seed is modulo of (1<< 15)? I use iscale_entry to control      the value. Adjustment widget in Scale uses gdouble(?). But it is not      precise to hold a long integer! Thus, in updating scale, the value will      be rounded. Since I can't imagine another solution, I use short (16bit)      integer as the seed of random number sequence. This approach works on      my i386-based Linux.   */
if|if
condition|(
name|VALS
operator|.
name|initial_value
operator|<
name|CML_INITIAL_RANDOM_FROM_SEED
condition|)
name|VALS
operator|.
name|seed
operator|=
name|time
argument_list|(
name|NULL
argument_list|)
operator|%
operator|(
literal|1
operator|<<
literal|15
operator|)
expr_stmt|;
name|srand
argument_list|(
name|VALS
operator|.
name|seed
argument_list|)
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|0
init|;
name|index
operator|<
name|cell_num
condition|;
name|index
operator|++
control|)
block|{
switch|switch
condition|(
name|VALS
operator|.
name|hue
operator|.
name|arrange
condition|)
block|{
case|case
name|RAND_POWER0
case|:
name|haux
index|[
name|index
index|]
operator|=
name|RANDOM
operator|*
literal|10
expr_stmt|;
break|break;
case|case
name|RAND_POWER2
case|:
case|case
name|MULTIPLY_GRADIENT
case|:
name|haux
index|[
name|index
index|]
operator|=
operator|(
name|gdouble
operator|)
name|abs
argument_list|(
operator|(
name|index
operator|%
literal|511
operator|)
operator|-
literal|255
argument_list|)
operator|/
operator|(
name|gdouble
operator|)
literal|256
expr_stmt|;
break|break;
case|case
name|RAND_POWER1
case|:
case|case
name|MULTIPLY_RANDOM0
case|:
name|haux
index|[
name|index
index|]
operator|=
name|RANDOM
expr_stmt|;
break|break;
case|case
name|MULTIPLY_RANDOM1
case|:
name|haux
index|[
name|index
index|]
operator|=
name|RANDOM
operator|*
literal|2
expr_stmt|;
break|break;
case|case
name|RAND_AND_P
case|:
name|haux
index|[
name|index
index|]
operator|=
operator|(
name|index
operator|%
operator|(
literal|2
operator|*
name|VALS
operator|.
name|hue
operator|.
name|diffusion_dist
operator|)
operator|==
literal|0
operator|)
condition|?
operator|(
name|RANDOM
operator|)
else|:
name|VALS
operator|.
name|hue
operator|.
name|power
expr_stmt|;
break|break;
default|default:
name|haux
index|[
name|index
index|]
operator|=
name|VALS
operator|.
name|hue
operator|.
name|power
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|VALS
operator|.
name|sat
operator|.
name|arrange
condition|)
block|{
case|case
name|RAND_POWER0
case|:
name|saux
index|[
name|index
index|]
operator|=
name|RANDOM
operator|*
literal|10
expr_stmt|;
break|break;
case|case
name|RAND_POWER2
case|:
case|case
name|MULTIPLY_GRADIENT
case|:
name|saux
index|[
name|index
index|]
operator|=
operator|(
name|gdouble
operator|)
name|abs
argument_list|(
operator|(
name|index
operator|%
literal|511
operator|)
operator|-
literal|255
argument_list|)
operator|/
operator|(
name|gdouble
operator|)
literal|256
expr_stmt|;
break|break;
case|case
name|RAND_POWER1
case|:
case|case
name|MULTIPLY_RANDOM0
case|:
name|saux
index|[
name|index
index|]
operator|=
name|RANDOM
expr_stmt|;
break|break;
case|case
name|MULTIPLY_RANDOM1
case|:
name|saux
index|[
name|index
index|]
operator|=
name|RANDOM
operator|*
literal|2
expr_stmt|;
break|break;
case|case
name|RAND_AND_P
case|:
name|saux
index|[
name|index
index|]
operator|=
operator|(
name|index
operator|%
operator|(
literal|2
operator|*
name|VALS
operator|.
name|sat
operator|.
name|diffusion_dist
operator|)
operator|==
literal|0
operator|)
condition|?
operator|(
name|RANDOM
operator|)
else|:
name|VALS
operator|.
name|sat
operator|.
name|power
expr_stmt|;
break|break;
default|default:
name|saux
index|[
name|index
index|]
operator|=
name|VALS
operator|.
name|sat
operator|.
name|power
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|VALS
operator|.
name|val
operator|.
name|arrange
condition|)
block|{
case|case
name|RAND_POWER0
case|:
name|vaux
index|[
name|index
index|]
operator|=
name|RANDOM
operator|*
literal|10
expr_stmt|;
break|break;
case|case
name|RAND_POWER2
case|:
case|case
name|MULTIPLY_GRADIENT
case|:
name|vaux
index|[
name|index
index|]
operator|=
operator|(
name|gdouble
operator|)
name|abs
argument_list|(
operator|(
name|index
operator|%
literal|511
operator|)
operator|-
literal|255
argument_list|)
operator|/
operator|(
name|gdouble
operator|)
literal|256
expr_stmt|;
break|break;
case|case
name|RAND_POWER1
case|:
case|case
name|MULTIPLY_RANDOM0
case|:
name|vaux
index|[
name|index
index|]
operator|=
name|RANDOM
expr_stmt|;
break|break;
case|case
name|MULTIPLY_RANDOM1
case|:
name|vaux
index|[
name|index
index|]
operator|=
name|RANDOM
operator|*
literal|2
expr_stmt|;
break|break;
case|case
name|RAND_AND_P
case|:
name|vaux
index|[
name|index
index|]
operator|=
operator|(
name|index
operator|%
operator|(
literal|2
operator|*
name|VALS
operator|.
name|val
operator|.
name|diffusion_dist
operator|)
operator|==
literal|0
operator|)
condition|?
operator|(
name|RANDOM
operator|)
else|:
name|VALS
operator|.
name|val
operator|.
name|power
expr_stmt|;
break|break;
default|default:
name|vaux
index|[
name|index
index|]
operator|=
name|VALS
operator|.
name|val
operator|.
name|power
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|VALS
operator|.
name|initial_value
condition|)
block|{
case|case
literal|0
case|:
case|case
literal|1
case|:
case|case
literal|2
case|:
name|hues
index|[
name|index
index|]
operator|=
name|sats
index|[
name|index
index|]
operator|=
name|vals
index|[
name|index
index|]
operator|=
literal|0.5
operator|*
operator|(
name|VALS
operator|.
name|initial_value
operator|)
expr_stmt|;
break|break;
case|case
literal|3
case|:
comment|/* use the values of the image (drawable) */
break|break;
comment|/* copy from the drawable after this loop */
case|case
literal|4
case|:
comment|/* grandient 1 */
name|hues
index|[
name|index
index|]
operator|=
name|sats
index|[
name|index
index|]
operator|=
name|vals
index|[
name|index
index|]
operator|=
call|(
name|gdouble
call|)
argument_list|(
name|index
operator|%
literal|256
argument_list|)
operator|/
operator|(
name|gdouble
operator|)
literal|256
expr_stmt|;
break|break;
comment|/* gradinet 2 */
case|case
literal|5
case|:
name|hues
index|[
name|index
index|]
operator|=
name|sats
index|[
name|index
index|]
operator|=
name|vals
index|[
name|index
index|]
operator|=
operator|(
name|gdouble
operator|)
name|abs
argument_list|(
operator|(
name|index
operator|%
literal|511
operator|)
operator|-
literal|255
argument_list|)
operator|/
operator|(
name|gdouble
operator|)
literal|256
expr_stmt|;
break|break;
case|case
name|CML_INITIAL_RANDOM_INDEPENDENT
case|:
case|case
name|CML_INITIAL_RANDOM_FROM_SEED
case|:
name|hues
index|[
name|index
index|]
operator|=
name|RANDOM
expr_stmt|;
name|sats
index|[
name|index
index|]
operator|=
name|RANDOM
expr_stmt|;
name|vals
index|[
name|index
index|]
operator|=
name|RANDOM
expr_stmt|;
break|break;
case|case
name|CML_INITIAL_RANDOM_SHARED
case|:
case|case
name|CML_INITIAL_RANDOM_FROM_SEED_SHARED
case|:
name|hues
index|[
name|index
index|]
operator|=
name|sats
index|[
name|index
index|]
operator|=
name|vals
index|[
name|index
index|]
operator|=
name|RANDOM
expr_stmt|;
break|break;
block|}
block|}
if|if
condition|(
name|VALS
operator|.
name|initial_value
operator|==
literal|3
condition|)
block|{
name|int
name|index
decl_stmt|;
for|for
control|(
name|index
operator|=
literal|0
init|;
name|index
operator|<
name|MIN
argument_list|(
name|cell_num
argument_list|,
name|width_by_pixel
operator|/
name|VALS
operator|.
name|scale
argument_list|)
condition|;
name|index
operator|++
control|)
block|{
name|guchar
name|buffer
index|[
literal|4
index|]
decl_stmt|;
name|int
name|rgbi
index|[
literal|3
index|]
decl_stmt|;
name|int
name|i
decl_stmt|;
name|gimp_pixel_rgn_get_pixel
argument_list|(
operator|&
name|src_rgn
argument_list|,
name|buffer
argument_list|,
name|x1
operator|+
operator|(
name|index
operator|*
name|VALS
operator|.
name|scale
operator|)
argument_list|,
name|y1
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
literal|3
condition|;
name|i
operator|++
control|)
name|rgbi
index|[
name|i
index|]
operator|=
name|buffer
index|[
name|i
index|]
expr_stmt|;
name|rgb_to_hsv
argument_list|(
name|rgbi
argument_list|,
name|rgbi
operator|+
literal|1
argument_list|,
name|rgbi
operator|+
literal|2
argument_list|)
expr_stmt|;
name|hues
index|[
name|index
index|]
operator|=
operator|(
name|gdouble
operator|)
name|rgbi
index|[
literal|0
index|]
operator|/
operator|(
name|gdouble
operator|)
literal|255
expr_stmt|;
name|sats
index|[
name|index
index|]
operator|=
operator|(
name|gdouble
operator|)
name|rgbi
index|[
literal|1
index|]
operator|/
operator|(
name|gdouble
operator|)
literal|255
expr_stmt|;
name|vals
index|[
name|index
index|]
operator|=
operator|(
name|gdouble
operator|)
name|rgbi
index|[
literal|2
index|]
operator|/
operator|(
name|gdouble
operator|)
literal|255
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|!
name|preview_p
condition|)
name|gimp_progress_init
argument_list|(
name|PROGRESS_NAME
argument_list|)
expr_stmt|;
comment|/* rolling start */
for|for
control|(
name|index
operator|=
literal|0
init|;
name|index
operator|<
name|VALS
operator|.
name|start_offset
condition|;
name|index
operator|++
control|)
name|CML_compute_next_step
argument_list|(
name|cell_num
argument_list|,
operator|&
name|hues
argument_list|,
operator|&
name|sats
argument_list|,
operator|&
name|vals
argument_list|,
operator|&
name|newh
argument_list|,
operator|&
name|news
argument_list|,
operator|&
name|newv
argument_list|,
operator|&
name|haux
argument_list|,
operator|&
name|saux
argument_list|,
operator|&
name|vaux
argument_list|)
expr_stmt|;
comment|/* rendering */
for|for
control|(
name|dy
operator|=
literal|0
init|;
name|dy
operator|<
name|height_by_pixel
condition|;
name|dy
operator|+=
name|VALS
operator|.
name|scale
control|)
block|{
name|gint
name|i
init|=
literal|0
decl_stmt|;
name|gint
name|r
decl_stmt|,
name|g
decl_stmt|,
name|b
decl_stmt|,
name|h
decl_stmt|,
name|s
decl_stmt|,
name|v
decl_stmt|;
name|gint
name|offset_x
decl_stmt|,
name|offset_y
decl_stmt|,
name|dest_offset
decl_stmt|;
if|if
condition|(
name|height_by_pixel
operator|<
name|dy
operator|+
name|keep_height
condition|)
name|keep_height
operator|=
name|height_by_pixel
operator|-
name|dy
expr_stmt|;
if|if
condition|(
operator|(
name|VALS
operator|.
name|hue
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
operator|||
operator|(
name|VALS
operator|.
name|sat
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
operator|||
operator|(
name|VALS
operator|.
name|val
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
condition|)
name|gimp_pixel_rgn_get_rect
argument_list|(
operator|&
name|src_rgn
argument_list|,
name|src_buffer
argument_list|,
name|x1
argument_list|,
name|y1
operator|+
name|dy
argument_list|,
name|width_by_pixel
argument_list|,
name|keep_height
argument_list|)
expr_stmt|;
name|CML_compute_next_step
argument_list|(
name|cell_num
argument_list|,
operator|&
name|hues
argument_list|,
operator|&
name|sats
argument_list|,
operator|&
name|vals
argument_list|,
operator|&
name|newh
argument_list|,
operator|&
name|news
argument_list|,
operator|&
name|newv
argument_list|,
operator|&
name|haux
argument_list|,
operator|&
name|saux
argument_list|,
operator|&
name|vaux
argument_list|)
expr_stmt|;
for|for
control|(
name|dx
operator|=
literal|0
init|;
name|dx
operator|<
name|cell_num
condition|;
name|dx
operator|++
control|)
block|{
name|h
operator|=
name|r
operator|=
name|HCANNONIZE
argument_list|(
name|VALS
operator|.
name|hue
argument_list|,
name|hues
index|[
name|dx
index|]
argument_list|)
expr_stmt|;
name|s
operator|=
name|g
operator|=
name|CANNONIZE
argument_list|(
name|VALS
operator|.
name|sat
argument_list|,
name|sats
index|[
name|dx
index|]
argument_list|)
expr_stmt|;
name|v
operator|=
name|b
operator|=
name|CANNONIZE
argument_list|(
name|VALS
operator|.
name|val
argument_list|,
name|vals
index|[
name|dx
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|dest_is_gray
condition|)
name|hsv_to_rgb
argument_list|(
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
expr_stmt|;
comment|/* render destination */
for|for
control|(
name|offset_y
operator|=
literal|0
init|;
operator|(
name|offset_y
operator|<
name|VALS
operator|.
name|scale
operator|)
operator|&&
operator|(
name|dy
operator|+
name|offset_y
operator|<
name|height_by_pixel
operator|)
condition|;
name|offset_y
operator|++
control|)
for|for
control|(
name|offset_x
operator|=
literal|0
init|;
operator|(
name|offset_x
operator|<
name|VALS
operator|.
name|scale
operator|)
operator|&&
operator|(
name|dx
operator|*
name|VALS
operator|.
name|scale
operator|+
name|offset_x
operator|<
name|width_by_pixel
operator|)
condition|;
name|offset_x
operator|++
control|)
block|{
if|if
condition|(
operator|(
name|VALS
operator|.
name|hue
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
operator|||
operator|(
name|VALS
operator|.
name|sat
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
operator|||
operator|(
name|VALS
operator|.
name|val
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
condition|)
block|{
name|int
name|rgbi
index|[
literal|3
index|]
decl_stmt|;
name|int
name|i
decl_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|src_bpp
condition|;
name|i
operator|++
control|)
name|rgbi
index|[
name|i
index|]
operator|=
name|src_buffer
index|[
name|offset_y
operator|*
name|src_bpl
operator|+
operator|(
name|dx
operator|*
name|VALS
operator|.
name|scale
operator|+
name|offset_x
operator|)
operator|*
name|src_bpp
operator|+
name|i
index|]
expr_stmt|;
if|if
condition|(
name|src_is_gray
operator|&&
operator|(
name|VALS
operator|.
name|val
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
condition|)
name|b
operator|=
name|rgbi
index|[
literal|0
index|]
expr_stmt|;
else|else
block|{
name|rgb_to_hsv
argument_list|(
name|rgbi
argument_list|,
name|rgbi
operator|+
literal|1
argument_list|,
name|rgbi
operator|+
literal|2
argument_list|)
expr_stmt|;
name|r
operator|=
operator|(
name|VALS
operator|.
name|hue
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
condition|?
name|rgbi
index|[
literal|0
index|]
else|:
name|h
expr_stmt|;
name|g
operator|=
operator|(
name|VALS
operator|.
name|sat
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
condition|?
name|rgbi
index|[
literal|1
index|]
else|:
name|s
expr_stmt|;
name|b
operator|=
operator|(
name|VALS
operator|.
name|val
operator|.
name|function
operator|==
name|CML_KEEP_VALUES
operator|)
condition|?
name|rgbi
index|[
literal|2
index|]
else|:
name|v
expr_stmt|;
name|hsv_to_rgb
argument_list|(
operator|&
name|r
argument_list|,
operator|&
name|g
argument_list|,
operator|&
name|b
argument_list|)
expr_stmt|;
block|}
block|}
name|dest_offset
operator|=
name|offset_y
operator|*
name|dest_bpl
operator|+
operator|(
name|dx
operator|*
name|VALS
operator|.
name|scale
operator|+
name|offset_x
operator|)
operator|*
name|dest_bpp
expr_stmt|;
if|if
condition|(
name|dest_is_gray
condition|)
name|dest_buffer
index|[
name|dest_offset
operator|++
index|]
operator|=
name|b
expr_stmt|;
else|else
block|{
name|dest_buffer
index|[
name|dest_offset
operator|++
index|]
operator|=
name|r
expr_stmt|;
name|dest_buffer
index|[
name|dest_offset
operator|++
index|]
operator|=
name|g
expr_stmt|;
name|dest_buffer
index|[
name|dest_offset
operator|++
index|]
operator|=
name|b
expr_stmt|;
block|}
if|if
condition|(
name|dest_has_alpha
condition|)
name|dest_buffer
index|[
name|dest_offset
index|]
operator|=
literal|255
expr_stmt|;
if|if
condition|(
operator|(
operator|!
name|preview_p
operator|)
operator|&&
operator|(
operator|++
name|processed
operator|%
operator|(
name|total
operator|/
name|PROGRESS_UPDATE_NUM
operator|)
operator|)
operator|==
literal|0
condition|)
name|gimp_progress_update
argument_list|(
operator|(
name|double
operator|)
name|processed
operator|/
operator|(
name|double
operator|)
name|total
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|preview_p
condition|)
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|keep_height
condition|;
name|i
operator|++
control|)
name|gtk_preview_draw_row
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|preview
argument_list|)
argument_list|,
name|dest_buffer
operator|+
name|dest_bpl
operator|*
name|i
argument_list|,
literal|0
argument_list|,
name|dy
operator|+
name|i
argument_list|,
name|width_by_pixel
argument_list|)
expr_stmt|;
else|else
name|gimp_pixel_rgn_set_rect
argument_list|(
operator|&
name|dest_rgn
argument_list|,
name|dest_buffer
argument_list|,
name|x1
argument_list|,
name|y1
operator|+
name|dy
argument_list|,
name|width_by_pixel
argument_list|,
name|keep_height
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|preview_p
condition|)
block|{
name|gtk_widget_draw
argument_list|(
name|preview
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|gimp_progress_update
argument_list|(
literal|1.0
argument_list|)
expr_stmt|;
name|gimp_drawable_flush
argument_list|(
name|drawable
argument_list|)
expr_stmt|;
name|gimp_drawable_merge_shadow
argument_list|(
name|drawable
operator|->
name|id
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gimp_drawable_update
argument_list|(
name|drawable
operator|->
name|id
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
operator|(
name|x2
operator|-
name|x1
operator|)
argument_list|,
operator|(
name|y2
operator|-
name|y1
operator|)
argument_list|)
expr_stmt|;
name|gimp_drawable_detach
argument_list|(
name|drawable
argument_list|)
expr_stmt|;
block|}
return|return
name|STATUS_SUCCESS
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_compute_next_step (gint size,gdouble ** h,gdouble ** s,gdouble ** v,gdouble ** hn,gdouble ** sn,gdouble ** vn,gdouble ** haux,gdouble ** saux,gdouble ** vaux)
name|CML_compute_next_step
parameter_list|(
name|gint
name|size
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|h
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|s
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|v
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|hn
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|sn
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|vn
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|haux
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|saux
parameter_list|,
name|gdouble
modifier|*
modifier|*
name|vaux
parameter_list|)
block|{
name|int
name|index
decl_stmt|;
for|for
control|(
name|index
operator|=
literal|0
init|;
name|index
operator|<
name|size
condition|;
name|index
operator|++
control|)
operator|(
operator|*
name|hn
operator|)
index|[
name|index
index|]
operator|=
name|CML_next_value
argument_list|(
operator|*
name|h
argument_list|,
name|index
argument_list|,
name|size
argument_list|,
operator|(
operator|*
name|s
operator|)
index|[
name|POS_IN_TORUS
argument_list|(
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|,
operator|(
operator|*
name|v
operator|)
index|[
name|POS_IN_TORUS
argument_list|(
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|,
operator|&
name|VALS
operator|.
name|hue
argument_list|,
operator|(
operator|*
name|haux
operator|)
index|[
name|POS_IN_TORUS
argument_list|(
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|0
init|;
name|index
operator|<
name|size
condition|;
name|index
operator|++
control|)
operator|(
operator|*
name|sn
operator|)
index|[
name|index
index|]
operator|=
name|CML_next_value
argument_list|(
operator|*
name|s
argument_list|,
name|index
argument_list|,
name|size
argument_list|,
operator|(
operator|*
name|v
operator|)
index|[
name|POS_IN_TORUS
argument_list|(
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|,
operator|(
operator|*
name|h
operator|)
index|[
name|POS_IN_TORUS
argument_list|(
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|,
operator|&
name|VALS
operator|.
name|sat
argument_list|,
operator|(
operator|*
name|saux
operator|)
index|[
name|POS_IN_TORUS
argument_list|(
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|0
init|;
name|index
operator|<
name|size
condition|;
name|index
operator|++
control|)
operator|(
operator|*
name|vn
operator|)
index|[
name|index
index|]
operator|=
name|CML_next_value
argument_list|(
operator|*
name|v
argument_list|,
name|index
argument_list|,
name|size
argument_list|,
operator|(
operator|*
name|h
operator|)
index|[
name|POS_IN_TORUS
argument_list|(
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|,
operator|(
operator|*
name|s
operator|)
index|[
name|POS_IN_TORUS
argument_list|(
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|,
operator|&
name|VALS
operator|.
name|val
argument_list|,
operator|(
operator|*
name|vaux
operator|)
index|[
name|POS_IN_TORUS
argument_list|(
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
expr_stmt|;
DECL|macro|GD_SWAP (x,y)
define|#
directive|define
name|GD_SWAP
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|)
value|{ gdouble *tmp = *x; *x = *y; *y = tmp; }
name|GD_SWAP
argument_list|(
name|h
argument_list|,
name|hn
argument_list|)
expr_stmt|;
name|GD_SWAP
argument_list|(
name|s
argument_list|,
name|sn
argument_list|)
expr_stmt|;
name|GD_SWAP
argument_list|(
name|v
argument_list|,
name|vn
argument_list|)
expr_stmt|;
undef|#
directive|undef
name|SWAP
block|}
end_function

begin_define
DECL|macro|AVE_DIST (x,y)
define|#
directive|define
name|AVE_DIST
parameter_list|(
name|x
parameter_list|,
name|y
parameter_list|)
value|(((x) * (x) + (y) * (y))/ 2.0)
end_define

begin_define
DECL|macro|LOGISTICS (x)
define|#
directive|define
name|LOGISTICS
parameter_list|(
name|x
parameter_list|)
value|logistic_function (param, x, power)
end_define

begin_define
DECL|macro|ENV_FACTOR (x)
define|#
directive|define
name|ENV_FACTOR
parameter_list|(
name|x
parameter_list|)
value|(param->env_sensitivity * LOGISTICS (x))
end_define

begin_define
DECL|macro|C_ENV_FACTOR (x)
define|#
directive|define
name|C_ENV_FACTOR
parameter_list|(
name|x
parameter_list|)
value|(param->mod_rate * ENV_FACTOR (x))
end_define

begin_define
DECL|macro|CHN_FACTOR (x)
define|#
directive|define
name|CHN_FACTOR
parameter_list|(
name|x
parameter_list|)
value|(param->ch_sensitivity * LOGISTICS (x))
end_define

begin_define
DECL|macro|C_CHN_FACTOR (x)
define|#
directive|define
name|C_CHN_FACTOR
parameter_list|(
name|x
parameter_list|)
value|(param->mod_rate * CHN_FACTOR (x))
end_define

begin_function
specifier|static
name|gdouble
DECL|function|CML_next_value (gdouble * vec,gint pos,gint size,gdouble c1,gdouble c2,CML_PARAM * param,gdouble power)
name|CML_next_value
parameter_list|(
name|gdouble
modifier|*
name|vec
parameter_list|,
name|gint
name|pos
parameter_list|,
name|gint
name|size
parameter_list|,
name|gdouble
name|c1
parameter_list|,
name|gdouble
name|c2
parameter_list|,
name|CML_PARAM
modifier|*
name|param
parameter_list|,
name|gdouble
name|power
parameter_list|)
block|{
name|gdouble
name|val
init|=
name|vec
index|[
name|pos
index|]
decl_stmt|;
name|gdouble
name|diff
init|=
literal|0
decl_stmt|;
name|gdouble
name|self_diff
init|=
literal|0
decl_stmt|;
name|gdouble
name|by_env
init|=
literal|0
decl_stmt|;
name|gdouble
name|self_mod_rate
init|=
literal|0
decl_stmt|;
name|gdouble
name|hold_rate
init|=
literal|1
operator|-
name|param
operator|->
name|mod_rate
decl_stmt|;
name|gdouble
name|env_factor
init|=
literal|0
decl_stmt|;
name|gint
name|index
decl_stmt|;
name|self_mod_rate
operator|=
operator|(
literal|1
operator|-
name|param
operator|->
name|env_sensitivity
operator|-
name|param
operator|->
name|ch_sensitivity
operator|)
expr_stmt|;
switch|switch
condition|(
name|param
operator|->
name|arrange
condition|)
block|{
case|case
name|ANTILOG
case|:
name|self_diff
operator|=
name|self_mod_rate
operator|*
name|LOGISTICS
argument_list|(
literal|1
operator|-
name|vec
index|[
name|pos
index|]
argument_list|)
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|1
init|;
name|index
operator|<=
name|param
operator|->
name|diffusion_dist
operator|/
literal|2
condition|;
name|index
operator|++
control|)
name|env_factor
operator|+=
name|ENV_FACTOR
argument_list|(
literal|1
operator|-
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|+
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
operator|+
name|ENV_FACTOR
argument_list|(
literal|1
operator|-
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|-
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|param
operator|->
name|diffusion_dist
operator|%
literal|2
operator|)
operator|==
literal|1
condition|)
name|env_factor
operator|+=
operator|(
name|ENV_FACTOR
argument_list|(
literal|1
operator|-
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|+
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
operator|+
name|ENV_FACTOR
argument_list|(
literal|1
operator|-
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|-
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
operator|)
operator|/
literal|2
expr_stmt|;
name|env_factor
operator|/=
operator|(
name|gdouble
operator|)
name|param
operator|->
name|diffusion_dist
expr_stmt|;
name|by_env
operator|=
name|env_factor
operator|+
operator|(
name|CHN_FACTOR
argument_list|(
literal|1
operator|-
name|c1
argument_list|)
operator|+
name|CHN_FACTOR
argument_list|(
literal|1
operator|-
name|c2
argument_list|)
operator|)
operator|/
literal|2
expr_stmt|;
name|diff
operator|=
name|param
operator|->
name|mod_rate
operator|*
operator|(
name|self_diff
operator|+
name|by_env
operator|)
expr_stmt|;
name|val
operator|=
name|hold_rate
operator|*
name|vec
index|[
name|pos
index|]
operator|+
name|diff
expr_stmt|;
break|break;
case|case
name|AVERAGE
case|:
name|self_diff
operator|=
name|self_mod_rate
operator|*
name|LOGISTICS
argument_list|(
name|vec
index|[
name|pos
index|]
argument_list|)
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|1
init|;
name|index
operator|<=
name|param
operator|->
name|diffusion_dist
operator|/
literal|2
condition|;
name|index
operator|++
control|)
name|env_factor
operator|+=
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|+
name|index
argument_list|,
name|size
argument_list|)
index|]
operator|+
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|-
name|index
argument_list|,
name|size
argument_list|)
index|]
expr_stmt|;
if|if
condition|(
operator|(
name|param
operator|->
name|diffusion_dist
operator|%
literal|2
operator|)
operator|==
literal|1
condition|)
name|env_factor
operator|+=
operator|(
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|+
name|index
argument_list|,
name|size
argument_list|)
index|]
operator|+
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|-
name|index
argument_list|,
name|size
argument_list|)
index|]
operator|)
operator|/
literal|2
expr_stmt|;
name|env_factor
operator|/=
operator|(
name|gdouble
operator|)
name|param
operator|->
name|diffusion_dist
expr_stmt|;
name|by_env
operator|=
name|ENV_FACTOR
argument_list|(
name|env_factor
argument_list|)
operator|+
operator|(
name|CHN_FACTOR
argument_list|(
name|c1
argument_list|)
operator|+
name|CHN_FACTOR
argument_list|(
name|c2
argument_list|)
operator|)
operator|/
literal|2
expr_stmt|;
name|diff
operator|=
name|param
operator|->
name|mod_rate
operator|*
operator|(
name|self_diff
operator|+
name|by_env
operator|)
expr_stmt|;
name|val
operator|=
name|hold_rate
operator|*
name|vec
index|[
name|pos
index|]
operator|+
name|diff
expr_stmt|;
break|break;
case|case
name|MULTIPLY_RANDOM0
case|:
case|case
name|MULTIPLY_RANDOM1
case|:
case|case
name|MULTIPLY_GRADIENT
case|:
block|{
name|gdouble
name|tmp
decl_stmt|;
name|tmp
operator|=
name|power
expr_stmt|;
name|power
operator|=
name|param
operator|->
name|power
expr_stmt|;
name|self_diff
operator|=
name|self_mod_rate
operator|*
name|LOGISTICS
argument_list|(
name|vec
index|[
name|pos
index|]
argument_list|)
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|1
init|;
name|index
operator|<=
name|param
operator|->
name|diffusion_dist
operator|/
literal|2
condition|;
name|index
operator|++
control|)
name|env_factor
operator|+=
name|ENV_FACTOR
argument_list|(
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|+
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
operator|+
name|ENV_FACTOR
argument_list|(
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|-
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|param
operator|->
name|diffusion_dist
operator|%
literal|2
operator|)
operator|==
literal|1
condition|)
name|env_factor
operator|+=
operator|(
name|ENV_FACTOR
argument_list|(
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|+
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
operator|+
name|ENV_FACTOR
argument_list|(
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|-
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
operator|)
operator|/
literal|2
expr_stmt|;
name|env_factor
operator|/=
operator|(
name|gdouble
operator|)
name|param
operator|->
name|diffusion_dist
expr_stmt|;
name|by_env
operator|=
operator|(
name|env_factor
operator|+
name|CHN_FACTOR
argument_list|(
name|c1
argument_list|)
operator|+
name|CHN_FACTOR
argument_list|(
name|c2
argument_list|)
operator|)
operator|/
literal|2
expr_stmt|;
name|diff
operator|=
name|pow
argument_list|(
name|param
operator|->
name|mod_rate
operator|*
operator|(
name|self_diff
operator|+
name|by_env
operator|)
argument_list|,
name|tmp
argument_list|)
expr_stmt|;
name|val
operator|=
name|hold_rate
operator|*
name|vec
index|[
name|pos
index|]
operator|+
name|diff
expr_stmt|;
break|break;
block|}
case|case
name|STANDARD
case|:
case|case
name|RAND_POWER0
case|:
case|case
name|RAND_POWER1
case|:
case|case
name|RAND_POWER2
case|:
case|case
name|RAND_AND_P
case|:
default|default:
name|self_diff
operator|=
name|self_mod_rate
operator|*
name|LOGISTICS
argument_list|(
name|vec
index|[
name|pos
index|]
argument_list|)
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|1
init|;
name|index
operator|<=
name|param
operator|->
name|diffusion_dist
operator|/
literal|2
condition|;
name|index
operator|++
control|)
name|env_factor
operator|+=
name|ENV_FACTOR
argument_list|(
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|+
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
operator|+
name|ENV_FACTOR
argument_list|(
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|-
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|param
operator|->
name|diffusion_dist
operator|%
literal|2
operator|)
operator|==
literal|1
condition|)
name|env_factor
operator|+=
operator|(
name|ENV_FACTOR
argument_list|(
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|+
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
operator|+
name|ENV_FACTOR
argument_list|(
name|vec
index|[
name|POS_IN_TORUS
argument_list|(
name|pos
operator|-
name|index
argument_list|,
name|size
argument_list|)
index|]
argument_list|)
operator|)
operator|/
literal|2
expr_stmt|;
name|env_factor
operator|/=
operator|(
name|gdouble
operator|)
name|param
operator|->
name|diffusion_dist
expr_stmt|;
name|by_env
operator|=
name|env_factor
operator|+
operator|(
name|CHN_FACTOR
argument_list|(
name|c1
argument_list|)
operator|+
name|CHN_FACTOR
argument_list|(
name|c2
argument_list|)
operator|)
operator|/
literal|2
expr_stmt|;
name|diff
operator|=
name|param
operator|->
name|mod_rate
operator|*
operator|(
name|self_diff
operator|+
name|by_env
operator|)
expr_stmt|;
name|val
operator|=
name|hold_rate
operator|*
name|vec
index|[
name|pos
index|]
operator|+
name|diff
expr_stmt|;
break|break;
block|}
comment|/* finalize */
if|if
condition|(
name|RANDOM
operator|<
name|param
operator|->
name|mutation_rate
condition|)
block|{
name|val
operator|+=
operator|(
operator|(
name|RANDOM
operator|<
literal|0.5
operator|)
condition|?
operator|-
literal|1.0
else|:
literal|1.0
operator|)
operator|*
name|param
operator|->
name|mutation_dist
operator|*
name|RANDOM
expr_stmt|;
block|}
if|if
condition|(
name|param
operator|->
name|cyclic_range
condition|)
block|{
if|if
condition|(
literal|1.0
operator|<
name|val
condition|)
name|val
operator|=
name|val
operator|-
operator|(
name|int
operator|)
name|val
expr_stmt|;
elseif|else
if|if
condition|(
name|val
operator|<
literal|0.0
condition|)
name|val
operator|=
name|val
operator|-
name|floor
argument_list|(
name|val
argument_list|)
expr_stmt|;
block|}
else|else
comment|/* The range of val should be [0,1], not [0,1).       Cannonization shuold be done in color mapping phase. */
name|val
operator|=
name|CLAMP
argument_list|(
name|val
argument_list|,
literal|0.0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
return|return
name|val
return|;
block|}
end_function

begin_undef
undef|#
directive|undef
name|AVE_DIST
end_undef

begin_undef
undef|#
directive|undef
name|LOGISTICS
end_undef

begin_undef
undef|#
directive|undef
name|ENV_FACTOR
end_undef

begin_undef
undef|#
directive|undef
name|C_ENV_FACTOR
end_undef

begin_undef
undef|#
directive|undef
name|CHN_FACTOR
end_undef

begin_undef
undef|#
directive|undef
name|C_CHN_FACTOR
end_undef

begin_function
specifier|static
name|gdouble
DECL|function|logistic_function (CML_PARAM * param,gdouble x,gdouble power)
name|logistic_function
parameter_list|(
name|CML_PARAM
modifier|*
name|param
parameter_list|,
name|gdouble
name|x
parameter_list|,
name|gdouble
name|power
parameter_list|)
block|{
name|gdouble
name|x1
init|=
name|x
decl_stmt|;
name|gdouble
name|result
init|=
literal|0
decl_stmt|;
name|int
name|n
init|=
name|param
operator|->
name|range_num
decl_stmt|;
name|int
name|step
decl_stmt|;
name|step
operator|=
call|(
name|int
call|)
argument_list|(
name|x
operator|*
operator|(
name|gdouble
operator|)
name|n
argument_list|)
expr_stmt|;
name|x1
operator|=
operator|(
name|x
operator|-
operator|(
operator|(
name|gdouble
operator|)
name|step
operator|/
operator|(
name|gdouble
operator|)
name|n
operator|)
operator|)
operator|*
name|n
expr_stmt|;
switch|switch
condition|(
name|param
operator|->
name|function
condition|)
block|{
case|case
name|CML_KEEP_VALUES
case|:
case|case
name|CML_KEEP_FIRST
case|:
name|result
operator|=
name|x
expr_stmt|;
return|return
name|result
return|;
break|break;
case|case
name|CML_FILL
case|:
name|result
operator|=
name|CLAMP
argument_list|(
name|param
operator|->
name|parameter_k
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|)
expr_stmt|;
return|return
name|result
return|;
break|break;
case|case
name|CML_LOGIST
case|:
name|result
operator|=
name|param
operator|->
name|parameter_k
operator|*
name|pow
argument_list|(
literal|4
operator|*
name|x1
operator|*
operator|(
literal|1.0
operator|-
name|x1
operator|)
argument_list|,
name|power
argument_list|)
expr_stmt|;
break|break;
case|case
name|CML_LOGIST_STEP
case|:
name|result
operator|=
name|param
operator|->
name|parameter_k
operator|*
name|pow
argument_list|(
literal|4
operator|*
name|x1
operator|*
operator|(
literal|1.0
operator|-
name|x1
operator|)
argument_list|,
name|power
argument_list|)
expr_stmt|;
name|result
operator|=
operator|(
name|result
operator|+
name|step
operator|)
operator|/
operator|(
name|gdouble
operator|)
name|n
expr_stmt|;
break|break;
case|case
name|CML_POWER
case|:
name|result
operator|=
name|param
operator|->
name|parameter_k
operator|*
name|pow
argument_list|(
name|x1
argument_list|,
name|power
argument_list|)
expr_stmt|;
break|break;
case|case
name|CML_POWER_STEP
case|:
name|result
operator|=
name|param
operator|->
name|parameter_k
operator|*
name|pow
argument_list|(
name|x1
argument_list|,
name|power
argument_list|)
expr_stmt|;
name|result
operator|=
operator|(
name|result
operator|+
name|step
operator|)
operator|/
operator|(
name|gdouble
operator|)
name|n
expr_stmt|;
break|break;
case|case
name|CML_REV_POWER
case|:
name|result
operator|=
name|param
operator|->
name|parameter_k
operator|*
operator|(
literal|1
operator|-
name|pow
argument_list|(
name|x1
argument_list|,
name|power
argument_list|)
operator|)
expr_stmt|;
break|break;
case|case
name|CML_REV_POWER_STEP
case|:
name|result
operator|=
name|param
operator|->
name|parameter_k
operator|*
operator|(
literal|1
operator|-
name|pow
argument_list|(
name|x1
argument_list|,
name|power
argument_list|)
operator|)
expr_stmt|;
name|result
operator|=
operator|(
name|result
operator|+
name|step
operator|)
operator|/
operator|(
name|gdouble
operator|)
name|n
expr_stmt|;
break|break;
case|case
name|CML_DELTA
case|:
name|result
operator|=
name|param
operator|->
name|parameter_k
operator|*
literal|2
operator|*
operator|(
operator|(
name|x1
operator|<
literal|0.5
operator|)
condition|?
name|x1
else|:
operator|(
literal|1.0
operator|-
name|x1
operator|)
operator|)
expr_stmt|;
break|break;
case|case
name|CML_DELTA_STEP
case|:
name|result
operator|=
name|param
operator|->
name|parameter_k
operator|*
literal|2
operator|*
operator|(
operator|(
name|x1
operator|<
literal|0.5
operator|)
condition|?
name|x1
else|:
operator|(
literal|1.0
operator|-
name|x1
operator|)
operator|)
expr_stmt|;
name|result
operator|=
operator|(
name|result
operator|+
name|step
operator|)
operator|/
operator|(
name|gdouble
operator|)
name|n
expr_stmt|;
break|break;
case|case
name|CML_SIN_CURVE
case|:
if|if
condition|(
literal|1.0
operator|<
name|power
condition|)
name|result
operator|=
literal|0.5
operator|*
operator|(
name|sin
argument_list|(
name|M_PI
operator|*
name|ABS
argument_list|(
name|x1
operator|-
literal|0.5
argument_list|)
operator|/
name|power
argument_list|)
operator|/
name|sin
argument_list|(
name|M_PI
operator|*
literal|0.5
operator|/
name|power
argument_list|)
operator|+
literal|1
operator|)
expr_stmt|;
else|else
name|result
operator|=
literal|0.5
operator|*
operator|(
name|pow
argument_list|(
name|sin
argument_list|(
name|M_PI
operator|*
name|ABS
argument_list|(
name|x1
operator|-
literal|0.5
argument_list|)
argument_list|)
argument_list|,
name|power
argument_list|)
operator|+
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|x1
operator|<
literal|0.5
condition|)
name|result
operator|=
literal|1
operator|-
name|result
expr_stmt|;
break|break;
case|case
name|CML_SIN_CURVE_STEP
case|:
if|if
condition|(
literal|1.0
operator|<
name|power
condition|)
name|result
operator|=
literal|0.5
operator|*
operator|(
name|sin
argument_list|(
name|M_PI
operator|*
name|ABS
argument_list|(
name|x1
operator|-
literal|0.5
argument_list|)
operator|/
name|power
argument_list|)
operator|/
name|sin
argument_list|(
name|M_PI
operator|*
literal|0.5
operator|/
name|power
argument_list|)
operator|+
literal|1
operator|)
expr_stmt|;
else|else
name|result
operator|=
literal|0.5
operator|*
operator|(
name|pow
argument_list|(
name|sin
argument_list|(
name|M_PI
operator|*
name|ABS
argument_list|(
name|x1
operator|-
literal|0.5
argument_list|)
argument_list|)
argument_list|,
name|power
argument_list|)
operator|+
literal|1
operator|)
expr_stmt|;
if|if
condition|(
name|x1
operator|<
literal|0.5
condition|)
name|result
operator|=
literal|1
operator|-
name|result
expr_stmt|;
name|result
operator|=
operator|(
name|result
operator|+
name|step
operator|)
operator|/
operator|(
name|gdouble
operator|)
name|n
expr_stmt|;
break|break;
block|}
switch|switch
condition|(
name|param
operator|->
name|composition
condition|)
block|{
case|case
name|COMP_NONE
case|:
break|break;
case|case
name|COMP_MAX_LINEAR
case|:
name|result
operator|=
name|MAX
argument_list|(
operator|(
name|gdouble
operator|)
name|x
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MAX_LINEAR_P1
case|:
name|result
operator|=
name|MAX
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|+
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MAX_LINEAR_P1L
case|:
if|if
condition|(
name|x
operator|<
literal|0.5
condition|)
name|result
operator|=
name|MAX
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|+
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MAX_LINEAR_P1U
case|:
if|if
condition|(
literal|0.5
operator|<
name|x
condition|)
name|result
operator|=
name|MAX
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|+
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MAX_LINEAR_M1
case|:
name|result
operator|=
name|MAX
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|-
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MAX_LINEAR_M1L
case|:
if|if
condition|(
name|x
operator|<
literal|0.5
condition|)
name|result
operator|=
name|MAX
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|-
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MAX_LINEAR_M1U
case|:
if|if
condition|(
literal|0.5
operator|<
name|x
condition|)
name|result
operator|=
name|MAX
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|-
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MIN_LINEAR
case|:
name|result
operator|=
name|MIN
argument_list|(
operator|(
name|gdouble
operator|)
name|x
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MIN_LINEAR_P1
case|:
name|result
operator|=
name|MIN
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|+
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MIN_LINEAR_P1L
case|:
if|if
condition|(
name|x
operator|<
literal|0.5
condition|)
name|result
operator|=
name|MIN
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|+
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MIN_LINEAR_P1U
case|:
if|if
condition|(
literal|0.5
operator|<
name|x
condition|)
name|result
operator|=
name|MIN
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|+
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MIN_LINEAR_M1
case|:
name|result
operator|=
name|MIN
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|-
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MIN_LINEAR_M1L
case|:
if|if
condition|(
name|x
operator|<
literal|0.5
condition|)
name|result
operator|=
name|MIN
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|-
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
case|case
name|COMP_MIN_LINEAR_M1U
case|:
if|if
condition|(
literal|0.5
operator|<
name|x
condition|)
name|result
operator|=
name|MIN
argument_list|(
operator|(
name|gdouble
operator|)
name|x
operator|-
operator|(
name|gdouble
operator|)
literal|1
operator|/
operator|(
name|gdouble
operator|)
literal|256
argument_list|,
operator|(
name|gdouble
operator|)
name|result
argument_list|)
expr_stmt|;
break|break;
block|}
return|return
name|result
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|rgb_to_hsv (int * r,int * g,int * b)
name|rgb_to_hsv
parameter_list|(
name|int
modifier|*
name|r
parameter_list|,
name|int
modifier|*
name|g
parameter_list|,
name|int
modifier|*
name|b
parameter_list|)
block|{
name|int
name|red
decl_stmt|,
name|green
decl_stmt|,
name|blue
decl_stmt|;
name|float
name|h
init|=
literal|0
decl_stmt|,
name|s
decl_stmt|,
name|v
decl_stmt|;
name|int
name|min
decl_stmt|,
name|max
decl_stmt|;
name|int
name|delta
decl_stmt|;
name|red
operator|=
operator|*
name|r
expr_stmt|;
name|green
operator|=
operator|*
name|g
expr_stmt|;
name|blue
operator|=
operator|*
name|b
expr_stmt|;
if|if
condition|(
name|red
operator|>
name|green
condition|)
block|{
if|if
condition|(
name|red
operator|>
name|blue
condition|)
name|max
operator|=
name|red
expr_stmt|;
else|else
name|max
operator|=
name|blue
expr_stmt|;
if|if
condition|(
name|green
operator|<
name|blue
condition|)
name|min
operator|=
name|green
expr_stmt|;
else|else
name|min
operator|=
name|blue
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
name|green
operator|>
name|blue
condition|)
name|max
operator|=
name|green
expr_stmt|;
else|else
name|max
operator|=
name|blue
expr_stmt|;
if|if
condition|(
name|red
operator|<
name|blue
condition|)
name|min
operator|=
name|red
expr_stmt|;
else|else
name|min
operator|=
name|blue
expr_stmt|;
block|}
name|v
operator|=
name|max
expr_stmt|;
if|if
condition|(
name|max
operator|!=
literal|0
condition|)
name|s
operator|=
operator|(
operator|(
name|max
operator|-
name|min
operator|)
operator|*
literal|255
operator|)
operator|/
operator|(
name|float
operator|)
name|max
expr_stmt|;
else|else
name|s
operator|=
literal|0
expr_stmt|;
if|if
condition|(
name|s
operator|==
literal|0
condition|)
name|h
operator|=
literal|0
expr_stmt|;
else|else
block|{
name|delta
operator|=
name|max
operator|-
name|min
expr_stmt|;
if|if
condition|(
name|red
operator|==
name|max
condition|)
name|h
operator|=
operator|(
name|green
operator|-
name|blue
operator|)
operator|/
operator|(
name|float
operator|)
name|delta
expr_stmt|;
elseif|else
if|if
condition|(
name|green
operator|==
name|max
condition|)
name|h
operator|=
literal|2
operator|+
operator|(
name|blue
operator|-
name|red
operator|)
operator|/
operator|(
name|float
operator|)
name|delta
expr_stmt|;
elseif|else
if|if
condition|(
name|blue
operator|==
name|max
condition|)
name|h
operator|=
literal|4
operator|+
operator|(
name|red
operator|-
name|green
operator|)
operator|/
operator|(
name|float
operator|)
name|delta
expr_stmt|;
name|h
operator|*=
literal|42.5
expr_stmt|;
if|if
condition|(
name|h
operator|<
literal|0
condition|)
name|h
operator|+=
literal|255
expr_stmt|;
if|if
condition|(
name|h
operator|>
literal|255
condition|)
name|h
operator|-=
literal|255
expr_stmt|;
block|}
operator|*
name|r
operator|=
name|h
expr_stmt|;
operator|*
name|g
operator|=
name|s
expr_stmt|;
operator|*
name|b
operator|=
name|v
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|hsv_to_rgb (int * h,int * s,int * v)
name|hsv_to_rgb
parameter_list|(
name|int
modifier|*
name|h
parameter_list|,
name|int
modifier|*
name|s
parameter_list|,
name|int
modifier|*
name|v
parameter_list|)
block|{
name|float
name|hue
decl_stmt|,
name|saturation
decl_stmt|,
name|value
decl_stmt|;
name|float
name|f
decl_stmt|,
name|p
decl_stmt|,
name|q
decl_stmt|,
name|t
decl_stmt|;
if|if
condition|(
operator|*
name|s
operator|==
literal|0
condition|)
block|{
operator|*
name|h
operator|=
operator|*
name|v
expr_stmt|;
operator|*
name|s
operator|=
operator|*
name|v
expr_stmt|;
operator|*
name|v
operator|=
operator|*
name|v
expr_stmt|;
block|}
else|else
block|{
name|hue
operator|=
operator|*
name|h
operator|*
literal|6.0
operator|/
literal|255.0
expr_stmt|;
if|if
condition|(
name|hue
operator|==
literal|6.0
condition|)
name|hue
operator|=
literal|0.0
expr_stmt|;
name|saturation
operator|=
operator|*
name|s
operator|/
literal|255.0
expr_stmt|;
name|value
operator|=
operator|*
name|v
operator|/
literal|255.0
expr_stmt|;
name|f
operator|=
name|hue
operator|-
operator|(
name|int
operator|)
name|hue
expr_stmt|;
name|p
operator|=
name|value
operator|*
operator|(
literal|1.0
operator|-
name|saturation
operator|)
expr_stmt|;
name|q
operator|=
name|value
operator|*
operator|(
literal|1.0
operator|-
operator|(
name|saturation
operator|*
name|f
operator|)
operator|)
expr_stmt|;
name|t
operator|=
name|value
operator|*
operator|(
literal|1.0
operator|-
operator|(
name|saturation
operator|*
operator|(
literal|1.0
operator|-
name|f
operator|)
operator|)
operator|)
expr_stmt|;
switch|switch
condition|(
operator|(
name|int
operator|)
name|hue
condition|)
block|{
case|case
literal|0
case|:
operator|*
name|h
operator|=
name|value
operator|*
literal|255
expr_stmt|;
operator|*
name|s
operator|=
name|t
operator|*
literal|255
expr_stmt|;
operator|*
name|v
operator|=
name|p
operator|*
literal|255
expr_stmt|;
break|break;
case|case
literal|1
case|:
operator|*
name|h
operator|=
name|q
operator|*
literal|255
expr_stmt|;
operator|*
name|s
operator|=
name|value
operator|*
literal|255
expr_stmt|;
operator|*
name|v
operator|=
name|p
operator|*
literal|255
expr_stmt|;
break|break;
case|case
literal|2
case|:
operator|*
name|h
operator|=
name|p
operator|*
literal|255
expr_stmt|;
operator|*
name|s
operator|=
name|value
operator|*
literal|255
expr_stmt|;
operator|*
name|v
operator|=
name|t
operator|*
literal|255
expr_stmt|;
break|break;
case|case
literal|3
case|:
operator|*
name|h
operator|=
name|p
operator|*
literal|255
expr_stmt|;
operator|*
name|s
operator|=
name|q
operator|*
literal|255
expr_stmt|;
operator|*
name|v
operator|=
name|value
operator|*
literal|255
expr_stmt|;
break|break;
case|case
literal|4
case|:
operator|*
name|h
operator|=
name|t
operator|*
literal|255
expr_stmt|;
operator|*
name|s
operator|=
name|p
operator|*
literal|255
expr_stmt|;
operator|*
name|v
operator|=
name|value
operator|*
literal|255
expr_stmt|;
break|break;
case|case
literal|5
case|:
operator|*
name|h
operator|=
name|value
operator|*
literal|255
expr_stmt|;
operator|*
name|s
operator|=
name|p
operator|*
literal|255
expr_stmt|;
operator|*
name|v
operator|=
name|q
operator|*
literal|255
expr_stmt|;
break|break;
block|}
block|}
block|}
end_function

begin_comment
comment|/* dialog stuff */
end_comment

begin_function
specifier|static
name|int
DECL|function|DIALOG ()
name|DIALOG
parameter_list|()
block|{
name|GtkWidget
modifier|*
name|dlg
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|gchar
modifier|*
modifier|*
name|argv
decl_stmt|;
name|gint
name|argc
decl_stmt|;
name|argc
operator|=
literal|1
expr_stmt|;
name|argv
operator|=
name|g_new
argument_list|(
name|gchar
operator|*
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|argv
index|[
literal|0
index|]
operator|=
name|g_strdup
argument_list|(
name|PLUG_IN_NAME
argument_list|)
expr_stmt|;
name|gtk_init
argument_list|(
operator|&
name|argc
argument_list|,
operator|&
name|argv
argument_list|)
expr_stmt|;
name|gtk_rc_parse
argument_list|(
name|gimp_gtkrc
argument_list|()
argument_list|)
expr_stmt|;
name|dlg
operator|=
name|gtkW_dialog_new
argument_list|(
literal|"Coupled-Map-Lattice Explorer"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|OK_CALLBACK
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_close_callback
argument_list|)
expr_stmt|;
name|memset
argument_list|(
operator|&
name|widget_pointers
argument_list|,
operator|(
name|int
operator|)
literal|0
argument_list|,
sizeof|sizeof
argument_list|(
name|widget_pointers
argument_list|)
argument_list|)
expr_stmt|;
name|CML_preview_defer
operator|=
name|TRUE
expr_stmt|;
name|hbox
operator|=
name|gtkW_hbox_new
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|)
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|preview_box
decl_stmt|;
name|GtkWidget
modifier|*
name|preview_table
decl_stmt|;
name|GtkWidget
modifier|*
name|preview_frame
decl_stmt|;
name|GtkWidget
modifier|*
name|hseparator
decl_stmt|;
name|table
operator|=
name|gtkW_table_new
argument_list|(
name|hbox
argument_list|,
literal|8
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtkW_frame_new
argument_list|(
name|NULL
argument_list|,
literal|"Preview"
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|frame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
name|gtkW_border_width
argument_list|)
expr_stmt|;
name|preview_box
operator|=
name|gtkW_hbox_new
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtkW_border_width
operator|=
literal|0
expr_stmt|;
name|preview_table
operator|=
name|gtkW_table_new
argument_list|(
name|preview_box
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtkW_border_width
operator|=
name|GTKW_BORDER_WIDTH
expr_stmt|;
name|gtkW_frame_shadow_type
operator|=
name|GTK_SHADOW_IN
expr_stmt|;
name|preview_frame
operator|=
name|gtkW_frame_new
argument_list|(
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtkW_frame_shadow_type
operator|=
name|GTK_SHADOW_ETCHED_IN
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|preview_frame
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|preview_frame
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|preview_table
argument_list|)
argument_list|,
name|preview_frame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* I don't understand well about the following codes */
name|gdk_set_use_xshm
argument_list|(
name|gimp_use_xshm
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_preview_set_gamma
argument_list|(
name|gimp_gamma
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_preview_set_install_cmap
argument_list|(
name|gimp_install_cmap
argument_list|()
argument_list|)
expr_stmt|;
block|{
name|guchar
modifier|*
name|color_cube
decl_stmt|;
name|color_cube
operator|=
name|gimp_color_cube
argument_list|()
expr_stmt|;
name|gtk_preview_set_color_cube
argument_list|(
name|color_cube
index|[
literal|0
index|]
argument_list|,
name|color_cube
index|[
literal|1
index|]
argument_list|,
name|color_cube
index|[
literal|2
index|]
argument_list|,
name|color_cube
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_set_default_visual
argument_list|(
name|gtk_preview_get_visual
argument_list|()
argument_list|)
expr_stmt|;
name|gtk_widget_set_default_colormap
argument_list|(
name|gtk_preview_get_cmap
argument_list|()
argument_list|)
expr_stmt|;
name|preview
operator|=
name|gtk_preview_new
argument_list|(
name|GTK_PREVIEW_COLOR
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|preview
argument_list|)
argument_list|,
name|GTKW_PREVIEW_WIDTH
argument_list|,
name|GTKW_PREVIEW_HEIGHT
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|preview_frame
argument_list|)
argument_list|,
name|preview
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|preview
argument_list|)
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|hbox
init|=
name|gtkW_hbox_new
argument_list|(
name|NULL
argument_list|)
decl_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|hbox
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
name|button
operator|=
name|gtkW_table_add_button
argument_list|(
name|table
argument_list|,
literal|"New seed"
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_preview_update_callback
argument_list|,
operator|&
name|VALS
argument_list|)
expr_stmt|;
name|random_sensitives
index|[
literal|0
index|]
operator|.
name|widget
operator|=
name|button
expr_stmt|;
name|random_sensitives
index|[
literal|0
index|]
operator|.
name|logic
operator|=
name|TRUE
expr_stmt|;
name|button
operator|=
name|gtkW_table_add_button
argument_list|(
name|table
argument_list|,
literal|"Fix seed"
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_set_or_randomize_seed_callback
argument_list|,
operator|&
name|VALS
argument_list|)
expr_stmt|;
name|random_sensitives
index|[
literal|1
index|]
operator|.
name|widget
operator|=
name|button
expr_stmt|;
name|random_sensitives
index|[
literal|1
index|]
operator|.
name|logic
operator|=
name|TRUE
expr_stmt|;
name|button
operator|=
name|gtkW_table_add_button
argument_list|(
name|table
argument_list|,
literal|"Random seed"
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|4
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_set_or_randomize_seed_callback
argument_list|,
operator|&
name|VALS
argument_list|)
expr_stmt|;
name|random_sensitives
index|[
literal|2
index|]
operator|.
name|widget
operator|=
name|button
expr_stmt|;
name|random_sensitives
index|[
literal|2
index|]
operator|.
name|logic
operator|=
name|FALSE
expr_stmt|;
name|hseparator
operator|=
name|gtk_hseparator_new
argument_list|()
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hseparator
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|hseparator
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|5
argument_list|,
literal|6
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
name|gtkW_border_width
argument_list|,
literal|2
operator|*
name|gtkW_border_width
argument_list|)
expr_stmt|;
name|gtkW_table_add_button
argument_list|(
name|table
argument_list|,
literal|"Load"
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|6
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_load_from_file_callback
argument_list|,
operator|&
name|VALS
argument_list|)
expr_stmt|;
name|gtkW_table_add_button
argument_list|(
name|table
argument_list|,
literal|"Save"
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|7
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_save_to_file_callback
argument_list|,
operator|&
name|VALS
argument_list|)
expr_stmt|;
block|}
block|{
name|GtkWidget
modifier|*
name|notebook
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|page
decl_stmt|;
name|GtkWidget
modifier|*
name|parent
init|=
name|hbox
decl_stmt|;
name|notebook
operator|=
name|gtk_notebook_new
argument_list|()
expr_stmt|;
name|gtk_notebook_set_tab_pos
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|parent
argument_list|)
argument_list|,
name|notebook
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|notebook
argument_list|)
expr_stmt|;
name|parent
operator|=
name|NULL
expr_stmt|;
name|page
operator|=
name|CML_dialog_sub_panel_new
argument_list|(
name|parent
argument_list|,
literal|"Hue settings"
argument_list|,
operator|&
name|VALS
operator|.
name|hue
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|page
argument_list|,
name|gtk_label_new
argument_list|(
literal|"Hue"
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|CML_dialog_sub_panel_new
argument_list|(
name|parent
argument_list|,
literal|"Saturation settings"
argument_list|,
operator|&
name|VALS
operator|.
name|sat
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|page
argument_list|,
name|gtk_label_new
argument_list|(
literal|"Saturation"
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|CML_dialog_sub_panel_new
argument_list|(
name|parent
argument_list|,
literal|"Value (grayimage) settings"
argument_list|,
operator|&
name|VALS
operator|.
name|val
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|page
argument_list|,
name|gtk_label_new
argument_list|(
literal|"Value"
argument_list|)
argument_list|)
expr_stmt|;
name|page
operator|=
name|CML_dialog_advanced_panel_new
argument_list|(
name|parent
argument_list|,
literal|"Advanced settings"
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|page
argument_list|,
name|gtk_label_new
argument_list|(
literal|"Advanced"
argument_list|)
argument_list|)
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|subtable
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|subframe
decl_stmt|;
name|GtkWidget
modifier|*
name|box
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|gint
name|index
decl_stmt|;
name|gint
name|sindex
decl_stmt|;
name|frame
operator|=
name|gtkW_frame_new
argument_list|(
name|NULL
argument_list|,
literal|"Other parameter settings"
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtkW_vbox_new
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtkW_table_new
argument_list|(
name|vbox
argument_list|,
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|index
operator|=
literal|0
expr_stmt|;
name|subframe
operator|=
name|gtkW_frame_new
argument_list|(
name|NULL
argument_list|,
literal|"Channel independed parameters"
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtkW_vbox_new
argument_list|(
name|subframe
argument_list|)
expr_stmt|;
name|subtable
operator|=
name|gtkW_table_new
argument_list|(
name|box
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|sindex
operator|=
literal|0
expr_stmt|;
name|gtkW_table_add_menu
argument_list|(
name|subtable
argument_list|,
literal|"Initial value"
argument_list|,
literal|0
argument_list|,
name|sindex
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_initial_value_menu_update
argument_list|,
operator|&
name|VALS
operator|.
name|initial_value
argument_list|,
name|initial_value_menu
argument_list|,
sizeof|sizeof
argument_list|(
name|initial_value_menu
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|initial_value_menu
index|[
literal|0
index|]
argument_list|)
argument_list|,
operator|&
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|0
index|]
argument_list|)
expr_stmt|;
name|gtkW_table_add_iscale_entry
argument_list|(
name|subtable
argument_list|,
literal|"Zoom scale"
argument_list|,
literal|0
argument_list|,
name|sindex
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_iscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_ientry_update
argument_list|,
operator|&
name|VALS
operator|.
name|scale
argument_list|,
literal|1
argument_list|,
literal|10
argument_list|,
literal|1
argument_list|,
operator|&
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|1
index|]
argument_list|)
expr_stmt|;
name|gtkW_table_add_iscale_entry
argument_list|(
name|subtable
argument_list|,
literal|"Start offset"
argument_list|,
literal|0
argument_list|,
name|sindex
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_iscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_ientry_update
argument_list|,
operator|&
name|VALS
operator|.
name|start_offset
argument_list|,
literal|0
argument_list|,
literal|100
argument_list|,
literal|1
argument_list|,
operator|&
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|2
index|]
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|subframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|index
argument_list|,
name|index
operator|+
literal|1
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
name|GTK_FILL
operator||
name|GTK_SHRINK
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|hbox
init|=
name|gtkW_hbox_new
argument_list|(
name|NULL
argument_list|)
decl_stmt|;
name|gtkW_border_width
operator|=
literal|0
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|hbox
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|index
argument_list|,
name|index
operator|+
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtkW_border_width
operator|=
name|GTKW_BORDER_WIDTH
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|}
name|subframe
operator|=
name|gtkW_frame_new
argument_list|(
name|NULL
argument_list|,
literal|"Seed of random (only for \"from seed\" modes)"
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtkW_vbox_new
argument_list|(
name|subframe
argument_list|)
expr_stmt|;
name|subtable
operator|=
name|gtkW_table_new
argument_list|(
name|box
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|sindex
operator|=
literal|0
expr_stmt|;
name|gtkW_table_add_iscale_entry
argument_list|(
name|subtable
argument_list|,
literal|"Seed"
argument_list|,
literal|0
argument_list|,
name|sindex
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_iscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_ientry_update
argument_list|,
operator|&
name|VALS
operator|.
name|seed
argument_list|,
literal|0
argument_list|,
literal|1
operator|<<
literal|15
argument_list|,
literal|1
argument_list|,
operator|&
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|3
index|]
argument_list|)
expr_stmt|;
name|random_sensitives
index|[
literal|3
index|]
operator|.
name|widget
operator|=
name|subtable
expr_stmt|;
name|random_sensitives
index|[
literal|3
index|]
operator|.
name|logic
operator|=
name|FALSE
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkTooltips
modifier|*
name|tooltips
decl_stmt|;
name|button
operator|=
name|gtkW_vbox_add_button
argument_list|(
name|box
argument_list|,
literal|"Switch to \"from seed\" with the last seed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_set_or_randomize_seed_callback
argument_list|,
operator|&
name|VALS
argument_list|)
expr_stmt|;
name|random_sensitives
index|[
literal|4
index|]
operator|.
name|widget
operator|=
name|button
expr_stmt|;
name|random_sensitives
index|[
literal|4
index|]
operator|.
name|logic
operator|=
name|TRUE
expr_stmt|;
name|tooltips
operator|=
name|gtkW_tooltips_new
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|gtk_tooltips_set_tips
argument_list|(
name|tooltips
argument_list|,
name|button
argument_list|,
literal|"\"Fix seed\" button is an alias of me.\nThe same seed produces the same image, if (1) the widths of images are same (this is the reason why image on drawable is different from preview), and (2) all mutation rates equal to zero."
argument_list|)
expr_stmt|;
name|gtk_tooltips_enable
argument_list|(
name|tooltips
argument_list|)
expr_stmt|;
block|}
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|subframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|index
argument_list|,
name|index
operator|+
literal|1
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|hbox
init|=
name|gtkW_hbox_new
argument_list|(
name|NULL
argument_list|)
decl_stmt|;
name|gtkW_border_width
operator|=
literal|0
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|hbox
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|index
argument_list|,
name|index
operator|+
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtkW_border_width
operator|=
name|GTKW_BORDER_WIDTH
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|}
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Others"
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|frame
argument_list|,
name|label
argument_list|)
expr_stmt|;
block|}
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|,
modifier|*
name|subtable
decl_stmt|,
modifier|*
name|frame
decl_stmt|,
modifier|*
name|subframe
decl_stmt|,
modifier|*
name|box
decl_stmt|,
modifier|*
name|vbox
decl_stmt|;
name|int
name|index
decl_stmt|,
name|sindex
decl_stmt|;
name|frame
operator|=
name|gtkW_frame_new
argument_list|(
name|NULL
argument_list|,
literal|"Misc operations"
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtkW_vbox_new
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtkW_table_new
argument_list|(
name|vbox
argument_list|,
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|index
operator|=
literal|0
expr_stmt|;
name|subframe
operator|=
name|gtkW_frame_new
argument_list|(
name|NULL
argument_list|,
literal|"Copy settings"
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtkW_vbox_new
argument_list|(
name|subframe
argument_list|)
expr_stmt|;
name|subtable
operator|=
name|gtkW_table_new
argument_list|(
name|box
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|sindex
operator|=
literal|0
expr_stmt|;
name|gtkW_table_add_menu
argument_list|(
name|subtable
argument_list|,
literal|"Source ch."
argument_list|,
literal|0
argument_list|,
name|sindex
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_menu_update
argument_list|,
operator|&
name|copy_source
argument_list|,
name|channel_menu
argument_list|,
sizeof|sizeof
argument_list|(
name|channel_menu
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|channel_menu
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtkW_table_add_menu
argument_list|(
name|subtable
argument_list|,
literal|"Destination ch."
argument_list|,
literal|0
argument_list|,
name|sindex
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_menu_update
argument_list|,
operator|&
name|copy_destination
argument_list|,
name|channel_menu
argument_list|,
sizeof|sizeof
argument_list|(
name|channel_menu
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|channel_menu
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtkW_table_add_button
argument_list|(
name|subtable
argument_list|,
literal|"Do copy parameters"
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|sindex
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_copy_parameters_callback
argument_list|,
operator|&
name|VALS
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|subframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|index
argument_list|,
name|index
operator|+
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|hbox
init|=
name|gtkW_hbox_new
argument_list|(
name|NULL
argument_list|)
decl_stmt|;
name|gtkW_border_width
operator|=
literal|0
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|hbox
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|index
argument_list|,
name|index
operator|+
literal|1
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtkW_border_width
operator|=
name|GTKW_BORDER_WIDTH
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|}
name|subframe
operator|=
name|gtkW_frame_new
argument_list|(
name|NULL
argument_list|,
literal|"Selective load settings"
argument_list|)
expr_stmt|;
name|box
operator|=
name|gtkW_vbox_new
argument_list|(
name|subframe
argument_list|)
expr_stmt|;
name|subtable
operator|=
name|gtkW_table_new
argument_list|(
name|box
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|sindex
operator|=
literal|0
expr_stmt|;
name|gtkW_table_add_menu
argument_list|(
name|subtable
argument_list|,
literal|"Source ch. in file"
argument_list|,
literal|0
argument_list|,
name|sindex
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_menu_update
argument_list|,
operator|&
name|selective_load_source
argument_list|,
name|sload_menu
argument_list|,
sizeof|sizeof
argument_list|(
name|sload_menu
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|sload_menu
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtkW_table_add_menu
argument_list|(
name|subtable
argument_list|,
literal|"Destination ch."
argument_list|,
literal|0
argument_list|,
name|sindex
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_menu_update
argument_list|,
operator|&
name|selective_load_destination
argument_list|,
name|sload_menu
argument_list|,
sizeof|sizeof
argument_list|(
name|sload_menu
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|sload_menu
index|[
literal|0
index|]
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|subframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|index
argument_list|,
name|index
operator|+
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|hbox
init|=
name|gtkW_hbox_new
argument_list|(
name|NULL
argument_list|)
decl_stmt|;
name|gtkW_border_width
operator|=
literal|0
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|hbox
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|index
argument_list|,
name|index
operator|+
literal|1
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtkW_border_width
operator|=
name|GTKW_BORDER_WIDTH
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|}
name|label
operator|=
name|gtk_label_new
argument_list|(
literal|"Misc ops."
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|frame
argument_list|,
name|label
argument_list|)
expr_stmt|;
block|}
block|}
name|CML_initial_value_sensitives_update
argument_list|()
expr_stmt|;
comment|/* Displaying preview might takes a long time. Thus, fisrt, dialog itself      should be shown before making preview in it. */
name|gtk_widget_show
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
name|CML_preview_defer
operator|=
name|FALSE
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
name|gtk_main
argument_list|()
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
return|return
name|INTERFACE
operator|.
name|run
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|CML_dialog_sub_panel_new (GtkWidget * parent,guchar * name,CML_PARAM * param,gint channel_id)
name|CML_dialog_sub_panel_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|CML_PARAM
modifier|*
name|param
parameter_list|,
name|gint
name|channel_id
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|subframe
decl_stmt|,
modifier|*
name|table
decl_stmt|;
name|gpointer
modifier|*
name|chank
decl_stmt|;
name|int
name|index
init|=
literal|0
decl_stmt|;
name|subframe
operator|=
name|gtkW_frame_new
argument_list|(
name|parent
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtkW_table_new
argument_list|(
name|subframe
argument_list|,
literal|14
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtkW_table_add_menu
argument_list|(
name|table
argument_list|,
literal|"Function type"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_menu_update
argument_list|,
operator|&
name|param
operator|->
name|function
argument_list|,
name|function_menu
argument_list|,
sizeof|sizeof
argument_list|(
name|function_menu
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|function_menu
index|[
literal|0
index|]
argument_list|)
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_menu
argument_list|(
name|table
argument_list|,
literal|"Composition"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_menu_update
argument_list|,
operator|&
name|param
operator|->
name|composition
argument_list|,
name|composition_menu
argument_list|,
sizeof|sizeof
argument_list|(
name|composition_menu
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|composition_menu
index|[
literal|0
index|]
argument_list|)
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_menu
argument_list|(
name|table
argument_list|,
literal|"Misc arrange"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_menu_update
argument_list|,
operator|&
name|param
operator|->
name|arrange
argument_list|,
name|arrange_menu
argument_list|,
sizeof|sizeof
argument_list|(
name|arrange_menu
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|arrange_menu
index|[
literal|0
index|]
argument_list|)
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_toggle
argument_list|(
name|table
argument_list|,
literal|"Use cyclic range"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_toggle_update
argument_list|,
operator|&
name|param
operator|->
name|cyclic_range
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_dscale_entry
argument_list|(
name|table
argument_list|,
literal|"Mod. rate"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dentry_update
argument_list|,
operator|&
name|param
operator|->
name|mod_rate
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_dscale_entry
argument_list|(
name|table
argument_list|,
literal|"Env. sensitivity"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dentry_update
argument_list|,
operator|&
name|param
operator|->
name|env_sensitivity
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_iscale_entry
argument_list|(
name|table
argument_list|,
literal|"Diffusion dist."
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_iscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_ientry_update
argument_list|,
operator|&
name|param
operator|->
name|diffusion_dist
argument_list|,
literal|2
argument_list|,
literal|10
argument_list|,
literal|1
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_iscale_entry
argument_list|(
name|table
argument_list|,
literal|"# of subranges"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_iscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_ientry_update
argument_list|,
operator|&
name|param
operator|->
name|range_num
argument_list|,
literal|1
argument_list|,
literal|10
argument_list|,
literal|1
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_dscale_entry
argument_list|(
name|table
argument_list|,
literal|"P(ower factor)"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dentry_update
argument_list|,
operator|&
name|param
operator|->
name|power
argument_list|,
literal|0.0
argument_list|,
literal|10.0
argument_list|,
literal|0.01
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_dscale_entry
argument_list|(
name|table
argument_list|,
literal|"Parameter k"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dentry_update
argument_list|,
operator|&
name|param
operator|->
name|parameter_k
argument_list|,
literal|0.0
argument_list|,
literal|10.0
argument_list|,
literal|0.01
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_dscale_entry
argument_list|(
name|table
argument_list|,
literal|"Range low"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dentry_update
argument_list|,
operator|&
name|param
operator|->
name|range_l
argument_list|,
literal|0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_dscale_entry
argument_list|(
name|table
argument_list|,
literal|"Range high"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dentry_update
argument_list|,
operator|&
name|param
operator|->
name|range_h
argument_list|,
literal|0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|{
name|GtkWidget
modifier|*
name|hbox
init|=
name|gtkW_hbox_new
argument_list|(
name|NULL
argument_list|)
decl_stmt|;
name|gtkW_border_width
operator|=
literal|0
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|hbox
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|index
argument_list|,
name|index
operator|+
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtkW_border_width
operator|=
name|GTKW_BORDER_WIDTH
expr_stmt|;
name|index
operator|++
expr_stmt|;
block|}
name|chank
operator|=
operator|(
name|gpointer
operator|*
operator|)
name|g_malloc
argument_list|(
literal|2
operator|*
sizeof|sizeof
argument_list|(
name|gpointer
argument_list|)
argument_list|)
expr_stmt|;
name|chank
index|[
literal|0
index|]
operator|=
operator|(
name|gpointer
operator|)
name|channel_id
expr_stmt|;
name|chank
index|[
literal|1
index|]
operator|=
operator|(
name|gpointer
operator|)
name|param
expr_stmt|;
name|gtkW_table_add_button
argument_list|(
name|table
argument_list|,
literal|"Plot the graph of the settings"
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
name|index
operator|++
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|function_graph_new
argument_list|,
name|chank
argument_list|)
expr_stmt|;
return|return
name|subframe
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|CML_dialog_advanced_panel_new (GtkWidget * parent,guchar * name)
name|CML_dialog_advanced_panel_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|subframe
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|subtable
decl_stmt|;
name|gint
name|index
init|=
literal|0
decl_stmt|;
name|gint
name|widget_offset
init|=
literal|12
decl_stmt|;
name|gint
name|channel_id
decl_stmt|;
name|guchar
modifier|*
name|ch_name
index|[]
init|=
block|{
literal|"Hue"
block|,
literal|"Saturation"
block|,
literal|"Value"
block|}
decl_stmt|;
name|CML_PARAM
modifier|*
name|param
decl_stmt|;
name|frame
operator|=
name|gtkW_frame_new
argument_list|(
name|parent
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtkW_table_new
argument_list|(
name|frame
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|)
expr_stmt|;
for|for
control|(
name|channel_id
operator|=
literal|0
init|;
name|channel_id
operator|<
literal|3
condition|;
name|channel_id
operator|++
control|)
block|{
name|param
operator|=
operator|(
name|CML_PARAM
operator|*
operator|)
operator|&
name|VALS
operator|+
name|channel_id
expr_stmt|;
name|subframe
operator|=
name|gtkW_frame_new
argument_list|(
name|NULL
argument_list|,
name|ch_name
index|[
name|channel_id
index|]
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|subframe
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|channel_id
argument_list|,
name|channel_id
operator|+
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|subtable
operator|=
name|gtkW_table_new
argument_list|(
name|subframe
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|index
operator|=
literal|0
expr_stmt|;
name|gtkW_table_add_dscale_entry
argument_list|(
name|subtable
argument_list|,
literal|"Ch. sensitivity"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dentry_update
argument_list|,
operator|&
name|param
operator|->
name|ch_sensitivity
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
operator|+
name|widget_offset
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_dscale_entry
argument_list|(
name|subtable
argument_list|,
literal|"Mutation rate"
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dentry_update
argument_list|,
operator|&
name|param
operator|->
name|mutation_rate
argument_list|,
literal|0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
operator|+
name|widget_offset
index|]
argument_list|)
expr_stmt|;
name|index
operator|++
expr_stmt|;
name|gtkW_table_add_dscale_entry
argument_list|(
name|subtable
argument_list|,
literal|"Mutation dist."
argument_list|,
literal|0
argument_list|,
name|index
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dscale_update
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_dentry_update
argument_list|,
operator|&
name|param
operator|->
name|mutation_dist
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
operator|&
name|widget_pointers
index|[
name|channel_id
index|]
index|[
name|index
operator|+
name|widget_offset
index|]
argument_list|)
expr_stmt|;
block|}
return|return
name|frame
return|;
block|}
end_function

begin_function
name|void
DECL|function|preview_update ()
name|preview_update
parameter_list|()
block|{
if|if
condition|(
name|CML_preview_defer
operator|==
name|FALSE
condition|)
name|MAIN_FUNCTION
argument_list|(
name|TRUE
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|function_graph_new (GtkWidget * widget,gpointer data)
name|function_graph_new
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|dlg
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|preview
decl_stmt|;
name|gint
name|channel_id
init|=
operator|*
operator|(
name|int
operator|*
operator|)
name|data
decl_stmt|;
name|CML_PARAM
modifier|*
name|param
init|=
operator|(
name|CML_PARAM
operator|*
operator|)
operator|*
operator|(
operator|(
name|gpointer
operator|*
operator|)
name|data
operator|+
literal|1
operator|)
decl_stmt|;
name|dlg
operator|=
name|gtk_dialog_new
argument_list|()
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"Graph of the current settings"
argument_list|)
expr_stmt|;
name|gtk_window_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_close_callback
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/* Action Area */
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"OK"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtk_widget_destroy
argument_list|,
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_grab_default
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtkW_frame_new
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|,
literal|"The Graph"
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtkW_vbox_new
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|preview
operator|=
name|gtk_preview_new
argument_list|(
name|GTK_PREVIEW_COLOR
argument_list|)
expr_stmt|;
name|gtk_preview_size
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|preview
argument_list|)
argument_list|,
literal|256
argument_list|,
literal|256
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|preview
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
block|{
name|int
name|x
decl_stmt|,
name|y
decl_stmt|,
name|last_y
decl_stmt|,
name|yy
decl_stmt|;
name|guchar
name|rgbc
index|[
literal|3
index|]
decl_stmt|;
name|int
name|rgbi
index|[
literal|3
index|]
decl_stmt|;
name|guchar
name|black
index|[]
init|=
block|{
literal|0
block|,
literal|0
block|,
literal|0
block|}
decl_stmt|;
name|guchar
name|white
index|[]
init|=
block|{
literal|255
block|,
literal|255
block|,
literal|255
block|}
decl_stmt|;
for|for
control|(
name|x
operator|=
literal|0
init|;
name|x
operator|<
literal|256
condition|;
name|x
operator|++
control|)
block|{
DECL|macro|FAST_AND_FULLCOLOR
define|#
directive|define
name|FAST_AND_FULLCOLOR
value|1
ifdef|#
directive|ifdef
name|FAST_AND_FULLCOLOR
comment|/* hue */
name|rgbi
index|[
literal|0
index|]
operator|=
name|rgbi
index|[
literal|1
index|]
operator|=
name|rgbi
index|[
literal|2
index|]
operator|=
literal|127
expr_stmt|;
if|if
condition|(
operator|(
literal|0
operator|<=
name|channel_id
operator|)
operator|&&
operator|(
name|channel_id
operator|<=
literal|2
operator|)
condition|)
name|rgbi
index|[
name|channel_id
index|]
operator|=
name|CANNONIZE
argument_list|(
operator|(
operator|*
name|param
operator|)
argument_list|,
operator|(
operator|(
name|gdouble
operator|)
name|x
operator|/
operator|(
name|gdouble
operator|)
literal|255
operator|)
argument_list|)
expr_stmt|;
name|hsv_to_rgb
argument_list|(
name|rgbi
argument_list|,
name|rgbi
operator|+
literal|1
argument_list|,
name|rgbi
operator|+
literal|2
argument_list|)
expr_stmt|;
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|<
literal|3
condition|;
name|y
operator|++
control|)
name|rgbc
index|[
name|y
index|]
operator|=
name|rgbi
index|[
name|y
index|]
expr_stmt|;
endif|#
directive|endif
for|for
control|(
name|y
operator|=
literal|0
init|;
name|y
operator|<
literal|256
condition|;
name|y
operator|++
control|)
name|gtk_preview_draw_row
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|preview
argument_list|)
argument_list|,
ifdef|#
directive|ifdef
name|FAST_AND_FULLCOLOR
name|rgbc
argument_list|,
else|#
directive|else
name|white
argument_list|,
endif|#
directive|endif
name|x
argument_list|,
name|y
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
name|y
operator|=
literal|255
operator|*
name|CLAMP
argument_list|(
name|logistic_function
argument_list|(
name|param
argument_list|,
name|x
operator|/
operator|(
name|gdouble
operator|)
literal|255
argument_list|,
name|param
operator|->
name|power
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1.0
argument_list|)
expr_stmt|;
for|for
control|(
name|x
operator|=
literal|0
init|;
name|x
operator|<
literal|256
condition|;
name|x
operator|++
control|)
block|{
name|last_y
operator|=
name|y
expr_stmt|;
comment|/* curve */
name|gtk_preview_draw_row
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|preview
argument_list|)
argument_list|,
name|white
argument_list|,
name|x
argument_list|,
literal|255
operator|-
name|x
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|y
operator|=
literal|255
operator|*
name|CLAMP
argument_list|(
name|logistic_function
argument_list|(
name|param
argument_list|,
name|x
operator|/
operator|(
name|gdouble
operator|)
literal|255
argument_list|,
name|param
operator|->
name|power
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1.0
argument_list|)
expr_stmt|;
for|for
control|(
name|yy
operator|=
name|MIN
argument_list|(
name|y
argument_list|,
name|last_y
argument_list|)
init|;
name|yy
operator|<=
name|MAX
argument_list|(
name|y
argument_list|,
name|last_y
argument_list|)
condition|;
name|yy
operator|++
control|)
name|gtk_preview_draw_row
argument_list|(
name|GTK_PREVIEW
argument_list|(
name|preview
argument_list|)
argument_list|,
name|black
argument_list|,
name|x
argument_list|,
literal|255
operator|-
name|yy
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
block|}
name|gtk_widget_show
argument_list|(
name|preview
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|gtk_main
argument_list|()
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_set_or_randomize_seed_callback (GtkWidget * widget,gpointer data)
name|CML_set_or_randomize_seed_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|CML_preview_defer
operator|=
name|TRUE
expr_stmt|;
switch|switch
condition|(
name|VALS
operator|.
name|initial_value
condition|)
block|{
case|case
name|CML_INITIAL_RANDOM_INDEPENDENT
case|:
name|VALS
operator|.
name|initial_value
operator|=
name|CML_INITIAL_RANDOM_FROM_SEED
expr_stmt|;
break|break;
case|case
name|CML_INITIAL_RANDOM_SHARED
case|:
name|VALS
operator|.
name|initial_value
operator|=
name|CML_INITIAL_RANDOM_FROM_SEED_SHARED
expr_stmt|;
break|break;
case|case
name|CML_INITIAL_RANDOM_FROM_SEED
case|:
name|VALS
operator|.
name|initial_value
operator|=
name|CML_INITIAL_RANDOM_INDEPENDENT
expr_stmt|;
break|break;
case|case
name|CML_INITIAL_RANDOM_FROM_SEED_SHARED
case|:
name|VALS
operator|.
name|initial_value
operator|=
name|CML_INITIAL_RANDOM_SHARED
expr_stmt|;
break|break;
default|default:
break|break;
block|}
if|if
condition|(
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|3
index|]
operator|.
name|widget
operator|&&
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|3
index|]
operator|.
name|updater
condition|)
operator|(
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|3
index|]
operator|.
name|updater
operator|)
operator|(
name|widget_pointers
index|[
literal|3
index|]
operator|+
literal|3
operator|)
expr_stmt|;
if|if
condition|(
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|0
index|]
operator|.
name|widget
operator|&&
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|0
index|]
operator|.
name|updater
condition|)
operator|(
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|0
index|]
operator|.
name|updater
operator|)
operator|(
name|widget_pointers
index|[
literal|3
index|]
operator|)
expr_stmt|;
name|CML_initial_value_sensitives_update
argument_list|()
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
name|CML_preview_defer
operator|=
name|FALSE
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_copy_parameters_callback (GtkWidget * widget,gpointer data)
name|CML_copy_parameters_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|int
name|index
decl_stmt|;
name|gtkW_widget_table
modifier|*
name|widgets
decl_stmt|;
if|if
condition|(
name|copy_source
operator|==
name|copy_destination
condition|)
block|{
name|gtkW_message_dialog
argument_list|(
name|TRUE
argument_list|,
literal|"Warning: the source and the destination are the same channel."
argument_list|)
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
return|return;
block|}
name|bcopy
argument_list|(
name|channel_menu
index|[
name|copy_source
index|]
operator|.
name|data
argument_list|,
name|channel_menu
index|[
name|copy_destination
index|]
operator|.
name|data
argument_list|,
sizeof|sizeof
argument_list|(
name|CML_PARAM
argument_list|)
argument_list|)
expr_stmt|;
name|CML_preview_defer
operator|=
name|TRUE
expr_stmt|;
name|widgets
operator|=
name|widget_pointers
index|[
name|copy_destination
index|]
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|0
init|;
name|index
operator|<
name|CML_PARAM_NUM
condition|;
name|index
operator|++
control|)
if|if
condition|(
name|widgets
index|[
name|index
index|]
operator|.
name|widget
operator|&&
name|widgets
index|[
name|index
index|]
operator|.
name|updater
condition|)
operator|(
name|widgets
index|[
name|index
index|]
operator|.
name|updater
operator|)
operator|(
name|widgets
operator|+
name|index
operator|)
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
name|CML_preview_defer
operator|=
name|FALSE
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
comment|/* gtk_main_quit (); */
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_menu_update (GtkWidget * widget,gpointer data)
name|CML_menu_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gint
modifier|*
modifier|*
name|buffer
init|=
operator|(
name|gint
operator|*
operator|*
operator|)
name|data
decl_stmt|;
if|if
condition|(
operator|*
name|buffer
index|[
literal|1
index|]
operator|!=
operator|(
name|gint
operator|)
name|buffer
index|[
literal|2
index|]
condition|)
block|{
operator|*
name|buffer
index|[
literal|1
index|]
operator|=
operator|(
name|gint
operator|)
name|buffer
index|[
literal|2
index|]
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_initial_value_sensitives_update ()
name|CML_initial_value_sensitives_update
parameter_list|()
block|{
name|gint
name|i
init|=
literal|0
decl_stmt|;
name|gint
name|flag1
decl_stmt|,
name|flag2
decl_stmt|;
name|flag1
operator|=
operator|(
name|CML_INITIAL_RANDOM_INDEPENDENT
operator|<=
name|VALS
operator|.
name|initial_value
operator|)
operator|&
operator|(
name|VALS
operator|.
name|initial_value
operator|<=
name|CML_INITIAL_RANDOM_FROM_SEED_SHARED
operator|)
expr_stmt|;
name|flag2
operator|=
operator|(
name|CML_INITIAL_RANDOM_INDEPENDENT
operator|<=
name|VALS
operator|.
name|initial_value
operator|)
operator|&
operator|(
name|VALS
operator|.
name|initial_value
operator|<=
name|CML_INITIAL_RANDOM_SHARED
operator|)
expr_stmt|;
for|for
control|(
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|random_sensitives
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|random_sensitives
index|[
literal|0
index|]
argument_list|)
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|random_sensitives
index|[
name|i
index|]
operator|.
name|widget
condition|)
name|gtk_widget_set_sensitive
argument_list|(
name|random_sensitives
index|[
name|i
index|]
operator|.
name|widget
argument_list|,
name|flag1
operator|&
operator|(
name|random_sensitives
index|[
name|i
index|]
operator|.
name|logic
operator|==
name|flag2
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_initial_value_menu_update (GtkWidget * widget,gpointer data)
name|CML_initial_value_menu_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gint
modifier|*
modifier|*
name|buffer
init|=
operator|(
name|gint
operator|*
operator|*
operator|)
name|data
decl_stmt|;
if|if
condition|(
operator|*
name|buffer
index|[
literal|1
index|]
operator|!=
operator|(
name|gint
operator|)
name|buffer
index|[
literal|2
index|]
condition|)
block|{
operator|*
name|buffer
index|[
literal|1
index|]
operator|=
operator|(
name|gint
operator|)
name|buffer
index|[
literal|2
index|]
expr_stmt|;
name|CML_initial_value_sensitives_update
argument_list|()
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|OK_CALLBACK (GtkWidget * widget,gpointer data)
name|OK_CALLBACK
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|INTERFACE
operator|.
name|run
operator|=
name|TRUE
expr_stmt|;
ifdef|#
directive|ifdef
name|INTERACTIVE_DIALOG
name|MAIN_FUNCTION
argument_list|(
name|FALSE
argument_list|)
expr_stmt|;
endif|#
directive|endif
name|gtk_widget_destroy
argument_list|(
name|GTK_WIDGET
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_ifdef
ifdef|#
directive|ifdef
name|INTERACTIVE_DIALOG
end_ifdef

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|CML_dialog_new (char * name,GtkSignalFunc execute_callback,GtkSignalFunc ok_callback,GtkSignalFunc close_callback)
name|CML_dialog_new
parameter_list|(
name|char
modifier|*
name|name
parameter_list|,
name|GtkSignalFunc
name|execute_callback
parameter_list|,
name|GtkSignalFunc
name|ok_callback
parameter_list|,
name|GtkSignalFunc
name|close_callback
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|dlg
decl_stmt|,
modifier|*
name|button
decl_stmt|;
name|dlg
operator|=
name|gtk_dialog_new
argument_list|()
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|gtk_window_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|close_callback
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/* Action Area */
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"Execute"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|execute_callback
argument_list|,
name|dlg
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_grab_default
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"Execute and Exit"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|ok_callback
argument_list|,
name|dlg
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"Exit"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtk_widget_destroy
argument_list|,
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
return|return
name|dlg
return|;
block|}
end_function

begin_endif
endif|#
directive|endif
end_endif

begin_function
specifier|static
name|void
DECL|function|CML_save_to_file_callback (GtkWidget * widget,gpointer client_data)
name|CML_save_to_file_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|filesel
decl_stmt|;
name|filesel
operator|=
name|gtk_file_selection_new
argument_list|(
literal|"Save parameters to"
argument_list|)
expr_stmt|;
name|gtk_window_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|filesel
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|filesel
argument_list|)
operator|->
name|ok_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_execute_save_to_file
argument_list|,
name|filesel
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|filesel
argument_list|)
operator|->
name|cancel_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtk_widget_destroy
argument_list|,
name|GTK_OBJECT
argument_list|(
name|GTK_WINDOW
argument_list|(
name|filesel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|strlen
argument_list|(
name|VALS
operator|.
name|last_file_name
argument_list|)
operator|>
literal|0
condition|)
name|gtk_file_selection_set_filename
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|filesel
argument_list|)
argument_list|,
name|VALS
operator|.
name|last_file_name
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|filesel
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_execute_save_to_file (GtkWidget * widget,gpointer client_data)
name|CML_execute_save_to_file
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|char
modifier|*
name|filename
decl_stmt|;
name|struct
name|stat
name|buf
decl_stmt|;
name|FILE
modifier|*
name|file
init|=
name|NULL
decl_stmt|;
name|int
name|channel_id
decl_stmt|;
name|int
name|err
decl_stmt|;
name|filename
operator|=
name|gtk_file_selection_get_filename
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|client_data
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|filename
condition|)
return|return;
name|err
operator|=
name|stat
argument_list|(
name|filename
argument_list|,
operator|&
name|buf
argument_list|)
expr_stmt|;
comment|/* returns zero if success */
if|if
condition|(
operator|(
name|err
operator|==
literal|0
operator|)
operator|||
operator|(
name|errno
operator|==
name|ENOENT
operator|)
condition|)
block|{
if|if
condition|(
name|errno
operator|==
name|ENOENT
condition|)
name|file
operator|=
name|fopen
argument_list|(
name|filename
argument_list|,
literal|"w"
argument_list|)
expr_stmt|;
elseif|else
if|if
condition|(
name|buf
operator|.
name|st_mode
operator|&
name|S_IFDIR
condition|)
block|{
name|GString
modifier|*
name|s
init|=
name|g_string_new
argument_list|(
name|filename
argument_list|)
decl_stmt|;
if|if
condition|(
name|filename
index|[
name|strlen
argument_list|(
name|filename
argument_list|)
operator|-
literal|1
index|]
operator|!=
literal|'/'
condition|)
name|g_string_append_c
argument_list|(
name|s
argument_list|,
literal|'/'
argument_list|)
expr_stmt|;
name|gtk_file_selection_set_filename
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|client_data
argument_list|)
argument_list|,
name|s
operator|->
name|str
argument_list|)
expr_stmt|;
name|g_string_free
argument_list|(
name|s
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
return|return;
block|}
elseif|else
if|if
condition|(
name|buf
operator|.
name|st_mode
operator|&
name|S_IFREG
condition|)
comment|/* already exists */
ifdef|#
directive|ifdef
name|VERBOSE_DIALOGS
if|if
condition|(
operator|!
name|force_overwrite
argument_list|(
name|filename
argument_list|)
condition|)
return|return;
else|else
name|file
operator|=
name|fopen
argument_list|(
name|filename
argument_list|,
literal|"w"
argument_list|)
expr_stmt|;
else|#
directive|else
name|file
operator|=
name|fopen
argument_list|(
name|filename
argument_list|,
literal|"w"
argument_list|)
expr_stmt|;
endif|#
directive|endif
block|}
if|if
condition|(
operator|(
name|err
operator|!=
literal|0
operator|)
operator|&&
operator|(
name|file
operator|==
name|NULL
operator|)
condition|)
block|{
name|guchar
name|buffer
index|[
name|CML_LINE_SIZE
index|]
decl_stmt|;
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"Error: could not open \"%s\""
argument_list|,
name|filename
argument_list|)
expr_stmt|;
name|gtkW_message_dialog
argument_list|(
name|TRUE
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
return|return;
block|}
else|else
block|{
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"; This is a parameter file for CML_explorer\n"
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"; File format version: %1.1f\n"
argument_list|,
name|PARAM_FILE_FORMAT_VERSION
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|";\n"
argument_list|)
expr_stmt|;
for|for
control|(
name|channel_id
operator|=
literal|0
init|;
name|channel_id
operator|<
literal|3
condition|;
name|channel_id
operator|++
control|)
block|{
name|CML_PARAM
name|param
init|=
operator|*
operator|(
name|CML_PARAM
operator|*
operator|)
operator|(
name|channel_menu
index|[
name|channel_id
index|]
operator|.
name|data
operator|)
decl_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"\t%s\n"
argument_list|,
name|channel_menu
index|[
name|channel_id
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Function_type    : %d (%s)\n"
argument_list|,
name|param
operator|.
name|function
argument_list|,
name|function_menu
index|[
name|param
operator|.
name|function
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Compostion_type  : %d (%s)\n"
argument_list|,
name|param
operator|.
name|composition
argument_list|,
name|composition_menu
index|[
name|param
operator|.
name|composition
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Arrange          : %d (%s)\n"
argument_list|,
name|param
operator|.
name|arrange
argument_list|,
name|arrange_menu
index|[
name|param
operator|.
name|arrange
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Cyclic_range     : %d (%s)\n"
argument_list|,
name|param
operator|.
name|cyclic_range
argument_list|,
operator|(
name|param
operator|.
name|cyclic_range
condition|?
literal|"TRUE"
else|:
literal|"FALSE"
operator|)
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Mod. rate        : %f\n"
argument_list|,
name|param
operator|.
name|mod_rate
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Env_sensitivtiy  : %f\n"
argument_list|,
name|param
operator|.
name|env_sensitivity
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Diffusion dist.  : %d\n"
argument_list|,
name|param
operator|.
name|diffusion_dist
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Ch. sensitivity  : %f\n"
argument_list|,
name|param
operator|.
name|ch_sensitivity
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Num. of Subranges: %d\n"
argument_list|,
name|param
operator|.
name|range_num
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Power_factor     : %f\n"
argument_list|,
name|param
operator|.
name|power
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Parameter_k      : %f\n"
argument_list|,
name|param
operator|.
name|parameter_k
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Range_low        : %f\n"
argument_list|,
name|param
operator|.
name|range_l
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Range_high       : %f\n"
argument_list|,
name|param
operator|.
name|range_h
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Mutation_rate    : %f\n"
argument_list|,
name|param
operator|.
name|mutation_rate
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Mutation_distance: %f\n"
argument_list|,
name|param
operator|.
name|mutation_dist
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"\n"
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Initial value  : %d (%s)\n"
argument_list|,
name|VALS
operator|.
name|initial_value
argument_list|,
name|initial_value_menu
index|[
name|VALS
operator|.
name|initial_value
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Zoom scale     : %d\n"
argument_list|,
name|VALS
operator|.
name|scale
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Start offset   : %d\n"
argument_list|,
name|VALS
operator|.
name|start_offset
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"Random seed    : %d\n"
argument_list|,
name|VALS
operator|.
name|seed
argument_list|)
expr_stmt|;
name|fclose
argument_list|(
name|file
argument_list|)
expr_stmt|;
ifdef|#
directive|ifdef
name|VERBOSE_DIALOGS
block|{
name|guchar
name|buffer
index|[
name|CML_LINE_SIZE
index|]
decl_stmt|;
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"Parameters were saved to \"%s\""
argument_list|,
name|filename
argument_list|)
expr_stmt|;
name|gtkW_message_dialog
argument_list|(
name|TRUE
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
block|}
endif|#
directive|endif
if|if
condition|(
sizeof|sizeof
argument_list|(
name|VALS
operator|.
name|last_file_name
argument_list|)
operator|<=
name|strlen
argument_list|(
name|filename
argument_list|)
condition|)
name|filename
index|[
sizeof|sizeof
argument_list|(
name|VALS
operator|.
name|last_file_name
argument_list|)
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
name|strcpy
argument_list|(
name|VALS
operator|.
name|last_file_name
argument_list|,
name|filename
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_destroy
argument_list|(
name|GTK_WIDGET
argument_list|(
name|client_data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|force_overwrite (char * filename)
name|force_overwrite
parameter_list|(
name|char
modifier|*
name|filename
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|dlg
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|guchar
name|buffer
index|[
name|CML_LINE_SIZE
index|]
decl_stmt|;
name|gint
name|tmp
decl_stmt|;
name|dlg
operator|=
name|gtkW_dialog_new
argument_list|(
literal|"CML file operation warning"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_overwrite_ok_callback
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_close_callback
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtkW_table_new
argument_list|(
name|NULL
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"%s exists, overwrite?"
argument_list|,
name|filename
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|buffer
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|gtk_main
argument_list|()
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
name|tmp
operator|=
name|overwritable
expr_stmt|;
name|overwritable
operator|=
literal|0
expr_stmt|;
return|return
name|tmp
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_overwrite_ok_callback (GtkWidget * widget,gpointer data)
name|CML_overwrite_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|overwritable
operator|=
literal|1
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|GTK_WIDGET
argument_list|(
name|data
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_preview_update_callback (GtkWidget * widget,gpointer data)
name|CML_preview_update_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gtkW_widget_table
name|seed_widget
init|=
name|widget_pointers
index|[
literal|3
index|]
index|[
literal|3
index|]
decl_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
name|CML_preview_defer
operator|=
name|TRUE
expr_stmt|;
if|if
condition|(
name|seed_widget
operator|.
name|widget
operator|&&
name|seed_widget
operator|.
name|updater
condition|)
call|(
name|seed_widget
operator|.
name|updater
call|)
argument_list|(
operator|&
name|seed_widget
argument_list|)
expr_stmt|;
name|CML_preview_defer
operator|=
name|FALSE
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_load_from_file_callback (GtkWidget * widget,gpointer client_data)
name|CML_load_from_file_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|filesel
decl_stmt|;
if|if
condition|(
operator|(
name|selective_load_source
operator|==
literal|0
operator|)
operator|||
operator|(
name|selective_load_destination
operator|==
literal|0
operator|)
condition|)
name|filesel
operator|=
name|gtk_file_selection_new
argument_list|(
literal|"Load parameters from"
argument_list|)
expr_stmt|;
else|else
name|filesel
operator|=
name|gtk_file_selection_new
argument_list|(
literal|"Selective load from"
argument_list|)
expr_stmt|;
name|gtk_window_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|filesel
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|filesel
argument_list|)
operator|->
name|ok_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|CML_execute_load_from_file
argument_list|,
name|filesel
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|filesel
argument_list|)
operator|->
name|cancel_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtk_widget_destroy
argument_list|,
name|GTK_OBJECT
argument_list|(
name|GTK_WINDOW
argument_list|(
name|filesel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|strlen
argument_list|(
name|VALS
operator|.
name|last_file_name
argument_list|)
operator|>
literal|0
condition|)
name|gtk_file_selection_set_filename
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|filesel
argument_list|)
argument_list|,
name|VALS
operator|.
name|last_file_name
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|filesel
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|CML_execute_load_from_file (GtkWidget * widget,gpointer client_data)
name|CML_execute_load_from_file
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|client_data
parameter_list|)
block|{
name|char
modifier|*
name|filename
decl_stmt|;
name|int
name|channel_id
decl_stmt|;
name|int
name|flag
init|=
name|TRUE
decl_stmt|;
name|filename
operator|=
name|gtk_file_selection_get_filename
argument_list|(
name|GTK_FILE_SELECTION
argument_list|(
name|client_data
argument_list|)
argument_list|)
expr_stmt|;
name|flag
operator|=
name|CML_load_parameter_file
argument_list|(
name|filename
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|GTK_WIDGET
argument_list|(
name|client_data
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|flag
condition|)
block|{
name|int
name|index
decl_stmt|;
name|gtkW_widget_table
modifier|*
name|widgets
decl_stmt|;
name|CML_preview_defer
operator|=
name|TRUE
expr_stmt|;
for|for
control|(
name|channel_id
operator|=
literal|0
init|;
name|channel_id
operator|<
literal|3
condition|;
name|channel_id
operator|++
control|)
block|{
name|widgets
operator|=
name|widget_pointers
index|[
name|channel_id
index|]
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|0
init|;
name|index
operator|<
name|CML_PARAM_NUM
condition|;
name|index
operator|++
control|)
if|if
condition|(
name|widgets
index|[
name|index
index|]
operator|.
name|widget
operator|&&
name|widgets
index|[
name|index
index|]
operator|.
name|updater
condition|)
operator|(
name|widgets
index|[
name|index
index|]
operator|.
name|updater
operator|)
operator|(
name|widgets
operator|+
name|index
operator|)
expr_stmt|;
block|}
comment|/* channel independent parameters */
name|widgets
operator|=
name|widget_pointers
index|[
literal|3
index|]
expr_stmt|;
for|for
control|(
name|index
operator|=
literal|0
init|;
name|index
operator|<
literal|4
condition|;
name|index
operator|++
control|)
if|if
condition|(
name|widgets
index|[
name|index
index|]
operator|.
name|widget
operator|&&
name|widgets
index|[
name|index
index|]
operator|.
name|updater
condition|)
operator|(
name|widgets
index|[
name|index
index|]
operator|.
name|updater
operator|)
operator|(
name|widgets
operator|+
name|index
operator|)
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
name|CML_preview_defer
operator|=
name|FALSE
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|CML_load_parameter_file (guchar * filename,gint interactive_mode)
name|CML_load_parameter_file
parameter_list|(
name|guchar
modifier|*
name|filename
parameter_list|,
name|gint
name|interactive_mode
parameter_list|)
block|{
name|FILE
modifier|*
name|file
decl_stmt|;
name|int
name|channel_id
decl_stmt|;
name|int
name|flag
init|=
name|TRUE
decl_stmt|;
name|CML_PARAM
name|ch
index|[
literal|3
index|]
decl_stmt|;
name|gint
name|initial_value
init|=
literal|0
decl_stmt|;
name|gint
name|scale
init|=
literal|1
decl_stmt|;
name|gint
name|start_offset
init|=
literal|0
decl_stmt|;
name|gint
name|seed
init|=
literal|0
decl_stmt|;
name|gint
name|old2new_function_id
index|[]
init|=
block|{
literal|3
block|,
literal|4
block|,
literal|5
block|,
literal|6
block|,
literal|7
block|,
literal|9
block|,
literal|10
block|,
literal|11
block|,
literal|1
block|,
literal|2
block|}
decl_stmt|;
name|file
operator|=
name|fopen
argument_list|(
name|filename
argument_list|,
literal|"r"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|file
condition|)
block|{
name|guchar
name|buffer
index|[
name|CML_LINE_SIZE
index|]
decl_stmt|;
if|if
condition|(
name|interactive_mode
condition|)
block|{
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"Error: could not open \"%s\""
argument_list|,
name|filename
argument_list|)
expr_stmt|;
name|gtkW_message_dialog
argument_list|(
name|TRUE
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
block|}
return|return
name|FALSE
return|;
block|}
else|else
block|{
name|guchar
name|line
index|[
name|CML_LINE_SIZE
index|]
decl_stmt|;
name|gdouble
name|version
init|=
literal|0.99
decl_stmt|;
name|version
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
comment|/* old format returns 1 */
if|if
condition|(
name|version
operator|==
literal|1.0
condition|)
name|version
operator|=
literal|0.99
expr_stmt|;
elseif|else
if|if
condition|(
operator|!
name|flag
condition|)
block|{
name|flag
operator|=
name|TRUE
expr_stmt|;
name|version
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
comment|/* maybe new format */
if|if
condition|(
name|flag
condition|)
name|fgets
argument_list|(
name|line
argument_list|,
name|CML_LINE_SIZE
operator|-
literal|1
argument_list|,
name|file
argument_list|)
expr_stmt|;
comment|/* one more comment line */
block|}
if|if
condition|(
name|version
operator|==
literal|0
condition|)
block|{
if|if
condition|(
name|interactive_mode
condition|)
name|gtkW_message_dialog
argument_list|(
name|TRUE
argument_list|,
literal|"Error: it's not CML parameter file."
argument_list|)
expr_stmt|;
name|fclose
argument_list|(
name|file
argument_list|)
expr_stmt|;
return|return
name|FALSE
return|;
block|}
if|if
condition|(
name|interactive_mode
condition|)
block|{
if|if
condition|(
name|version
operator|<
name|PARAM_FILE_FORMAT_VERSION
condition|)
name|gtkW_message_dialog
argument_list|(
name|TRUE
argument_list|,
literal|"Warning: it's an old format file."
argument_list|)
expr_stmt|;
if|if
condition|(
name|PARAM_FILE_FORMAT_VERSION
operator|<
name|version
condition|)
name|gtkW_message_dialog
argument_list|(
name|TRUE
argument_list|,
literal|"Warning: Hmmm, it's a parameter file for newer CML_explorer than me."
argument_list|)
expr_stmt|;
block|}
for|for
control|(
name|channel_id
operator|=
literal|0
init|;
name|flag
operator|&&
operator|(
name|channel_id
operator|<
literal|3
operator|)
condition|;
name|channel_id
operator|++
control|)
block|{
comment|/* patched by Tim Mooney<mooney@dogbert.cc.ndsu.NoDak.edu> */
if|if
condition|(
name|fgets
argument_list|(
name|line
argument_list|,
name|CML_LINE_SIZE
operator|-
literal|1
argument_list|,
name|file
argument_list|)
operator|==
name|NULL
condition|)
comment|/* skip channel name */
block|{
name|flag
operator|=
name|FALSE
expr_stmt|;
break|break;
block|}
name|ch
index|[
name|channel_id
index|]
operator|.
name|function
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
if|if
condition|(
name|version
operator|<
literal|1.0
condition|)
name|ch
index|[
name|channel_id
index|]
operator|.
name|function
operator|=
name|old2new_function_id
index|[
name|ch
index|[
name|channel_id
index|]
operator|.
name|function
index|]
expr_stmt|;
if|if
condition|(
literal|1.0
operator|<=
name|version
condition|)
name|ch
index|[
name|channel_id
index|]
operator|.
name|composition
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
else|else
name|ch
index|[
name|channel_id
index|]
operator|.
name|composition
operator|=
name|COMP_NONE
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|arrange
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|cyclic_range
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|mod_rate
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|env_sensitivity
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
if|if
condition|(
literal|1.0
operator|<=
name|version
condition|)
name|ch
index|[
name|channel_id
index|]
operator|.
name|diffusion_dist
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
else|else
name|ch
index|[
name|channel_id
index|]
operator|.
name|diffusion_dist
operator|=
literal|2
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|ch_sensitivity
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|range_num
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|power
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|parameter_k
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|range_l
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|range_h
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|mutation_rate
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
name|ch
index|[
name|channel_id
index|]
operator|.
name|mutation_dist
operator|=
name|parse_line_to_gdouble
argument_list|(
name|file
argument_list|,
operator|&
name|flag
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|flag
condition|)
block|{
name|gint
name|dummy
decl_stmt|;
if|if
condition|(
name|fgets
argument_list|(
name|line
argument_list|,
name|CML_LINE_SIZE
operator|-
literal|1
argument_list|,
name|file
argument_list|)
operator|==
name|NULL
condition|)
comment|/* skip a line */
name|dummy
operator|=
literal|1
expr_stmt|;
else|else
block|{
name|initial_value
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|dummy
argument_list|)
expr_stmt|;
name|scale
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|dummy
argument_list|)
expr_stmt|;
name|start_offset
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|dummy
argument_list|)
expr_stmt|;
name|seed
operator|=
name|parse_line_to_gint
argument_list|(
name|file
argument_list|,
operator|&
name|dummy
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|dummy
condition|)
block|{
name|initial_value
operator|=
literal|0
expr_stmt|;
name|scale
operator|=
literal|1
expr_stmt|;
name|start_offset
operator|=
literal|0
expr_stmt|;
name|seed
operator|=
literal|0
expr_stmt|;
block|}
block|}
name|fclose
argument_list|(
name|file
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|flag
operator|==
name|FALSE
condition|)
block|{
if|if
condition|(
name|interactive_mode
condition|)
name|gtkW_message_dialog
argument_list|(
name|TRUE
argument_list|,
literal|"Error: failed to load paramters"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
operator|(
name|selective_load_source
operator|==
literal|0
operator|)
operator|||
operator|(
name|selective_load_destination
operator|==
literal|0
operator|)
condition|)
block|{
name|bcopy
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|ch
index|[
literal|0
index|]
argument_list|,
operator|&
operator|(
name|VALS
operator|.
name|hue
operator|)
argument_list|,
sizeof|sizeof
argument_list|(
name|CML_PARAM
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|ch
index|[
literal|1
index|]
argument_list|,
operator|&
operator|(
name|VALS
operator|.
name|sat
operator|)
argument_list|,
sizeof|sizeof
argument_list|(
name|CML_PARAM
argument_list|)
argument_list|)
expr_stmt|;
name|bcopy
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|ch
index|[
literal|2
index|]
argument_list|,
operator|&
operator|(
name|VALS
operator|.
name|val
operator|)
argument_list|,
sizeof|sizeof
argument_list|(
name|CML_PARAM
argument_list|)
argument_list|)
expr_stmt|;
name|VALS
operator|.
name|initial_value
operator|=
name|initial_value
expr_stmt|;
name|VALS
operator|.
name|scale
operator|=
name|scale
expr_stmt|;
name|VALS
operator|.
name|start_offset
operator|=
name|start_offset
expr_stmt|;
name|VALS
operator|.
name|seed
operator|=
name|seed
expr_stmt|;
block|}
else|else
block|{
name|bcopy
argument_list|(
operator|(
name|void
operator|*
operator|)
operator|&
name|ch
index|[
name|selective_load_source
operator|-
literal|1
index|]
argument_list|,
operator|(
name|CML_PARAM
operator|*
operator|)
operator|&
name|VALS
operator|+
operator|(
name|selective_load_destination
operator|-
literal|1
operator|)
argument_list|,
sizeof|sizeof
argument_list|(
name|CML_PARAM
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
sizeof|sizeof
argument_list|(
name|VALS
operator|.
name|last_file_name
argument_list|)
operator|<=
name|strlen
argument_list|(
name|filename
argument_list|)
condition|)
name|filename
index|[
sizeof|sizeof
argument_list|(
name|VALS
operator|.
name|last_file_name
argument_list|)
operator|-
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
name|strcpy
argument_list|(
name|VALS
operator|.
name|last_file_name
argument_list|,
name|filename
argument_list|)
expr_stmt|;
block|}
return|return
name|flag
return|;
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|parse_line_to_gint (FILE * file,gint * flag)
name|parse_line_to_gint
parameter_list|(
name|FILE
modifier|*
name|file
parameter_list|,
name|gint
modifier|*
name|flag
parameter_list|)
block|{
name|guchar
name|line
index|[
name|CML_LINE_SIZE
index|]
decl_stmt|;
name|guchar
modifier|*
name|str
decl_stmt|;
name|gint
name|value
decl_stmt|;
if|if
condition|(
operator|!
operator|*
name|flag
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|fgets
argument_list|(
name|line
argument_list|,
name|CML_LINE_SIZE
operator|-
literal|1
argument_list|,
name|file
argument_list|)
operator|==
name|NULL
condition|)
block|{
operator|*
name|flag
operator|=
name|FALSE
expr_stmt|;
comment|/* set FALSE if fail to parse */
return|return
literal|0
return|;
block|}
name|str
operator|=
operator|&
name|line
index|[
literal|0
index|]
expr_stmt|;
while|while
condition|(
operator|*
name|str
operator|!=
literal|':'
condition|)
if|if
condition|(
operator|*
name|str
operator|==
literal|'\000'
condition|)
block|{
operator|*
name|flag
operator|=
name|FALSE
expr_stmt|;
return|return
literal|0
return|;
block|}
else|else
name|str
operator|++
expr_stmt|;
name|value
operator|=
operator|(
name|gint
operator|)
name|atoi
argument_list|(
name|str
operator|+
literal|1
argument_list|)
expr_stmt|;
return|return
name|value
return|;
block|}
end_function

begin_function
specifier|static
name|gdouble
DECL|function|parse_line_to_gdouble (FILE * file,gint * flag)
name|parse_line_to_gdouble
parameter_list|(
name|FILE
modifier|*
name|file
parameter_list|,
name|gint
modifier|*
name|flag
parameter_list|)
block|{
name|guchar
name|line
index|[
name|CML_LINE_SIZE
index|]
decl_stmt|;
name|guchar
modifier|*
name|str
decl_stmt|;
name|gdouble
name|value
decl_stmt|;
if|if
condition|(
operator|!
operator|*
name|flag
condition|)
return|return
literal|0
return|;
if|if
condition|(
name|fgets
argument_list|(
name|line
argument_list|,
name|CML_LINE_SIZE
operator|-
literal|1
argument_list|,
name|file
argument_list|)
operator|==
name|NULL
condition|)
block|{
operator|*
name|flag
operator|=
name|FALSE
expr_stmt|;
comment|/* set FALSE if fail to parse */
return|return
literal|0
return|;
block|}
name|str
operator|=
operator|&
name|line
index|[
literal|0
index|]
expr_stmt|;
while|while
condition|(
operator|*
name|str
operator|!=
literal|':'
condition|)
if|if
condition|(
operator|*
name|str
operator|==
literal|'\000'
condition|)
block|{
operator|*
name|flag
operator|=
name|FALSE
expr_stmt|;
return|return
literal|0
return|;
block|}
else|else
name|str
operator|++
expr_stmt|;
name|value
operator|=
operator|(
name|gdouble
operator|)
name|atof
argument_list|(
name|str
operator|+
literal|1
argument_list|)
expr_stmt|;
return|return
name|value
return|;
block|}
end_function

begin_comment
comment|/* gtkW functions */
end_comment

begin_comment
comment|/* gtkW callback */
end_comment

begin_function
specifier|static
name|void
DECL|function|gtkW_close_callback (GtkWidget * widget,gpointer data)
name|gtkW_close_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gtk_main_quit
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_toggle_update (GtkWidget * widget,gpointer data)
name|gtkW_toggle_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|int
modifier|*
name|toggle_val
decl_stmt|;
name|toggle_val
operator|=
operator|(
name|int
operator|*
operator|)
name|data
expr_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
condition|)
operator|*
name|toggle_val
operator|=
name|TRUE
expr_stmt|;
else|else
operator|*
name|toggle_val
operator|=
name|FALSE
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_iscale_update (GtkAdjustment * adjustment,gpointer data)
name|gtkW_iscale_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|gchar
name|buffer
index|[
literal|32
index|]
decl_stmt|;
name|int
modifier|*
name|val
decl_stmt|;
name|val
operator|=
name|data
expr_stmt|;
if|if
condition|(
operator|*
name|val
operator|!=
operator|(
name|int
operator|)
name|adjustment
operator|->
name|value
condition|)
block|{
operator|*
name|val
operator|=
name|adjustment
operator|->
name|value
expr_stmt|;
name|entry
operator|=
name|gtk_object_get_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"%d"
argument_list|,
operator|(
name|int
operator|)
name|adjustment
operator|->
name|value
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_ientry_update (GtkWidget * widget,gpointer data)
name|gtkW_ientry_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|GtkAdjustment
modifier|*
name|adjustment
decl_stmt|;
name|int
name|new_val
decl_stmt|;
name|int
modifier|*
name|val
decl_stmt|;
name|val
operator|=
name|data
expr_stmt|;
name|new_val
operator|=
name|atoi
argument_list|(
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|widget
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|*
name|val
operator|!=
name|new_val
condition|)
block|{
name|adjustment
operator|=
name|gtk_object_get_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|new_val
operator|>=
name|adjustment
operator|->
name|lower
operator|)
operator|&&
operator|(
name|new_val
operator|<=
name|adjustment
operator|->
name|upper
operator|)
condition|)
block|{
operator|*
name|val
operator|=
name|new_val
expr_stmt|;
name|adjustment
operator|->
name|value
operator|=
name|new_val
expr_stmt|;
name|gtk_signal_emit_by_name
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|)
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_dscale_update (GtkAdjustment * adjustment,gpointer data)
name|gtkW_dscale_update
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|gchar
name|buffer
index|[
literal|32
index|]
decl_stmt|;
name|gdouble
modifier|*
name|val
decl_stmt|;
name|val
operator|=
name|data
expr_stmt|;
if|if
condition|(
name|GTKW_FLOAT_MIN_ERROR
operator|<
name|ABS
argument_list|(
operator|*
name|val
operator|-
operator|(
name|gdouble
operator|)
name|adjustment
operator|->
name|value
argument_list|)
condition|)
block|{
operator|*
name|val
operator|=
name|adjustment
operator|->
name|value
expr_stmt|;
name|entry
operator|=
name|gtk_object_get_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"%6f"
argument_list|,
operator|(
name|gdouble
operator|)
name|adjustment
operator|->
name|value
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_dentry_update (GtkWidget * widget,gpointer data)
name|gtkW_dentry_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|GtkAdjustment
modifier|*
name|adjustment
decl_stmt|;
name|gdouble
name|new_val
decl_stmt|;
name|gdouble
modifier|*
name|val
decl_stmt|;
name|val
operator|=
name|data
expr_stmt|;
name|new_val
operator|=
name|atof
argument_list|(
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|widget
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|GTKW_FLOAT_MIN_ERROR
operator|<
name|ABS
argument_list|(
operator|*
name|val
operator|-
name|new_val
argument_list|)
condition|)
block|{
name|adjustment
operator|=
name|gtk_object_get_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|(
name|new_val
operator|>=
name|adjustment
operator|->
name|lower
operator|)
operator|&&
operator|(
name|new_val
operator|<=
name|adjustment
operator|->
name|upper
operator|)
condition|)
block|{
operator|*
name|val
operator|=
name|new_val
expr_stmt|;
name|adjustment
operator|->
name|value
operator|=
name|new_val
expr_stmt|;
name|gtk_signal_emit_by_name
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|)
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_dscale_entry_change_value (gtkW_widget_table * wtable)
name|gtkW_dscale_entry_change_value
parameter_list|(
name|gtkW_widget_table
modifier|*
name|wtable
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|gchar
name|buffer
index|[
literal|32
index|]
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adjustment
init|=
operator|(
name|GtkAdjustment
operator|*
operator|)
operator|(
name|wtable
operator|->
name|widget
operator|)
decl_stmt|;
name|adjustment
operator|->
name|value
operator|=
operator|*
operator|(
name|gdouble
operator|*
operator|)
operator|(
name|wtable
operator|->
name|value
operator|)
expr_stmt|;
name|gtk_signal_emit_by_name
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|)
expr_stmt|;
name|entry
operator|=
name|gtk_object_get_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"%6f"
argument_list|,
operator|(
name|gdouble
operator|)
name|adjustment
operator|->
name|value
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_iscale_entry_change_value (gtkW_widget_table * wtable)
name|gtkW_iscale_entry_change_value
parameter_list|(
name|gtkW_widget_table
modifier|*
name|wtable
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|gchar
name|buffer
index|[
literal|32
index|]
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adjustment
init|=
operator|(
name|GtkAdjustment
operator|*
operator|)
operator|(
name|wtable
operator|->
name|widget
operator|)
decl_stmt|;
comment|/*  adustment->value is double, that is not precise to hold long interger. */
name|adjustment
operator|->
name|value
operator|=
operator|*
operator|(
name|gint
operator|*
operator|)
operator|(
name|wtable
operator|->
name|value
operator|)
expr_stmt|;
name|gtk_signal_emit_by_name
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|)
expr_stmt|;
name|entry
operator|=
name|gtk_object_get_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"%d"
argument_list|,
operator|(
name|gint
operator|)
name|adjustment
operator|->
name|value
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|preview_update
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_menu_change_value (gtkW_widget_table * wtable)
name|gtkW_menu_change_value
parameter_list|(
name|gtkW_widget_table
modifier|*
name|wtable
parameter_list|)
block|{
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|wtable
operator|->
name|widget
argument_list|)
argument_list|,
operator|*
operator|(
name|gint
operator|*
operator|)
operator|(
name|wtable
operator|->
name|value
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_menu_update (GtkWidget * widget,gpointer data)
name|gtkW_menu_update
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|gint
modifier|*
modifier|*
name|buffer
init|=
operator|(
name|gint
operator|*
operator|*
operator|)
name|data
decl_stmt|;
if|if
condition|(
operator|*
name|buffer
index|[
literal|1
index|]
operator|!=
operator|(
name|gint
operator|)
name|buffer
index|[
literal|2
index|]
condition|)
operator|*
name|buffer
index|[
literal|1
index|]
operator|=
operator|(
name|gint
operator|)
name|buffer
index|[
literal|2
index|]
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_toggle_change_value (gtkW_widget_table * wtable)
name|gtkW_toggle_change_value
parameter_list|(
name|gtkW_widget_table
modifier|*
name|wtable
parameter_list|)
block|{
name|gtk_toggle_button_set_state
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|wtable
operator|->
name|widget
argument_list|)
argument_list|,
operator|*
operator|(
name|gint
operator|*
operator|)
operator|(
name|wtable
operator|->
name|value
operator|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/* gtkW method */
end_comment

begin_function
name|GtkWidget
modifier|*
DECL|function|gtkW_check_button_new (GtkWidget * parent,guchar * name,GtkSignalFunc update,gint * value)
name|gtkW_check_button_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|GtkSignalFunc
name|update
parameter_list|,
name|gint
modifier|*
name|value
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|toggle
decl_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toggle
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|update
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_state
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
operator|*
name|value
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|parent
argument_list|)
argument_list|,
name|toggle
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
return|return
name|toggle
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_dialog_new (guchar * name,GtkSignalFunc ok_callback,GtkSignalFunc close_callback)
name|gtkW_dialog_new
parameter_list|(
name|guchar
modifier|*
name|name
parameter_list|,
name|GtkSignalFunc
name|ok_callback
parameter_list|,
name|GtkSignalFunc
name|close_callback
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|dlg
decl_stmt|,
modifier|*
name|button
decl_stmt|;
name|dlg
operator|=
name|gtk_dialog_new
argument_list|()
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|gtk_window_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|close_callback
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/* Action Area */
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"OK"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|ok_callback
argument_list|,
name|dlg
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_grab_default
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"Cancel"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtk_widget_destroy
argument_list|,
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
return|return
name|dlg
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_frame_new (GtkWidget * parent,guchar * name)
name|gtkW_frame_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|gtkW_frame_shadow_type
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|gtkW_border_width
argument_list|)
expr_stmt|;
if|if
condition|(
name|parent
operator|!=
name|NULL
condition|)
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|parent
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_hbox_new (GtkWidget * parent)
name|gtkW_hbox_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|gtkW_homogeneous_layout
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|gtkW_border_width
argument_list|)
expr_stmt|;
if|if
condition|(
name|parent
condition|)
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|parent
argument_list|)
argument_list|,
name|hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
return|return
name|hbox
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gtkW_message_dialog (gint gtk_was_initialized,guchar * message)
name|gtkW_message_dialog
parameter_list|(
name|gint
name|gtk_was_initialized
parameter_list|,
name|guchar
modifier|*
name|message
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|dlg
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|gchar
modifier|*
modifier|*
name|argv
decl_stmt|;
name|gint
name|argc
decl_stmt|;
if|if
condition|(
operator|!
name|gtk_was_initialized
condition|)
block|{
name|argc
operator|=
literal|1
expr_stmt|;
name|argv
operator|=
name|g_new
argument_list|(
name|gchar
operator|*
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|argv
index|[
literal|0
index|]
operator|=
name|g_strdup
argument_list|(
name|PLUG_IN_NAME
argument_list|)
expr_stmt|;
name|gtk_init
argument_list|(
operator|&
name|argc
argument_list|,
operator|&
name|argv
argument_list|)
expr_stmt|;
name|gtk_rc_parse
argument_list|(
name|gimp_gtkrc
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|dlg
operator|=
name|gtkW_message_dialog_new
argument_list|(
name|PLUG_IN_NAME
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtkW_table_new
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|message
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dlg
argument_list|)
expr_stmt|;
name|gtk_main
argument_list|()
expr_stmt|;
name|gdk_flush
argument_list|()
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_message_dialog_new (guchar * name)
name|gtkW_message_dialog_new
parameter_list|(
name|guchar
modifier|*
name|name
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|dlg
decl_stmt|,
modifier|*
name|button
decl_stmt|;
name|dlg
operator|=
name|gtk_dialog_new
argument_list|()
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
name|name
argument_list|)
expr_stmt|;
name|gtk_window_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dlg
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtkW_close_callback
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
comment|/* Action Area */
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
literal|"OK"
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|gtk_widget_destroy
argument_list|,
name|GTK_OBJECT
argument_list|(
name|dlg
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_grab_default
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
return|return
name|dlg
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_table_add_button (GtkWidget * table,gchar * name,gint x0,gint x1,gint y,GtkSignalFunc callback,gpointer value)
name|gtkW_table_add_button
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|gchar
modifier|*
name|name
parameter_list|,
name|gint
name|x0
parameter_list|,
name|gint
name|x1
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|callback
parameter_list|,
name|gpointer
name|value
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|button
argument_list|,
name|x0
argument_list|,
name|x1
argument_list|,
name|y
argument_list|,
name|y
operator|+
literal|1
argument_list|,
name|gtkW_align_x
argument_list|,
name|gtkW_align_y
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|callback
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
return|return
name|button
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_table_add_dscale_entry (GtkWidget * table,gchar * name,gint x,gint y,GtkSignalFunc scale_update,GtkSignalFunc entry_update,gdouble * value,gdouble min,gdouble max,gdouble step,gpointer widget_entry)
name|gtkW_table_add_dscale_entry
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|gchar
modifier|*
name|name
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|scale_update
parameter_list|,
name|GtkSignalFunc
name|entry_update
parameter_list|,
name|gdouble
modifier|*
name|value
parameter_list|,
name|gdouble
name|min
parameter_list|,
name|gdouble
name|max
parameter_list|,
name|gdouble
name|step
parameter_list|,
name|gpointer
name|widget_entry
parameter_list|)
block|{
name|GtkObject
modifier|*
name|adjustment
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|hbox
decl_stmt|,
modifier|*
name|scale
decl_stmt|,
modifier|*
name|entry
decl_stmt|;
name|guchar
modifier|*
name|buffer
decl_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
name|x
argument_list|,
name|x
operator|+
literal|1
argument_list|,
name|y
argument_list|,
name|y
operator|+
literal|1
argument_list|,
name|gtkW_align_x
argument_list|,
name|gtkW_align_y
argument_list|,
name|gtkW_border_width
argument_list|,
name|gtkW_border_height
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|x
operator|+
literal|1
argument_list|,
name|x
operator|+
literal|2
argument_list|,
name|y
argument_list|,
name|y
operator|+
literal|1
argument_list|,
name|gtkW_align_x
argument_list|,
name|gtkW_border_width
argument_list|,
name|gtkW_border_width
argument_list|,
name|gtkW_border_height
argument_list|)
expr_stmt|;
name|adjustment
operator|=
name|gtk_adjustment_new
argument_list|(
operator|*
name|value
argument_list|,
name|min
argument_list|,
name|max
argument_list|,
name|step
argument_list|,
name|step
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|scale
operator|=
name|gtk_hscale_new
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|adjustment
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|scale
argument_list|,
name|GTKW_SCALE_WIDTH
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|scale
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_scale_set_value_pos
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_scale_set_digits
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_UPDATE_DELAYED
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|scale_update
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
name|adjustment
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|adjustment
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|entry
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|entry
argument_list|,
name|GTKW_ENTRY_WIDTH
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|buffer
operator|=
operator|(
name|guchar
operator|*
operator|)
name|g_malloc
argument_list|(
name|GTKW_ENTRY_BUFFER_SIZE
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"%6f"
argument_list|,
operator|*
name|value
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
if|if
condition|(
name|widget_entry
condition|)
block|{
name|gtkW_widget_table
modifier|*
name|tentry
init|=
operator|(
name|gtkW_widget_table
operator|*
operator|)
name|widget_entry
decl_stmt|;
name|tentry
operator|->
name|widget
operator|=
operator|(
name|GtkWidget
operator|*
operator|)
name|adjustment
expr_stmt|;
name|tentry
operator|->
name|updater
operator|=
name|gtkW_dscale_entry_change_value
expr_stmt|;
name|tentry
operator|->
name|value
operator|=
name|value
expr_stmt|;
block|}
return|return
name|entry
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_table_add_iscale_entry (GtkWidget * table,gchar * name,gint x,gint y,GtkSignalFunc scale_update,GtkSignalFunc entry_update,gint * value,gdouble min,gdouble max,gdouble step,gpointer widget_entry)
name|gtkW_table_add_iscale_entry
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|gchar
modifier|*
name|name
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|scale_update
parameter_list|,
name|GtkSignalFunc
name|entry_update
parameter_list|,
name|gint
modifier|*
name|value
parameter_list|,
name|gdouble
name|min
parameter_list|,
name|gdouble
name|max
parameter_list|,
name|gdouble
name|step
parameter_list|,
name|gpointer
name|widget_entry
parameter_list|)
block|{
name|GtkObject
modifier|*
name|adjustment
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|hbox
decl_stmt|,
modifier|*
name|scale
decl_stmt|,
modifier|*
name|entry
decl_stmt|;
name|guchar
modifier|*
name|buffer
decl_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
name|x
argument_list|,
name|x
operator|+
literal|1
argument_list|,
name|y
argument_list|,
name|y
operator|+
literal|1
argument_list|,
name|gtkW_align_x
argument_list|,
name|gtkW_align_y
argument_list|,
name|gtkW_border_width
argument_list|,
name|gtkW_border_height
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|x
operator|+
literal|1
argument_list|,
name|x
operator|+
literal|2
argument_list|,
name|y
argument_list|,
name|y
operator|+
literal|1
argument_list|,
name|gtkW_align_x
argument_list|,
name|gtkW_align_y
argument_list|,
name|gtkW_border_width
argument_list|,
name|gtkW_border_height
argument_list|)
expr_stmt|;
name|adjustment
operator|=
name|gtk_adjustment_new
argument_list|(
operator|*
name|value
argument_list|,
name|min
argument_list|,
name|max
argument_list|,
name|step
argument_list|,
name|step
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|scale
operator|=
name|gtk_hscale_new
argument_list|(
name|GTK_ADJUSTMENT
argument_list|(
name|adjustment
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|scale
argument_list|,
name|GTKW_SCALE_WIDTH
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|scale
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_scale_set_value_pos
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_scale_set_digits
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_range_set_update_policy
argument_list|(
name|GTK_RANGE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|GTK_UPDATE_DELAYED
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|scale_update
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
name|adjustment
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|adjustment
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|entry
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|entry
argument_list|,
name|GTKW_ENTRY_WIDTH
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|buffer
operator|=
operator|(
name|guchar
operator|*
operator|)
name|g_malloc
argument_list|(
name|GTKW_ENTRY_BUFFER_SIZE
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|buffer
argument_list|,
literal|"%d"
argument_list|,
operator|*
name|value
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|entry_update
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
if|if
condition|(
name|widget_entry
condition|)
block|{
name|gtkW_widget_table
modifier|*
name|tentry
init|=
operator|(
name|gtkW_widget_table
operator|*
operator|)
name|widget_entry
decl_stmt|;
name|tentry
operator|->
name|widget
operator|=
operator|(
name|GtkWidget
operator|*
operator|)
name|adjustment
expr_stmt|;
name|tentry
operator|->
name|updater
operator|=
name|gtkW_iscale_entry_change_value
expr_stmt|;
name|tentry
operator|->
name|value
operator|=
name|value
expr_stmt|;
block|}
return|return
name|entry
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_table_add_menu (GtkWidget * table,guchar * name,gint x,gint y,GtkSignalFunc menu_update,gint * val,gtkW_menu_item * item,gint item_num,gpointer widget_entry)
name|gtkW_table_add_menu
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|menu_update
parameter_list|,
name|gint
modifier|*
name|val
parameter_list|,
name|gtkW_menu_item
modifier|*
name|item
parameter_list|,
name|gint
name|item_num
parameter_list|,
name|gpointer
name|widget_entry
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|menu
decl_stmt|,
modifier|*
name|menuitem
decl_stmt|,
modifier|*
name|option_menu
decl_stmt|;
name|gint
name|i
decl_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
name|x
argument_list|,
name|x
operator|+
literal|1
argument_list|,
name|y
argument_list|,
name|y
operator|+
literal|1
argument_list|,
name|gtkW_align_x
argument_list|,
name|gtkW_align_y
argument_list|,
name|gtkW_border_width
argument_list|,
name|gtkW_border_height
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|menu
operator|=
name|gtk_menu_new
argument_list|()
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|item_num
condition|;
name|i
operator|++
control|)
block|{
name|gint
modifier|*
modifier|*
name|buffer
decl_stmt|;
name|buffer
operator|=
operator|(
name|gint
operator|*
operator|*
operator|)
name|g_malloc
argument_list|(
literal|3
operator|*
sizeof|sizeof
argument_list|(
name|gint
operator|*
argument_list|)
argument_list|)
expr_stmt|;
name|buffer
index|[
literal|0
index|]
operator|=
operator|(
name|gint
operator|*
operator|)
operator|(
operator|(
operator|*
name|val
operator|==
name|i
operator|)
condition|?
name|TRUE
else|:
name|FALSE
operator|)
expr_stmt|;
comment|/* for trick */
name|buffer
index|[
literal|1
index|]
operator|=
name|val
expr_stmt|;
comment|/* for pointer */
name|buffer
index|[
literal|2
index|]
operator|=
operator|(
name|gint
operator|*
operator|)
name|i
expr_stmt|;
comment|/* for value */
name|menuitem
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|item
index|[
name|i
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|menuitem
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|menuitem
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|menu_update
argument_list|,
name|buffer
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|menuitem
argument_list|)
expr_stmt|;
block|}
name|option_menu
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|option_menu
argument_list|)
argument_list|,
name|menu
argument_list|)
expr_stmt|;
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|option_menu
argument_list|)
argument_list|,
operator|*
name|val
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|option_menu
argument_list|,
name|x
operator|+
literal|1
argument_list|,
name|x
operator|+
literal|2
argument_list|,
name|y
argument_list|,
name|y
operator|+
literal|1
argument_list|,
name|gtkW_align_x
argument_list|,
name|gtkW_align_y
argument_list|,
name|gtkW_border_width
argument_list|,
name|gtkW_border_height
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|option_menu
argument_list|)
expr_stmt|;
if|if
condition|(
name|widget_entry
condition|)
block|{
name|gtkW_widget_table
modifier|*
name|tentry
init|=
operator|(
name|gtkW_widget_table
operator|*
operator|)
name|widget_entry
decl_stmt|;
name|tentry
operator|->
name|widget
operator|=
name|option_menu
expr_stmt|;
name|tentry
operator|->
name|updater
operator|=
name|gtkW_menu_change_value
expr_stmt|;
name|tentry
operator|->
name|value
operator|=
name|val
expr_stmt|;
block|}
return|return
name|option_menu
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_table_add_toggle (GtkWidget * table,guchar * name,gint x,gint y,GtkSignalFunc update,gint * value,gpointer widget_entry)
name|gtkW_table_add_toggle
parameter_list|(
name|GtkWidget
modifier|*
name|table
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|gint
name|x
parameter_list|,
name|gint
name|y
parameter_list|,
name|GtkSignalFunc
name|update
parameter_list|,
name|gint
modifier|*
name|value
parameter_list|,
name|gpointer
name|widget_entry
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|toggle
decl_stmt|;
name|toggle
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|toggle
argument_list|,
name|x
argument_list|,
name|x
operator|+
literal|2
argument_list|,
name|y
argument_list|,
name|y
operator|+
literal|1
argument_list|,
name|gtkW_align_x
argument_list|,
name|gtkW_align_y
argument_list|,
name|gtkW_border_width
argument_list|,
name|gtkW_border_height
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toggle
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|update
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_state
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|toggle
argument_list|)
argument_list|,
operator|*
name|value
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|toggle
argument_list|)
expr_stmt|;
if|if
condition|(
name|widget_entry
condition|)
block|{
name|gtkW_widget_table
modifier|*
name|tentry
init|=
operator|(
name|gtkW_widget_table
operator|*
operator|)
name|widget_entry
decl_stmt|;
name|tentry
operator|->
name|widget
operator|=
name|toggle
expr_stmt|;
name|tentry
operator|->
name|updater
operator|=
name|gtkW_toggle_change_value
expr_stmt|;
name|tentry
operator|->
name|value
operator|=
name|value
expr_stmt|;
block|}
return|return
name|toggle
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_table_new (GtkWidget * parent,gint col,gint row)
name|gtkW_table_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|,
name|gint
name|col
parameter_list|,
name|gint
name|row
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
name|col
argument_list|,
name|row
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|table
argument_list|)
argument_list|,
name|gtkW_border_width
argument_list|)
expr_stmt|;
if|if
condition|(
name|parent
condition|)
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|parent
argument_list|)
argument_list|,
name|table
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
return|return
name|table
return|;
block|}
end_function

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|gtkW_vbox_add_button (GtkWidget * vbox,guchar * name,GtkSignalFunc update,gpointer data)
name|gtkW_vbox_add_button
parameter_list|(
name|GtkWidget
modifier|*
name|vbox
parameter_list|,
name|guchar
modifier|*
name|name
parameter_list|,
name|GtkSignalFunc
name|update
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|update
argument_list|,
name|data
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
return|return
name|button
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|gtkW_vbox_new (GtkWidget * parent)
name|gtkW_vbox_new
parameter_list|(
name|GtkWidget
modifier|*
name|parent
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|gtkW_homogeneous_layout
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|gtkW_border_width
argument_list|)
expr_stmt|;
if|if
condition|(
name|parent
condition|)
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|parent
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
return|return
name|vbox
return|;
block|}
end_function

begin_function
specifier|static
name|GtkTooltips
modifier|*
DECL|function|gtkW_tooltips_new (GtkWidget * frame)
name|gtkW_tooltips_new
parameter_list|(
name|GtkWidget
modifier|*
name|frame
parameter_list|)
block|{
name|GtkTooltips
modifier|*
name|tooltips
decl_stmt|;
name|tooltips
operator|=
name|gtk_tooltips_new
argument_list|()
expr_stmt|;
if|if
condition|(
name|gtkW_tooltips_color_allocated
operator|==
name|FALSE
condition|)
block|{
name|tooltips_foreground
operator|.
name|red
operator|=
literal|0
expr_stmt|;
name|tooltips_foreground
operator|.
name|green
operator|=
literal|0
expr_stmt|;
name|tooltips_foreground
operator|.
name|blue
operator|=
literal|0
expr_stmt|;
comment|/* postit yellow (khaki) as background: */
name|gdk_color_alloc
argument_list|(
name|gtk_widget_get_colormap
argument_list|(
name|frame
argument_list|)
argument_list|,
operator|&
name|tooltips_foreground
argument_list|)
expr_stmt|;
name|tooltips_background
operator|.
name|red
operator|=
literal|61669
expr_stmt|;
name|tooltips_background
operator|.
name|green
operator|=
literal|59113
expr_stmt|;
name|tooltips_background
operator|.
name|blue
operator|=
literal|35979
expr_stmt|;
name|gdk_color_alloc
argument_list|(
name|gtk_widget_get_colormap
argument_list|(
name|frame
argument_list|)
argument_list|,
operator|&
name|tooltips_background
argument_list|)
expr_stmt|;
name|gtkW_tooltips_color_allocated
operator|=
name|TRUE
expr_stmt|;
block|}
name|gtk_tooltips_set_colors
argument_list|(
name|tooltips
argument_list|,
operator|&
name|tooltips_background
argument_list|,
operator|&
name|tooltips_foreground
argument_list|)
expr_stmt|;
return|return
name|tooltips
return|;
block|}
end_function

begin_comment
comment|/* end of gtkW functions */
end_comment

begin_comment
comment|/* CML_explorer.c ends here */
end_comment

end_unit

