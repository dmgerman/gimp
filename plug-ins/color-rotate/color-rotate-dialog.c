begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/*  * Copyright (C) 1995 Spencer Kimball and Peter Mattis  *  * This is a plug-in for GIMP.  *  * Colormap-Rotation plug-in. Exchanges two color ranges.  *  * Copyright (C) 1999 Sven Anders (anderss@fmi.uni-passau.de)  *                    Based on code from Pavel Grinfeld (pavel@ml.com)  *  *  * This program is free software: you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 3 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program.  If not, see<http://www.gnu.org/licenses/>.  */
end_comment

begin_comment
comment|/*---------------------------------------------------------------------------  * Change log:  *  * Version 2.0, 04 April 1999.  *  Nearly complete rewrite, made plug-in stable.  *  (Works with GIMP 1.1 and GTK+ 1.2)  *  * Version 1.0, 27 March 1997.  *  Initial (unstable) release by Pavel Grinfeld  *  *---------------------------------------------------------------------------*/
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<libgimp/gimp.h>
end_include

begin_include
include|#
directive|include
file|<libgimp/gimpui.h>
end_include

begin_include
include|#
directive|include
file|"color-rotate.h"
end_include

begin_include
include|#
directive|include
file|"color-rotate-utils.h"
end_include

begin_include
include|#
directive|include
file|"color-rotate-draw.h"
end_include

begin_include
include|#
directive|include
file|"color-rotate-callbacks.h"
end_include

begin_include
include|#
directive|include
file|"color-rotate-dialog.h"
end_include

begin_include
include|#
directive|include
file|"color-rotate-stock.h"
end_include

begin_include
include|#
directive|include
file|"images/color-rotate-stock-pixbufs.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/stdplugins-intl.h"
end_include

begin_comment
comment|/* Defines */
end_comment

begin_define
DECL|macro|INITIAL_ALPHA
define|#
directive|define
name|INITIAL_ALPHA
value|0
end_define

begin_define
DECL|macro|INITIAL_BETA
define|#
directive|define
name|INITIAL_BETA
value|G_PI_2
end_define

begin_define
DECL|macro|INITIAL_GRAY_SAT
define|#
directive|define
name|INITIAL_GRAY_SAT
value|0.0
end_define

begin_define
DECL|macro|INITIAL_GRAY_RSAT
define|#
directive|define
name|INITIAL_GRAY_RSAT
value|0.0
end_define

begin_define
DECL|macro|INITIAL_GRAY_HUE
define|#
directive|define
name|INITIAL_GRAY_HUE
value|0.0
end_define

begin_define
DECL|macro|RANGE_ADJUST_MASK
define|#
directive|define
name|RANGE_ADJUST_MASK
value|GDK_EXPOSURE_MASK | \                           GDK_ENTER_NOTIFY_MASK | \                           GDK_BUTTON_PRESS_MASK | \                           GDK_BUTTON_RELEASE_MASK | \                           GDK_BUTTON1_MOTION_MASK | \                           GDK_POINTER_MOTION_HINT_MASK
end_define

begin_comment
comment|/* Previews: create one preview */
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|rcm_create_one_preview (GtkWidget ** preview,gint mode,gint width,gint height)
name|rcm_create_one_preview
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|preview
parameter_list|,
name|gint
name|mode
parameter_list|,
name|gint
name|width
parameter_list|,
name|gint
name|height
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|align
init|=
name|gtk_alignment_new
argument_list|(
literal|0.5
argument_list|,
literal|0.5
argument_list|,
literal|0.0
argument_list|,
literal|0.0
argument_list|)
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|align
argument_list|)
argument_list|,
name|frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
operator|*
name|preview
operator|=
name|gimp_preview_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
operator|*
name|preview
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
operator|*
name|preview
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
operator|*
name|preview
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
operator|*
name|preview
argument_list|)
argument_list|,
literal|"mode"
argument_list|,
name|GINT_TO_POINTER
argument_list|(
name|mode
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|align
return|;
block|}
end_function

begin_comment
comment|/* Previews */
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|rcm_create_previews (void)
name|rcm_create_previews
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|top_vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkWidget
modifier|*
name|combo
decl_stmt|;
name|top_vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|top_vbox
argument_list|)
argument_list|,
name|vbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Original"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|label
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|frame
operator|=
name|rcm_create_one_preview
argument_list|(
operator|&
name|Current
operator|.
name|Bna
operator|->
name|before
argument_list|,
name|ORIGINAL
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|width
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|g_signal_connect_after
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|before
argument_list|,
literal|"size-allocate"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_render_preview
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|top_vbox
argument_list|)
argument_list|,
name|vbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Rotated"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|label
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|frame
operator|=
name|rcm_create_one_preview
argument_list|(
operator|&
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
name|CURRENT
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|width
argument_list|,
name|Current
operator|.
name|reduced
operator|->
name|height
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|g_signal_connect_after
argument_list|(
name|Current
operator|.
name|Bna
operator|->
name|after
argument_list|,
literal|"size-allocate"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_render_preview
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|top_vbox
argument_list|)
argument_list|,
name|vbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_check_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Continuous update"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|Current
operator|.
name|RealTime
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_preview_as_you_drag
argument_list|)
argument_list|,
operator|&
operator|(
name|Current
operator|.
name|RealTime
operator|)
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Area:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|label
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|combo
operator|=
name|gimp_int_combo_box_new
argument_list|(
name|_
argument_list|(
literal|"Entire Layer"
argument_list|)
argument_list|,
name|ENTIRE_IMAGE
argument_list|,
name|_
argument_list|(
literal|"Selection"
argument_list|)
argument_list|,
name|SELECTION
argument_list|,
name|_
argument_list|(
literal|"Context"
argument_list|)
argument_list|,
name|SELECTION_IN_CONTEXT
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_int_combo_box_set_active
argument_list|(
name|GIMP_INT_COMBO_BOX
argument_list|(
name|combo
argument_list|)
argument_list|,
name|Current
operator|.
name|Slctn
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|combo
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|combo
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|combo
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_combo_callback
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|top_vbox
argument_list|)
expr_stmt|;
return|return
name|top_vbox
return|;
block|}
end_function

begin_comment
comment|/* Main: One circles with values and buttons */
end_comment

begin_function
specifier|static
name|RcmCircle
modifier|*
DECL|function|rcm_create_one_circle (gint height,const gchar * label_content)
name|rcm_create_one_circle
parameter_list|(
name|gint
name|height
parameter_list|,
specifier|const
name|gchar
modifier|*
name|label_content
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|button_table
decl_stmt|,
modifier|*
name|legend_table
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|,
modifier|*
name|button
decl_stmt|,
modifier|*
name|entry
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|RcmCircle
modifier|*
name|st
decl_stmt|;
name|st
operator|=
name|g_new
argument_list|(
name|RcmCircle
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|st
operator|->
name|angle
operator|=
name|g_new
argument_list|(
name|RcmAngle
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|alpha
operator|=
name|INITIAL_ALPHA
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|beta
operator|=
name|INITIAL_BETA
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|cw_ccw
operator|=
literal|1
expr_stmt|;
comment|/** Main: Circle: create (main) frame **/
name|st
operator|->
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|label_content
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|frame
argument_list|)
expr_stmt|;
comment|/** Main: Circle: create frame& preview **/
comment|/* create frame */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
comment|/* create preview */
name|st
operator|->
name|preview
operator|=
name|gimp_preview_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|st
operator|->
name|preview
argument_list|,
name|height
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|st
operator|->
name|preview
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|preview
argument_list|)
expr_stmt|;
comment|/* set signals */
name|gtk_widget_set_events
argument_list|(
name|st
operator|->
name|preview
argument_list|,
name|RANGE_ADJUST_MASK
argument_list|)
expr_stmt|;
name|g_signal_connect_after
argument_list|(
name|st
operator|->
name|preview
argument_list|,
literal|"expose-event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_expose_event
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|st
operator|->
name|preview
argument_list|,
literal|"button-press-event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_button_press_event
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|st
operator|->
name|preview
argument_list|,
literal|"button-release-event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_release_event
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|st
operator|->
name|preview
argument_list|,
literal|"motion-notify-event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_motion_notify_event
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
comment|/** Main: Circle: create table for buttons **/
name|button_table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|1
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button_table
argument_list|)
expr_stmt|;
comment|/** Main: Circle: Buttons **/
name|button
operator|=
name|gtk_button_new_from_stock
argument_list|(
name|st
operator|->
name|angle
operator|->
name|cw_ccw
operator|>
literal|0
condition|?
name|STOCK_COLOR_ROTATE_SWITCH_CLOCKWISE
else|:
name|STOCK_COLOR_ROTATE_SWITCH_COUNTERCLOCKWISE
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_cw_ccw
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|button_table
argument_list|)
argument_list|,
name|button
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|4
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|st
operator|->
name|cw_ccw_pixmap
operator|=
name|NULL
expr_stmt|;
name|st
operator|->
name|cw_ccw_button
operator|=
name|button
expr_stmt|;
name|st
operator|->
name|cw_ccw_box
operator|=
name|NULL
expr_stmt|;
name|st
operator|->
name|cw_ccw_label
operator|=
name|NULL
expr_stmt|;
name|button
operator|=
name|gtk_button_new_from_stock
argument_list|(
name|STOCK_COLOR_ROTATE_CHANGE_ORDER
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_a_to_b
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|button_table
argument_list|)
argument_list|,
name|button
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|4
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|st
operator|->
name|a_b_pixmap
operator|=
name|NULL
expr_stmt|;
name|st
operator|->
name|a_b_box
operator|=
name|NULL
expr_stmt|;
name|st
operator|->
name|a_b_button
operator|=
name|button
expr_stmt|;
name|button
operator|=
name|gtk_button_new_from_stock
argument_list|(
name|STOCK_COLOR_ROTATE_SELECT_ALL
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_360_degrees
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|button_table
argument_list|)
argument_list|,
name|button
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|4
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|st
operator|->
name|f360_pixmap
operator|=
name|NULL
expr_stmt|;
name|st
operator|->
name|f360_box
operator|=
name|NULL
expr_stmt|;
name|st
operator|->
name|f360_button
operator|=
name|button
expr_stmt|;
comment|/** Main: Circle: Legend **/
name|legend_table
operator|=
name|gtk_table_new
argument_list|(
literal|1
argument_list|,
literal|6
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|legend_table
argument_list|)
expr_stmt|;
comment|/* spinbutton 1 */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|C_
argument_list|(
literal|"color-range"
argument_list|,
literal|"From:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|5
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|alpha
operator|=
name|INITIAL_ALPHA
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|angle
operator|->
name|alpha
argument_list|,
literal|0.0
argument_list|,
literal|2.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|st
operator|->
name|alpha_entry
operator|=
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|entry
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|2
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|entry
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_set_alpha
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
comment|/* label */
name|st
operator|->
name|alpha_units_label
operator|=
name|gtk_label_new
argument_list|(
name|rcm_units_string
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|alpha_units_label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|st
operator|->
name|alpha_units_label
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|4
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|/* spinbutton 2 */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|C_
argument_list|(
literal|"color-range"
argument_list|,
literal|"To:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|4
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|st
operator|->
name|angle
operator|->
name|beta
operator|=
name|INITIAL_BETA
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|angle
operator|->
name|beta
argument_list|,
literal|0.0
argument_list|,
literal|2.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|st
operator|->
name|beta_entry
operator|=
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|entry
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|4
argument_list|,
literal|5
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|2
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|entry
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_set_beta
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
comment|/* label */
name|st
operator|->
name|beta_units_label
operator|=
name|gtk_label_new
argument_list|(
name|rcm_units_string
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|beta_units_label
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|legend_table
argument_list|)
argument_list|,
name|st
operator|->
name|beta_units_label
argument_list|,
literal|5
argument_list|,
literal|6
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|4
argument_list|,
literal|4
argument_list|)
expr_stmt|;
comment|/* Main: Circle: create table for Preview / Buttons / Legend */
name|st
operator|->
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|table
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|frame
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|button_table
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|st
operator|->
name|table
argument_list|)
argument_list|,
name|legend_table
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
comment|/* add table to (main) frame */
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|st
operator|->
name|frame
argument_list|)
argument_list|,
name|st
operator|->
name|table
argument_list|)
expr_stmt|;
return|return
name|st
return|;
block|}
end_function

begin_comment
comment|/* Main */
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|rcm_create_main (void)
name|rcm_create_main
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|Current
operator|.
name|From
operator|=
name|rcm_create_one_circle
argument_list|(
name|SUM
argument_list|,
name|C_
argument_list|(
literal|"color-rotate"
argument_list|,
literal|"From:"
argument_list|)
argument_list|)
expr_stmt|;
name|Current
operator|.
name|To
operator|=
name|rcm_create_one_circle
argument_list|(
name|SUM
argument_list|,
name|C_
argument_list|(
literal|"color-rotate"
argument_list|,
literal|"To:"
argument_list|)
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|Current
operator|.
name|From
operator|->
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|Current
operator|.
name|To
operator|->
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
name|vbox
return|;
block|}
end_function

begin_comment
comment|/* Misc: Gray */
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|rcm_create_gray (void)
name|rcm_create_gray
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|top_vbox
decl_stmt|,
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|,
modifier|*
name|preview
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|GtkWidget
modifier|*
name|radio_box
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|RcmGray
modifier|*
name|st
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|Current
operator|.
name|Gray
operator|=
name|st
operator|=
name|g_new
argument_list|(
name|RcmGray
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|st
operator|->
name|hue
operator|=
literal|0
expr_stmt|;
name|st
operator|->
name|satur
operator|=
literal|0
expr_stmt|;
name|top_vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|top_vbox
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|top_vbox
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Gray"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|top_vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|st
operator|->
name|preview
operator|=
name|preview
operator|=
name|gimp_preview_area_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_size_request
argument_list|(
name|preview
argument_list|,
name|GRAY_SUM
argument_list|,
name|GRAY_SUM
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|preview
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|preview
argument_list|)
expr_stmt|;
name|gtk_widget_add_events
argument_list|(
name|preview
argument_list|,
name|RANGE_ADJUST_MASK
argument_list|)
expr_stmt|;
name|g_signal_connect_after
argument_list|(
name|preview
argument_list|,
literal|"expose-event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_gray_expose_event
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|preview
argument_list|,
literal|"button-press-event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_gray_button_press_event
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|preview
argument_list|,
literal|"button-release-event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_gray_release_event
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|preview
argument_list|,
literal|"motion-notify-event"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_gray_motion_notify_event
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
comment|/* Gray: Circle: Legend */
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
comment|/* Gray: Circle: Spinbutton 1 */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Hue:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|st
operator|->
name|hue
operator|=
name|INITIAL_GRAY_HUE
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|hue
argument_list|,
literal|0.0
argument_list|,
literal|2.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|st
operator|->
name|hue_entry
operator|=
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|entry
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|entry
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_set_hue
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
comment|/* Gray: Circle: units label */
name|st
operator|->
name|hue_units_label
operator|=
name|gtk_label_new
argument_list|(
name|rcm_units_string
argument_list|(
name|Current
operator|.
name|Units
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|st
operator|->
name|hue_units_label
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|st
operator|->
name|hue_units_label
argument_list|)
expr_stmt|;
comment|/* Gray: Circle: Spinbutton 2 */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Saturation:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|st
operator|->
name|satur
operator|=
name|INITIAL_GRAY_SAT
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|satur
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|st
operator|->
name|satur_entry
operator|=
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|entry
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|entry
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|entry
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_set_satur
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
comment|/** Gray: Operation-Mode **/
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Gray Mode"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|top_vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|radio_box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|radio_box
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|radio_box
argument_list|)
expr_stmt|;
comment|/* Gray: Operation-Mode: two radio buttons */
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Treat as this"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_get_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Gray_to_from
operator|==
name|GRAY_FROM
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_switch_to_gray_from
argument_list|)
argument_list|,
operator|&
operator|(
name|Current
operator|.
name|Gray_to_from
operator|)
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Change to this"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_get_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Gray_to_from
operator|==
name|GRAY_TO
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_switch_to_gray_to
argument_list|)
argument_list|,
operator|&
operator|(
name|Current
operator|.
name|Gray_to_from
operator|)
argument_list|)
expr_stmt|;
comment|/** Gray: What is gray? **/
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Gray Threshold"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|top_vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Saturation:"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|label
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|st
operator|->
name|gray_sat
operator|=
name|INITIAL_GRAY_RSAT
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|st
operator|->
name|gray_sat
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0.0001
argument_list|,
literal|0.001
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|entry
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|0.01
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_numeric
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|entry
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|entry
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|entry
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_set_gray_sat
argument_list|)
argument_list|,
name|st
argument_list|)
expr_stmt|;
return|return
name|top_vbox
return|;
block|}
end_function

begin_comment
comment|/* Misc */
end_comment

begin_function
specifier|static
name|GtkWidget
modifier|*
DECL|function|rcm_create_units (void)
name|rcm_create_units
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
comment|/** Misc: Used unit selection **/
name|frame
operator|=
name|gimp_frame_new
argument_list|(
name|_
argument_list|(
literal|"Units"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|6
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
comment|/* Misc: Used unit selection: 3 radio buttons */
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Radians"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_get_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Units
operator|==
name|RADIANS
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_switch_to_radians
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Radians/Pi"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_get_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Units
operator|==
name|RADIANS_OVER_PI
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_switch_to_radians_over_PI
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Degrees"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
if|if
condition|(
name|Current
operator|.
name|Units
operator|==
name|DEGREES
condition|)
name|gtk_button_clicked
argument_list|(
name|GTK_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"clicked"
argument_list|,
name|G_CALLBACK
argument_list|(
name|rcm_switch_to_degrees
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
return|return
name|frame
return|;
block|}
end_function

begin_comment
comment|/* create and call main dialog */
end_comment

begin_function
name|gboolean
DECL|function|color_rotate_dialog (void)
name|color_rotate_dialog
parameter_list|(
name|void
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|dialog
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|notebook
decl_stmt|;
name|GtkWidget
modifier|*
name|previews
decl_stmt|;
name|gboolean
name|run
decl_stmt|;
name|Current
operator|.
name|Bna
operator|=
name|g_new
argument_list|(
name|RcmBna
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gimp_ui_init
argument_list|(
name|PLUG_IN_BINARY
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|color_rotate_stock_init
argument_list|()
expr_stmt|;
name|dialog
operator|=
name|gimp_dialog_new
argument_list|(
name|_
argument_list|(
literal|"Rotate Colors"
argument_list|)
argument_list|,
name|PLUG_IN_ROLE
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|,
name|gimp_standard_help_func
argument_list|,
name|PLUG_IN_PROC
argument_list|,
name|GTK_STOCK_CANCEL
argument_list|,
name|GTK_RESPONSE_CANCEL
argument_list|,
name|GTK_STOCK_OK
argument_list|,
name|GTK_RESPONSE_OK
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_dialog_set_alternative_button_order
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dialog
argument_list|)
argument_list|,
name|GTK_RESPONSE_OK
argument_list|,
name|GTK_RESPONSE_CANCEL
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gimp_window_set_transient
argument_list|(
name|GTK_WINDOW
argument_list|(
name|dialog
argument_list|)
argument_list|)
expr_stmt|;
name|Current
operator|.
name|Bna
operator|->
name|dlg
operator|=
name|dialog
expr_stmt|;
comment|/* Create sub-dialogs */
name|Current
operator|.
name|reduced
operator|=
name|rcm_reduce_image
argument_list|(
name|Current
operator|.
name|drawable
argument_list|,
name|Current
operator|.
name|mask
argument_list|,
name|MAX_PREVIEW_SIZE
argument_list|,
name|Current
operator|.
name|Slctn
argument_list|)
expr_stmt|;
name|Current
operator|.
name|Bna
operator|->
name|bna_frame
operator|=
name|previews
operator|=
name|rcm_create_previews
argument_list|()
expr_stmt|;
comment|/* H-Box */
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|hbox
argument_list|)
argument_list|,
literal|12
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|gtk_dialog_get_content_area
argument_list|(
name|GTK_DIALOG
argument_list|(
name|dialog
argument_list|)
argument_list|)
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|previews
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/* Notebook */
name|notebook
operator|=
name|gtk_notebook_new
argument_list|()
expr_stmt|;
name|gtk_notebook_set_tab_pos
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|GTK_POS_TOP
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|notebook
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|notebook
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|rcm_create_main
argument_list|()
argument_list|,
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Main Options"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|rcm_create_gray
argument_list|()
argument_list|,
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Gray Options"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_notebook_append_page
argument_list|(
name|GTK_NOTEBOOK
argument_list|(
name|notebook
argument_list|)
argument_list|,
name|rcm_create_units
argument_list|()
argument_list|,
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Units"
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|dialog
argument_list|)
expr_stmt|;
name|rcm_render_circle
argument_list|(
name|Current
operator|.
name|From
operator|->
name|preview
argument_list|,
name|SUM
argument_list|,
name|MARGIN
argument_list|)
expr_stmt|;
name|rcm_render_circle
argument_list|(
name|Current
operator|.
name|To
operator|->
name|preview
argument_list|,
name|SUM
argument_list|,
name|MARGIN
argument_list|)
expr_stmt|;
name|rcm_render_circle
argument_list|(
name|Current
operator|.
name|Gray
operator|->
name|preview
argument_list|,
name|GRAY_SUM
argument_list|,
name|GRAY_MARGIN
argument_list|)
expr_stmt|;
name|run
operator|=
operator|(
name|gimp_dialog_run
argument_list|(
name|GIMP_DIALOG
argument_list|(
name|dialog
argument_list|)
argument_list|)
operator|==
name|GTK_RESPONSE_OK
operator|)
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|dialog
argument_list|)
expr_stmt|;
return|return
name|run
return|;
block|}
end_function

end_unit

