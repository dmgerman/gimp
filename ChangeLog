2005-01-23    <maurits@Mau>

	* plug-ins/imagemap/imap_toolbar.[ch]
	* plug-ins/imagemap/imap_tools.[ch]: removed

	* plug-ins/imagemap/Makefile.am
	* po-plug-ins/POTFILES.in: changed accordingly

	* plug-ins/imagemap/imap_grid.c
	* plug-ins/imagemap/imap_main.[ch]
	* plug-ins/imagemap/imap_menu.[ch]
	* plug-ins/imagemap/imap_misc.[ch]
	* plug-ins/imagemap/imap_object_popup.c
	* plug-ins/imagemap/imap_selection.c: more conversion to action based
	menus. Still have to attach some actions.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* libgimpbase/Makefile.am
	* libgimpbase/gimpbaseparams.[ch]: removed this file again.

	* libgimpbase/gimpmemsize.[ch]
	* libgimpbase/gimppath.[ch]
	* libgimpbase/gimpunit.[ch]: moved the paramspec definitions to
	the types they belong to.

	* libgimpbase/gimpbase.h: changed accordingly.

	* libgimpwidgets/Makefile.am (libgimpwidgetsinclude_HEADERS):
	install the new header files.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/text/text-enums.h
	* libgimpbase/gimpbaseenums.h: moved enum to libgimpbase (from
	app/text and libgimp).

	* libgimp/gimpenums.h
	* libgimpbase/gimpbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libgimpbase/gimpbase.def
	* libgimp/gimp.def: updated.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/actions/dialogs-actions.c (dialogs_actions): set Ctrl-B as
	default shortcut to raise the Toolbox (as suggested in bug #163368).

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/paint/paint-enums.h
	* libgimpbase/gimpbaseenums.h: moved enums to libgimpbase (from
	app/paint and libgimp). The remaining enums in
	app/paint/paint-enums.h need special treatment.

	* app/paint/paint-enums.c:
	* libgimp/gimpenums.h
	* libgimpbase/gimpbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libgimpbase/gimpbase.def
	* libgimp/gimp.def: updated.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-enums.h: new file with enums moved from ...

	* app/plug-in/plug-in-types.h: ... here.

	* tools/pdbgen/Makefile.am (enum_headers): changed accordingly.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/core/core-enums.h
	* libgimpbase/gimpbaseenums.h: moved enums to libgimpbase (from
	app/core and libgimp). The remaining enums in app/core/core-enums.h
	need special treatment.

	* app/core/core-enums.c:
	* libgimp/gimpenums.h
	* libgimpbase/gimpbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libgimpbase/gimpbase.def
	* libgimp/gimp.def: updated.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/base/base-enums.h
	* libgimpbase/gimpbaseenums.h: moved GimpInterpolationType and
	GimpTransferMode to libgimpbase (from app/base and libgimp). The
	remaining enums in app/base/base-enums.h need special treatment.

	* app/base/base-enums.c
	* libgimp/gimpenums.h
	* libgimpbase/gimpbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libgimpbase/gimpbase.def
	* libgimp/gimp.def: updated.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/script-fu/script-fu-enums.h
	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-types.h
	* plug-ins/script-fu/siod-wrapper.c: added new script-fu
	parameter SF-ENUM that allows to easily create a combo-box to
	choose values from registered enums. For this to work correctly,
	another change is needed that I will commit separately.

	* plug-ins/script-fu/scripts/perspective-shadow.scm
	* plug-ins/script-fu/scripts/test-sphere.scm: use the new SF-ENUM
	parameter.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimppropwidgets.[ch]: added gimp_prop_expander_new().

	* app/paint/gimppaintoptions.[ch]: added a property to track the
	state of the "Pressure sensitivity" expander.

	* app/tools/gimppaintoptions-gui.c: use gimp_prop_expander_new()
	to create the "Pressure sensitivity" expander.

2005-01-22  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_file.c 
	* plug-ins/imagemap/imap_main.c 
	* plug-ins/imagemap/imap_menu.c 
	* plug-ins/imagemap/imap_menu_funcs.[ch]
	* plug-ins/imagemap/imap_misc.[ch] 
	* plug-ins/imagemap/imap_object.[ch]
	* plug-ins/imagemap/imap_selection.c: cleaning up code, mostly
	replacing homebrewn stuff that is now in either GTK or one of the
	GIMP libs. More to come.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpselectiondata.c: include <stdio.h> for sscanf().

2005-01-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/jpeg/jpeg-save.c (save_dialog): update the preview (and
	thus the filesize) if the EXIF or thumbnail toggles are being used.
	Fixes bug #164914.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/imagemap/imap_file.c: fixed overwrite confirmation
	dialog (bug #164864).

2005-01-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/imagemap/imap_file.c (do_file_save_as_dialog): use
	GTK_STOCK_SAVE for the save dialog (bug #164864).

2005-01-21  Manish Singh  <yosh@gimp.org>

	* app/display/gimpdisplayshell.c: #include gimpbase.h for declaration
	of gimp_param_spec_unit().

2005-01-22  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpenumwidgets.c: added more gtk-doc comments.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimpbase.def
	* libgimpcolor/gimpcolor.def
	* libgimpmath/gimpmath.def: added new symbols.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimputils.c (gimp_enum_value_get_help): same fix here.

2005-01-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>
	
	* app/config/gimpconfig-types.c
	* app/config/gimpconfig-types.h: removed...

	* libgimpbase/gimpbasetypes.c
	* libgimpbase/gimpbasetypes.h: and contents merged
	into here.
	
	* app/config/gimpconfig-params.c: removed...

	* libgimpbase/gimpbaseparams.c
	* libgimpcolor/gimprgb.c
	* libgimpmath/gimpmatrix.c: and contents merged
	into here.

	* app/config/gimpconfig-params.h: part removed...

	* libgimpbase/gimpbaseparams.h
	* libgimpcolor/gimprgb.h
	* libgimpmath/gimpmatrix.h: and merged into here

	* libgimpbase/Makefile.am
	* libgimpbase/gimpbase.h
	* libgimpcolor/gimpbilinear.c
	* libgimpcolor/gimpcmyk.c
	* libgimpmath/gimpvector.c
	* app/config/Makefile.am
	* app/config/gimpconfig-deserialize.c
	* app/config/gimpconfig-dump.c
	* app/config/gimpconfig-serialize.c
	* app/config/gimpcoreconfig.c
	* app/config/gimpguiconfig.c
	* app/config/gimppluginconfig.c
	* app/core/gimp-utils.c
	* app/core/gimpcontext.c
	* app/tools/tools-utils.c
	* app/widgets/gimpaction.c
	* plug-ins/gimpressionist/utils.c: dependencies changed
	accordingly.

	First step in config migration out of core.  Need to fix
	devel-docs to reflect these changes.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimputils.c (gimp_enum_value_get_desc): no point in
	crashing if gimp_enum_get_desc() returns NULL.

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_proof.c: register enum descriptions, use
	GimpEnumComboBox.

2005-01-21  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimppreviewarea.c: improved docs.

2005-01-21  Sven Neumann  <sven@gimp.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/gimpenumcombobox.[ch]
	* app/widgets/gimpenumstore.[ch]: moved GimpEnumStore and
	GimpEnumComboBox from here ...

	* libgimpwidgets/Makefile.am
	* libgimpwidgets/gimpwidgets.def
	* libgimpwidgets/gimpwidgets.h
	* libgimpwidgets/gimpwidgetstypes.h
	* libgimpwidgets/gimpenumcombobox.[ch]
	* libgimpwidgets/gimpenumstore.[ch]: ... to libgimpwidgets.

	* app/dialogs/convert-dialog.c
	* app/dialogs/scale-dialog.c
	* app/tools/gimpblendoptions.c
	* app/tools/gimpcurvestool.c
	* app/tools/gimplevelstool.c
	* app/widgets/gimpcolorframe.c
	* app/widgets/gimphistogrameditor.c
	* app/widgets/gimppropwidgets.c
	* app/widgets/gimpstrokeeditor.c
	* data/images/gimp-splash.png: changed includes accordingly.

2005-01-21  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpwidgets-utils.[ch] (gimp_action_get_accel_closure):
	new function as workaround for missing GTK+ API	(see bug #141750).

	* app/widgets/gimpactionview.[ch]: use the function instead of
	having this ugly hack here. Store the accel_closure instead of the
	hackish menu_item in the tree store. Removed cruft and cleaned up
	a bit.

2005-01-21  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-transform.c: applied a patch from Geert
	Jordaens that seems to fix drawable transformation using the new
	Lanczos interpolation routine :)

2005-01-20  Sven Neumann  <sven@gimp.org>

	* HACKING
	* Makefile.am
	* acinclude.m4
	* autogen.sh: applied (modified) patch from RaphaÃ«l Quinet that
	allows to build GIMP from CVS without having gtk-doc installed.
	If you need to do this, pass --disable-gtk-doc to autogen.sh.

	* configure.in: removed --disable-devel-docs option since it has
	become obsolete now.

	* devel-docs/Makefile.am: require gtk-doc when running 'make dist'.

2005-01-20  Sven Neumann  <sven@gimp.org>

	* app/paint-funcs/scale-funcs.[ch]: applied patch from Geert
	Jordaens that improves results of the Lanczos interpolation
	routine.

2005-01-20  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcomponenteditor.c
	(gimp_component_editor_button_press): call gimp_image_flush() after
	setting the active component since this might unselect the active
	channel. Fixes bug #164195.

2005-01-19  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-transform.c: applied a patch from Geert
	Jordaens that fixes the crash in the drawable transformations
	using the Lanczos interpolation type. The result is somewhat wrong
	though :(

2005-01-18  Manish Singh  <yosh@gimp.org>

	* plug-ins/jpeg/jpeg-save.[ch]: Adapted the code from the stable
	branch (based on a patch from Nils Philippsen) that makes sure that
	the EXIF thumbnail doesn't cause the EXIF data block to grow beyond
	its maximum size. Fixes bug #164087.

2005-01-19  Sven Neumann  <sven@gimp.org>

	* app/display/gimpscalecombobox.c (gimp_scale_combo_box_set_scale):
	don't use == to compare floating point values.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/bumpmap.c: make sure bumpmap_init_params()
	is called when necessary, fixes bug #162285.
	
2005-01-18  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpparasitelist.c (parasite_serialize): use
	gimp_config_writer_data() to write the parasite data because
	it's binary and can contain '\0'.

	(gimp_parasite_list_deserialize): use gimp_scanner_parse_data() to
	read it. Still accepts the old file format for backward
	compatibility. Fixes bug #163131.

2005-01-18  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpdockable.c (gimp_dockable_expose_event): blink
	more correctly.

2005-01-18  Carol Spears  <carol@gimp.org>

	* data/images/gimp-splash.png a different splash for the
        developers branch.

	* data/images/gimp-splash.png fixed a commit conflict.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* gimp/plug-ins/jpeg/gimpexif.c
	* gimp/plug-ins/jpeg/gimpexif.h: new files with prototype
	interface code for metadata system.

	* gimp/plug-ins/jpeg/Makefile.am
	* gimp/plug-ins/jpeg/jpeg-exif.c
	* gimp/plug-ins/jpeg/jpeg.c: adapted to metadata interface
	as described on gimp-dev mailing list.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* libgimpwidgets/gimpwidgets.c (gimp_coordinates_callback):
	Make sure last_x and last_y are set to values that match
	those returned by gimp_size_entry_get_refval(), 
	fixes bug #163951.
	
2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/dialogs/info-dialog.c: disconnect callbacks to prevent crash
	when destroying dialog, fixes bug #163617.
	
2005-01-18  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpdockable.[ch]: added new function
	gimp_dockable_blink() which lets the dockable's title_area blink.

	* app/widgets/gimpdialogfactory.c
	(gimp_dialog_factory_dialog_new_internal): let wilber blink at the
	user :) Fixes bug #164156.

2005-01-18  Alexander Shopov  <ash@contact.bg>

	* configure.in (ALL_LINGUAS): Added "bg" (Bulgarian)

2005-01-17  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/xjt/xjt.c: use gimp_temp_name instead of trying to
	create temp dir at loc of file, fixes bug #164116.
	
2005-01-17  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/spheredesigner.c: add basic validity check
	when attempting to open a preset; let's say this fixes
	bug #148984.

2005-01-17  Michael Natterer  <mitch@gimp.org>

	Allow to drop stuff onto empty layers, channels and paths dialogs
	to create new items:

	* app/widgets/gimpcontainertreeview.h (struct GimpContainerTreeView):
	added "gboolean dnd_drop_to_empty".

	* app/widgets/gimpcontainertreeview-dnd.c: if "dnd_drop_to_empty"
	is TRUE, dispatch drops to empty views and to the empty area below
	all items.

	* app/widgets/gimpitemtreeview.c (gimp_item_tree_view_init): set
	"dnd_drop_to_empty" to TRUE.

	* app/widgets/gimpitemtreeview.c
	* app/widgets/gimpchanneltreeview.c
	* app/widgets/gimpdrawabletreeview.c
	* app/widgets/gimplayertreeview.c
	* app/widgets/gimpvectorstreeview.c: made all drop functions work
	with "dest_viewable" being NULL and changed drop_possible()
	implementations accordingly. Cleaned up the whole DND code a bit.

	* app/widgets/gimplayertreeview.c: removed color and pattern
	drop code...

	* app/widgets/gimpdrawabletreeview.c: and added it here so colors
	and patterns can be dropped to the channels dialog too.

2005-01-16  Sven Neumann  <sven@gimp.org>

	* app/tools/gimppaintoptions-gui.c (pressure_options_gui): added a
	toggle to control whether pressure affects opacity of the Airbrush
	tool (bug #164237).

2005-01-16  Sven Neumann  <sven@gimp.org>

	* app/config/gimpdisplayconfig.[ch]
	* app/dialogs/preferences-dialog.c: also list the default image
	title and statusbar formats.

2005-01-16  Sven Neumann  <sven@gimp.org>

	* app/dialogs/preferences-dialog.c: renamed default image title
	and statusbar format as suggested in bug #150679.

2005-01-16  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/curve_bend.c: applied patch from Jan Heller that
	fixes broken expose event handling (bug #164207).

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpchannel.c: implement GimpItem::convert(). Handles
	any drawable, including conversion to GRAY, flattening and
	resizing.

	* app/widgets/gimpchanneltreeview.c: implement dropping of all
	kinds of drawables as new channels. Fixes bug #158133.

	Simplified component dropping by removing stuff which is done by
	gimp_item_convert() now.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-transform.c
	* app/paint-funcs/scale-funcs.c: minor cleanups to the new Lanczos
	interpolation routines. Drawable transformations do still crash :(

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/display/gimpdisplayshell-dnd.[ch]: added new function
	gimp_display_shell_dnd_init() which connects all DND callbacks.
	Made all DND callbacks static.

	* app/display/gimpdisplayshell.c (gimp_display_shell_init): call
	above function instead of connecting all DND callbacks here. Removed
	lots of now unused #includes.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpitem.c
	* app/core/gimpdrawable.c
	* app/vectors/gimpvectors.c: made GimpItem::scale() and ::resize()
	work on unattached items.

	* app/widgets/gimplayertreeview.c
	(gimp_layer_tree_view_drop_component): fix drop index.

	* app/widgets/gimpchanneltreeview.c: implement dropping of
	components as new channels. Fixes bug #158483.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpcontainertreeview.[ch]: added virtual function
	GimpContainerTreeView::drop_component(). Added EEKy "dnd_gimp"
	needed for gimp_selection_data_get_component().

	* app/widgets/gimpitemtreeview.c (gimp_item_tree_view_set_context):
	set the "dnd_gimp" pointer if it is NULL.

	* app/widgets/gimpcontainertreeview-dnd.c: handle component drops
	and dispatch ::drop_component() accordingly.

	* app/widgets/gimplayertreeview.c: implement dropping of
	components as new layers. Addresses bugs #158483 and #158133.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/display/gimpdisplayshell.c
	* app/display/gimpdisplayshell-dnd.[ch]
	* app/widgets/gimptoolbox-dnd.c: enabled dropping of components
	to the display and the toolbox. Addresses bug #158483.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpchannel.c (gimp_channel_new*): don't require a
	non-NULL color parameter (just leave the default color untouched
	if NULL is passed).

	* app/actions/channels-commands.c
	* app/core/gimpchannel-select.c: pass NULL as color for temporary
	channels or channels where we used to pass black.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpdnd.c: added gimp_dnd_get_component_icon().

	* app/widgets/gimpcomponenteditor.c: allow to drag
	components. They can't be dropped anywhere yet.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* libgimp/gimptile.c (gimp_tile_put)
	* libgimp/gimp.c (gimp_loop) (gimp_read_expect_msg): added missing
	calls to wire_destroy(). Plugs memory leaks in the wire protocol.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimpprotocol.c: formatting.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_free_script)
	* plug-ins/script-fu/siod-wrapper.c (init_procedures): plugged
	memory leaks.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpitemtreeview.c
	(gimp_item_tree_view_drop_viewable): handle drops of items of all
	types from all images and convert them if needed.

	* app/widgets/gimplayertreeview.c: enable dropping of all kinds of
	drawables. Addresses bug #158133.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/widgets/widgets-enums.h (enum GimpDndType): reordered so
	COMPONENT is after IMAGE.

	* app/widgets/gimpdnd.[ch]
	* app/widgets/gimpselectiondata.[ch]: added API for passing
	components around via DND. Speaks in terms of a
	(GimpImage,GimpChannelType) tuple.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/psd_save.c: fixed array out-of-bounds access and
	some mem-leaks reported by valgrind.

2005-01-14  Jay Cox  <jaycox@gimp.org>

	* plug-ins/common/psd_save.c: Much less wasted memory.  Save guides.
	Fixes bug #151904.

2005-01-14  Michael Natterer  <mitch@gimp.org>

	* app/paint/gimppaintcore-undo.c: doesn't need "gimp-intl.h" either.

2005-01-14  Sven Neumann  <sven@gimp.org>

	* app/paint/gimpink-undo.c: doesn't need to include "gimp-intl.h".

2005-01-14  Michael Natterer  <mitch@gimp.org>

	* app/core/core-enums.[ch] (enum GimpUndoType): added GIMP_UNDO_INK.

	* app/paint/gimppaintcore.[ch]: added virtual function
	GimpPaintCore::push_undo() and call it.

	* app/paint/gimppaintcore-undo.[ch]: made it the default
	implementation.

	* app/paint/gimpink-blob.[ch]: added blob_duplicate().

	* app/paint/gimpink.[ch]: added a "start_blob" (just like
	GimpPaintCore::start_coords) which gets set whenever we start a
	new stroke or line. Removed ink->lastx and ink->lasty because
	they are the same as paint_core->last_coords.

	* app/paint/Makefile.am
	* app/paint/gimpink-undo.[ch]: new files implementing an
	undo step for ink which restores the last blob used along
	with the whole ink state. Fixes bug #163670.

2005-01-14  Michael Natterer  <mitch@gimp.org>

	* app/actions/buffers-commands.[ch]
	* app/actions/data-commands.[ch]
	* app/actions/documents-commands.[ch]
	* app/actions/palettes-commands.[ch]
	* app/actions/templates-commands.[ch]: changed the remaining
	callbacks to follow a consistent naming scheme
	(e.g. buffers_delete_buffer_cmd_callback ->
	buffers_delete_cmd_callback).

	* app/actions/brushes-actions.c
	* app/actions/buffers-actions.c
	* app/actions/documents-actions.c
	* app/actions/gradients-actions.c
	* app/actions/palettes-actions.c
	* app/actions/patterns-actions.c
	* app/actions/templates-actions.c: changed accordingly.

2005-01-14  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/retinex.c (run): fixed check for number of
	parameters in non-interactive mode.

2005-01-13  Manish Singh  <yosh@gimp.org>

	* plug-ins/common/channel_mixer.c: Add a Reset button. Addresses
	bug #163045.

2005-01-14  Sven Neumann  <sven@gimp.org>

	* plug-ins/bmp/bmpread.c: removed obscure error codes from
	translatable error messages.

2005-01-13  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/Lighting/lighting_shade.c: remove artifacts
	when light strikes underside of bumpmapped surface;
	should fix bug #163877.
	
2005-01-13  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/bmp/bmp.h
	* plug-ins/bmp/bmpread.c: handle negative height values
	as per spec, fixes bug #158033
	
2005-01-13  Michael Natterer  <mitch@gimp.org>

	Allow to easily open brushes and patterns as images.
	Fixes bug #163059.

	* app/actions/brushes-actions.c
	* app/actions/patterns-actions.c: added "brushes-open-as-image"
	and "patterns-open-as-image" actions.

	* app/actions/data-commands.[ch]: added
	data_open_as_image_cmd_callback() which tries to load
	data->filename as image.

	* app/widgets/gimphelp-ids.h: added help IDs for the new actions.

	* app/widgets/gimpdatafactoryview.c: added buttons.

	* menus/brushes-menu.xml
	* menus/patterns-menu.xml: added them to the menus.

2005-01-13  Michael Natterer  <mitch@gimp.org>

	Splitting GimpItem::convert() into two virtual functions was
	apparently buggy over-engineering. Reverted that stuff and
	implement item conversion much simpler:

	* app/core/gimpitem.[ch]: have a single virtual function,
	GimpItem::convert(), which takes a newly duplicated item and the
	destination image.

	(gimp_item_convert): simply call GimpItem::convert() on the result
	of gimp_item_duplicate().

	(gimp_item_real_convert): set the item's new image.

	* app/core/gimplayer.c (gimp_layer_convert)
	* app/vectors/gimpvectors.c (gimp_vectors_convert): changed
	accordingly and chain up after, not before doing our own stuff
	so the old image is still available as item->image for stuff
	like colormap conversion. Fixes bug #163879.

2005-01-13  Michael Natterer  <mitch@gimp.org>

	Made the file open and save dialogs use the last used folder
	instead of defaulting to current directory. Fixes bug #162385.

	* app/widgets/gimpfiledialog.[ch] (gimp_file_dialog_set_uri):
	removed this function because it had no functionality except
	creating usability problems.

	* app/actions/file-commands.c: use gtk_file_chooser_set_uri()
	instead but *only* if we already have an uri from an alread open
	image or the document hinstory.

	* app/widgets/gimpfiledialog.c (gimp_file_dialog_set_image): set
	the file chooser's uri only if we have an uri from the image
	itself. Leave the current folder untouched otherwise and just set
	the current name (e.g. "Untitled").

	* app/dialogs/file-save-dialog.c (file_save_dialog_save_image): on
	successful save, remember the used uri by attaching it to the
	"gimp" instance.

	(file_save_dialog_new): set the last saved uri's folder on the
	newly created file save dialog.

2005-01-13  Sven Neumann  <sven@gimp.org>

	* app/units.c
	* app/core/gimp-units.c
	* app/core/gimp.c
	* app/core/gimpunit.[ch]: added a utility function that frees the
	memory allocated for user units. Minor cleanups.

2005-01-13  Sven Neumann  <sven@gimp.org>

	* configure.in (ALL_LINGUAS): added mk (Macedonian).

2005-01-11  Sven Neumann  <sven@gimp.org>

	* app/pdb/drawable_transform_cmds.c
	* libgimp/gimpenums.h
	* plug-ins/pygimp/gimpenums.py
	* tools/pdbgen/enums.pl: regenerated after change of
	GimpInterpolationType enum.

2005-01-11  Sven Neumann  <sven@gimp.org>

	* app/base/base-enums.[ch]
	* app/core/gimpdrawable-transform.c
	* app/core/gimpdrawable.c
	* app/paint-funcs/Makefile.am
	* app/paint-funcs/paint-funcs.[ch]
	* app/paint-funcs/scale-funcs.[ch]: applied patch by Geert Jordaens
	(after a good deal of reformatting for coding style compliance).
	This factors the scale routines into their own file and adds a
	sinc-based (Lanczos) interpolation routine (bug #162250).

2005-01-11  Sven Neumann  <sven@gimp.org>

	* plug-ins/script-fu/siod/slib.c (help): removed wrong URL from
	help output.

2005-01-10  Manish Singh  <yosh@gimp.org>

	* modules/controller_midi.c: #include <time.h> to make sure all
	the types are there for the alsa headers. Should address bug
	#163593.

2005-01-10  Sven Neumann  <sven@gimp.org>

	* tools/pdbgen/pdb/text_tool.pdb: explicitely mention the encoding.

	* app/pdb/text_tool_cmds.c
	* libgimp/gimptexttool_pdb.c: regenerated.

2005-01-10  DindinX  <dindinx@gimp.org>

	* plug-ins/common/sparkle.c: update the preview when a parameter
	change.  Updating the preview is now disabled by default since it
	can be very slow.

2005-01-09  Sven Neumann  <sven@gimp.org>

	* libgimp/gimpgradientmenu.c: fixed out-of-bounds access in
	gradient selection widget. Presumably fixes bug #163427.

2005-01-09  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontrollerkeyboard.c: changed "Key" to "Cursor".

2005-01-09  DindinX  <dindinx@gimp.org>

	* plug-ins/common/sparkle.c: added a preview. This will need more
	testing.  Shlomi Fish, can you please try to test this plug-in again?

2005-01-09  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpactionview.c (gimp_action_view_new): connect to
	"button_press_event" and start editing immidiately instead of
	waiting for a second click. Fixes bug #163385.

2005-01-09  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpdialogfactory.c (gimp_dialog_factories_toggle):
	if called with (ensure_visibility == TRUE), raise the toolbox.
	Fixes bug #163381.

2005-01-08  DindinX  <dindinx@gimp.org>

	* plug-ins/common/mosaic.c: made the preview fast enough to be useful.

2005-01-08  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontainertreeview.c
	(gimp_container_tree_view_button_press): fixed handling of clicks
	into a horizontally scrolled treeview.

	(gimp_container_tree_view_find_click_cell): really fix handling of
	RTL layouts (bug #162663).

2005-01-08  Sven Neumann  <sven@gimp.org>

	* app/dialogs/scale-dialog.c: use a GimpMessageBox to display the
	informative message when scaling an indexed image.

2005-01-07  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontainertreeview.c
	(gimp_container_tree_view_button_press): handle RTL layouts (fixes
	bug #162663).

2005-01-07  Shlomi Fish  <shlomif@iglu.org.il>

	* plug-ins/script-fu/scripts/frosty-logo.scm: made sure the shadow
	is given enough space and then truncated instead of translated to
	the center of the image, thus preventing the display of shadows
	with a completely horizontal or vertical edge.

	Fixes bug #132145.

2005-01-07  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpimage-snap.c: moved variables to local scopes,
	assign the snapped coords unconditionally (also if we don't snap),
	cleanup.

	(gimp_image_snap_rectangle): entirely rewritten to use local
	mindist_x, mindist_y variables instead of fiddling with lots of
	boolean variables. Implemented vectors snapping as if the required
	GimpStroke functions existed (#defined them). Simon, your turn :)

2005-01-07  Michael Natterer  <mitch@gimp.org>

	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c: GIMP_PROGRESS(NULL) is perfectly
	valid, no need to say gdisp ? GIMP_PROGRESS(gdisp) : NULL.

	* app/actions/plug-in-commands.c (plug_in_run_cmd_callback):
	remember the last plug-in if it has at least 3 args, not 2.
	Cleaned up the whole function and removed cruft.

2005-01-07  Sven Neumann  <sven@gimp.org>

	* app/composite/gimp-composite-x86.h
	* app/composite/gimp-composite-sse.c: applied patch from Andreas
	Jochens that fixes the build on amd64 with gcc-4.0 (bug #163041).

2005-01-07  Sven Neumann  <sven@gimp.org>

	* data/misc/gimp.desktop.in.in: changed Comment field as suggested
	in bug #160990.

2005-01-07  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/mail.c: just some minor formatting changes.

2005-01-07  Sven Neumann  <sven@gimp.org>

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg-exif.c
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg.[ch]: some code cleanup.

2005-01-06  Manish Singh  <yosh@gimp.org>

	* libgimpwidgets/gimpdialog.c: flush the display in dispose if we're
	no longer in a main loop, so the dialog doesn't hang around while
	possibly long running calculations are being done. Fixes bug #163084.

2005-01-06  Michael Schumacher <schumaml@cvs.gnome.org>

	* libgimpwidgets/gimpwidgets.def: added
	gimp_scrolled_preview_set_position 

2005-01-06  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/sparkle.c: applied patch from Shlomi Fish that
	fixes more regressions in Sparkle plug-in (bug #132145).

2005-01-05  DindinX  <dindinx@gimp.org>

	* libgimpwidgets/gimpscrolledpreview.[ch]: new function:
	gimp_scrolled_preview_set_position () to set the position of the
	preview content wrt the drawable.  This function might be moved to a
	virtual function of GimpPreview in a near future.

	* libgimp/gimpdrawablepreview.c: use this function, so a preview
	remembers its position from one invocation to the next.  This is done
	using the current executable name as a key for gimp_set/get_data () so
	each plug-in can have its preview on a different place.

	More informations could be saved this way: the update toggle, the
	checks, etc.

	Addresses bug #162286.

	* libgimpwidgets/gimppreview.c: smallish cleanup.

2005-01-04  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* configure.in: add check for libexif version >= 0.6.0,
	necessary because of nasty incompatible api change.
	
	* plug-ins/jpeg/exif-handling.txt: removed from here...

	* devel-docs/exif-handling.txt: ...and added here
	
	* plug-ins/jpeg/jpeg-exif.c
	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg.h: extract info from exif on loading,
	and add info to exif on saving, addresses bug #56433,
	bug #61499, and bug #121810.
	
2005-01-04  Sven Neumann  <sven@gimp.org>

	* app/display/gimpdisplayshell-close.c
	(gimp_display_shell_close_dialog): set the default response to
	Cancel in order to reduce the risk of accidentally saving an
	image (bug #162872).

2005-01-04  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontainertreeview.c: prepared code for fixing
	bug #162663.

2005-01-03  DindinX  <dindinx@gimp.org>

	* plug-ins/common/mosaic.c: invalidate the preview when a parameter
	changes.  Disabled updating the preview by default. There is room
	for optimisations, but this fixes #162710.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpcellrenderertoggle.c
	(gimp_cell_renderer_toggle_get_size): made the code look more
	similar to GtkCellRendererToggle to allow for easy comparison.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* app/menus/plug-in-menus.c: made the code a little more robust by
	not relying on certain properties of the menu path.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* tools/pdbgen/pdb/gradient.pdb: do actually add the new procedure
	gimp_gradient_is_editable().

	* app/pdb/gradient_cmds.c
	* app/pdb/internal_procs.c
	* libgimp/gimpgradient_pdb.[ch]: regenerated.

	* libgimp/gimp.def: updated.

2005-01-03  Michael Natterer  <mitch@gimp.org>

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]
	* app/display/gimpdisplayshell-appearance.[ch]
	* menus/image-menu.xml.in: reordered actions, functions and menu
	items so the "show" and "snap" actions are grouped.

2005-01-03  Michael Natterer  <mitch@gimp.org>

	Implemented "Snap to Canvas Edges" (fixes bug #152971) and
	"Snap to Active Path" (half way done):

	* app/core/gimpimage-snap.[ch]: added boolean snap_to_canvas and
	snap_to_vectors parameters (snap_to_vectors works fine when
	snapping to a point, but is unimplemented for snapping to a
	rectangle).

	* app/display/gimpdisplayshell.[ch] (struct GimpDisplayShell):
	added snap_to_canvas and snap_to_vectors booleans.

	* app/display/gimpdisplayshell-appearance.[ch]: added API to
	get/set them.

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]
	* app/widgets/gimphelp-ids.h: added actions, callbacks and help IDs.

	* menus/image-menu.xml.in: added them to Image->View.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* plug-ins/ifscompose/ifscompose.c: use g_free() to release memory
	allocated using g_malloc().

2005-01-03  Michael Natterer  <mitch@gimp.org>

	* app/display/gimpdisplayshell-autoscroll.c
	(gimp_display_shell_autoscroll_timeout): need to snap the
	coordinates before passing them to the active tool.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/fp.c: removed GtkFrame from dialog and replaced
	a call to free() by g_free().

2005-01-03  Michael Natterer  <mitch@gimp.org>

	* app/paint/gimpbrushcore.c
	* app/paint/gimppaintoptions.[ch]
	* app/tools/gimppaintoptions-gui.c: renamed "invsize" to
	"inverse-size" and reordered it to be after "size".

2005-01-03  Sven Neumann  <sven@gimp.org>

	* etc/ps-menurc: another update from Eric Pierce.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* app/paint/gimpink.[ch]: handle event time as guint32. That's the
	type we deal with here and it avoids a crash that occured when
	autoscrolling with the Ink tool.

	* app/display/gimpdisplayshell-autoscroll.c: cosmetics.

2005-01-02  Michael Natterer  <mitch@gimp.org>

	* app/display/Makefile.am
	* app/display/gimpdisplayshell-autoscroll.[ch]
	* app/display/gimpdisplayshell-coords.[ch]: new files factored out
	of gimpdisplayshell-callbacks.c

	* app/display/gimpdisplayshell.h (struct GimpDisplayShell): added
	"gpointer scroll_info" needed by autoscroll.

	* app/display/gimpdisplayshell-callbacks.c: removed the stuff
	above. Also removed the static autoscroll struct because it's not
	needed any longer.

2005-01-02  DindinX  <dindinx@gimp.org>

	* plug-ins/common/mosaic.c: Added a preview.  This still needs some
	work and some testing.  Calculating the preview takes ages.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/exif-handling.txt:  added summary of how Gimp should
	handle each exif field according to the specs.
	
2005-01-02  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpsizebox.c
	* app/widgets/gimptemplateeditor.c: round displayed resolution
	instead of just casting to integer values. Use image size limits
	from libgimpbase/gimplimits.h instead of some arbitrary numbers.

2005-01-02  Manish Singh  <yosh@gimp.org>

	* plug-ins/pygimp/plug-ins/clothify.py
	* plug-ins/pygimp/plug-ins/foggify.py: Add layers to images before
	using them. Fixes bug #162707.

2005-01-02  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_about.c: bumped version number

	* plug-ins/imagemap/AUTHORS
	* plug-ins/imagemap/NEWS
	* plug-ins/imagemap/README
	* plug-ins/imagemap/TODO: removed since they don't contain relevant
	information anymore.

	* plug-ins/imagemap/imap_popup.[ch]: removed

	* plug-ins/imagemap/Makefile.am
	* po-plug-ins/POTFILES.in: changed accordingly

	* plug-ins/imagemap/imap_grid.c
	* plug-ins/imagemap/imap_main.[ch]
	* plug-ins/imagemap/imap_menu.[ch]
	* plug-ins/imagemap/imap_object_popup.c
	* plug-ins/imagemap/imap_preview.c
	* plug-ins/imagemap/imap_toolbar.[ch]
	* plug-ins/imagemap/imap_tools.[ch]: first set of changes to fix
	#138841 (Use action based menus in Imagemap plug-in).
	
2005-01-02  Sven Neumann  <sven@gimp.org>

	* app/gui/splash.c (splash_update): fixed display of progress
	labels in RTL environment.

2005-01-02  Sven Neumann  <sven@gimp.org>

	* etc/ps-menurc: updated PS keybindings contributed by Eric Pierce.

2005-01-02  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpsizebox.c (gimp_size_box_constructor): fixed
	position of pixel and resolution labels.

2005-01-02  Sven Neumann  <sven@gimp.org>

	* app/display/gimpdisplayshell-callbacks.c: fixed auto-scrolling
	for left and bottom display edges. Remove the timeout on
	button-release event, some minor cleanups.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/jpeg_load.c
	* plug-ins/jpeg/jpeg_load.h
	* plug-ins/jpeg/jpeg_save.c
	* plug-ins/jpeg/jpeg_save.h: removed
	
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-load.h
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg-save.h: added (changing _ to -)

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg.c
	* po-plug-ins/POTFILES.in: changed accordingly

2005-01-02  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/sparkle.c: applied patch from Shlomi Fish that
	fixes regressions in Sparkle plug-in (bug #132145).

2005-01-02  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/plugin-defs.pl: changed for move of JPEG plug-in.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/Lighting/lighting_ui.c: add a control for
	viewpoint distance.  Should finish fixing bug #4044.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/NEWS
	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg.h
	* plug-ins/jpeg/jpeg_load.c
	* plug-ins/jpeg/jpeg_load.h
	* plug-ins/jpeg/jpeg_save.c
	* plug-ins/jpeg/jpeg_save.h: moved jpeg code into new
	dir and split up, already too large and a good bit more 
	will be needed for proper exif handling.
	
	* plug-ins/common/jpeg.c: removed

	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/common/Makefile.am: changed accordingly

2005-01-01  Manish Singh  <yosh@gimp.org>

	* plug-ins/common/tiff.c: Revert incorrect optimization from previous
	change.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/gradmap.c: added procedure plug_in_palettemap
	that does the same thing as gradmap except using the current
	palette; should resolve bug #68879.
	
2005-01-02  Manish Singh  <yosh@gimp.org>

	* plug-ins/common/tiff.c: Special case 1-bit black & white indexed
	images to save out as 1-bit grayscale MINISWHITE tiffs. Also load
	these images as indexed images into GIMP. Fixes bug #150865.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/display/gimpdisplayshell-callbacks.c: use a timeout for
	autoscrolling, to fix bug #8269.  Happy new year!

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/gimpbrushcore.c
	* app/paint/gimppaintoptions.c
	* app/paint/gimppaintoptions.h
	* app/tools/gimppaintoptions-gui.c: reverted last change, and
	applied full patch from Dave Ahlswede in bug #149576.

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* tools/pdbgen/pdb/gradient.pdb: added gradient-is-editable

	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/palette.pdb: changed mitch_misc to bill_misc
	where correct.

	* app/pdb/brush_cmds.c
	* app/pdb/palette_cmds.c
	* libgimp/gimpbrush_pdb.c
	* libgimp/gimppalette_pdb.c: regenerated.

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/gimpbrushcore.c: make previously committed change
	in pressure-size relationship apply only to airbrush, as
	intended.
	
2004-12-31  Michael Natterer  <mitch@gimp.org>

	* app/actions/plug-in-actions.c: use the orininal string if
	plug_in_actions_check_translation() fails instead of bailing out.
	Fixes bug #162590.

2004-12-31  Michael Natterer  <mitch@gimp.org>

	* app/core/gimppalette.[ch]: removed the just added
	gimp_palette_insert_entry() and added a "gint position" parameter
	to gimp_palette_add_entry() instead (no need to have two almost
	identical functions).

	* app/actions/palette-editor-commands.c
	* app/core/gimppalette-import.c
	* app/widgets/gimppaletteeditor.c
	* tools/pdbgen/pdb/palette.pdb: changed accordingly.

	* app/pdb/palette_cmds.c: regenerated.

2004-12-31  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpfgbgeditor.[ch]: use the coordinates passed in
	the color drop callback instead of remembering them in the
	drag_motion handler.

2004-12-31  Sven Neumann  <sven@gimp.org>

	* tools/kernelgen.c: fixed rounding so that all brush kernels are
	created with a constant sum of 256.

	* app/paint/gimpbrushcore-kernels.h: regenerated.

	* app/paint/gimpbrushcore.c (gimp_brush_core_subsample_mask): use
	the constant defined in app/paint/gimpbrushcore-kernels.h. Should
	give a tiny speedup.

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/gimpbrushcore.c: invert dependence of brush size on
	pressure, using formula from Dave Ahlswede in bug #149576.
	
2004-12-31  Michael Natterer  <mitch@gimp.org>

	Applied modified patch from Ben Campbell which adds drop
	coordinates to the color drop callback and uses it to insert
	colors in the palette editor. Extended the patch to add drop
	coordinates to all drop callbacks.

	* app/core/gimppalette.[ch]: added gimp_palette_insert_entry().

	* app/display/gimpdisplayshell-dnd.[ch]: added drop coordinates
	to all drop callbacks.

	* app/dialogs/palette-import-dialog.c
	* app/widgets/gimpcolormapeditor.c
	* app/widgets/gimpcontainerview.c
	* app/widgets/gimpdnd.[ch]
	* app/widgets/gimpdrawabletreeview.c
	* app/widgets/gimpfgbgeditor.c
	* app/widgets/gimpgradienteditor.c
	* app/widgets/gimpitemtreeview.c
	* app/widgets/gimppaletteeditor.c
	* app/widgets/gimppropwidgets.c
	* app/widgets/gimpselectioneditor.c
	* app/widgets/gimptoolbox-dnd.c
	* app/widgets/gimptoolbox-image-area.c
	* app/widgets/gimptoolbox-indicator-area.c
	* app/widgets/gimptooloptionseditor.c
	* libgimpwidgets/gimpcolorselect.c: changed accordingly. The passed
	drop coordiantes are so far unused.

	* app/widgets/gimppaletteeditor.c: use the drop coordinates to
	insert the new color into the palette at the right place instead
	of always appending. Fixes bug #150030.

2004-12-31  Michael Natterer  <mitch@gimp.org>

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]
	* app/widgets/gimptoolview.[ch]: applied a (modified) patch from
	Joao S. O. Bueno which adds "raise" and "lower" actions and
	their buttons in the tool dialog. Fixes bug #158666.
	Cleaned up the tool action callbacks.

2004-12-31  Sven Neumann  <sven@gimp.org>

	* plug-ins/imagemap/imap_preview.c (render_rgb_image): use the proper
	image type and rowstride. Fixes bug #162592.

2004-12-30  Manish Singh  <yosh@gimp.org>

	* tools/Makefile.am
	* app/Makefile.am: build binaries with 2.3 versions.

2004-12-30  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/widgets/gimpsizebox.c: give correct arguments to
	gimp_coordinates_new().  Fixes problem described in
	comment 6 of bug #162387.
	
2004-12-31  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped gimp_app_version and gimp_user_version to 2.3.

	* app/Makefile.am
	* tools/Makefile.am: changed to 2.3.

2004-12-30  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* tools/pdbgen/pdb/brush.pdb: added api for changing properties
	of generated brushes.
	
	* tools/pdbgen/pdb/palette.pdb: added palette_is_editable().

	* app/pdb/brush_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/palette_cmds.c
	* libgimp/gimpbrush_pdb.c
	* libgimp/gimpbrush_pdb.h
	* libgimp/gimppalette_pdb.c
	* libgimp/gimppalette_pdb.h: autogenerated.

2004-12-29  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped version to 2.3.0.

2004-12-29  Sven Neumann  <sven@gimp.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_response):
	handle a NULL return value from gtk_file_chooser_get_uri(). Fixes
	bug #162443.

2004-12-29  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_preferences.[ch]: replace home-brewn color
	selection by GimpColorButton.

2004-12-29  DindinX  <dindinx@gimp.org>

	* plug-ins/gfig/gfig-rectangle.[ch]
	* plug-ins/gfig/images/stock-rectangle.png: news files to implement a
	rectangle tool to gfig.

	* plug-ins/gfig/gfig-stock.c
	* plug-ins/gfig/gfig-stock.h
	* plug-ins/gfig/Makefile.am: modified accordingly.

	* plug-ins/gfig/gfig-circle.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig-dobject.c
	* plug-ins/gfig/gfig-ellipse.c
	* plug-ins/gfig/gfig-poly.c
	* plug-ins/gfig/gfig-star.c
	* plug-ins/gfig/gfig-types.h
	* plug-ins/gfig/gfig.c
	* plug-ins/gfig/gfig.h: modified to support the new shape and
	implement two new filling types: vertical and horizontal gradients.
	These gradients are imho much more useful than the shapeburst one.

2004-12-28  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/compose.c: Recompose did not properly 
	handle case where layer with alpha is decomposed into
	something that does not encode alpha -- now does.

	
2004-12-28  Michael Natterer  <mitch@gimp.org>

	* app/core/gimp-edit.c (gimp_edit_set_buffer): new utility
	function instead of code duplication.

2004-12-28  Michael Natterer  <mitch@gimp.org>

	* app/base/base-enums.[ch]: added translatable strings to the
	GimpLayerModeEffects enum because they will soon disappear from
	widgets/gimpwidgets-constructors.c

2004-12-28  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/compose.c: add "Recompose" (plug_in_recompose) 
	as described on dev mailing list.

	* plug-ins/common/decompose.c: add "decompose-data" parasite
	when decoposing, to support Recompose.  Also add missing 
	alpha channels to newly produced layers
	
2004-12-28  Sven Neumann  <sven@gimp.org>

	* Made 2.2.1 release.

2004-12-28  Sven Neumann  <sven@gimp.org>

	* libgimp/gimp.[ch] (gimp_install_procedure, gimp_install_temp_proc):
	renamed menu_path parameter to menu_label and added a pointer to
	gimp_plugin_menu_register()

	* app/widgets/gimpsizebox.c (gimp_size_box_constructor): removed
	unused variables.

2004-12-28  Sven Neumann  <sven@gimp.org>

	* app/paint/gimpbrushcore.c (gimp_brush_core_subsample_mask):
	reverted Bill's change since it is obviously not the right fix.
	Allocate the array larger to avoid the crash. We need to
	investigate bug #161323 further.

2004-12-27  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/gimpbrushcore.c (gimp_brush_core_subsample_mask):
	don't set array outside its bounds.  Should fix bug #161323.
	Credit to Robert ÃÂgren for figuring out what was wrong.
	
2004-12-27  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/colortoalpha.c: if possible, use
	gimp_preview_draw_buffer() so that the selection mask is correctly
	previewed. Minor cleanups.

2004-12-27  Sven Neumann  <sven@gimp.org>

	* libgimp/gimpregioniterator.c: added some checks to avoid
	division by zero.

	* libgimpwidgets/gimppreviewarea.[ch]: minor cleanups, improved
	API documentation.

2004-12-26  DindinX  <dindinx@gimp.org>

	* plug-ins/gfig/gfig-arc.c
	* plug-ins/gfig/gfig-bezier.c
	* plug-ins/gfig/gfig-circle.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig-ellipse.c
	* plug-ins/gfig/gfig-line.c
	* plug-ins/gfig/gfig-poly.c
	* plug-ins/gfig/gfig-spiral.c
	* plug-ins/gfig/gfig-star.c
	* plug-ins/gfig/gfig-style.h
	* plug-ins/gfig/gfig.h: plugged some memory-leaks, and done some
	cleanups.

2004-12-26  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/core/gimpbrush.c: don't ask for preview with
	zero width or height, fixes bug #162232.

	* app/base/brush-scale.c: remove tabs and trailing
	whitespace.

2004-12-26  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/actions/documents-commands.c
	* app/actions/file-commands.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/display/gimpdisplayshell-dnd.c
	* app/widgets/gimplayertreeview.c
	* app/widgets/gimptoolbox-dnd.c: undo changes of 12-24,
	in favor of a better fix.

	* app/widgets/gimperrordialog.c: fix bug #162147 properly,
	as suggested by mitch.

2004-12-25  Michael Natterer  <mitch@gimp.org>

	* plug-ins/script-fu/scripts/weave.scm: limit the "Thread
	intensity" parameter to [0..100] because it's used as layer
	opacity. Fixes bug #162182.

2004-12-24  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/actions/documents-commands.c
	* app/actions/file-commands.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/display/gimpdisplayshell-dnd.c
	* app/widgets/gimplayertreeview.c
	* app/widgets/gimptoolbox-dnd.c: replace % with space
	in file name before showing error message, 
	fixes bug #162147.

	* app/core/gimp-gui.c
	* app/widgets/gimpmessagebox.c: be a bit more paranoid
	about validating utf8 for messages.

2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* gimp/app/widgets/gimpsizebox.c: fix incorrect Update
	Policy for size entry as pointed out by mitch.
	
2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/cartoon.c
	* plug-ins/common/cubism.c
	* plug-ins/common/displace.c
	* plug-ins/common/dog.c
	* plug-ins/common/emboss.c
	* plug-ins/common/engrave.c
	* plug-ins/common/gauss.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/neon.c
	* plug-ins/common/noisify.c
	* plug-ins/common/oilify.c
	* plug-ins/common/photocopy.c
	* plug-ins/common/ripple.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/shift.c
	* plug-ins/common/sobel.c
	* plug-ins/common/softglow.c
	* plug-ins/common/spread.c
	* plug-ins/common/tileit.c
	* plug-ins/common/whirlpinch.c: make sure tile cache is allocated
	before preview is shown -- significant speedup in some cases,
	minimal in others.

	* plug-ins/common/sel_gauss.c: give it a tile cache (didn't
	have one).  Still very slow but a little better.
	
2004-12-24  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/despeckle.c (despeckle_median): don't call
	gimp_progress_update() for each and every pixel. Every few rows
	should be enough. Fixes bug #162129.

	* plug-ins/common/blur.c: set progress to 1.0 when done, not to 100.

2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/mblur.c: set up tile cache before
	creating dialog -- major speedup in preview.
	
2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* gimp/app/widgets/gimpsizebox.c: use gimp_coordinates_new()
	instead of duplicating a lot of code.  Fixes bug #161756.
	
	* gimp/app/widgets/gimppropwidgets.c: small change in 
	chainbutton handling to make above work.

2004-12-23  Sven Neumann  <sven@gimp.org>

	* app/plug-in/plug-in-proc-frame.[ch]: made plug_in_proc_frame_free()
	a static function.

2004-12-23  Michael Natterer  <mitch@gimp.org>

	Item conversion depends on the old *and* the new item type, so
	it can't live in the old item's vtable only:

	* app/core/gimpitem.[ch]: split GimpItem::convert() into
	GimpItem::convert_from() (which is called on the old item and
	creates the new item) and GimpItem::convert_to() (which is called
	on the new item). This way functions from the old *and* new items'
	vtables are called and it's possible to convert between item types
	which live on different branches of the class hierarchy or to item
	types which live further down the class tree than the old item.

	(gimp_item_convert): call ::convert_to() on the new item created
	by ::convert_from().

	* app/vectors/gimpvectors.c: changed ::convert() implementation
	to ::convert_from().

	* app/core/gimplayer.c: changed ::convert() to ::convert_to().
	Fixes bug #161877.

2004-12-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/asc2img.scm: removed this script as it
	is broken beyond repair and the functionality is provided by the
	text tool itself.

2004-12-22  Sven Neumann  <sven@gimp.org>

	* NEWS: added NEWS for the stable branch (no, we haven't branched
	yet).

	* Makefile.am
	* NEWS.pre-2.2: moved old NEWS here.
	
2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c (blur_line): fixed the degenerate case
	where the source image is smaller than the blurred area. This used
	to give artefacts at the borders.

2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: more code cleanup and micro
	optimizations.

2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: reverted the last change since it
	introduced artefacts. Even had to increase the border around the
	previewed area. Fixed a bug in unsharp_region() where it was using
	the wrong source region for blurring.

2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: compute preview for the displayed area
	only, some more code cleanup.

2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c (preview_update): fixed bug #157910.
	More code cleanup and some trivial optimizations.

2004-12-21  Michael Natterer  <mitch@gimp.org>

	* app/actions/gradient-editor-actions.c
	(gradient_editor_actions_update): if the dialog is insensitive,
	disable all actions which modify the gradient. Fixes bug #161411.

	* app/actions/gradient-editor-commands.c: update the UI manager
	after setting the dialog sensitive/insensitive so te above works.

2004-12-20  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: more code cleanup.

2004-12-20  Sven Neumann  <sven@gimp.org>

	* libgimp/gimpdrawablepreview.c (gimp_drawable_preview_draw_region):
	unset the dirty flag on the GimpPixelRgn used to iterate the region.

	* libgimp/gimppixelrgn.c (gimp_pixel_rgn_init): improved docs.

2004-12-20  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: code cleanup, no real changes.

2004-12-20  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped version to 2.2.1.

	* plug-ins/FractalExplorer/FractalExplorer.c: applied patch from
	Yeti that fixes a memory corruption (bug #161729).

2004-12-19  Sven Neumann  <sven@gimp.org>

	* Made 2.2.0 release.
