2005-03-03  Manish Singh  <yosh@gimp.org>

	* tools/pdbgen/pdb/drawable.pdb: fix a typo in the docs.

2005-03-03  Manish Singh  <yosh@gimp.org>

	* plug-ins/pygimp/pygimp.h: Make a compatibility wrapper for
	PyBool_FromLong for pre-2.3 versions of python.

	* plug-ins/pygimp/gimpfu.py
	* plug-ins/pygimp/gimpui.py: Update to use some more modern python
	features.

	* plug-ins/pygimp/gimpmodule.c
	* plug-ins/pygimp/pygimp-display.c
	* plug-ins/pygimp/pygimp-drawable.c
	* plug-ins/pygimp/pygimp-image.c
	* plug-ins/pygimp/pygimp-parasite.c
	* plug-ins/pygimp/pygimp-pdb.c
	* plug-ins/pygimp/pygimp-tile.c: Throw exceptions on failures for
	libgimp wrappers (fixes bug #160136), and make the exception strings
	a lot more descriptive to aid debugging. Also return proper Bools when
	appropriate. Some new API wrapped as well. Still a work in progress.

	* plug-ins/pygimp/gimpplugin.py
	* plug-ins/pygimp/gimpshelf.py
	* plug-ins/pygimp/plug-ins/clothify.py
	* plug-ins/pygimp/plug-ins/foggify.py
	* plug-ins/pygimp/plug-ins/sphere.py: Add some whitespace to make
	things more readable.

2005-03-03  Sven Neumann  <sven@gimp.org>

	* libgimp/gimpdrawablecombobox.c
	* libgimp/gimpimagecombobox.c: set a width-request on the combo boxes.
	
	* plug-ins/common/bumpmap.c (SCALE_WIDTH): set a minimum width on
	the scales.

2005-03-02  Manish Singh  <yosh@gimp.org>

	* libgimp/gimp.[ch]
	* libgimp/gimpdrawable.[ch]
	* libgimp/gimpimage.[ch]: changed attach_new_parasite variants
	to return success or failure.

2005-03-02  Sven Neumann  <sven@gimp.org>

	* app/dialogs/resize-dialog.c (resize_dialog_reset)
	* app/dialogs/scale-dialog.c (scale_dialog_reset): don't rely on
	GObject internals about the order in which properties are being
	set. Fixes one aspect of bug #169011.

2005-03-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/tools-enums.[ch]: oops, missed in previous 
	commit.
	
2005-03-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/gimprectangletool.c
	* app/tools/gimprectangletool.h
	* app/tools/gimprectangleoptions.c
	* app/tools/gimprectangleoptions.h: new code for base
	class for rectangle tools.

	* app/tools/gimpnewrectselecttool.[ch]: modified to
	derive from GimpRectangleTool.

	* app/tools/Makefile.am: modified accordingly

	* app/tools/gimpselectionoptions.[ch]: remove stuff
	no longer needed by new rect select tool.

	This is work in progress.
	
2005-03-02  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/gimpgradienteditor.c: allow dnd of colors
	into preview and control areas, as described in
	bug #119470.

2005-03-02  Sven Neumann  <sven@gimp.org>

	* app/text/gimptextlayout.c
	* app/tools/gimptextoptions.[ch]: allow to adjust letter-spacing.

2005-03-01  Manish Singh  <yosh@gimp.org>

	* plug-ins/common/mail.c: use g_spawn_async_with_pipes instead of
	popen. Addresses bug #108659. Also some general cleanup.

	* plug-ins/common/mblur.c: Fix some typos in comments.

2005-03-01  Michael Natterer  <mitch@gimp.org>

	* app/core/core-enums.[ch]: added VISIBLE and LINKED to the
	GimpImageResizeLayers enum.

	* app/core/gimpimage-resize.c (gimp_image_resize_with_layers):
	changed accordingly. Also looks nicer now.

2005-03-01  Sven Neumann  <sven@gimp.org>

	* plug-ins/ifscompose/ifscompose.[ch]
	* plug-ins/ifscompose/ifscompose_utils.c: purely cosmetic coding
	style changes.

2005-03-01  Kevin Cozens  <kcozens@cvs.gimp.org>

	* plug-ins/script-fu/siod-wrapper.c: Fixed marshalling code to
	treat string arrays as arrays instead of lists of strings. Last
	part of the fix for bug #168290.

2005-03-01  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpenumcombobox.[ch]: removed 
	gimp_enum_combo_box_set_visible().

	* libgimpwidgets/gimpintcombobox.[ch]: added
	gimp_int_combo_box_set_sensitivity() instead.

	* app/tools/gimpcurvestool.c
	* app/tools/gimplevelstool.c
	* app/widgets/gimphistogrameditor.c: changed accordingly.

	* libgimpwidgets/gimpenumstore.h: added padding for future expansion.

	* libgimpwidgets/gimpwidgets.def: updated.

2005-02-28  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-blend.c: major speedup for dithering code
	thanks to a suggestion from Jay Cox.

2005-02-28  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimphelp.c (gimp_help_get_locales): use
	g_get_language_names().

	* plug-ins/help/locales.c (locales_parse): simplified;
	g_get_language_names() already takes care of this.

2005-02-27  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpintcombobox.c: allow to change ellipsation
	mode after the combo has been created.

2005-02-27  Sven Neumann  <sven@gimp.org>

	* plug-ins/imagemap/imap_menu.c (menu_build_mru_items): another
	build fix for compilers that don't support C99 extensions.

2005-02-27  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpintcombobox.c: added an "ellipsize" construct
	property and changed the default behaviour back to not doing
	ellipsation on the text.

	* libgimp/gimpimagecombobox.c
	* libgimp/gimpdrawablecombobox.c: set "ellipsize" to middle for
	drawable and image combo boxes.

2005-02-27  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-blend.c: improved readability by
	introducing a macro for the dithering code.

2005-02-27  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-blend.c: fixed rounding errors in the
	non-dithered case and optimized the dithering code.

2005-02-27  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-blend.c: (hopefully) improve the threaded
	performance by using a dedicated RNG per tile.

2005-02-27  Sven Neumann  <sven@gimp.org>

	* app/core/gimpimage-convert-fsdither.h
	* app/core/gimpimage-convertc: save a kilobyte of data by using
	guchar for the range array.

2005-02-27  Daniel Egger  <de@axiros.com>

	* app/base/Makefile.am
	* app/composite/Makefile.am
	* app/config/Makefile.am
	* app/core/Makefile.am
	* app/display/Makefile.am
	* app/file/Makefile.am
	* app/paint-funcs/Makefile.am
	* app/pdb/Makefile.am
	* app/plug-in/Makefile.am
	* app/text/Makefile.am
	* app/tools/Makefile.am
	* app/vectors/Makefile.am
	* app/xcf/Makefile.am: Commonized include paths to always look
	in the builddir also to cater for srcdir != builddir builds.

2005-02-27  Sven Neumann  <sven@gimp.org>

	* app/core/gimpgradient.[ch]: removed the "last_visited" field
	from GimpGradient. Instead added a segment parameter to
	gimp_gradient_get_color_at() that allows the caller to do the same
	optimization.

	* app/actions/gradient-editor-commands.c
	* app/core/gimpdrawable-blend.c
	* app/core/gimppalette-import.c
	* app/paint/gimppaintoptions.c
	* app/widgets/gimpgradienteditor.c
	* app/widgets/gimpgradientselect.c
	* app/widgets/gimpviewrenderergradient.c: changed accordingly.

	* app/pdb/gradient_cmds.c
	* app/pdb/gradients_cmds.c: regenerated.

2005-02-26  Manish Singh  <yosh@gimp.org>

	* plug-ins/common/png.c: revert change to read images one row at a
	time, it didn't really fix the bug.

2005-02-26  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-blend.c: minor code cleanup.

2005-02-26  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.c (do_parallel_regions): obtain a lock
	on the pool mutex while signalling the termination condition.

2005-02-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/png.c: read non-interlaced files one row
	at a time instead of in 64-row chunks; fixes bug #137327.

2005-02-25  Kevin Cozens  <kcozens@cvs.gimp.org>

	* plug-ins/script-fu/siod/siod.h
	* plug-ins/script-fu/siod/sliba.c: Creation and manipulation of
	string arrays was seriously broken. Fixes bug #168290.

2005-02-25  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.c: fixed indentation.

2005-02-24  Jay Cox  <jaycox@gimp.org>

	* app/base/pixel-processor.c: fixed potential race condition on
	processor->threads.  Changed mutex to a GMutex from a GStaticMutex
	because it needs to be initialized anyway.  Placed g_cond_wait
	calls inside while loops to handle g_cond_wait returning prematurely.

2005-02-24  Manish Singh  <yosh@gimp.org>

	* plug-ins/uri/uri-backend-wget.c: Handle large file sizes, and
	update the downloaded size for unknown file sizes.

2005-02-24  Sven Neumann  <sven@gimp.org>

	* plug-ins/uri/uri-backend-wget.c (uri_backend_load_image): pulse
	the progress while downloading an unspecified amount of data.

2005-02-24  Manish Singh  <yosh@gimp.org>

	* plug-ins/uri/uri-backend-wget.c: Handle HTTP 302 Redirect output
	from wget properly. Also give a little more informative display for
	unspecified sizes. Fixes bug #168322.

2005-02-24  Sven Neumann  <sven@gimp.org>

	* app/actions/file-commands.c (file_open_as_layer_cmd_callback):
	preselect the image just as in file_open_from_image_cmd_callback().

2005-02-24  Michael Natterer  <mitch@gimp.org>

	Allow to resize layers with the image. Fixes bug #87789.
	Based on patch by Akkana Peck.

	* app/core/core-enums.[ch]: added enum GimpImageResizeLayers which
	can be one of { NONE, MATCHING, ALL }.

	* app/core/gimpimage-resize.[ch]: added new function
	gimp_image_resize_with_layers().

	* app/dialogs/resize-dialog.[ch]: added a "Layers" frame
	containing a "Resize Layers" combo box offering the choices above.
	Changed GimpResizeCallback signature accordingly.

	* app/actions/image-commands.c
	* app/actions/layers-commands.c: changed accordingly.

2005-02-23  Michael Natterer  <mitch@gimp.org>

	* libgimpwidgets/gimpbutton.c (gimp_button_button_press): don't
	reset button->press_state on double clicks because
	GDK_2BUTTON_PRESS always arrive immediately after
	GDK_BUTTON_PRESS, so resetting the state causes the second click
	of a double click to be always interpreted as "clicked", not
	"extended-clicked", breaking e.g. adding of multiple layers by
	shift-clicking the layers dialog's "new" button. Phew, too much
	text for a one-liner bug fix, blah... Spotted by Jimmac.
	Cleaned up this antique file a bit.

2005-02-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/*/Makefile.am
	* plug-ins/common/mkgen.pl: add libgimpmath deps
	needed because libgimpconfig links it.

2005-02-23  Shlomi Fish  <shlomif@iglu.org.il>

	* plug-ins/common/displace.c: fixed the numbers of parameters check
	in RUN_NONINTERACTIVE. (it was a typo).

2005-02-22  Sven Neumann  <sven@gimp.org>

	* app/display/gimpdisplayshell-callbacks.c: removed redundant casts,
	made gimp_display_shell_compress_motion() static.

2005-02-22  Shlomi Fish  <shlomif@iglu.org.il>

	* tools/pdbgen/pdb/channel.pdb: add the 
	gimp_channel_new_from_component() PDB function.

	* libgimp/gimpchannel_pdb.[ch]
	* app/pdb/channel_cmds.c: resultant files.

	* libgimp/gimp.def: add the new function to the def file

2005-02-22  Michael Natterer  <mitch@gimp.org>

	* app/tools/gimpmagnifytool.c (gimp_magnify_tool_init)
	* app/tools/gimpmeasuretool.c (gimp_measure_tool_init)
	* app/tools/gimpvectortool.c (gimp_vector_tool_init): set
	handles_empty_image to TRUE because all these tools work fine
	without active drawable.

	* app/display/gimpdisplayshell-callbacks.c
	(gimp_display_shell_canvas_tool_events): also look at
	handles_empty_image, not only at gimp_image_is_empty() before
	setting the BAD cursor.

2005-02-21  Manish Singh  <yosh@gimp.org>

	* app/text/gimpfont-utils.[ch]: be smarter about finding trailing
	numbers that look like sizes, so we don't have spurious commas.

	* app/text/gimpfontlist.c: As an optimization, figure out if
	pango needs a workaround, and if not, just call it directly.

2005-02-21  Michael Natterer  <mitch@gimp.org>

	* app/display/gimpdisplayshell-callbacks.c
	(gimp_display_shell_canvas_tool_events): put back some important
	code that was accidentially removed when fixing bug #162823. Also
	moved the calls to gtk_grab_add() and gtk_grab_remove() around a
	bit.

2005-02-21  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimptoolbox.c (toolbox_area_notify): apply evil
	size_request hacks to the color/image/foo areas' wrapbox because
	its child requisition/allocation code is apparently broken. Works
	around bug #162500.

2005-02-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/emboss.c: fixed emboss on small images (bug #168022).

2005-02-21  Sven Neumann  <sven@gimp.org>

	* libgimpthumb/gimpthumb-utils.c (gimp_thumb_init): workaround for
	bug #167973: if no valid home directory exists, use the folder for
	temporary files to store thumbnails.

2005-02-21  Michael Natterer  <mitch@gimp.org>

	* app/actions/context-actions.c
	* app/actions/context-commands.[ch]: removed the newly added color
	picker radius actions...

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]: ...and added them here.

2005-02-20  Manish Singh  <yosh@gimp.org>

	Support for custom plug-in interpreters, independent of OS support.

	* app/core/Makefile.am
	* app/core/core-types.h
	* app/core/gimpinterpreterdb.[ch]: implemented GimpInterpreterDB,
	which handles registering and resolving custom plug-in interpreters.

	* app/core/gimp.[ch]: keep a GimpInterpreterDB around.

	* app/config/gimpcoreconfig.[ch]
	* app/config/gimprc-blurbs.h
	* app/dialogs/preferences-dialog.c
	* app/dialogs/user-install-dialog.c
	* app/widgets/gimphelp-ids.h: interpreter-path config stuff.

	* app/plug-in/plug-in.c: use registered interpreters when running
	plug-ins.

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/folders-interp.png: just copied
	folders-plug-ins.png here, need a better one.

	* data/interpreters/Makefile.am: creates system interpreter directory.

	* data/interpreters/default.interp: sample interpreter file info.

	* data/Makefile.am
	* configure.in: add data/interpreters directory.

	* plug-ins/pygimp/Makefile.am: install pygimp.interp, which configures
	the python interpreter to point to the python we were built with. Also
	register the .py extension.

	* etc/gimprc
	* docs/gimprc.5.in: regenerated

2005-02-20  Jay Cox  <jaycox@gimp.org>

	* plug-ins/common/psd.c: Fix layer mask support.  Addresses bug
	#166976

2005-02-21  Sven Neumann  <sven@gimp.org>

	Another step towards color management:

	* modules/Makefile.am
	* modules/cdisplay_lcms.c: added new color display module that
	implements color management for the image displays. Still work
	in progress...

	* modules/cdisplay_proof.c: no need to include <string.h> here.

	* libgimpconfig/gimpcolorconfig.[ch]: added new property
	"display-module" to configure the display color management module.

	* app/display/gimpdisplayshell-filter.[ch]
	* app/display/gimpdisplayshell.c: create the configured color
	management display filter for each display.

2005-02-20  Sven Neumann  <sven@gimp.org>

	* plug-ins/gimpressionist/presets.c (get_object_name): use
	g_filename_display_basename().

2005-02-20  Sven Neumann  <sven@gimp.org>

	* app/core/gimpgradient-load.c
	* app/core/gimppalette.c
	* app/core/gimppattern.c
	* app/plug-in/plug-in.c
	* libgimpbase/gimputils.c
	* libgimpmodule/gimpmodule.c
	* libgimpwidgets/gimppatheditor.c
	* tools/pdbgen/pdb/image.pdb: use g_filename_display_name() or
	g_filename_display_basename() where appropriate.

	* app/pdb/image_cmds.c: regenerated.

2005-02-20  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.c: better error reporting.

2005-02-20  Sven Neumann  <sven@gimp.org>

	* app/actions/context-actions.c
	* app/actions/context-commands.c[ch]: added actions to control the
	average radius of color picker tools (bug #167765).

	* app/actions/tool-options-actions.c: fixed a typo in a comment.

2005-02-20  Manish Singh  <yosh@gimp.org>

	* plug-ins/pygimp/Makefile.am: attempt to support Win32 (untested).

2005-02-19  Manish Singh  <yosh@gimp.org>

	* plug-ins/pygimp/plug-ins/gtkcons.py
	* plug-ins/pygimp/plug-ins/gimpcons.py: Use newer gtkcons widget
	from pygtk. Some cosmetic additions.

2005-02-19  Manish Singh  <yosh@gimp.org>

	* plug-ins/pygimp/plug-ins/py-slice.py: Ignore guides at or beyond
	image bounds, since those aren't valid slicing bounds. Fixes bug
	#167843.

2005-02-20  Sven Neumann  <sven@gimp.org>

	* app/dialogs/user-install-dialog.c: migrate gimp-2.2 settings if
	available. Pass the version to gimp_templates_migrate().

	* app/core/gimp-templates.[ch] (gimp_templates_migrate): if
	migrating templaterc from ~/.gimp-2.0, do a case-insensitive match
	on template names to accommodate for the fact that we changed the
	spelling of some default templates between 2.0 and 2.2.

2005-02-19  Michael Natterer  <mitch@gimp.org>

	* app/tools/gimptexttool.c (gimp_text_tool_create_layer): block
	the "active-layer-changed" callback while anchoring the floating
	selection so the callback doesn't reset the text tool in the
	middle of adding a new text layer. Fixes bug #166829.

2005-02-19  Hans Breuer  <hans@breuer.org>

	* plug-ins/makefile.msc plug-ins/script-fu/script-fu-server.c :
	now that I'm aware of script-fu-server running on win32 make it
	compile with msvc, too ;)

2005-02-19  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpdockable.c
	* app/widgets/gimphelp-ids.h: added a tooltip and a help-id for the
	dockable menu.

2005-02-19  Sven Neumann  <sven@gimp.org>

	* plug-ins/script-fu/script-fu.c
	* plug-ins/script-fu/siod-wrapper.c: there is script-fu server on
	Win32. Reverted this change, again!

2005-02-19  Hans Breuer  <hans@breuer.org>

	* app/base/pixel-processor.c : TILE_WIDTH is used unconditionally
	so always include "tile.h"
	* app/base/tile-swap.c : WIN32 needs <process.h> for _getpid()

	* app/dialogs/user-install-dialog.c : include gimpwin32-io.h
	* libgimpbase/gimpwin32-io.h : there are no group or other
	flags in msvcrt, define S_IGRP etc in terms of _S_IREAD etc

	* plug-ins/script-fu/script-fu.c plug-ins/script-fu/siod-wrapper.c :
	no script-fu server on win32, make respective function calls conditional

	* libgimpconfig/makefile.msc : new file
	* **/makefile.msc app/gimpcore.def : updated, gimp builds 
	and runs once more with ms toolchain

2005-02-18  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/mng.c (mng_save_image): write a DEFI chunk to
	set the frame offset if the layer offsets are != 0, not only if
	they are > 0. Fixes bug #166059.

2005-02-18  Sven Neumann  <sven@gimp.org>

	* app/display/gimpstatusbar.c: unset the CAN_FOCUS flag on the
	combo boxes and the cancel button. Set "focus-on-click" to FALSE
	for the combo boxes. Fixes bug #167809.

2005-02-18  Michael Natterer  <mitch@gimp.org>

	* libgimp/gimpexport.c (export_dialog): applied patch from Patrice
	Tremblay which sets an alternative button order for the export
	dialog (bug #166678).

2005-02-18  Sven Neumann  <sven@gimp.org>

	* app/core/Makefile.am
	* app/core/gimpdrawable-convert.[ch]: new files holding 
	gimp_drawable_convert_rgb() and gimp_drawable_convert_grayscale()
	moved out of gimpimage-convert.[ch].

	* app/core/gimpchannel.c
	* app/core/gimpimage-convert.[ch]
	* app/core/gimplayer.c: changed accordingly.

2005-02-18  Sven Neumann  <sven@gimp.org>

	* app/core/gimpimage-convert.c: some simple loop unrolling,
	converted tabs to spaces and sprinkled the code with const
	qualifiers.

2005-02-17  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpviewrenderergradient.c
	(gimp_view_renderer_gradient_render): don't attempt to read beyond
	the pre-calculated render buffers, even if the gradient somehow
	has out-of-bounds values. Fixes the crash reported in bug #167604.

2005-02-17  Sven Neumann  <sven@gimp.org>

	* plug-ins/imagemap/imap_main.c: fixed the build for compilers that
	don't support C99 extensions.

2005-02-16  Kevin Cozens  <kcozens@cvs.gimp.org>

	* plug-ins/script-fu/siod-wrapper.c: Added constants MIN-IMAGE-SIZE,
	MAX-IMAGE-SIZE, MIN-RESOLUTION, and MAX-RESOLUTION for use in Script-Fu
	scripts. See comment #4 in bug #167529.

2005-02-17  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontainercombobox.c
	* libgimpwidgets/gimpintcombobox.c: set the "ellipsize" property
	on the text cell-renderer. Not sure if it's a good idea to
	hardcode this for GimpIntComboBox, but let's give it a try. Fixes
	bug #136676.

2005-02-17  Sven Neumann  <sven@gimp.org>

	* plug-ins/help/gimp-help-lookup.c: use GOptionContext to parse
	the command-line.

2005-02-16  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.c: switched to using a thread pool.
	Enables the progress callback for the threaded case.

2005-02-16  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/plug-ins/script-fu/scripts/guides-new.scm:  committted
	slightly modified patch from  Joao S. O. Bueno Calligaris
	to raise guide position limit to 262144.
	
2005-02-16  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/gimpclonetool.[ch]: make sure clone source is
	shown in correct display, fixes bug #167002.

2005-02-16  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.[ch]: added a variant of
	pixel_regions_process_parallel() that takes a progress callback and
	progress data. Does only work for the single-threaded case yet.

	* app/core/gimpdrawable-blend.c (gradient_fill_region): parallelized.

2005-02-16  Sven Neumann  <sven@gimp.org>

	* app/core/gimpimage-contiguous-region.c
	(gimp_image_contiguous_region_by_color): parallelized.

	* app/core/gimpdrawable-desaturate.c (gimp_drawable_desaturate):
	parallelized.

2005-02-16  Sven Neumann  <sven@gimp.org>

	* app/core/gimplayer.c (gimp_layer_transform_color): code cleanup.

2005-02-15  Sven Neumann  <sven@gimp.org>

	* app/paint-funcs/paint-funcs.[ch]: formatting.

2005-02-15  Sven Neumann  <sven@gimp.org>

	* app/core/gimpimagemap.[ch]: changed GimpImageMapApplyFunc to
	be compatible with PixelProcessorFunc.

	* app/base/color-balance.[ch]
	* app/base/colorize.[ch]
	* app/base/gimplut.[ch]
	* app/base/hue-saturation.[ch]
	* app/base/threshold.[ch]: removed wrappers that used to
	shift parameters around to match GimpImageMapApplyFunc and
	PixelProcessorFunc signatures.

	* app/tools/gimpbrightnesscontrasttool.c
	* app/tools/gimpcolorbalancetool.c
	* app/tools/gimpcurvestool.c
	* app/tools/gimplevelstool.c
	* app/tools/gimpposterizetool.c
	* app/tools/gimpthresholdtool.c: changed accordingly.

	* tools/pdbgen/pdb/color.pdb: use pixel_region_process_parallel()
	for all color operations.

	* app/pdb/color_cmds.c: regenerated.

2005-02-15  Sven Neumann  <sven@gimp.org>

	* app/main.c (gimp_init_malloc): added a comment about the use of
	mallopt() and what could be done instead. Use the TILE_WIDTH and
	TILE_HEIGHT defines to determine the M_MMAP_THRESHOLD value.

2005-02-14  Sven Neumann  <sven@gimp.org>

	* app/base/gimphistogram.c: allocate histogram slots in one large
	block instead of multiple smaller chunks. Hide pointer arithmetic
	in macros.

2005-02-14  Sven Neumann  <sven@gimp.org>

	* app/dialogs/resolution-calibrate-dialog.c: fix for setups with
	multiple monitors on the same screen (bug #167339).

2005-02-14  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimppropwidgets.c: fixed gtk-doc comment.

2005-02-14  Sven Neumann  <sven@gimp.org>

	* app/config/gimprc-blurbs.h
	* app/dialogs/offset-dialog.c
	* plug-ins/common/displace.c
	* plug-ins/script-fu/scripts/rendermap.scm
	* plug-ins/script-fu/scripts/ripply-anim.scm: use the american
	spelling of "behaviour". Fixes bug #167267.

2005-02-14  Michael Natterer  <mitch@gimp.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_check_uri):
	when appending an extension, update the filename entry so the user
	can see what's going on. Added even more debugging output.

2005-02-14  Sven Neumann  <sven@gimp.org>

	* app/base/gimphistogram.c: simplified the code and avoid
	excessive memory allocations for the threaded case.

2005-02-14  Sven Neumann  <sven@gimp.org>

	* app/base/gimphistogram.[ch]: allocate temporary histogram slots
	on demand and provide an array with enough slots for the maximum
	number of threads. gimp_histogram_new() doesn't need a
	GimpBaseConfig parameter any longer.

	* app/core/gimpdrawable-equalize.c
	* app/core/gimpdrawable-levels.c
	* app/tools/gimpcurvestool.c
	* app/tools/gimplevelstool.c
	* app/tools/gimpthresholdtool.c
	* app/widgets/gimphistogrameditor.c
	* tools/pdbgen/pdb/color.pdb: changed accordingly.

	* app/pdb/color_cmds.c: regenerated.

2005-02-14  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.[ch]: define the maximum number of
	threads in the header file.

	* app/config/gimpbaseconfig.c: use the #define.

2005-02-14  Sven Neumann  <sven@gimp.org>

	* app/base/gimphistogram.c
	* app/base/pixel-processor.c: use static mutexes.

2005-02-14  Sven Neumann  <sven@gimp.org>

	* configure.in: allow to enable the threaded tile-swapper code
	(use at your own risk).

2005-02-13  Sven Neumann  <sven@gimp.org>

	* configure.in
	* app/base/tile-cache.c
	* app/base/tile-private.h
	* app/base/tile-swap.c
	* app/base/tile.c: in an attempt to save this code from bit-rot,
	ported the experimental threaded tile-swapper to gthread.

2005-02-13  Sven Neumann  <sven@gimp.org>

	* app/base/gimphistogram.c: port this code to gthread as well.

2005-02-13  Jay Cox  <jaycox@gimp.org>

	* plug-ins/common/psd_save.c: Rewrote all the code that deals with
	pixels to be stingy with memory and operate on tile-size chunks.
	Create a flattened copy of the image when necessary. Fixes file
	corruption bug #167139 and memory bug #121871.

2005-02-13  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.c: some more cleanup; introduced a
	#define to control the number of tiles per thread.

2005-02-13  Sven Neumann  <sven@gimp.org>

	* app/base/base.c: fixed typo.

	* app/config/gimpbaseconfig.c: reverted last change,
	"num-processor" doesn't need a confirmation.

2005-02-13  Michael Natterer  <mitch@gimp.org>

	* app/file/file-save.[ch]: removed file_save() and renamed
	file_save_as() to file_save() which always requires "uri" and
	"file_proc" to be passed. This functions does no more file_proc by
	extension finding and stuff.

	* app/actions/file-commands.c (file_save_cmd_callback): only call
	file_save() if the image has both uri and save_proc, fall back to
	file_save_as_cmd_callback() otherwise.

	* app/dialogs/file-save-dialog.c: completely chopped and
	reconstructed. Added tons of checks for extension vs. save_proc
	consistency and ask the user if she really wants to save weird
	stuff. Added masive debugging output because I'm far from certain
	that everything is correct.

2005-02-13  Sven Neumann  <sven@gimp.org>

	* libgimp*/Makefile.am: s/GIMP_THREAD_FLAGS/GTHREAD_CFLAGS/

2005-02-13  Sven Neumann  <sven@gimp.org>

	* app/base/base.c
	* app/base/tile-swap.[ch]: moved some code from base_init() into
	tile_swap_init().

	* app/base/pixel-processor.[ch]: prepared for porting to GThreadPool.

	* app/config/gimpbaseconfig.c: changed "num-processors" option to
	require a confirmation before being changed.

2005-02-13  Sven Neumann  <sven@gimp.org>

	* configure.in: check for gthread-2.0 unless the --disable-mp
	option is given.

	* app/app_procs.c (app_libs_init): call g_thread_init().

	* app/base/pixel-processor.c: ported to GThread.

	* app/Makefile.am
	* app/*/Makefile.am: use @GTHREAD_CFLAGS@.

2005-02-13  Sven Neumann  <sven@gimp.org>

	* libgimp/gimpprogress.c (gimp_progress_install): fixed typos in
	comment.

	* libgimp/gimpprogress.[ch]: gimp_progress_set_text() has boolean
	return value.

2005-02-13  Sven Neumann  <sven@gimp.org>

	* plug-ins/jpeg/jpeg-exif.c: use context specific labels for the
	action buttons in the rotate confirmation dialog.

2005-02-13  Sven Neumann  <sven@gimp.org>

	* app/core/gimpprogress.c (gimp_progress_start): accept an empty
	string.

	* app/plug-in/plug-in-progress.c: if NULL is passed as message to
	plug_in_progress_start(), set an empty string on the progress.

	* tools/pdbgen/pdb/progress.pdb:
	* libgimp/gimpprogress.[ch]: wrap the new gimp_progress_set_text()
	PDP function with a function that accepts printf-like arguments.

	* libgimp/gimpprogress_pdb.[ch]: regenerated.

	* lots of plug-ins, most of them file plug-ins:
	use gimp_progress_init(NULL) followed by gimp_progress_set_text()
	to initialize the progress using the new API instead of constructing
	a temporary string.

2005-02-12  Michael Natterer  <mitch@gimp.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_response): use
	gtk_file_chooser_set_uri() to check if a file exists. Seems to
	work reliably even for remote files and fixes the issue i
	mentioned below.

2005-02-12  Sven Neumann  <sven@gimp.org>

	Changes suggested in bug #167200:

	* plug-ins/common/unsharp.c: increased maximum value for Amount.

	* app/tools/gimplevelstool.c: changed increments for gamma
	spinbutton.

	* app/tools/gimpcoloroptions.c: increased maximum radius for color
	picking to 300 pixels and made the slider logarithmic.

2005-02-12  Sven Neumann  <sven@gimp.org>

	* plug-ins/uri/uri-backend-gnomevfs.c: use gimp_progress_set_text().

2005-02-12  Sven Neumann  <sven@gimp.org>

	* app/plug-in/plug-in-progress.[ch]
	* tools/pdbgen/pdb/progress.pdb: added new PDB function
	gimp_progress_set_text().

	* app/pdb/internal_procs.c
	* app/pdb/progress_cmds.c
	* libgimp/gimpprogress_pdb.[ch]: regenerated.

	* libgimp/gimp.def: updated.

2005-02-12  Sven Neumann  <sven@gimp.org>

	* app/plug-in/plug-in-progress.c (plug_in_progress_start): only
	set progress value to 0.0 if it isn't 0.0 already. Allows to use
	gimp_progress_init() to change the progress message w/o causing
	gtk_progress_bar_set_fraction() to be called.

	* plug-ins/uri/uri-backend-gnomevfs.c: use gimp_progress_pulse()
	if the filesize is unknown. Also limit frequency of progress
	updates.

2005-02-12  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.c: fixed a bug I introduced with my
	latest changes and cleaned up the code further.

2005-02-12  Michael Natterer  <mitch@gimp.org>

	* app/dialogs/file-open-dialog.c (file_open_dialog_response)
	* app/dialogs/file-save-dialog.c (file_save_dialog_response):
	don't bail out if filename_from_uri() returns NULL. Perform
	checks for G_FILE_TEST_IS_REGULAR and G_FILE_TEST_EXISTS
	only on local files.

	(This brings up the problem that we will overwrite existing remote
	files without warning. Need to fix that before enabling remote
	files in GimpFileDialog).

2005-02-12  Michael Natterer  <mitch@gimp.org>

	* libgimpbase/gimpbaseenums.h (enum GimpProgressCommand):
	added GIMP_PROGRESS_COMMAND_PULSE.

	* libgimpbase/gimpbaseenums.c
	* plug-ins/pygimp/gimpenums.py
	* tools/pdbgen/enums.pl: regenerated.

	* app/core/gimppdbprogress.c: implement GimpProgress::pulse()
	and send a PULSE command to the callback.

	* libgimp/gimpprogress.c: handle PULSE by calling the set_value()
	callback with a value of -1 and document that hack in the API docs.

	* libgimp/gimpprogressbar.c: interpret -1 as request to pulse.

2005-02-12  Sven Neumann  <sven@gimp.org>

	* app/core/gimpprogress.[ch]: added GimpProgress::pulse.

	* app/display/gimpdisplay.c
	* app/display/gimpstatusbar.c
	* app/widgets/gimpfiledialog.c
	* app/widgets/gimpprogressbox.c
	* app/widgets/gimpprogressdialog.c
	* app/widgets/gimpthumbbox.c: implement it in the classes that
	implement the GimpProgress interface.

	* app/plug-in/plug-in-progress.[ch]: allow plug-ins to pulse their
	progress.

	* tools/pdbgen/pdb/progress.pdb: added a procedure for the new
	functionality.

	* app/pdb/internal_procs.c
	* app/pdb/progress_cmds.c
	* libgimp/gimpprogress_pdb.[ch]: regenerated.

	* libgimp/gimp.def: updated.

2005-02-11  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.[ch]: code cleanup. Removed unused code,
	renamed variables and types.

	* app/base/gimphistogram.c
	* app/core/gimpchannel-combine.c
	* app/core/gimpchannel.c
	* app/core/gimpdrawable-equalize.c
	* app/core/gimpdrawable-invert.c
	* app/core/gimpdrawable-levels.c
	* app/paint-funcs/paint-funcs.c
	* tools/pdbgen/pdb/color.pdb: changed accordingly.

	* app/pdb/color_cmds.c: regenerated.

2005-02-11  Sven Neumann  <sven@gimp.org>

	* app/base/pixel-processor.c: include <string.h>.

2005-02-11  Sven Neumann  <sven@gimp.org>

	* app/dialogs/preferences-dialog.c: reordered pages in an attempt
	to list important settings first.

2005-02-11  Sven Neumann  <sven@gimp.org>

	* configure.in: enable support for multiple processors by default.
	Hyperthreading and multicore CPUs are becoming common and we
	should try to give this as much testing as possible.

	* app/config/gimpbaseconfig.c: use two processors by default. Also
	increased default tile-cache-size to 256MB.

2005-02-11  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimptoolbox.c (toolbox_paste_received): drop
	everything after the first newline and strip leading and trailing
	whitespace from the pasted text.

2005-02-11  Michael Natterer  <mitch@gimp.org>

	* app/actions/layers-actions.c (layers_actions): fixed
	"layers-duplicate" action entry.

2005-02-11  Sven Neumann  <sven@gimp.org>

	* app/actions/layers-actions.c
	* app/actions/view-actions.c: added shortcuts for New
	Layer (Shift-Ctrl-N, used to be the Navigation Dialog) and
	Duplicate Layer (Shift-Ctrl-D).

2005-02-11  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimptoolbox.c: allow to paste URLs and filenames to
	the toolbox using the middle mouse button.

2005-02-10  Manish Singh  <yosh@gimp.org>

	* app/file/file-save.c (file_save_as): Make sure filename is
	initialized before use.

2005-02-10  Michael Natterer  <mitch@gimp.org>

	* plug-ins/uri/uri-backend-gnomevfs.c: use gimp_memsize_to_string()
	instead of always showing bytes with a translatable %llu format
	string. Increased BUFSIZE to 4096.

	* plug-ins/uri/uri-backend-wget.c (uri_backend_load_image): don't
	leak the memsize string. Use sizeof(buf) instead of BUFSIZE.

2005-02-10  Michael Natterer  <mitch@gimp.org>

	* app/tools/gimpcroptool.c
	* app/tools/gimptransformtool.c: alternative button order for
	the info dialogs (bug #166678).

2005-02-10  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/displace.c: applied a modified patch from Joao
	S. O. Bueno Calligaris that adds a polar mode to the Displace
	plug-in (bug #161131).

2005-02-10  Sven Neumann  <sven@gimp.org>

	* app/file/file-save.c (file_save_as): applied a (slightly
	modified) patch from Shlomi Fish that automatically adds the .xcf
	extension if none is given (bug #165684).

2005-02-10  Sven Neumann  <sven@gimp.org>

	* app/actions/data-commands.c
	* app/actions/edit-commands.c
	* app/actions/error-console-commands.c
	* app/actions/file-commands.c
	* app/actions/gradient-editor-commands.c
	* app/actions/gradients-commands.c
	* app/actions/plug-in-commands.c
	* app/actions/templates-commands.c
	* app/actions/text-editor-commands.c
	* app/actions/tool-options-commands.c
	* app/dialogs/image-new-dialog.c
	* app/dialogs/resize-dialog.c
	* app/display/gimpdisplayshell-close.c
	* app/display/gimpdisplayshell-filter-dialog.c
	* app/display/gimpdisplayshell-scale.c
	* app/tools/gimpimagemaptool.c
	* app/tools/gimptexttool.c
	* libgimp/gimpexport.c
	* libgimpwidgets/gimpcolorbutton.c
	* libgimpwidgets/gimpfileentry.c
	* libgimpwidgets/gimpquerybox.c
	* libgimpwidgets/gimpunitmenu.c: applied another patch by Patrice
	Tremblay to make more dialogs obey the alternative button order
	setting (bug #166678).

2005-02-09  Manish Singh  <yosh@gimp.org>

	* app/text/gimpfont-utils.[ch]: new function to workaround pango
	bug #166540, by tacking on a ',' to font names that end in numbers,
	so pango_font_description_from_string doesn't interpret it as a size.

	* app/text/Makefile.am: add above files.

	* app/text/gimpfontlist.c
	* app/text/gimptext-compat.c: use new function.

	* app/text/gimptext-xlfd.c: also make sure font names pulled out
	from XLFD don't end in numbers.

	* app/text/gimpfont.c
	* app/text/gimptextlayout.c: remove some redundant checks.

2005-02-09  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/display/gimpdisplayshell-callbacks.c 
	(gimp_display_shell_canvas_tool_events):  For testing, apply
	patch switching display-wide grab to app-wide grab while
	handling button-release event, see bug #162823.

2005-02-09  DindinX  <dindinx@gimp.org>

	* plug-ins/common/pixelize.c: added a preview.

2005-02-09  Sven Neumann  <sven@gimp.org>

	* plug-ins/uri/uri-backend-wget.c: marked strings for translation.

2005-02-09  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpsizeentry.[ch]
	* libgimpwidgets/gimpwidgets.def: added new function
	gimp_size_entry_set_activates_default().

	* app/dialogs/image-new-dialog.c: set the initial focus on the
	Width entry and set the activates_default flag for the size entry.
	Fixes bug #165748.

2005-02-09  Sven Neumann  <sven@gimp.org>

	* app/display/gimpscalecombobox.[ch]
	* app/display/gimpstatusbar.c: pass an action label to
	gimp_scale_combo_box_add_action().

2005-02-09  Sven Neumann  <sven@gimp.org>

	* app/display/gimpscalecombobox.c: fixed brokeness introduced by
	the latest changes.

2005-02-09  Sven Neumann  <sven@gimp.org>

	* app/display/gimpscalecombobox.[ch]
	* app/display/gimpstatusbar.c: add an "Other..." item to the scale
	menu in the image window. Somewhat hackish but fixes bug #143747.

2005-02-09  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpimagefile.c
	* app/widgets/gimpthumbbox.c: enable explicit (not automatic while
	browsing the list of files) thumbnailing of remote files

2005-02-08  Sven Neumann  <sven@gimp.org>

	* app/app_procs.[ch]
	* app/gui/gui.[ch]
	* app/main.c: simplified initialization by passing GOptionContext
	to app_libs_init() and gui_libs_init().

2005-02-08  Michael Natterer  <mitch@gimp.org>

	* app/main.c: removed SIGCHLD handler which used to call
	waitpid(-1,...) because this breaks all waitpid(pid,...) calls
	in a non-deterministic way. Apparently it is possible to use both
	SIG_DFL *and* SA_RESTART (SA_RESTART being the original reason
	why the call to sigaction() was introduced).

	* app/plug-in/plug-in.c (plug_in_close): don't have a million
	subsequent if(plug_in->pid) blocks. Put everything into one big
	if(plug_in->pid) block instead. Call g_spawn_close_pid() on all
	platforms instead of using the Win32 CloseHandle().

2005-02-08  Michael Natterer  <mitch@gimp.org>

	* app/actions/file-actions.c
	* app/actions/image-actions.c
	* app/actions/qmask-actions.c
	* app/actions/tools-actions.c: removed ugly accel_path hacks
	(don't g_object_set_data(action, "gimp-accel-path", "foo")).

	* app/widgets/gimpactionview.c (gimp_action_view_accel_edited):
	simply use gtk_action_get_accel_path() instead of doing even more
	ugly stuff than above.

2005-02-08  Michael Natterer  <mitch@gimp.org>

	* app/actions/actions.c (action_data_get_widget): return the
	active display's shell instead of the toolbox when called from the
	<Image> popup. Fall back to the toolbox if there is no active
	display. Fixes bug #166012.

2005-02-08  Michael Natterer  <mitch@gimp.org>

	* HACKING: updated info about stable CVS branches of modules we
	depend on.

2005-02-08  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpuimanager.[ch]: removed gimp_ui_manager_ui_get()
	and implement the new virtual functions GtkUIManager::get_widget()
	and ::get_action() instead. Menu loading happens transparently now.

	* app/display/gimpdisplayshell.c
	* app/widgets/gimpdockable.c
	* app/widgets/gimptexteditor.c
	* app/widgets/gimptoolbox.c
	* app/widgets/gimptooloptionseditor.c: use
	gtk_ui_manager_get_widget() instead of the removed
	gimp_ui_manager_ui_get().

2005-02-08  Sven Neumann  <sven@gimp.org>

	Applied a patch from Patrice Tremblay that makes (almost) all
	dialogs obey the "gtk-alternative-button-order" setting
	(bug #166678). Changes too many files to list them all...

2005-02-08  Sven Neumann  <sven@gimp.org>

	* tools/gimp-remote.c: add the gtk+ options to the GOptionContext.

2005-02-08  Sven Neumann  <sven@gimp.org>

	* INSTALL: updated.

2005-02-08  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpgradienteditor.c (gimp_gradient_editor_init):
	use "single-line-mode" for the hint labels. Should fix bug #157570.

2005-02-08  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpwidgets-constructors.[ch]: undeprecated the
	paint mode menu (ported to GimpEnumComboBox with separators).
	The separator code is quite hackish and therefore still
	implemented privately here.

	* app/widgets/gimpbrushselect.c
	* app/widgets/gimplayertreeview.c
	* app/widgets/gimppropwidgets.c: changed accordingly.

2005-02-08  Michael Natterer  <mitch@gimp.org>

	* configure.in: depend on GTK+ >= 2.6.0 and pango >= 1.8.0.

	* app/gui/gui.c (gui_sanity_check): changed accordingly.

2005-02-08  Sven Neumann  <sven@gimp.org>

	* plug-ins/winicon/icosave.c: minor cleanup.

2005-02-08  Manish Singh  <yosh@gimp.org>

	* plug-ins/pygimp/plug-ins/Makefile.am: install sphere.py in unstable
	releases only.

2005-02-08  Manish Singh  <yosh@gimp.org>

	* plug-ins/pygimp/plug-ins/sphere.py
	* plug-ins/pygimp/plug-ins/gimpcons.py
	* plug-ins/pygimp/plug-ins/pdbbrowse.py: Just leave imagetypes empty,
	since we don't operate on existing images here. Fixes bug #166650.

2005-02-08  Michael Natterer  <mitch@gimp.org>

	* app/gui/gui.c (gui_display_changed): if display became NULL
	(e.g. by closing a view) and we decide to activate another view
	of the same image, stop the emission of the original
	"display-changed" signal so it doesn't affect the toolbox'
	UI manager. Fixes bug #159304.

2005-02-08  Sven Neumann  <sven@gimp.org>

	* plug-ins/winicon/icosave.c (ico_image_get_reduced_buf): fixed
	bug in save routine for 256-slot palette (bug #162742).

2005-02-08  Sven Neumann  <sven@gimp.org>

	* configure.in: added automake conditional GIMP_UNSTABLE.

	* plug-ins/script-fu/scripts/Makefile.am: install test-sphere.scm
	in unstable releases only.

2005-02-08  Sven Neumann  <sven@gimp.org>

	* libgimpconfig/gimpcolorconfig-enums.[ch]: gimp-mkenums doesn't
	seem to like newlines in enum definitions.

	* libgimpconfig/gimpcolorconfig.[ch]: removed the "profile-path"
	property for now. It doesn't work too well with GimpFileEntry.
	We can add it back later if it turns out that we really need it.

	* app/dialogs/preferences-dialog.c
	* app/widgets/gimphelp-ids.h: added a color management page to the
	preferences dialog.

2005-02-07  Michael Natterer  <mitch@gimp.org>

	* plug-ins/uri/uri-backend.h: added backend methods for saving to
	URIs.

	* plug-ins/uri/uri.c: register a save procecure if the save method
	is available, using some code from compressor.c

	* plug-ins/uri/uri-backend-gnomevfs.c: implement saving.

	* plug-ins/uri/uri-backend-wget.c: added saving stubs which always
	fail.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpfiledialog.c (gimp_file_dialog_add_filters): add
	an "All Images" filter and select it by default.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpselectiondata.c
	* plug-ins/help/domain.c
	* plug-ins/helpbrowser/dialog.c: fixed my latest changes.

2005-02-07  Michael Natterer  <mitch@gimp.org>

	* app/dialogs/file-open-location-dialog.c
	(file_open_location_dialog_new): set "activates-default" on the
	URI entry.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* plug-ins/help/domain.c
	* plug-ins/helpbrowser/dialog.c: same trick here; should allow to
	work with help files installed in an UNC path.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-save-dialog.c
	* app/widgets/gimpthumbbox.c: use file_utils_filename_from_uri()
	in some more places.

	* app/dialogs/file-open-location-dialog.c
	* app/widgets/gimpselectiondata.c: deal with hostname in URIs.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* app/core/gimpimagefile.c (gimp_imagefile_get_desc_string):
	changed "Remote Image" to "Remote File". The state of the
	thumbnail doesn't tell us if this is an image file at all.

	* app/widgets/gimpthumbbox.c: don't auto-thumbnail remote files.

	* libgimpthumb/gimpthumb-utils.[ch]
	* libgimpthumb/gimpthumbnail.c: do the same workaround for UNC
	paths as in file_utils_filename_from_uri().

2005-02-07  Michael Natterer  <mitch@gimp.org>

	* plug-ins/uri/uri-backend.h: added backend methods
	uri_backend_init() and uri_backend_shutdown().

	* plug-ins/uri/uri.c: call them around using other backend
	functions (both in query() and run()).

	* plug-ins/uri/uri-backend-gnomevfs.c: moved init()/shutdown() of
	GnomeVFS into the new backend methods. Create the list of
	supported protocols dynamically. Get rid of one translatable
	string.

	* plug-ins/uri/uri-backend-wget.c: implement the new methods as
	empty stubs which always succeed.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* libgimpconfig/Makefile.am
	* libgimpconfig/gimpconfig.def
	* libgimpconfig/gimpconfig.h
	* libgimpconfig/gimpconfigtypes.h: install the GimpColorConfig
	header and include it.

	* libgimpconfig/gimpcolorconfig.[ch]: commented out some options
	that will only be needed later and that will most likely undergo
	some changes.

	* app/config/gimpcoreconfig.[ch]
	* app/config/gimprc-blurbs.h: added GimpColorConfig to GimpRc.

2005-02-07  Michael Natterer  <mitch@gimp.org>

	* plug-ins/uri/uri-backend-gnomevfs.c: fixed wrong use of
	GnomeVFSFileInfo (it wants to be allocated and unrefed). Extended
	the list of supported prefixes (still conceptually broken).

2005-02-07  Sven Neumann  <sven@gimp.org>

	* HACKING
	* autogen.sh: dropped support for automake 1.6, automake >= 1.7 is
	now required.

	* configure.in: removed cruft that was there only for automake 1.6.

2005-02-07  Michael Natterer  <mitch@gimp.org>

	* configure.in: check for gnome-vfs-2.0

	* plug-ins/uri/Makefile.am
	* plug-ins/uri/uri-backend-gnomevfs.c: new file which is built
	instead of the wget backend if GnomeVFS is available.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* app/config/gimpconfig-file.c
	* app/file/file-utils.c
	* app/gui/themes.c
	* app/tools/gimpimagemaptool.c
	* app/vectors/gimpvectors-export.c
	* app/widgets/gimpwidgets-utils.c
	* app/xcf/xcf.c
	* tools/pdbgen/pdb/procedural_db.pdb: use gstdio wrappers.

	* app/pdb/procedural_db_cmds.c: regenerated.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* app/base/base.c
	* app/base/temp-buf.c
	* app/base/tile-swap.c
	* app/config/gimpconfig-file.c
	* app/core/gimpbrush.c
	* app/core/gimpbrushgenerated.c
	* app/core/gimpbrushpipe.c
	* app/core/gimpdata.c
	* app/core/gimpenvirontable.c
	* app/core/gimpgradient-load.c
	* app/core/gimpgradient-save.c
	* app/core/gimppalette-import.c
	* app/core/gimppalette.c
	* app/core/gimppattern.c
	* app/dialogs/user-install-dialog.c
	* app/gui/session.c
	* app/menus/menus.c
	* app/widgets/gimpdevices.c: use gstdio wrappers.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimpdatafiles.c
	* libgimpbase/gimpenv.c
	* libgimpconfig/gimpconfigwriter.c
	* libgimpconfig/gimpscanner.c
	* libgimpthumb/gimpthumb-utils.c
	* libgimpthumb/gimpthumbnail.c: include gstdio.h.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimpdatafiles.c
	* libgimpbase/gimpenv.c
	* libgimpconfig/gimpconfigwriter.c
	* libgimpconfig/gimpscanner.c
	* libgimpthumb/gimpthumb-utils.c
	* libgimpthumb/gimpthumbnail.c: use gstdio wrappers.
	Unfortunately this causes compiler warnings, see bug #166512.

2005-02-07  Sven Neumann  <sven@gimp.org>

	* themes/Default/images/preferences/Makefile.am
	* themes/Default/images/preferences/color-management.png: added
	icon for the yet to be added color management preferences page.
	Icon kindly provided by Alastair M. Robinson (bug #78265).

2005-02-07  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimptooldialog.c (gimp_tool_dialog_new): unset the
	"focus-on-map" property for tool dialogs. Fixes bug #154651 (on
	window managers supporting this hint).

2005-02-06  Sven Neumann  <sven@gimp.org>

	* libgimpconfig/Makefile.am
	* libgimpconfig/gimpcolorconfig-enums.[ch]
	* libgimpconfig/gimpcolorconfig.[ch]: added a first draft of a
	color management configuration object. Not yet installed nor used
	by anything. This is based on an older patch by Stefan Döhla.

2005-02-06  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/unsharp.c:  apply speedup proposed 
	by Peter Heckert in bug #166406.  

2005-02-06  Sven Neumann  <sven@gimp.org>

	* configure.in: removed traces of url plug-in.

	* plug-ins/Makefile.am: don't build uri on Win32 (for now).

2005-02-06  Sven Neumann  <sven@gimp.org>

	* configure.in: added $(EXEEXT) to gimp-remote so it can be built
	on Win32 when compiling for GTK+-X11.

2005-02-06  Michael Natterer  <mitch@gimp.org>

	* plug-ins/common/url.c: removed.

	* plug-ins/common/plugin-defs.pl: changed accordingly.

	* plug-ins/common/.cvsignore
	* plug-ins/common/Makefile.am: regenerated.

	* configure.in
	* plug-ins/Makefile.am: added the "uri" subdir.

	* plug-ins/uri/.cvsignore
	* plug-ins/uri/Makefile.am
	* plug-ins/uri/uri-backend-wget.c
	* plug-ins/uri/uri-backend.h
	* plug-ins/uri/uri.c: new files: split uri plug-in into common and
	backend-specific code that will soon optionally use gnomre-vfs.

	Also treat everything after the basename's first dot as extension,
	not after the last dot, so opening "foo.ext.gz" doesn't trigger
	warnings from the compressor plug-in.

2005-02-06  Sven Neumann  <sven@gimp.org>

	* app/main.c: moved call to sanity_check() after the
	initialization of gtk+ so that the error message can be displayed.

2005-02-05  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontrollers.c (gimp_controllers_init): removed
	some eeeky code that used to fiddle with the GimpController type.

	* libgimpwidgets/gimpcontroller.c (gimp_controller_get_type): add
	the GimpConfig interface here, where it belongs.

2005-02-05  Sven Neumann  <sven@gimp.org>

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_proof.c: there's no longer a need to keep a
	pointer to the widget returned by GimpColorDisplay::configure.

2005-02-05  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpcolordisplay.[ch]: deprecate the
	implementation of the class methods clone, load_state, save_state
	and configure_reset and implement them in the base class using the
	GimpConfigInterface.

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_proof.c: removed deprecated implementations here.

2005-02-05  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpcolordisplay.c: add the GimpConfig interface
	in the GimpColorDisplay class...

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_proof.c: ... instead of adding it in each
	implementation.

2005-02-05  Sven Neumann  <sven@gimp.org>

	* app/display/gimpdisplayshell-callbacks.c
	(gimp_display_shell_canvas_tool_events): switched meaning of Ctrl
	and Shift modifiers used with the mouse scroll wheel. The HIG
	suggests to use Ctrl for zooming and it makes GIMP more consistent
	with other apps (for example Inkscape).

2005-02-05  Sven Neumann  <sven@gimp.org>

	* libgimpconfig/gimpconfig-params.h: renamed GIMP_PARAM_ #defines
	to GIMP_CONFIG_PARAM_.

	* app/config/gimpbaseconfig.c
	* app/config/gimpconfig-dump.c
	* app/config/gimpcoreconfig.c
	* app/config/gimpdisplayconfig.c
	* app/config/gimpguiconfig.c
	* app/config/gimprc-deserialize.c
	* app/config/gimprc-serialize.c
	* app/config/gimprc.c
	* app/core/gimp.c
	* app/core/gimpstrokedesc.c
	* app/dialogs/preferences-dialog.c
	* app/text/gimptext.c
	* app/tools/gimptextoptions.c
	* libgimpconfig/gimpconfig-deserialize.c
	* libgimpconfig/gimpconfig-iface.c
	* libgimpconfig/gimpconfig-serialize.c
	* libgimpconfig/gimpconfig-utils.c: changed accordingly.

	* libgimpmodule/gimpmoduletypes.h: deprecate the
	GIMP_MODULE_PARAM_SERIALIZE #define, GIMP_CONFIG_PARAM_SERIALIZE
	should be used instead.

	* modules/controller_linux_input.c
	* modules/controller_midi.c: changed accordingly.

2005-02-05  Sven Neumann  <sven@gimp.org>

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_gamma.c
	* modules/cdisplay_highcontrast.c
	* modules/cdisplay_proof.c: ported all ColorDisplay modules to
	GimpConfig.

2005-02-05  Sven Neumann  <sven@gimp.org>

	* modules/Makefile.am: link ColorDisplay modules with libgimpconfig.

	* modules/cdisplay_colorblind.c: added the GimpConfig interface
	and use it.

2005-02-05  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimppropwidgets.[ch]: documentation fixes.

2005-02-05  Dave Neary  <bolsh@gimp.org>

	* tools/gimp-remote.c: Added locale.h to the headers
	included - fixes the build.

2005-02-04  Manish Singh  <yosh@gimp.org>

	* app/widgets/gimppropwidgets.h: readd declaration of
	gimp_prop_paint_mode_menu_new().

2005-02-04  Manish Singh  <yosh@gimp.org>

	* gimpui.pc.in: add libgimpconfig to Libs.

2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	added dependencies in wrong spot, fixed.  Same list of
	files as for previous commit.
	
2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libgimpwidgets/Makefile.am
	* plug-ins/FractalExplorer/Makefile.am
	* plug-ins/Lighting/Makefile.am
	* plug-ins/MapObject/Makefile.am
	* plug-ins/bmp/Makefile.am
	* plug-ins/common/Makefile.am
	* plug-ins/common/mkgen.pl
	* plug-ins/dbbrowser/Makefile.am
	* plug-ins/faxg3/Makefile.am
	* plug-ins/fits/Makefile.am
	* plug-ins/flame/Makefile.am
	* plug-ins/gfig/Makefile.am
	* plug-ins/gflare/Makefile.am
	* plug-ins/gfli/Makefile.am
	* plug-ins/gimpressionist/Makefile.am
	* plug-ins/helpbrowser/Makefile.am
	* plug-ins/ifscompose/Makefile.am
	* plug-ins/imagemap/Makefile.am
	* plug-ins/jpeg/Makefile.am
	* plug-ins/maze/Makefile.am
	* plug-ins/pagecurl/Makefile.am
	* plug-ins/print/Makefile.am
	* plug-ins/pygimp/Makefile.am
	* plug-ins/rcm/Makefile.am
	* plug-ins/script-fu/Makefile.am
	* plug-ins/sel2path/Makefile.am
	* plug-ins/sgi/Makefile.am
	* plug-ins/twain/Makefile.am
	* plug-ins/winicon/Makefile.am
	* plug-ins/winsnap/Makefile.am
	* plug-ins/xjt/Makefile.am: ouch, broke build badly, needed to
	add libgimpconfig dependencies after moving gimppropwidgets.

2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libgimpwidgets/gimppropwidgets.[ch]: oops, use libgimp header.
	
2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libgimpwidgets/gimppropwidgets.[ch]: magic-copied from app/widgets
	and un-movable things then removed.
	
	* libgimpwidgets/Makefile.am
	* libgimpwidgets/gimpwidgets.def
	* libgimpwidgets/gimpwidgets.h: corresponding changes

	* app/widgets/gimppropwidgets.[ch]: remove functions that were
	moved.

	* app/dialogs/stroke-dialog.c
	* app/dialogs/tips-dialog.c
	* app/dialogs/user-install-dialog.c
	* app/tools/gimpairbrushtool.c
	* app/tools/gimpblendoptions.c
	* app/tools/gimpbucketfilloptions.c
	* app/tools/gimpclonetool.c
	* app/tools/gimpcoloroptions.c
	* app/tools/gimpcolorpickeroptions.c
	* app/tools/gimpconvolvetool.c
	* app/tools/gimpcropoptions.c
	* app/tools/gimpcurvestool.c
	* app/tools/gimpdodgeburntool.c
	* app/tools/gimperasertool.c
	* app/tools/gimpflipoptions.c
	* app/tools/gimphistogramoptions.c
	* app/tools/gimpimagemaptool.c
	* app/tools/gimpinkoptions-gui.c
	* app/tools/gimplevelstool.c
	* app/tools/gimpmagnifyoptions.c
	* app/tools/gimpmeasureoptions.c
	* app/tools/gimpmoveoptions.c
	* app/tools/gimpselectionoptions.c
	* app/tools/gimpsmudgetool.c
	* app/tools/gimpthresholdtool.c
	* app/tools/gimptransformoptions.c
	* app/tools/gimpvectoroptions.c
	* app/widgets/gimpcontainerbox.c
	* app/widgets/gimpcontrollereditor.c
	* app/widgets/gimpdevicestatus.c
	* app/widgets/gimpgrideditor.c
	* app/widgets/gimphistogrambox.c
	* app/widgets/gimphistogrameditor.c
	* app/widgets/gimpsizebox.c
	* app/widgets/gimpstrokeeditor.c
	* app/widgets/gimptemplateeditor.c
	* app/widgets/gimptooloptionseditor.c: fix includes.

2005-02-04  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/jpeg-exif.c: check validity of orientation
	value before using, see bug #166248.
	
2005-02-03  Sven Neumann  <sven@gimp.org>

	* app/file/file-utils.[ch]: added new utility function
	file_utils_filename_from_uri().
	
	* app/file/file-open.c (file_open_image)
	* app/file/file-save.c (file_save_as):
	* app/file/file-utils.c (file_utils_find_proc)
	(file_utils_uri_to_utf8_filename): replaced calls to
	g_filename_from_uri() with file_utils_filename_from_uri().

2005-02-03  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/gimppropwidgets.c:  add gtk-doc comments to 
	public functions in prep for moving to libgimpwidgets.

2005-02-03  Michael Natterer  <mitch@gimp.org>

	* app/dialogs/print-size-dialog.c
	* app/dialogs/resize-dialog.c
	* app/dialogs/scale-dialog.c: moved "Reset" buttons left of "Cancel".

2005-02-03  Sven Neumann  <sven@gimp.org>

	* tools/Makefile.am
	* tools/gimp-remote.c: allow to localize gimp-remote.

	* app/main.c: changed a string so it can be shared with gimp-remote.

2005-02-03  Michael Natterer  <mitch@gimp.org>

	* app/actions/help-commands.c (help_context_help_cmd_callback):
	for consistency, use return_if_no_widget() instead of
	action_data_get_widget()

2005-02-03  Michael Natterer  <mitch@gimp.org>

	* app/dialogs/image-scale-dialog.c (image_scale_dialog_new): use
	the passed parent widget instead of display->shell.

2005-02-03  Sven Neumann  <sven@gimp.org>

	* tools/gimp-remote.c: ported to GOption command-line parser.

2005-02-03  Sven Neumann  <sven@gimp.org>

	* app/core/gimpimagemap.c (gimp_image_map_do): fixed handling of
	pixel region that broke with my latest change. Fixes bug #166126.

2005-02-03  Sven Neumann  <sven@gimp.org>

	* app/main.c: some cleanup in main().

2005-02-03  Michael Natterer  <mitch@gimp.org>

	* app/sanity.c (sanity_check_glib): there is no such thing as GLib+

2005-02-03  Sven Neumann  <sven@gimp.org>

	* app/app_procs.[ch]
	* app/main.c: let the GLib command-line parser deal with the
	remaining arguments and pass a string array to app_run().

2005-02-03  Sven Neumann  <sven@gimp.org>

	* app/main.c: more work on the command-line option parser.

2005-02-02  Michael Natterer  <mitch@gimp.org>

	* app/core/gimp-utils.[ch] (gimp_check_glib_version): removed this
	function.

	* app/sanity.c (sanity_check_glib): use glib_check_version()
	instead and set required version to 2.6.0.

2005-02-02  Sven Neumann  <sven@gimp.org>

	* configure.in: depend on glib >= 2.6.0.

	* app/main.c: use the new GLib commandline option parser. Still
	work in progress.

2005-02-02  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpimage-convert.c (gimp_image_convert): relax/rigor
	the floating selection around the convert operations so color
	analysis for indexed conversion works on the floating selection's
	drawable original pixels, and not on the composited one.
	Fixes bug #165342.

2005-02-02  Sven Neumann  <sven@gimp.org>

	* data/misc/gimp.desktop.in.in (_Name): experimentally expand the
	GIMP acronym. Not sure if this is a good idea at all...

2005-02-01  Sven Neumann  <sven@gimp.org>

	* app/core/gimpimagemap.c (gimp_image_map_do): tiny optimization
	based on a patch by Bill Skaggs. Process up to 16 tiles in one go
	before updating the display.

2005-01-31  Sven Neumann  <sven@gimp.org>

	* themes/Default/images/Makefile.am
	* themes/Default/images/tools/stock-tool-new-rect-select-16.png
	* themes/Default/images/tools/stock-tool-new-rect-select-22.png
	* libgimpwidgets/gimpstock.[ch]: removed the new icon again;
	there's no point in adding a stock icon temporarily.

	* app/tools/gimpnewrectselecttool.c: changed accordingly.

2005-01-31  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/gimpnewrectselecttool.[ch]: new rectangle select tool

	* app/tools/Makefile.am
	* app/tools/gimp-tools.c: add it to toolbox

	* app/tools/gimpselectionoptions.[ch]: set its options
	
	* themes/Default/images/tools/stock-tool-new-rect-select-16.png
	* themes/Default/images/tools/stock-tool-new-rect-select-22.png:
	toolbox icon
	
	* libgimpwidgets/gimpstock.[ch]
	* themes/Default/images/Makefile.am: add the toolbox icon

2005-01-31  Michael Natterer  <mitch@gimp.org>

	Some cleanup to make plug-in menu creation less hackish and
	finally enable registering plug-in menu entries in much more UI
	managers (not only in the image and toolbox menus):

	* app/menus/menus.c: added a <Toolbox> UI manager instead of
	creating the toolbox menu from the <Image> UI manager.

	* app/widgets/gimpimagedock.[ch]: removed the ui_manager and the
	signal connections to update it...

	* app/widgets/gimpdock.[ch]: ...and added them here so all docks
	have their own UI manager. Determine which manager to create from
	looking at GimpDockClass::ui_manager_name (defaults to <Dock>).

	* app/widgets/gimptoolbox.c: set ui_manager_name to <Toolbox> and
	use the UI manager created by our parent class instead of using
	the <Image> one.

	(toolbox_create_tools): use gimp_action_get_accel_closure()
	instead of doing evil hacks.

	* app/gui/gui-vtable.c
	* app/menus/plug-in-menus.c: removed lots of special casing of the
	<Image> UI manager. The code is almost ready for allowing plug-in
	menus under <Layers>, <Channels>, <Brushes> etc.

2005-01-30  Sven Neumann  <sven@gimp.org>

	* app/core/gimpimagemap.c: formatting.

2005-01-29  Michael Schumacher  <schumaml@cvs.gnome.org>

	* libgimpbase/gimpbase.def: added gimp_path_parse 
	* libgimpmath/gimpmath.def: added gimp_param_spec_matrix2

2005-01-29  Sven Neumann  <sven@gimp.org>

	* libgimpconfig/gimpconfig-deserialize.c
	* libgimpconfig/gimpconfig-error.c
	* libgimpconfig/gimpconfig-iface.c
	* libgimpconfig/gimpconfig-path.c
	* libgimpconfig/gimpconfig-serialize.c
	* libgimpconfig/gimpconfig-utils.c
	* libgimpconfig/gimpconfigwriter.c
	* libgimpconfig/gimpscanner.c: use libgimp header,
	added "Since: GIMP 2.4" to the gtk-doc comments.

2005-01-29  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpenumwidgets.[ch]: use libgimp header,
	added "Since: GIMP 2.4" to the gtk-doc comments.

2005-01-28  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/widgets/gimpenumwidgets.c
	* app/widgets/gimpenumwidgets.h: magic-moved from here...

	* libgimpwidgets/gimpenumwidgets.c
	* libgimpwidgets/gimpenumwidgets.h: ...to here.

	* app/dialogs/convert-dialog.c
	* app/dialogs/layer-add-mask-dialog.c
	* app/dialogs/layer-options-dialog.c
	* app/tools/gimpcolorbalancetool.c
	* app/tools/gimpcroptool.c
	* app/tools/gimpcurvestool.c
	* app/tools/gimplevelstool.c
	* app/widgets/Makefile.am
	* app/widgets/gimpbrusheditor.c
	* app/widgets/gimpeditor.c
	* app/widgets/gimppropwidgets.c
	* app/widgets/gimptemplateeditor.c
	* libgimpwidgets/Makefile.am
	* libgimpwidgets/gimpwidgets.def
	* libgimpwidgets/gimpwidgets.h: all changed accordingly.
	Still need to do devel-docs.

2005-01-28  Michael Natterer  <mitch@gimp.org>

	* app/actions/Makefile.am
	* app/actions/window-actions.[ch]: new files holding utility
	functions to create actions to move windows to other screens.

	* app/actions/dock-actions.c
	* app/actions/dock-commands.[ch]
	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]: use the new actions instead of
	the change screen dialog.

	* app/menus/Makefile.am
	* app/menus/window-menu.[ch]: new files which create menu items
	for above actions.

	* app/menus/dockable-menu.[ch]: new files using above window-menu
	utility functions.

	* app/menus/image-menu.c: use them here too.

	* app/menus/menus.c: set a setup_func for the "<Dockable>"
	UI manager.

	* menus/dockable-menu.xml.in
	* menus/image-menu.xml.in: changed accordingly.

2005-01-28  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libgimp/gimpdrawablepreview.c: set preview bounds correctly
	when previewed drawable extends beyond image edges, 
	fixes bug #165372.
	
2005-01-27  Manish Singh  <yosh@gimp.org>

	* README: update ancient IRC info.

2005-01-27  Sven Neumann  <sven@gimp.org>

	* app/core/gimpgrid.c: changed default grid distance to 32 as
	suggested in bug #165367.

2005-01-26  Manish Singh  <yosh@gimp.org>

	* libgimpconfig/Makefile.am: make LIBADD really work.

	* Makefile.am: build libgimpconfig after libgimpcolor and libgimpmath.

2005-01-26  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/jpeg-exif.c:  libexif can return a result
	even for files without exif, need to validate it.
	
2005-01-26  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libgimpconfig/Makefile.am: add necessary stuff to 
	LIBADD -- reported by schumaml, fix explained by yosh.

2005-01-26  Michael Natterer  <mitch@gimp.org>

	* tools/pdbgen/pdb/fileops.pdb
	* tools/pdbgen/pdb/gimprc.pdb: fixed includes after libgimpconfig
	file moving. Reported by Volker Sturm.

	* app/pdb/gimprc_cmds.c: regenerated.

2005-01-26  Michael Natterer  <mitch@gimp.org>

	* app/actions/dockable-actions.c
	* app/actions/dockable-commands.[ch]: removed dock-related
	actions (show-image-menu, auto-follow-active and move-to-screen).

	* app/actions/dock-actions.c
	* app/actions/dock-commands.[ch]: and added them here.

	* app/menus/menus.c: add the "dock" action group to the
	"<Dockable>" UI Manager.

	* app/widgets/gimphelp-ids.h: reordered to match the new grouping.

	* menus/dockable-menu.xml.in: changed accordingly.

2005-01-26  Raphaël Quinet  <raphael@gimp.org>

	* app/composite/gimp-composite-generic.c: minor doc fix for
	formula used by gimp_composite_multiply_any_any_any_generic().

2005-01-26  Sven Neumann  <sven@gimp.org>

	* libgimpconfig/gimpconfig-path.h: added declarations for the
	gimp_config_build_path functions.

	* app/config/Makefile.am
	* app/config/gimprc-utils.[ch]: removed these two files again;
	they used to duplicate functionality from libgimpconfig.

	* app/config/gimpcoreconfig.c
	* app/config/gimpguiconfig.c
	* app/config/gimppluginconfig.c: changed accordingly.

2005-01-26  Sven Neumann  <sven@gimp.org>

	* libgimpbase/Makefile.am
	* libgimpbase/gimppath.[ch]: removed these two files again.

	* libgimpconfig/gimpconfig-path.[ch]: merged the path type and
	param spec here. Renamed to GimpConfigPath and GimpParamConfigPath.

	* libgimpbase/gimpbase.h
	* libgimpbase/gimpbasetypes.[ch]
	* libgimpconfig/gimpconfig-deserialize.c
	* libgimpconfig/gimpconfig-params.h
	* app/config/gimpbaseconfig.c
	* app/config/gimpconfig-dump.c
	* app/config/gimpcoreconfig.c
	* app/config/gimpguiconfig.c
	* app/config/gimppluginconfig.c
	* app/widgets/gimppropwidgets.c: changed accordingly.

	* libgimpbase/gimpbase.def: updated.

2005-01-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libgimpconfig/gimpconfig.def: added
	
2005-01-25  Michael Natterer  <mitch@gimp.org>

	* libgimpconfig/gimpconfigtypes.h: new file holding the opaque
	typedefs for libgimpconfig. Includes "libgimpbase/gimpbasetypes.h"

	* libgimpconfig/Makefile.am: added the new file. Removed stuff
	that is not needed.

	* libgimpconfig/gimpconfigwriter.h
	* libgimpconfig/gimpconfig-iface.h: removed typedefs here.

	* libgimpconfig/gimpconfig-deserialize.c
	* libgimpconfig/gimpconfig-iface.c
	* libgimpconfig/gimpconfig-serialize.c
	* libgimpconfig/gimpconfig-utils.c
	* libgimpconfig/gimpconfig.h
	* libgimpconfig/gimpconfigwriter.c: include it before including
	any other libgimpconfig stuff.

	* app/config/config-types.h: #include "libgimpbase/gimpbasetypes.h"

	* app/config/gimpconfig-utils.h: changed include guards to
	__APP_GIMP_CONFIG_UTILS_H__.

	* app/dialogs/tips-parser.c: include <glib-object.h> instead of
	just <glib.h>.

	* app/tools/gimphistogramoptions.c
	* app/tools/gimptextoptions.c: include "config/gimpconfig-utils.h"

	* app/widgets/gimpdialogfactory.h
	* app/widgets/gimpsessioninfo.h: removed inclusion of
	"libgimpconfig/gimpconfig.h".

2005-01-25  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/config/gimpconfig-deserialize.c
	* app/config/gimpconfig-deserialize.h
	* app/config/gimpconfig-error.c
	* app/config/gimpconfig-error.h
	* app/config/gimpconfig-params.h
	* app/config/gimpconfig-path.c
	* app/config/gimpconfig-path.h
	* app/config/gimpconfig-serialize.c
	* app/config/gimpconfig-serialize.h
	* app/config/gimpconfig.c
	* app/config/gimpconfig.h
	* app/config/gimpconfigwriter.c
	* app/config/gimpconfigwriter.h
	* app/config/gimpscanner.c
	* app/config/gimpscanner.h: removed

	* libgimpconfig/gimpconfig-deserialize.c
	* libgimpconfig/gimpconfig-deserialize.h
	* libgimpconfig/gimpconfig-error.h
	* libgimpconfig/gimpconfig-iface.c
	* libgimpconfig/gimpconfig-iface.h
	* libgimpconfig/gimpconfig-params.h
	* libgimpconfig/gimpconfig-path.c
	* libgimpconfig/gimpconfig-path.h
	* libgimpconfig/gimpconfig-serialize.c
	* libgimpconfig/gimpconfig-serialize.h
	* libgimpconfig/gimpconfig-utils.c
	* libgimpconfig/gimpconfig-utils.h
	* libgimpconfig/gimpconfig.h
	* libgimpconfig/gimpconfigwriter.c
	* libgimpconfig/gimpconfigwriter.h
	* libgimpconfig/gimpscanner.c
	* libgimpconfig/gimpscanner.h: copied from app/config
	by yosh.

	* libgimpconfig/.cvsignore: added
	
	* libgimpconfig/Makefile.am: modified

	* Makefile.am
	* configure.in
	* app/Makefile.am
	* app/actions/templates-commands.c
	* app/actions/tool-options-commands.c
	* app/base/base.c
	* app/base/temp-buf.c
	* app/config/Makefile.am
	* app/config/config-types.h
	* app/config/gimpconfig-utils.c
	* app/config/gimpconfig-utils.h
	* app/config/gimpconfig-file.c
	* app/config/gimpconfig-dump.c
	* app/config/gimpbaseconfig.c
	* app/config/gimpcoreconfig.c
	* app/config/gimpdisplayconfig.c
	* app/config/gimpguiconfig.c
	* app/config/gimppluginconfig.c
	* app/config/gimprc-deserialize.c
	* app/config/gimprc-serialize.c
	* app/config/gimprc-unknown.c
	* app/config/gimprc.c
	* app/config/test-config.c
	* app/core/gimp-documents.c
	* app/core/gimp-modules.c
	* app/core/gimp-parasites.c
	* app/core/gimp-templates.c
	* app/core/gimp-units.c
	* app/core/gimp.c
	* app/core/gimpcontainer.c
	* app/core/gimpcontext.c
	* app/core/gimpdatafactory.c
	* app/core/gimpdocumentlist.c
	* app/core/gimpgrid.c
	* app/core/gimpimage-duplicate.c
	* app/core/gimpimage-grid.c
	* app/core/gimpimage-new.c
	* app/core/gimpimage-undo-push.c
	* app/core/gimpimage.c
	* app/core/gimpparasitelist.c
	* app/core/gimpstrokedesc.c
	* app/core/gimpstrokeoptions.c
	* app/core/gimptemplate.c
	* app/core/gimptoolinfo.c
	* app/core/gimptooloptions.c
	* app/core/gimpviewable.c
	* app/dialogs/grid-dialog.c
	* app/dialogs/image-new-dialog.c
	* app/dialogs/preferences-dialog.c
	* app/dialogs/stroke-dialog.c
	* app/dialogs/template-options-dialog.c
	* app/display/gimpdisplayoptions.c
	* app/display/gimpdisplayshell.c
	* app/gui/color-history.c
	* app/gui/session.c
	* app/gui/themes.c
	* app/paint/gimpairbrushoptions.c
	* app/paint/gimpcloneoptions.c
	* app/paint/gimpconvolveoptions.c
	* app/paint/gimpdodgeburnoptions.c
	* app/paint/gimperaseroptions.c
	* app/paint/gimpinkoptions.c
	* app/paint/gimppaintoptions.c
	* app/paint/gimppenciloptions.c
	* app/paint/gimpsmudgeoptions.c
	* app/pdb/fileops_cmds.c
	* app/pdb/gimprc_cmds.c
	* app/plug-in/plug-in-rc.c
	* app/plug-in/plug-ins.c
	* app/text/gimp-fonts.c
	* app/text/gimptext-parasite.c
	* app/text/gimptext.c
	* app/text/gimptextlayer.c
	* app/text/gimptextundo.c
	* app/tools/gimp-tools.c
	* app/tools/gimpblendoptions.c
	* app/tools/gimpbucketfilloptions.c
	* app/tools/gimpcoloroptions.c
	* app/tools/gimpcolorpickeroptions.c
	* app/tools/gimpcolorpickertool.c
	* app/tools/gimpcropoptions.c
	* app/tools/gimpcroptool.c
	* app/tools/gimpflipoptions.c
	* app/tools/gimphistogramoptions.c
	* app/tools/gimpimagemapoptions.c
	* app/tools/gimpmagnifyoptions.c
	* app/tools/gimpmeasureoptions.c
	* app/tools/gimpmoveoptions.c
	* app/tools/gimppaintoptions-gui.c
	* app/tools/gimpselectionoptions.c
	* app/tools/gimptextoptions.c
	* app/tools/gimptexttool.c
	* app/tools/gimptransformoptions.c
	* app/tools/gimptransformtool.c
	* app/tools/gimpvectoroptions.c
	* app/widgets/gimpcolorbar.c
	* app/widgets/gimpcontrollerinfo.c
	* app/widgets/gimpcontrollers.c
	* app/widgets/gimpdasheditor.c
	* app/widgets/gimpdeviceinfo.c
	* app/widgets/gimpdevices.c
	* app/widgets/gimpdialogfactory.h
	* app/widgets/gimppropwidgets.c
	* app/widgets/gimpsessioninfo.c
	* app/widgets/gimpsessioninfo.h
	* app/widgets/gimpsizebox.c
	* app/widgets/gimptemplateeditor.c
	* app/widgets/gimptemplateview.c: changed accordingly

	Moving things from app/config to libgimpconfig.

2005-01-24  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* libgimpconfig/Makefile.am
	* libgimpconfig/gimpconfig.h: setting up for libgimpconfig
	
2005-01-24  Sven Neumann  <sven@gimp.org>

	* app/config/Makefile.am
	* app/config/gimpconfig-file.[ch]
	* app/config/gimprc-utils.[ch]: more new files, code factored out
	of gimpconfig-utils.[ch].

	* app/config/gimpconfig-path.[ch]
	* app/config/gimpconfig-utils.[ch]
	* app/config/gimpcoreconfig.c
	* app/config/gimpguiconfig.c
	* app/config/gimppluginconfig.c
	* app/config/gimprc.c
	* app/core/gimp-units.c
	* app/dialogs/user-install-dialog.c
	* app/gui/session.c: changed accordingly.

2005-01-24  Sven Neumann  <sven@gimp.org>

	* app/config/gimpconfig-deserialize.[ch]: removed an unused parameter.

	* app/config/gimpconfig.c: changed accordingly.

2005-01-24  Sven Neumann  <sven@gimp.org>

	* app/config/gimpconfig-deserialize.[ch]
	* app/config/gimpconfig-serialize.[ch]
	* app/config/gimpconfig.[ch]: factored out some rather obscure
	GimpConfig features that were added solely for gimprc.

	* app/config/Makefile.am
	* app/config/gimprc-deserialize.[ch]
	* app/config/gimprc-serialize.[ch]
	* app/config/gimprc-unknown.[ch]: moved gimprc-specific code to
	these new files.

	* app/config/gimprc.c
	* app/config/test-config.c: changed accordingly.

2005-01-24  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpenumcombobox.c
	* libgimpwidgets/gimpenumstore.[ch]: improved API docs.

2005-01-24  Michael Natterer  <mitch@gimp.org>

	Enabled closing docks with Ctrl-W:

	* app/actions/Makefile.am
	* app/actions/dock-actions.[ch]
	* app/actions/dock-commands.[ch]: added new action group which
	holds a single action, "dock-close".

	* app/actions/actions.c: register the "dock" group.

	* app/menus/menus.c: add it to the "<Dock>" UI manager.

	* app/widgets/gimphelp-ids.h: added GIMP_HELP_DOCK_CLOSE.

2005-01-23  Bill Skaggs  <weskaggs@primate.ucdavis.edu>

	* app/tools/gimpcroptool.c (crop_aspect_changed): don't 
	accept aspect ratios that make image less than 1 byte high, 
	fixes bug #164827.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* plug-ins/MapObject/Makefile.am (MapObject_SOURCES): added
	arcball.c; it isn't used but it doesn't hurt to have it in the
	tarball in case someone wants to resurrect this functionality.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/edge.c: don't read beyond the src buffer. Fixes
	bug #164963.

2005-01-23  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_toolbar.[ch]
	* plug-ins/imagemap/imap_tools.[ch]: removed

	* plug-ins/imagemap/Makefile.am
	* po-plug-ins/POTFILES.in: changed accordingly

	* plug-ins/imagemap/imap_grid.c
	* plug-ins/imagemap/imap_main.[ch]
	* plug-ins/imagemap/imap_menu.[ch]
	* plug-ins/imagemap/imap_misc.[ch]
	* plug-ins/imagemap/imap_object_popup.c
	* plug-ins/imagemap/imap_selection.c: more conversion to action based
	menus. Still have to attach some actions.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* libgimpbase/Makefile.am
	* libgimpbase/gimpbaseparams.[ch]: removed this file again.

	* libgimpbase/gimpmemsize.[ch]
	* libgimpbase/gimppath.[ch]
	* libgimpbase/gimpunit.[ch]: moved the paramspec definitions to
	the types they belong to.

	* libgimpbase/gimpbase.h: changed accordingly.

	* libgimpwidgets/Makefile.am (libgimpwidgetsinclude_HEADERS):
	install the new header files.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/text/text-enums.h
	* libgimpbase/gimpbaseenums.h: moved enum to libgimpbase (from
	app/text and libgimp).

	* libgimp/gimpenums.h
	* libgimpbase/gimpbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libgimpbase/gimpbase.def
	* libgimp/gimp.def: updated.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/actions/dialogs-actions.c (dialogs_actions): set Ctrl-B as
	default shortcut to raise the Toolbox (as suggested in bug #163368).

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/paint/paint-enums.h
	* libgimpbase/gimpbaseenums.h: moved enums to libgimpbase (from
	app/paint and libgimp). The remaining enums in
	app/paint/paint-enums.h need special treatment.

	* app/paint/paint-enums.c:
	* libgimp/gimpenums.h
	* libgimpbase/gimpbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libgimpbase/gimpbase.def
	* libgimp/gimp.def: updated.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/plug-in/Makefile.am
	* app/plug-in/plug-in-enums.h: new file with enums moved from ...

	* app/plug-in/plug-in-types.h: ... here.

	* tools/pdbgen/Makefile.am (enum_headers): changed accordingly.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/core/core-enums.h
	* libgimpbase/gimpbaseenums.h: moved enums to libgimpbase (from
	app/core and libgimp). The remaining enums in app/core/core-enums.h
	need special treatment.

	* app/core/core-enums.c:
	* libgimp/gimpenums.h
	* libgimpbase/gimpbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libgimpbase/gimpbase.def
	* libgimp/gimp.def: updated.

2005-01-23  Sven Neumann  <sven@gimp.org>

	* app/base/base-enums.h
	* libgimpbase/gimpbaseenums.h: moved GimpInterpolationType and
	GimpTransferMode to libgimpbase (from app/base and libgimp). The
	remaining enums in app/base/base-enums.h need special treatment.

	* app/base/base-enums.c
	* libgimp/gimpenums.h
	* libgimpbase/gimpbaseenums.c
	* tools/pdbgen/enums.pl: regenerated.

	* libgimpbase/gimpbase.def
	* libgimp/gimp.def: updated.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/script-fu/script-fu-enums.h
	* plug-ins/script-fu/script-fu-interface.c
	* plug-ins/script-fu/script-fu-scripts.c
	* plug-ins/script-fu/script-fu-types.h
	* plug-ins/script-fu/siod-wrapper.c: added new script-fu
	parameter SF-ENUM that allows to easily create a combo-box to
	choose values from registered enums. For this to work correctly,
	another change is needed that I will commit separately.

	* plug-ins/script-fu/scripts/perspective-shadow.scm
	* plug-ins/script-fu/scripts/test-sphere.scm: use the new SF-ENUM
	parameter.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimppropwidgets.[ch]: added gimp_prop_expander_new().

	* app/paint/gimppaintoptions.[ch]: added a property to track the
	state of the "Pressure sensitivity" expander.

	* app/tools/gimppaintoptions-gui.c: use gimp_prop_expander_new()
	to create the "Pressure sensitivity" expander.

2005-01-22  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_file.c 
	* plug-ins/imagemap/imap_main.c 
	* plug-ins/imagemap/imap_menu.c 
	* plug-ins/imagemap/imap_menu_funcs.[ch]
	* plug-ins/imagemap/imap_misc.[ch] 
	* plug-ins/imagemap/imap_object.[ch]
	* plug-ins/imagemap/imap_selection.c: cleaning up code, mostly
	replacing homebrewn stuff that is now in either GTK or one of the
	GIMP libs. More to come.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpselectiondata.c: include <stdio.h> for sscanf().

2005-01-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/jpeg/jpeg-save.c (save_dialog): update the preview (and
	thus the filesize) if the EXIF or thumbnail toggles are being used.
	Fixes bug #164914.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/imagemap/imap_file.c: fixed overwrite confirmation
	dialog (bug #164864).

2005-01-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/imagemap/imap_file.c (do_file_save_as_dialog): use
	GTK_STOCK_SAVE for the save dialog (bug #164864).

2005-01-21  Manish Singh  <yosh@gimp.org>

	* app/display/gimpdisplayshell.c: #include gimpbase.h for declaration
	of gimp_param_spec_unit().

2005-01-22  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpenumwidgets.c: added more gtk-doc comments.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimpbase.def
	* libgimpcolor/gimpcolor.def
	* libgimpmath/gimpmath.def: added new symbols.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimputils.c (gimp_enum_value_get_help): same fix here.

2005-01-21  Bill Skaggs  <weskaggs@primate.ucdavis.edu>
	
	* app/config/gimpconfig-types.c
	* app/config/gimpconfig-types.h: removed...

	* libgimpbase/gimpbasetypes.c
	* libgimpbase/gimpbasetypes.h: and contents merged
	into here.
	
	* app/config/gimpconfig-params.c: removed...

	* libgimpbase/gimpbaseparams.c
	* libgimpcolor/gimprgb.c
	* libgimpmath/gimpmatrix.c: and contents merged
	into here.

	* app/config/gimpconfig-params.h: part removed...

	* libgimpbase/gimpbaseparams.h
	* libgimpcolor/gimprgb.h
	* libgimpmath/gimpmatrix.h: and merged into here

	* libgimpbase/Makefile.am
	* libgimpbase/gimpbase.h
	* libgimpcolor/gimpbilinear.c
	* libgimpcolor/gimpcmyk.c
	* libgimpmath/gimpvector.c
	* app/config/Makefile.am
	* app/config/gimpconfig-deserialize.c
	* app/config/gimpconfig-dump.c
	* app/config/gimpconfig-serialize.c
	* app/config/gimpcoreconfig.c
	* app/config/gimpguiconfig.c
	* app/config/gimppluginconfig.c
	* app/core/gimp-utils.c
	* app/core/gimpcontext.c
	* app/tools/tools-utils.c
	* app/widgets/gimpaction.c
	* plug-ins/gimpressionist/utils.c: dependencies changed
	accordingly.

	First step in config migration out of core.  Need to fix
	devel-docs to reflect these changes.

2005-01-22  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimputils.c (gimp_enum_value_get_desc): no point in
	crashing if gimp_enum_get_desc() returns NULL.

	* modules/cdisplay_colorblind.c
	* modules/cdisplay_proof.c: register enum descriptions, use
	GimpEnumComboBox.

2005-01-21  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimppreviewarea.c: improved docs.

2005-01-21  Sven Neumann  <sven@gimp.org>

	* app/widgets/Makefile.am
	* app/widgets/widgets-types.h
	* app/widgets/gimpenumcombobox.[ch]
	* app/widgets/gimpenumstore.[ch]: moved GimpEnumStore and
	GimpEnumComboBox from here ...

	* libgimpwidgets/Makefile.am
	* libgimpwidgets/gimpwidgets.def
	* libgimpwidgets/gimpwidgets.h
	* libgimpwidgets/gimpwidgetstypes.h
	* libgimpwidgets/gimpenumcombobox.[ch]
	* libgimpwidgets/gimpenumstore.[ch]: ... to libgimpwidgets.

	* app/dialogs/convert-dialog.c
	* app/dialogs/scale-dialog.c
	* app/tools/gimpblendoptions.c
	* app/tools/gimpcurvestool.c
	* app/tools/gimplevelstool.c
	* app/widgets/gimpcolorframe.c
	* app/widgets/gimphistogrameditor.c
	* app/widgets/gimppropwidgets.c
	* app/widgets/gimpstrokeeditor.c
	* data/images/gimp-splash.png: changed includes accordingly.

2005-01-21  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpwidgets-utils.[ch] (gimp_action_get_accel_closure):
	new function as workaround for missing GTK+ API	(see bug #141750).

	* app/widgets/gimpactionview.[ch]: use the function instead of
	having this ugly hack here. Store the accel_closure instead of the
	hackish menu_item in the tree store. Removed cruft and cleaned up
	a bit.

2005-01-21  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-transform.c: applied a patch from Geert
	Jordaens that seems to fix drawable transformation using the new
	Lanczos interpolation routine :)

2005-01-20  Sven Neumann  <sven@gimp.org>

	* HACKING
	* Makefile.am
	* acinclude.m4
	* autogen.sh: applied (modified) patch from Raphaël Quinet that
	allows to build GIMP from CVS without having gtk-doc installed.
	If you need to do this, pass --disable-gtk-doc to autogen.sh.

	* configure.in: removed --disable-devel-docs option since it has
	become obsolete now.

	* devel-docs/Makefile.am: require gtk-doc when running 'make dist'.

2005-01-20  Sven Neumann  <sven@gimp.org>

	* app/paint-funcs/scale-funcs.[ch]: applied patch from Geert
	Jordaens that improves results of the Lanczos interpolation
	routine.

2005-01-20  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcomponenteditor.c
	(gimp_component_editor_button_press): call gimp_image_flush() after
	setting the active component since this might unselect the active
	channel. Fixes bug #164195.

2005-01-19  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-transform.c: applied a patch from Geert
	Jordaens that fixes the crash in the drawable transformations
	using the Lanczos interpolation type. The result is somewhat wrong
	though :(

2005-01-18  Manish Singh  <yosh@gimp.org>

	* plug-ins/jpeg/jpeg-save.[ch]: Adapted the code from the stable
	branch (based on a patch from Nils Philippsen) that makes sure that
	the EXIF thumbnail doesn't cause the EXIF data block to grow beyond
	its maximum size. Fixes bug #164087.

2005-01-19  Sven Neumann  <sven@gimp.org>

	* app/display/gimpscalecombobox.c (gimp_scale_combo_box_set_scale):
	don't use == to compare floating point values.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/bumpmap.c: make sure bumpmap_init_params()
	is called when necessary, fixes bug #162285.
	
2005-01-18  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpparasitelist.c (parasite_serialize): use
	gimp_config_writer_data() to write the parasite data because
	it's binary and can contain '\0'.

	(gimp_parasite_list_deserialize): use gimp_scanner_parse_data() to
	read it. Still accepts the old file format for backward
	compatibility. Fixes bug #163131.

2005-01-18  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpdockable.c (gimp_dockable_expose_event): blink
	more correctly.

2005-01-18  Carol Spears  <carol@gimp.org>

	* data/images/gimp-splash.png a different splash for the
        developers branch.

	* data/images/gimp-splash.png fixed a commit conflict.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* gimp/plug-ins/jpeg/gimpexif.c
	* gimp/plug-ins/jpeg/gimpexif.h: new files with prototype
	interface code for metadata system.

	* gimp/plug-ins/jpeg/Makefile.am
	* gimp/plug-ins/jpeg/jpeg-exif.c
	* gimp/plug-ins/jpeg/jpeg.c: adapted to metadata interface
	as described on gimp-dev mailing list.

2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* libgimpwidgets/gimpwidgets.c (gimp_coordinates_callback):
	Make sure last_x and last_y are set to values that match
	those returned by gimp_size_entry_get_refval(), 
	fixes bug #163951.
	
2005-01-18  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/dialogs/info-dialog.c: disconnect callbacks to prevent crash
	when destroying dialog, fixes bug #163617.
	
2005-01-18  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpdockable.[ch]: added new function
	gimp_dockable_blink() which lets the dockable's title_area blink.

	* app/widgets/gimpdialogfactory.c
	(gimp_dialog_factory_dialog_new_internal): let wilber blink at the
	user :) Fixes bug #164156.

2005-01-18  Alexander Shopov  <ash@contact.bg>

	* configure.in (ALL_LINGUAS): Added "bg" (Bulgarian)

2005-01-17  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/xjt/xjt.c: use gimp_temp_name instead of trying to
	create temp dir at loc of file, fixes bug #164116.
	
2005-01-17  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/spheredesigner.c: add basic validity check
	when attempting to open a preset; let's say this fixes
	bug #148984.

2005-01-17  Michael Natterer  <mitch@gimp.org>

	Allow to drop stuff onto empty layers, channels and paths dialogs
	to create new items:

	* app/widgets/gimpcontainertreeview.h (struct GimpContainerTreeView):
	added "gboolean dnd_drop_to_empty".

	* app/widgets/gimpcontainertreeview-dnd.c: if "dnd_drop_to_empty"
	is TRUE, dispatch drops to empty views and to the empty area below
	all items.

	* app/widgets/gimpitemtreeview.c (gimp_item_tree_view_init): set
	"dnd_drop_to_empty" to TRUE.

	* app/widgets/gimpitemtreeview.c
	* app/widgets/gimpchanneltreeview.c
	* app/widgets/gimpdrawabletreeview.c
	* app/widgets/gimplayertreeview.c
	* app/widgets/gimpvectorstreeview.c: made all drop functions work
	with "dest_viewable" being NULL and changed drop_possible()
	implementations accordingly. Cleaned up the whole DND code a bit.

	* app/widgets/gimplayertreeview.c: removed color and pattern
	drop code...

	* app/widgets/gimpdrawabletreeview.c: and added it here so colors
	and patterns can be dropped to the channels dialog too.

2005-01-16  Sven Neumann  <sven@gimp.org>

	* app/tools/gimppaintoptions-gui.c (pressure_options_gui): added a
	toggle to control whether pressure affects opacity of the Airbrush
	tool (bug #164237).

2005-01-16  Sven Neumann  <sven@gimp.org>

	* app/config/gimpdisplayconfig.[ch]
	* app/dialogs/preferences-dialog.c: also list the default image
	title and statusbar formats.

2005-01-16  Sven Neumann  <sven@gimp.org>

	* app/dialogs/preferences-dialog.c: renamed default image title
	and statusbar format as suggested in bug #150679.

2005-01-16  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/curve_bend.c: applied patch from Jan Heller that
	fixes broken expose event handling (bug #164207).

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpchannel.c: implement GimpItem::convert(). Handles
	any drawable, including conversion to GRAY, flattening and
	resizing.

	* app/widgets/gimpchanneltreeview.c: implement dropping of all
	kinds of drawables as new channels. Fixes bug #158133.

	Simplified component dropping by removing stuff which is done by
	gimp_item_convert() now.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* app/core/gimpdrawable-transform.c
	* app/paint-funcs/scale-funcs.c: minor cleanups to the new Lanczos
	interpolation routines. Drawable transformations do still crash :(

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/display/gimpdisplayshell-dnd.[ch]: added new function
	gimp_display_shell_dnd_init() which connects all DND callbacks.
	Made all DND callbacks static.

	* app/display/gimpdisplayshell.c (gimp_display_shell_init): call
	above function instead of connecting all DND callbacks here. Removed
	lots of now unused #includes.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpitem.c
	* app/core/gimpdrawable.c
	* app/vectors/gimpvectors.c: made GimpItem::scale() and ::resize()
	work on unattached items.

	* app/widgets/gimplayertreeview.c
	(gimp_layer_tree_view_drop_component): fix drop index.

	* app/widgets/gimpchanneltreeview.c: implement dropping of
	components as new channels. Fixes bug #158483.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpcontainertreeview.[ch]: added virtual function
	GimpContainerTreeView::drop_component(). Added EEKy "dnd_gimp"
	needed for gimp_selection_data_get_component().

	* app/widgets/gimpitemtreeview.c (gimp_item_tree_view_set_context):
	set the "dnd_gimp" pointer if it is NULL.

	* app/widgets/gimpcontainertreeview-dnd.c: handle component drops
	and dispatch ::drop_component() accordingly.

	* app/widgets/gimplayertreeview.c: implement dropping of
	components as new layers. Addresses bugs #158483 and #158133.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/display/gimpdisplayshell.c
	* app/display/gimpdisplayshell-dnd.[ch]
	* app/widgets/gimptoolbox-dnd.c: enabled dropping of components
	to the display and the toolbox. Addresses bug #158483.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpchannel.c (gimp_channel_new*): don't require a
	non-NULL color parameter (just leave the default color untouched
	if NULL is passed).

	* app/actions/channels-commands.c
	* app/core/gimpchannel-select.c: pass NULL as color for temporary
	channels or channels where we used to pass black.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpdnd.c: added gimp_dnd_get_component_icon().

	* app/widgets/gimpcomponenteditor.c: allow to drag
	components. They can't be dropped anywhere yet.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* libgimp/gimptile.c (gimp_tile_put)
	* libgimp/gimp.c (gimp_loop) (gimp_read_expect_msg): added missing
	calls to wire_destroy(). Plugs memory leaks in the wire protocol.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* libgimpbase/gimpprotocol.c: formatting.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* plug-ins/script-fu/script-fu-scripts.c (script_fu_free_script)
	* plug-ins/script-fu/siod-wrapper.c (init_procedures): plugged
	memory leaks.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpitemtreeview.c
	(gimp_item_tree_view_drop_viewable): handle drops of items of all
	types from all images and convert them if needed.

	* app/widgets/gimplayertreeview.c: enable dropping of all kinds of
	drawables. Addresses bug #158133.

2005-01-15  Michael Natterer  <mitch@gimp.org>

	* app/widgets/widgets-enums.h (enum GimpDndType): reordered so
	COMPONENT is after IMAGE.

	* app/widgets/gimpdnd.[ch]
	* app/widgets/gimpselectiondata.[ch]: added API for passing
	components around via DND. Speaks in terms of a
	(GimpImage,GimpChannelType) tuple.

2005-01-15  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/psd_save.c: fixed array out-of-bounds access and
	some mem-leaks reported by valgrind.

2005-01-14  Jay Cox  <jaycox@gimp.org>

	* plug-ins/common/psd_save.c: Much less wasted memory.  Save guides.
	Fixes bug #151904.

2005-01-14  Michael Natterer  <mitch@gimp.org>

	* app/paint/gimppaintcore-undo.c: doesn't need "gimp-intl.h" either.

2005-01-14  Sven Neumann  <sven@gimp.org>

	* app/paint/gimpink-undo.c: doesn't need to include "gimp-intl.h".

2005-01-14  Michael Natterer  <mitch@gimp.org>

	* app/core/core-enums.[ch] (enum GimpUndoType): added GIMP_UNDO_INK.

	* app/paint/gimppaintcore.[ch]: added virtual function
	GimpPaintCore::push_undo() and call it.

	* app/paint/gimppaintcore-undo.[ch]: made it the default
	implementation.

	* app/paint/gimpink-blob.[ch]: added blob_duplicate().

	* app/paint/gimpink.[ch]: added a "start_blob" (just like
	GimpPaintCore::start_coords) which gets set whenever we start a
	new stroke or line. Removed ink->lastx and ink->lasty because
	they are the same as paint_core->last_coords.

	* app/paint/Makefile.am
	* app/paint/gimpink-undo.[ch]: new files implementing an
	undo step for ink which restores the last blob used along
	with the whole ink state. Fixes bug #163670.

2005-01-14  Michael Natterer  <mitch@gimp.org>

	* app/actions/buffers-commands.[ch]
	* app/actions/data-commands.[ch]
	* app/actions/documents-commands.[ch]
	* app/actions/palettes-commands.[ch]
	* app/actions/templates-commands.[ch]: changed the remaining
	callbacks to follow a consistent naming scheme
	(e.g. buffers_delete_buffer_cmd_callback ->
	buffers_delete_cmd_callback).

	* app/actions/brushes-actions.c
	* app/actions/buffers-actions.c
	* app/actions/documents-actions.c
	* app/actions/gradients-actions.c
	* app/actions/palettes-actions.c
	* app/actions/patterns-actions.c
	* app/actions/templates-actions.c: changed accordingly.

2005-01-14  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/retinex.c (run): fixed check for number of
	parameters in non-interactive mode.

2005-01-13  Manish Singh  <yosh@gimp.org>

	* plug-ins/common/channel_mixer.c: Add a Reset button. Addresses
	bug #163045.

2005-01-14  Sven Neumann  <sven@gimp.org>

	* plug-ins/bmp/bmpread.c: removed obscure error codes from
	translatable error messages.

2005-01-13  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/Lighting/lighting_shade.c: remove artifacts
	when light strikes underside of bumpmapped surface;
	should fix bug #163877.
	
2005-01-13  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/bmp/bmp.h
	* plug-ins/bmp/bmpread.c: handle negative height values
	as per spec, fixes bug #158033
	
2005-01-13  Michael Natterer  <mitch@gimp.org>

	Allow to easily open brushes and patterns as images.
	Fixes bug #163059.

	* app/actions/brushes-actions.c
	* app/actions/patterns-actions.c: added "brushes-open-as-image"
	and "patterns-open-as-image" actions.

	* app/actions/data-commands.[ch]: added
	data_open_as_image_cmd_callback() which tries to load
	data->filename as image.

	* app/widgets/gimphelp-ids.h: added help IDs for the new actions.

	* app/widgets/gimpdatafactoryview.c: added buttons.

	* menus/brushes-menu.xml
	* menus/patterns-menu.xml: added them to the menus.

2005-01-13  Michael Natterer  <mitch@gimp.org>

	Splitting GimpItem::convert() into two virtual functions was
	apparently buggy over-engineering. Reverted that stuff and
	implement item conversion much simpler:

	* app/core/gimpitem.[ch]: have a single virtual function,
	GimpItem::convert(), which takes a newly duplicated item and the
	destination image.

	(gimp_item_convert): simply call GimpItem::convert() on the result
	of gimp_item_duplicate().

	(gimp_item_real_convert): set the item's new image.

	* app/core/gimplayer.c (gimp_layer_convert)
	* app/vectors/gimpvectors.c (gimp_vectors_convert): changed
	accordingly and chain up after, not before doing our own stuff
	so the old image is still available as item->image for stuff
	like colormap conversion. Fixes bug #163879.

2005-01-13  Michael Natterer  <mitch@gimp.org>

	Made the file open and save dialogs use the last used folder
	instead of defaulting to current directory. Fixes bug #162385.

	* app/widgets/gimpfiledialog.[ch] (gimp_file_dialog_set_uri):
	removed this function because it had no functionality except
	creating usability problems.

	* app/actions/file-commands.c: use gtk_file_chooser_set_uri()
	instead but *only* if we already have an uri from an alread open
	image or the document hinstory.

	* app/widgets/gimpfiledialog.c (gimp_file_dialog_set_image): set
	the file chooser's uri only if we have an uri from the image
	itself. Leave the current folder untouched otherwise and just set
	the current name (e.g. "Untitled").

	* app/dialogs/file-save-dialog.c (file_save_dialog_save_image): on
	successful save, remember the used uri by attaching it to the
	"gimp" instance.

	(file_save_dialog_new): set the last saved uri's folder on the
	newly created file save dialog.

2005-01-13  Sven Neumann  <sven@gimp.org>

	* app/units.c
	* app/core/gimp-units.c
	* app/core/gimp.c
	* app/core/gimpunit.[ch]: added a utility function that frees the
	memory allocated for user units. Minor cleanups.

2005-01-13  Sven Neumann  <sven@gimp.org>

	* configure.in (ALL_LINGUAS): added mk (Macedonian).

2005-01-11  Sven Neumann  <sven@gimp.org>

	* app/pdb/drawable_transform_cmds.c
	* libgimp/gimpenums.h
	* plug-ins/pygimp/gimpenums.py
	* tools/pdbgen/enums.pl: regenerated after change of
	GimpInterpolationType enum.

2005-01-11  Sven Neumann  <sven@gimp.org>

	* app/base/base-enums.[ch]
	* app/core/gimpdrawable-transform.c
	* app/core/gimpdrawable.c
	* app/paint-funcs/Makefile.am
	* app/paint-funcs/paint-funcs.[ch]
	* app/paint-funcs/scale-funcs.[ch]: applied patch by Geert Jordaens
	(after a good deal of reformatting for coding style compliance).
	This factors the scale routines into their own file and adds a
	sinc-based (Lanczos) interpolation routine (bug #162250).

2005-01-11  Sven Neumann  <sven@gimp.org>

	* plug-ins/script-fu/siod/slib.c (help): removed wrong URL from
	help output.

2005-01-10  Manish Singh  <yosh@gimp.org>

	* modules/controller_midi.c: #include <time.h> to make sure all
	the types are there for the alsa headers. Should address bug
	#163593.

2005-01-10  Sven Neumann  <sven@gimp.org>

	* tools/pdbgen/pdb/text_tool.pdb: explicitely mention the encoding.

	* app/pdb/text_tool_cmds.c
	* libgimp/gimptexttool_pdb.c: regenerated.

2005-01-10  DindinX  <dindinx@gimp.org>

	* plug-ins/common/sparkle.c: update the preview when a parameter
	change.  Updating the preview is now disabled by default since it
	can be very slow.

2005-01-09  Sven Neumann  <sven@gimp.org>

	* libgimp/gimpgradientmenu.c: fixed out-of-bounds access in
	gradient selection widget. Presumably fixes bug #163427.

2005-01-09  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontrollerkeyboard.c: changed "Key" to "Cursor".

2005-01-09  DindinX  <dindinx@gimp.org>

	* plug-ins/common/sparkle.c: added a preview. This will need more
	testing.  Shlomi Fish, can you please try to test this plug-in again?

2005-01-09  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpactionview.c (gimp_action_view_new): connect to
	"button_press_event" and start editing immidiately instead of
	waiting for a second click. Fixes bug #163385.

2005-01-09  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpdialogfactory.c (gimp_dialog_factories_toggle):
	if called with (ensure_visibility == TRUE), raise the toolbox.
	Fixes bug #163381.

2005-01-08  DindinX  <dindinx@gimp.org>

	* plug-ins/common/mosaic.c: made the preview fast enough to be useful.

2005-01-08  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontainertreeview.c
	(gimp_container_tree_view_button_press): fixed handling of clicks
	into a horizontally scrolled treeview.

	(gimp_container_tree_view_find_click_cell): really fix handling of
	RTL layouts (bug #162663).

2005-01-08  Sven Neumann  <sven@gimp.org>

	* app/dialogs/scale-dialog.c: use a GimpMessageBox to display the
	informative message when scaling an indexed image.

2005-01-07  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontainertreeview.c
	(gimp_container_tree_view_button_press): handle RTL layouts (fixes
	bug #162663).

2005-01-07  Shlomi Fish  <shlomif@iglu.org.il>

	* plug-ins/script-fu/scripts/frosty-logo.scm: made sure the shadow
	is given enough space and then truncated instead of translated to
	the center of the image, thus preventing the display of shadows
	with a completely horizontal or vertical edge.

	Fixes bug #132145.

2005-01-07  Michael Natterer  <mitch@gimp.org>

	* app/core/gimpimage-snap.c: moved variables to local scopes,
	assign the snapped coords unconditionally (also if we don't snap),
	cleanup.

	(gimp_image_snap_rectangle): entirely rewritten to use local
	mindist_x, mindist_y variables instead of fiddling with lots of
	boolean variables. Implemented vectors snapping as if the required
	GimpStroke functions existed (#defined them). Simon, your turn :)

2005-01-07  Michael Natterer  <mitch@gimp.org>

	* app/actions/plug-in-commands.c
	* app/actions/vectors-commands.c: GIMP_PROGRESS(NULL) is perfectly
	valid, no need to say gdisp ? GIMP_PROGRESS(gdisp) : NULL.

	* app/actions/plug-in-commands.c (plug_in_run_cmd_callback):
	remember the last plug-in if it has at least 3 args, not 2.
	Cleaned up the whole function and removed cruft.

2005-01-07  Sven Neumann  <sven@gimp.org>

	* app/composite/gimp-composite-x86.h
	* app/composite/gimp-composite-sse.c: applied patch from Andreas
	Jochens that fixes the build on amd64 with gcc-4.0 (bug #163041).

2005-01-07  Sven Neumann  <sven@gimp.org>

	* data/misc/gimp.desktop.in.in: changed Comment field as suggested
	in bug #160990.

2005-01-07  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/mail.c: just some minor formatting changes.

2005-01-07  Sven Neumann  <sven@gimp.org>

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg-exif.c
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg.[ch]: some code cleanup.

2005-01-06  Manish Singh  <yosh@gimp.org>

	* libgimpwidgets/gimpdialog.c: flush the display in dispose if we're
	no longer in a main loop, so the dialog doesn't hang around while
	possibly long running calculations are being done. Fixes bug #163084.

2005-01-06  Michael Schumacher <schumaml@cvs.gnome.org>

	* libgimpwidgets/gimpwidgets.def: added
	gimp_scrolled_preview_set_position 

2005-01-06  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/sparkle.c: applied patch from Shlomi Fish that
	fixes more regressions in Sparkle plug-in (bug #132145).

2005-01-05  DindinX  <dindinx@gimp.org>

	* libgimpwidgets/gimpscrolledpreview.[ch]: new function:
	gimp_scrolled_preview_set_position () to set the position of the
	preview content wrt the drawable.  This function might be moved to a
	virtual function of GimpPreview in a near future.

	* libgimp/gimpdrawablepreview.c: use this function, so a preview
	remembers its position from one invocation to the next.  This is done
	using the current executable name as a key for gimp_set/get_data () so
	each plug-in can have its preview on a different place.

	More informations could be saved this way: the update toggle, the
	checks, etc.

	Addresses bug #162286.

	* libgimpwidgets/gimppreview.c: smallish cleanup.

2005-01-04  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* configure.in: add check for libexif version >= 0.6.0,
	necessary because of nasty incompatible api change.
	
	* plug-ins/jpeg/exif-handling.txt: removed from here...

	* devel-docs/exif-handling.txt: ...and added here
	
	* plug-ins/jpeg/jpeg-exif.c
	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg.h: extract info from exif on loading,
	and add info to exif on saving, addresses bug #56433,
	bug #61499, and bug #121810.
	
2005-01-04  Sven Neumann  <sven@gimp.org>

	* app/display/gimpdisplayshell-close.c
	(gimp_display_shell_close_dialog): set the default response to
	Cancel in order to reduce the risk of accidentally saving an
	image (bug #162872).

2005-01-04  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpcontainertreeview.c: prepared code for fixing
	bug #162663.

2005-01-03  DindinX  <dindinx@gimp.org>

	* plug-ins/common/mosaic.c: invalidate the preview when a parameter
	changes.  Disabled updating the preview by default. There is room
	for optimisations, but this fixes #162710.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* libgimpwidgets/gimpcellrenderertoggle.c
	(gimp_cell_renderer_toggle_get_size): made the code look more
	similar to GtkCellRendererToggle to allow for easy comparison.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* app/menus/plug-in-menus.c: made the code a little more robust by
	not relying on certain properties of the menu path.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* tools/pdbgen/pdb/gradient.pdb: do actually add the new procedure
	gimp_gradient_is_editable().

	* app/pdb/gradient_cmds.c
	* app/pdb/internal_procs.c
	* libgimp/gimpgradient_pdb.[ch]: regenerated.

	* libgimp/gimp.def: updated.

2005-01-03  Michael Natterer  <mitch@gimp.org>

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]
	* app/display/gimpdisplayshell-appearance.[ch]
	* menus/image-menu.xml.in: reordered actions, functions and menu
	items so the "show" and "snap" actions are grouped.

2005-01-03  Michael Natterer  <mitch@gimp.org>

	Implemented "Snap to Canvas Edges" (fixes bug #152971) and
	"Snap to Active Path" (half way done):

	* app/core/gimpimage-snap.[ch]: added boolean snap_to_canvas and
	snap_to_vectors parameters (snap_to_vectors works fine when
	snapping to a point, but is unimplemented for snapping to a
	rectangle).

	* app/display/gimpdisplayshell.[ch] (struct GimpDisplayShell):
	added snap_to_canvas and snap_to_vectors booleans.

	* app/display/gimpdisplayshell-appearance.[ch]: added API to
	get/set them.

	* app/actions/view-actions.c
	* app/actions/view-commands.[ch]
	* app/widgets/gimphelp-ids.h: added actions, callbacks and help IDs.

	* menus/image-menu.xml.in: added them to Image->View.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* plug-ins/ifscompose/ifscompose.c: use g_free() to release memory
	allocated using g_malloc().

2005-01-03  Michael Natterer  <mitch@gimp.org>

	* app/display/gimpdisplayshell-autoscroll.c
	(gimp_display_shell_autoscroll_timeout): need to snap the
	coordinates before passing them to the active tool.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/fp.c: removed GtkFrame from dialog and replaced
	a call to free() by g_free().

2005-01-03  Michael Natterer  <mitch@gimp.org>

	* app/paint/gimpbrushcore.c
	* app/paint/gimppaintoptions.[ch]
	* app/tools/gimppaintoptions-gui.c: renamed "invsize" to
	"inverse-size" and reordered it to be after "size".

2005-01-03  Sven Neumann  <sven@gimp.org>

	* etc/ps-menurc: another update from Eric Pierce.

2005-01-03  Sven Neumann  <sven@gimp.org>

	* app/paint/gimpink.[ch]: handle event time as guint32. That's the
	type we deal with here and it avoids a crash that occured when
	autoscrolling with the Ink tool.

	* app/display/gimpdisplayshell-autoscroll.c: cosmetics.

2005-01-02  Michael Natterer  <mitch@gimp.org>

	* app/display/Makefile.am
	* app/display/gimpdisplayshell-autoscroll.[ch]
	* app/display/gimpdisplayshell-coords.[ch]: new files factored out
	of gimpdisplayshell-callbacks.c

	* app/display/gimpdisplayshell.h (struct GimpDisplayShell): added
	"gpointer scroll_info" needed by autoscroll.

	* app/display/gimpdisplayshell-callbacks.c: removed the stuff
	above. Also removed the static autoscroll struct because it's not
	needed any longer.

2005-01-02  DindinX  <dindinx@gimp.org>

	* plug-ins/common/mosaic.c: Added a preview.  This still needs some
	work and some testing.  Calculating the preview takes ages.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/exif-handling.txt:  added summary of how Gimp should
	handle each exif field according to the specs.
	
2005-01-02  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpsizebox.c
	* app/widgets/gimptemplateeditor.c: round displayed resolution
	instead of just casting to integer values. Use image size limits
	from libgimpbase/gimplimits.h instead of some arbitrary numbers.

2005-01-02  Manish Singh  <yosh@gimp.org>

	* plug-ins/pygimp/plug-ins/clothify.py
	* plug-ins/pygimp/plug-ins/foggify.py: Add layers to images before
	using them. Fixes bug #162707.

2005-01-02  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_about.c: bumped version number

	* plug-ins/imagemap/AUTHORS
	* plug-ins/imagemap/NEWS
	* plug-ins/imagemap/README
	* plug-ins/imagemap/TODO: removed since they don't contain relevant
	information anymore.

	* plug-ins/imagemap/imap_popup.[ch]: removed

	* plug-ins/imagemap/Makefile.am
	* po-plug-ins/POTFILES.in: changed accordingly

	* plug-ins/imagemap/imap_grid.c
	* plug-ins/imagemap/imap_main.[ch]
	* plug-ins/imagemap/imap_menu.[ch]
	* plug-ins/imagemap/imap_object_popup.c
	* plug-ins/imagemap/imap_preview.c
	* plug-ins/imagemap/imap_toolbar.[ch]
	* plug-ins/imagemap/imap_tools.[ch]: first set of changes to fix
	#138841 (Use action based menus in Imagemap plug-in).
	
2005-01-02  Sven Neumann  <sven@gimp.org>

	* app/gui/splash.c (splash_update): fixed display of progress
	labels in RTL environment.

2005-01-02  Sven Neumann  <sven@gimp.org>

	* etc/ps-menurc: updated PS keybindings contributed by Eric Pierce.

2005-01-02  Sven Neumann  <sven@gimp.org>

	* app/widgets/gimpsizebox.c (gimp_size_box_constructor): fixed
	position of pixel and resolution labels.

2005-01-02  Sven Neumann  <sven@gimp.org>

	* app/display/gimpdisplayshell-callbacks.c: fixed auto-scrolling
	for left and bottom display edges. Remove the timeout on
	button-release event, some minor cleanups.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/jpeg_load.c
	* plug-ins/jpeg/jpeg_load.h
	* plug-ins/jpeg/jpeg_save.c
	* plug-ins/jpeg/jpeg_save.h: removed
	
	* plug-ins/jpeg/jpeg-load.c
	* plug-ins/jpeg/jpeg-load.h
	* plug-ins/jpeg/jpeg-save.c
	* plug-ins/jpeg/jpeg-save.h: added (changing _ to -)

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/jpeg.c
	* po-plug-ins/POTFILES.in: changed accordingly

2005-01-02  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/sparkle.c: applied patch from Shlomi Fish that
	fixes regressions in Sparkle plug-in (bug #132145).

2005-01-02  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/plugin-defs.pl: changed for move of JPEG plug-in.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/Lighting/lighting_ui.c: add a control for
	viewpoint distance.  Should finish fixing bug #4044.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/jpeg/Makefile.am
	* plug-ins/jpeg/NEWS
	* plug-ins/jpeg/jpeg.c
	* plug-ins/jpeg/jpeg.h
	* plug-ins/jpeg/jpeg_load.c
	* plug-ins/jpeg/jpeg_load.h
	* plug-ins/jpeg/jpeg_save.c
	* plug-ins/jpeg/jpeg_save.h: moved jpeg code into new
	dir and split up, already too large and a good bit more 
	will be needed for proper exif handling.
	
	* plug-ins/common/jpeg.c: removed

	* configure.in
	* plug-ins/Makefile.am
	* plug-ins/common/Makefile.am: changed accordingly

2005-01-01  Manish Singh  <yosh@gimp.org>

	* plug-ins/common/tiff.c: Revert incorrect optimization from previous
	change.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/gradmap.c: added procedure plug_in_palettemap
	that does the same thing as gradmap except using the current
	palette; should resolve bug #68879.
	
2005-01-02  Manish Singh  <yosh@gimp.org>

	* plug-ins/common/tiff.c: Special case 1-bit black & white indexed
	images to save out as 1-bit grayscale MINISWHITE tiffs. Also load
	these images as indexed images into GIMP. Fixes bug #150865.

2005-01-01  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/display/gimpdisplayshell-callbacks.c: use a timeout for
	autoscrolling, to fix bug #8269.  Happy new year!

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/gimpbrushcore.c
	* app/paint/gimppaintoptions.c
	* app/paint/gimppaintoptions.h
	* app/tools/gimppaintoptions-gui.c: reverted last change, and
	applied full patch from Dave Ahlswede in bug #149576.

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* tools/pdbgen/pdb/gradient.pdb: added gradient-is-editable

	* tools/pdbgen/pdb/brush.pdb
	* tools/pdbgen/pdb/palette.pdb: changed mitch_misc to bill_misc
	where correct.

	* app/pdb/brush_cmds.c
	* app/pdb/palette_cmds.c
	* libgimp/gimpbrush_pdb.c
	* libgimp/gimppalette_pdb.c: regenerated.

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/gimpbrushcore.c: make previously committed change
	in pressure-size relationship apply only to airbrush, as
	intended.
	
2004-12-31  Michael Natterer  <mitch@gimp.org>

	* app/actions/plug-in-actions.c: use the orininal string if
	plug_in_actions_check_translation() fails instead of bailing out.
	Fixes bug #162590.

2004-12-31  Michael Natterer  <mitch@gimp.org>

	* app/core/gimppalette.[ch]: removed the just added
	gimp_palette_insert_entry() and added a "gint position" parameter
	to gimp_palette_add_entry() instead (no need to have two almost
	identical functions).

	* app/actions/palette-editor-commands.c
	* app/core/gimppalette-import.c
	* app/widgets/gimppaletteeditor.c
	* tools/pdbgen/pdb/palette.pdb: changed accordingly.

	* app/pdb/palette_cmds.c: regenerated.

2004-12-31  Michael Natterer  <mitch@gimp.org>

	* app/widgets/gimpfgbgeditor.[ch]: use the coordinates passed in
	the color drop callback instead of remembering them in the
	drag_motion handler.

2004-12-31  Sven Neumann  <sven@gimp.org>

	* tools/kernelgen.c: fixed rounding so that all brush kernels are
	created with a constant sum of 256.

	* app/paint/gimpbrushcore-kernels.h: regenerated.

	* app/paint/gimpbrushcore.c (gimp_brush_core_subsample_mask): use
	the constant defined in app/paint/gimpbrushcore-kernels.h. Should
	give a tiny speedup.

2004-12-31  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/gimpbrushcore.c: invert dependence of brush size on
	pressure, using formula from Dave Ahlswede in bug #149576.
	
2004-12-31  Michael Natterer  <mitch@gimp.org>

	Applied modified patch from Ben Campbell which adds drop
	coordinates to the color drop callback and uses it to insert
	colors in the palette editor. Extended the patch to add drop
	coordinates to all drop callbacks.

	* app/core/gimppalette.[ch]: added gimp_palette_insert_entry().

	* app/display/gimpdisplayshell-dnd.[ch]: added drop coordinates
	to all drop callbacks.

	* app/dialogs/palette-import-dialog.c
	* app/widgets/gimpcolormapeditor.c
	* app/widgets/gimpcontainerview.c
	* app/widgets/gimpdnd.[ch]
	* app/widgets/gimpdrawabletreeview.c
	* app/widgets/gimpfgbgeditor.c
	* app/widgets/gimpgradienteditor.c
	* app/widgets/gimpitemtreeview.c
	* app/widgets/gimppaletteeditor.c
	* app/widgets/gimppropwidgets.c
	* app/widgets/gimpselectioneditor.c
	* app/widgets/gimptoolbox-dnd.c
	* app/widgets/gimptoolbox-image-area.c
	* app/widgets/gimptoolbox-indicator-area.c
	* app/widgets/gimptooloptionseditor.c
	* libgimpwidgets/gimpcolorselect.c: changed accordingly. The passed
	drop coordiantes are so far unused.

	* app/widgets/gimppaletteeditor.c: use the drop coordinates to
	insert the new color into the palette at the right place instead
	of always appending. Fixes bug #150030.

2004-12-31  Michael Natterer  <mitch@gimp.org>

	* app/actions/tools-actions.c
	* app/actions/tools-commands.[ch]
	* app/widgets/gimptoolview.[ch]: applied a (modified) patch from
	Joao S. O. Bueno which adds "raise" and "lower" actions and
	their buttons in the tool dialog. Fixes bug #158666.
	Cleaned up the tool action callbacks.

2004-12-31  Sven Neumann  <sven@gimp.org>

	* plug-ins/imagemap/imap_preview.c (render_rgb_image): use the proper
	image type and rowstride. Fixes bug #162592.

2004-12-30  Manish Singh  <yosh@gimp.org>

	* tools/Makefile.am
	* app/Makefile.am: build binaries with 2.3 versions.

2004-12-30  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/widgets/gimpsizebox.c: give correct arguments to
	gimp_coordinates_new().  Fixes problem described in
	comment 6 of bug #162387.
	
2004-12-31  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped gimp_app_version and gimp_user_version to 2.3.

	* app/Makefile.am
	* tools/Makefile.am: changed to 2.3.

2004-12-30  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* tools/pdbgen/pdb/brush.pdb: added api for changing properties
	of generated brushes.
	
	* tools/pdbgen/pdb/palette.pdb: added palette_is_editable().

	* app/pdb/brush_cmds.c
	* app/pdb/internal_procs.c
	* app/pdb/palette_cmds.c
	* libgimp/gimpbrush_pdb.c
	* libgimp/gimpbrush_pdb.h
	* libgimp/gimppalette_pdb.c
	* libgimp/gimppalette_pdb.h: autogenerated.

2004-12-29  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped version to 2.3.0.

2004-12-29  Sven Neumann  <sven@gimp.org>

	* app/dialogs/file-save-dialog.c (file_save_dialog_response):
	handle a NULL return value from gtk_file_chooser_get_uri(). Fixes
	bug #162443.

2004-12-29  Maurits Rijk  <m.rijk@chello.nl>

	* plug-ins/imagemap/imap_preferences.[ch]: replace home-brewn color
	selection by GimpColorButton.

2004-12-29  DindinX  <dindinx@gimp.org>

	* plug-ins/gfig/gfig-rectangle.[ch]
	* plug-ins/gfig/images/stock-rectangle.png: news files to implement a
	rectangle tool to gfig.

	* plug-ins/gfig/gfig-stock.c
	* plug-ins/gfig/gfig-stock.h
	* plug-ins/gfig/Makefile.am: modified accordingly.

	* plug-ins/gfig/gfig-circle.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig-dobject.c
	* plug-ins/gfig/gfig-ellipse.c
	* plug-ins/gfig/gfig-poly.c
	* plug-ins/gfig/gfig-star.c
	* plug-ins/gfig/gfig-types.h
	* plug-ins/gfig/gfig.c
	* plug-ins/gfig/gfig.h: modified to support the new shape and
	implement two new filling types: vertical and horizontal gradients.
	These gradients are imho much more useful than the shapeburst one.

2004-12-28  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/compose.c: Recompose did not properly 
	handle case where layer with alpha is decomposed into
	something that does not encode alpha -- now does.

	
2004-12-28  Michael Natterer  <mitch@gimp.org>

	* app/core/gimp-edit.c (gimp_edit_set_buffer): new utility
	function instead of code duplication.

2004-12-28  Michael Natterer  <mitch@gimp.org>

	* app/base/base-enums.[ch]: added translatable strings to the
	GimpLayerModeEffects enum because they will soon disappear from
	widgets/gimpwidgets-constructors.c

2004-12-28  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/compose.c: add "Recompose" (plug_in_recompose) 
	as described on dev mailing list.

	* plug-ins/common/decompose.c: add "decompose-data" parasite
	when decoposing, to support Recompose.  Also add missing 
	alpha channels to newly produced layers
	
2004-12-28  Sven Neumann  <sven@gimp.org>

	* Made 2.2.1 release.

2004-12-28  Sven Neumann  <sven@gimp.org>

	* libgimp/gimp.[ch] (gimp_install_procedure, gimp_install_temp_proc):
	renamed menu_path parameter to menu_label and added a pointer to
	gimp_plugin_menu_register()

	* app/widgets/gimpsizebox.c (gimp_size_box_constructor): removed
	unused variables.

2004-12-28  Sven Neumann  <sven@gimp.org>

	* app/paint/gimpbrushcore.c (gimp_brush_core_subsample_mask):
	reverted Bill's change since it is obviously not the right fix.
	Allocate the array larger to avoid the crash. We need to
	investigate bug #161323 further.

2004-12-27  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/paint/gimpbrushcore.c (gimp_brush_core_subsample_mask):
	don't set array outside its bounds.  Should fix bug #161323.
	Credit to Robert Ögren for figuring out what was wrong.
	
2004-12-27  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/colortoalpha.c: if possible, use
	gimp_preview_draw_buffer() so that the selection mask is correctly
	previewed. Minor cleanups.

2004-12-27  Sven Neumann  <sven@gimp.org>

	* libgimp/gimpregioniterator.c: added some checks to avoid
	division by zero.

	* libgimpwidgets/gimppreviewarea.[ch]: minor cleanups, improved
	API documentation.

2004-12-26  DindinX  <dindinx@gimp.org>

	* plug-ins/gfig/gfig-arc.c
	* plug-ins/gfig/gfig-bezier.c
	* plug-ins/gfig/gfig-circle.c
	* plug-ins/gfig/gfig-dialog.c
	* plug-ins/gfig/gfig-ellipse.c
	* plug-ins/gfig/gfig-line.c
	* plug-ins/gfig/gfig-poly.c
	* plug-ins/gfig/gfig-spiral.c
	* plug-ins/gfig/gfig-star.c
	* plug-ins/gfig/gfig-style.h
	* plug-ins/gfig/gfig.h: plugged some memory-leaks, and done some
	cleanups.

2004-12-26  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/core/gimpbrush.c: don't ask for preview with
	zero width or height, fixes bug #162232.

	* app/base/brush-scale.c: remove tabs and trailing
	whitespace.

2004-12-26  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/actions/documents-commands.c
	* app/actions/file-commands.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/display/gimpdisplayshell-dnd.c
	* app/widgets/gimplayertreeview.c
	* app/widgets/gimptoolbox-dnd.c: undo changes of 12-24,
	in favor of a better fix.

	* app/widgets/gimperrordialog.c: fix bug #162147 properly,
	as suggested by mitch.

2004-12-25  Michael Natterer  <mitch@gimp.org>

	* plug-ins/script-fu/scripts/weave.scm: limit the "Thread
	intensity" parameter to [0..100] because it's used as layer
	opacity. Fixes bug #162182.

2004-12-24  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* app/actions/documents-commands.c
	* app/actions/file-commands.c
	* app/dialogs/file-open-dialog.c
	* app/dialogs/file-open-location-dialog.c
	* app/display/gimpdisplayshell-dnd.c
	* app/widgets/gimplayertreeview.c
	* app/widgets/gimptoolbox-dnd.c: replace % with space
	in file name before showing error message, 
	fixes bug #162147.

	* app/core/gimp-gui.c
	* app/widgets/gimpmessagebox.c: be a bit more paranoid
	about validating utf8 for messages.

2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* gimp/app/widgets/gimpsizebox.c: fix incorrect Update
	Policy for size entry as pointed out by mitch.
	
2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/cartoon.c
	* plug-ins/common/cubism.c
	* plug-ins/common/displace.c
	* plug-ins/common/dog.c
	* plug-ins/common/emboss.c
	* plug-ins/common/engrave.c
	* plug-ins/common/gauss.c
	* plug-ins/common/glasstile.c
	* plug-ins/common/neon.c
	* plug-ins/common/noisify.c
	* plug-ins/common/oilify.c
	* plug-ins/common/photocopy.c
	* plug-ins/common/ripple.c
	* plug-ins/common/sharpen.c
	* plug-ins/common/shift.c
	* plug-ins/common/sobel.c
	* plug-ins/common/softglow.c
	* plug-ins/common/spread.c
	* plug-ins/common/tileit.c
	* plug-ins/common/whirlpinch.c: make sure tile cache is allocated
	before preview is shown -- significant speedup in some cases,
	minimal in others.

	* plug-ins/common/sel_gauss.c: give it a tile cache (didn't
	have one).  Still very slow but a little better.
	
2004-12-24  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/despeckle.c (despeckle_median): don't call
	gimp_progress_update() for each and every pixel. Every few rows
	should be enough. Fixes bug #162129.

	* plug-ins/common/blur.c: set progress to 1.0 when done, not to 100.

2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* plug-ins/common/mblur.c: set up tile cache before
	creating dialog -- major speedup in preview.
	
2004-12-23  Bill Skaggs <weskaggs@primate.ucdavis.edu>

	* gimp/app/widgets/gimpsizebox.c: use gimp_coordinates_new()
	instead of duplicating a lot of code.  Fixes bug #161756.
	
	* gimp/app/widgets/gimppropwidgets.c: small change in 
	chainbutton handling to make above work.

2004-12-23  Sven Neumann  <sven@gimp.org>

	* app/plug-in/plug-in-proc-frame.[ch]: made plug_in_proc_frame_free()
	a static function.

2004-12-23  Michael Natterer  <mitch@gimp.org>

	Item conversion depends on the old *and* the new item type, so
	it can't live in the old item's vtable only:

	* app/core/gimpitem.[ch]: split GimpItem::convert() into
	GimpItem::convert_from() (which is called on the old item and
	creates the new item) and GimpItem::convert_to() (which is called
	on the new item). This way functions from the old *and* new items'
	vtables are called and it's possible to convert between item types
	which live on different branches of the class hierarchy or to item
	types which live further down the class tree than the old item.

	(gimp_item_convert): call ::convert_to() on the new item created
	by ::convert_from().

	* app/vectors/gimpvectors.c: changed ::convert() implementation
	to ::convert_from().

	* app/core/gimplayer.c: changed ::convert() to ::convert_to().
	Fixes bug #161877.

2004-12-22  Sven Neumann  <sven@gimp.org>

	* plug-ins/script-fu/scripts/Makefile.am
	* plug-ins/script-fu/scripts/asc2img.scm: removed this script as it
	is broken beyond repair and the functionality is provided by the
	text tool itself.

2004-12-22  Sven Neumann  <sven@gimp.org>

	* NEWS: added NEWS for the stable branch (no, we haven't branched
	yet).

	* Makefile.am
	* NEWS.pre-2.2: moved old NEWS here.
	
2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c (blur_line): fixed the degenerate case
	where the source image is smaller than the blurred area. This used
	to give artefacts at the borders.

2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: more code cleanup and micro
	optimizations.

2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: reverted the last change since it
	introduced artefacts. Even had to increase the border around the
	previewed area. Fixed a bug in unsharp_region() where it was using
	the wrong source region for blurring.

2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: compute preview for the displayed area
	only, some more code cleanup.

2004-12-21  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c (preview_update): fixed bug #157910.
	More code cleanup and some trivial optimizations.

2004-12-21  Michael Natterer  <mitch@gimp.org>

	* app/actions/gradient-editor-actions.c
	(gradient_editor_actions_update): if the dialog is insensitive,
	disable all actions which modify the gradient. Fixes bug #161411.

	* app/actions/gradient-editor-commands.c: update the UI manager
	after setting the dialog sensitive/insensitive so te above works.

2004-12-20  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: more code cleanup.

2004-12-20  Sven Neumann  <sven@gimp.org>

	* libgimp/gimpdrawablepreview.c (gimp_drawable_preview_draw_region):
	unset the dirty flag on the GimpPixelRgn used to iterate the region.

	* libgimp/gimppixelrgn.c (gimp_pixel_rgn_init): improved docs.

2004-12-20  Sven Neumann  <sven@gimp.org>

	* plug-ins/common/unsharp.c: code cleanup, no real changes.

2004-12-20  Sven Neumann  <sven@gimp.org>

	* configure.in: bumped version to 2.2.1.

	* plug-ins/FractalExplorer/FractalExplorer.c: applied patch from
	Yeti that fixes a memory corruption (bug #161729).

2004-12-19  Sven Neumann  <sven@gimp.org>

	* Made 2.2.0 release.
