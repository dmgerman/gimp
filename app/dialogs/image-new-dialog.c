begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"appenv.h"
end_include

begin_include
include|#
directive|include
file|"actionarea.h"
end_include

begin_include
include|#
directive|include
file|"app_procs.h"
end_include

begin_include
include|#
directive|include
file|"commands.h"
end_include

begin_include
include|#
directive|include
file|"general.h"
end_include

begin_include
include|#
directive|include
file|"gimage.h"
end_include

begin_include
include|#
directive|include
file|"gimprc.h"
end_include

begin_include
include|#
directive|include
file|"global_edit.h"
end_include

begin_include
include|#
directive|include
file|"interface.h"
end_include

begin_include
include|#
directive|include
file|"plug_in.h"
end_include

begin_include
include|#
directive|include
file|"tile_manager_pvt.h"
end_include

begin_include
include|#
directive|include
file|"gdisplay.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/gimpchainbutton.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/gimpsizeentry.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/gimpintl.h"
end_include

begin_typedef
DECL|struct|__anon2b72d56c0108
typedef|typedef
struct|struct
block|{
DECL|member|dlg
name|GtkWidget
modifier|*
name|dlg
decl_stmt|;
DECL|member|size_sizeentry
name|GtkWidget
modifier|*
name|size_sizeentry
decl_stmt|;
DECL|member|simple_res
name|GtkWidget
modifier|*
name|simple_res
decl_stmt|;
DECL|member|resolution_sizeentry
name|GtkWidget
modifier|*
name|resolution_sizeentry
decl_stmt|;
DECL|member|change_size
name|GtkWidget
modifier|*
name|change_size
decl_stmt|;
DECL|member|couple_resolutions
name|GtkWidget
modifier|*
name|couple_resolutions
decl_stmt|;
DECL|member|width
name|int
name|width
decl_stmt|;
DECL|member|height
name|int
name|height
decl_stmt|;
DECL|member|unit
name|GUnit
name|unit
decl_stmt|;
DECL|member|xresolution
name|float
name|xresolution
decl_stmt|;
DECL|member|yresolution
name|float
name|yresolution
decl_stmt|;
DECL|member|res_unit
name|GUnit
name|res_unit
decl_stmt|;
DECL|member|type
name|int
name|type
decl_stmt|;
DECL|member|fill_type
name|int
name|fill_type
decl_stmt|;
DECL|typedef|NewImageValues
block|}
name|NewImageValues
typedef|;
end_typedef

begin_comment
comment|/*  new image local functions  */
end_comment

begin_function_decl
specifier|static
name|void
name|file_new_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_cancel_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|file_new_delete_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|GdkEvent
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_toggle_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_resolution_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_advanced_res_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/*  static variables  */
end_comment

begin_decl_stmt
DECL|variable|last_width
specifier|static
name|int
name|last_width
init|=
literal|256
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_height
specifier|static
name|int
name|last_height
init|=
literal|256
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_type
specifier|static
name|int
name|last_type
init|=
name|RGB
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_fill_type
specifier|static
name|int
name|last_fill_type
init|=
name|BACKGROUND_FILL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_xresolution
specifier|static
name|float
name|last_xresolution
init|=
literal|72
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|last_xresolution
comment|/* always in DPI */
end_comment

begin_decl_stmt
DECL|variable|last_yresolution
specifier|static
name|float
name|last_yresolution
init|=
literal|72
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_unit
specifier|static
name|GUnit
name|last_unit
init|=
name|UNIT_INCH
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_res_unit
specifier|static
name|GUnit
name|last_res_unit
init|=
name|UNIT_INCH
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_new_image
specifier|static
name|gboolean
name|last_new_image
init|=
name|TRUE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|new_dialog_run
specifier|static
name|int
name|new_dialog_run
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|TileManager
modifier|*
name|global_buf
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
DECL|function|file_new_ok_callback (GtkWidget * widget,gpointer data)
name|file_new_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|GImage
modifier|*
name|gimage
decl_stmt|;
name|GDisplay
modifier|*
name|gdisplay
decl_stmt|;
name|Layer
modifier|*
name|layer
decl_stmt|;
name|int
name|type
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
comment|/* get the image size in pixels */
name|vals
operator|->
name|width
operator|=
name|gimp_size_entry_get_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|vals
operator|->
name|height
operator|=
name|gimp_size_entry_get_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|/* get the resolution in dpi */
name|vals
operator|->
name|xresolution
operator|=
name|gimp_size_entry_get_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|vals
operator|->
name|yresolution
operator|=
name|gimp_size_entry_get_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
comment|/* get the units */
name|vals
operator|->
name|unit
operator|=
name|gimp_size_entry_get_unit
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|)
expr_stmt|;
name|vals
operator|->
name|res_unit
operator|=
name|gimp_size_entry_get_unit
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|)
expr_stmt|;
name|last_new_image
operator|=
name|TRUE
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
expr_stmt|;
name|last_width
operator|=
name|vals
operator|->
name|width
expr_stmt|;
name|last_height
operator|=
name|vals
operator|->
name|height
expr_stmt|;
name|last_type
operator|=
name|vals
operator|->
name|type
expr_stmt|;
name|last_fill_type
operator|=
name|vals
operator|->
name|fill_type
expr_stmt|;
name|last_xresolution
operator|=
name|vals
operator|->
name|xresolution
expr_stmt|;
name|last_yresolution
operator|=
name|vals
operator|->
name|yresolution
expr_stmt|;
name|last_unit
operator|=
name|vals
operator|->
name|unit
expr_stmt|;
name|last_res_unit
operator|=
name|vals
operator|->
name|res_unit
expr_stmt|;
switch|switch
condition|(
name|vals
operator|->
name|fill_type
condition|)
block|{
case|case
name|BACKGROUND_FILL
case|:
case|case
name|FOREGROUND_FILL
case|:
case|case
name|WHITE_FILL
case|:
name|type
operator|=
operator|(
name|vals
operator|->
name|type
operator|==
name|RGB
operator|)
condition|?
name|RGB_GIMAGE
else|:
name|GRAY_GIMAGE
expr_stmt|;
break|break;
case|case
name|TRANSPARENT_FILL
case|:
name|type
operator|=
operator|(
name|vals
operator|->
name|type
operator|==
name|RGB
operator|)
condition|?
name|RGBA_GIMAGE
else|:
name|GRAYA_GIMAGE
expr_stmt|;
break|break;
default|default:
name|type
operator|=
name|RGB_IMAGE
expr_stmt|;
break|break;
block|}
name|gimage
operator|=
name|gimage_new
argument_list|(
name|vals
operator|->
name|width
argument_list|,
name|vals
operator|->
name|height
argument_list|,
name|vals
operator|->
name|type
argument_list|)
expr_stmt|;
name|gimp_image_set_resolution
argument_list|(
name|gimage
argument_list|,
name|vals
operator|->
name|xresolution
argument_list|,
name|vals
operator|->
name|yresolution
argument_list|)
expr_stmt|;
name|gimp_image_set_unit
argument_list|(
name|gimage
argument_list|,
name|vals
operator|->
name|unit
argument_list|)
expr_stmt|;
comment|/*  Make the background (or first) layer  */
name|layer
operator|=
name|layer_new
argument_list|(
name|gimage
argument_list|,
name|gimage
operator|->
name|width
argument_list|,
name|gimage
operator|->
name|height
argument_list|,
name|type
argument_list|,
name|_
argument_list|(
literal|"Background"
argument_list|)
argument_list|,
name|OPAQUE_OPACITY
argument_list|,
name|NORMAL
argument_list|)
expr_stmt|;
if|if
condition|(
name|layer
condition|)
block|{
comment|/*  add the new layer to the gimage  */
name|gimage_disable_undo
argument_list|(
name|gimage
argument_list|)
expr_stmt|;
name|gimage_add_layer
argument_list|(
name|gimage
argument_list|,
name|layer
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gimage_enable_undo
argument_list|(
name|gimage
argument_list|)
expr_stmt|;
name|drawable_fill
argument_list|(
name|GIMP_DRAWABLE
argument_list|(
name|layer
argument_list|)
argument_list|,
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
name|gimage_clean_all
argument_list|(
name|gimage
argument_list|)
expr_stmt|;
name|gdisplay
operator|=
name|gdisplay_new
argument_list|(
name|gimage
argument_list|,
literal|0x0101
argument_list|)
expr_stmt|;
block|}
name|g_free
argument_list|(
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|file_new_delete_callback (GtkWidget * widget,GdkEvent * event,gpointer data)
name|file_new_delete_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|file_new_cancel_callback
argument_list|(
name|widget
argument_list|,
name|data
argument_list|)
expr_stmt|;
return|return
name|TRUE
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_cancel_callback (GtkWidget * widget,gpointer data)
name|file_new_cancel_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_toggle_callback (GtkWidget * widget,gpointer data)
name|file_new_toggle_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|int
modifier|*
name|val
decl_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
condition|)
block|{
name|val
operator|=
name|data
expr_stmt|;
operator|*
name|val
operator|=
operator|(
name|long
operator|)
name|gtk_object_get_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_advanced_res_callback (GtkWidget * widget,gpointer data)
name|file_new_advanced_res_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|gtk_widget_hide
argument_list|(
name|widget
argument_list|)
expr_stmt|;
name|gtk_widget_hide
argument_list|(
name|vals
operator|->
name|simple_res
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|couple_resolutions
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_resolution_callback (GtkWidget * widget,gpointer data)
name|file_new_resolution_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
specifier|static
name|float
name|xres
init|=
literal|0.0
decl_stmt|;
specifier|static
name|float
name|yres
init|=
literal|0.0
decl_stmt|;
name|float
name|new_xres
decl_stmt|;
name|float
name|new_yres
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|new_xres
operator|=
name|gimp_size_entry_get_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|widget
operator|==
name|vals
operator|->
name|simple_res
condition|)
block|{
if|if
condition|(
name|new_xres
operator|!=
name|xres
condition|)
block|{
name|xres
operator|=
name|new_xres
expr_stmt|;
name|yres
operator|=
name|xres
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|xres
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|yres
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|new_yres
operator|=
name|gimp_size_entry_get_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
if|if
condition|(
name|gimp_chain_button_get_active
argument_list|(
name|GIMP_CHAIN_BUTTON
argument_list|(
name|vals
operator|->
name|couple_resolutions
argument_list|)
argument_list|)
condition|)
block|{
if|if
condition|(
name|new_xres
operator|!=
name|xres
condition|)
block|{
name|yres
operator|=
name|new_yres
operator|=
name|xres
operator|=
name|new_xres
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|yres
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|new_yres
operator|!=
name|yres
condition|)
block|{
name|xres
operator|=
name|new_xres
operator|=
name|yres
operator|=
name|new_yres
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|xres
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
if|if
condition|(
name|new_xres
operator|!=
name|xres
condition|)
name|xres
operator|=
name|new_xres
expr_stmt|;
if|if
condition|(
name|new_yres
operator|!=
name|yres
condition|)
name|yres
operator|=
name|new_yres
expr_stmt|;
block|}
block|}
name|gimp_size_entry_set_resolution
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|xres
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_resolution
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|yres
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|file_new_cmd_callback (GtkWidget * widget,gpointer callback_data,guint callback_action)
name|file_new_cmd_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|callback_data
parameter_list|,
name|guint
name|callback_action
parameter_list|)
block|{
name|GDisplay
modifier|*
name|gdisp
decl_stmt|;
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox2
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|radio_box
decl_stmt|;
name|gboolean
name|advanced_options
init|=
name|FALSE
decl_stmt|;
name|GtkWidget
modifier|*
name|advanced_button
decl_stmt|;
name|GSList
modifier|*
name|group
decl_stmt|;
if|if
condition|(
operator|!
name|new_dialog_run
condition|)
block|{
name|last_width
operator|=
name|default_width
expr_stmt|;
name|last_height
operator|=
name|default_height
expr_stmt|;
name|last_type
operator|=
name|default_type
expr_stmt|;
name|last_xresolution
operator|=
name|default_xresolution
expr_stmt|;
comment|/* these values are taken */
name|last_yresolution
operator|=
name|default_yresolution
expr_stmt|;
comment|/* from gimprc            */
name|last_unit
operator|=
name|default_units
expr_stmt|;
name|last_res_unit
operator|=
name|default_resolution_units
expr_stmt|;
name|new_dialog_run
operator|=
literal|1
expr_stmt|;
block|}
comment|/*  Before we try to determine the responsible gdisplay,    *  make sure this wasn't called from the toolbox    */
if|if
condition|(
name|callback_action
condition|)
name|gdisp
operator|=
name|gdisplay_active
argument_list|()
expr_stmt|;
else|else
name|gdisp
operator|=
name|NULL
expr_stmt|;
name|vals
operator|=
name|g_malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|NewImageValues
argument_list|)
argument_list|)
expr_stmt|;
name|vals
operator|->
name|fill_type
operator|=
name|last_fill_type
expr_stmt|;
if|if
condition|(
name|gdisp
condition|)
block|{
name|vals
operator|->
name|width
operator|=
name|gdisp
operator|->
name|gimage
operator|->
name|width
expr_stmt|;
name|vals
operator|->
name|height
operator|=
name|gdisp
operator|->
name|gimage
operator|->
name|height
expr_stmt|;
name|vals
operator|->
name|type
operator|=
name|gimage_base_type
argument_list|(
name|gdisp
operator|->
name|gimage
argument_list|)
expr_stmt|;
name|vals
operator|->
name|xresolution
operator|=
name|gdisp
operator|->
name|gimage
operator|->
name|xresolution
expr_stmt|;
name|vals
operator|->
name|yresolution
operator|=
name|gdisp
operator|->
name|gimage
operator|->
name|yresolution
expr_stmt|;
name|vals
operator|->
name|unit
operator|=
name|gdisp
operator|->
name|gimage
operator|->
name|unit
expr_stmt|;
name|vals
operator|->
name|res_unit
operator|=
name|UNIT_INCH
expr_stmt|;
block|}
else|else
block|{
name|vals
operator|->
name|width
operator|=
name|last_width
expr_stmt|;
name|vals
operator|->
name|height
operator|=
name|last_height
expr_stmt|;
name|vals
operator|->
name|type
operator|=
name|last_type
expr_stmt|;
name|vals
operator|->
name|xresolution
operator|=
name|last_xresolution
expr_stmt|;
name|vals
operator|->
name|yresolution
operator|=
name|last_yresolution
expr_stmt|;
name|vals
operator|->
name|unit
operator|=
name|last_unit
expr_stmt|;
name|vals
operator|->
name|res_unit
operator|=
name|last_res_unit
expr_stmt|;
block|}
if|if
condition|(
name|vals
operator|->
name|xresolution
operator|!=
name|vals
operator|->
name|yresolution
condition|)
name|advanced_options
operator|=
name|TRUE
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|type
operator|==
name|INDEXED
condition|)
name|vals
operator|->
name|type
operator|=
name|RGB
expr_stmt|;
comment|/* no indexed images */
comment|/* if a cut buffer exist, default to using its size for the new image */
comment|/* also check to see if a new_image has been opened */
if|if
condition|(
name|global_buf
operator|&&
operator|!
name|last_new_image
condition|)
block|{
name|vals
operator|->
name|width
operator|=
name|global_buf
operator|->
name|width
expr_stmt|;
name|vals
operator|->
name|height
operator|=
name|global_buf
operator|->
name|height
expr_stmt|;
comment|/* It would be good to set the resolution here, but that would        * require TileManagers to know about the resolution of tiles        * they're dealing with.  It's not clear we want to go down that        * road. -- austin */
block|}
name|vals
operator|->
name|dlg
operator|=
name|gtk_dialog_new
argument_list|()
expr_stmt|;
name|gtk_window_set_wmclass
argument_list|(
name|GTK_WINDOW
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
literal|"new_image"
argument_list|,
literal|"Gimp"
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"New Image"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_window_set_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_window_set_policy
argument_list|(
name|GTK_WINDOW
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* handle the wm close signal */
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
literal|"delete_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|file_new_delete_callback
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|GTK_DIALOG
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"OK"
argument_list|)
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_ok_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_grab_default
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Cancel"
argument_list|)
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_cancel_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
comment|/* vbox holding the rest of the dialog */
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|vbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|vals
operator|->
name|size_sizeentry
operator|=
name|gimp_size_entry_new
argument_list|(
literal|2
argument_list|,
name|vals
operator|->
name|unit
argument_list|,
literal|"%p"
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|75
argument_list|,
name|GIMP_SIZE_ENTRY_UPDATE_SIZE
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_resolution
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|vals
operator|->
name|xresolution
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_resolution
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|vals
operator|->
name|yresolution
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval_boundaries
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|32767
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval_boundaries
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|32767
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|vals
operator|->
name|width
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|vals
operator|->
name|height
argument_list|)
expr_stmt|;
name|gimp_size_entry_attach_label
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Width"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gimp_size_entry_attach_label
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Height"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gimp_size_entry_attach_label
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Pixels"
argument_list|)
argument_list|,
literal|1
argument_list|,
literal|4
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|vals
operator|->
name|size_sizeentry
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|size_sizeentry
argument_list|)
expr_stmt|;
comment|/* resolution frame */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Resolution"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|vbox2
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox2
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|vbox2
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox2
argument_list|)
expr_stmt|;
name|vals
operator|->
name|simple_res
operator|=
name|gimp_size_entry_new
argument_list|(
literal|1
argument_list|,
name|vals
operator|->
name|res_unit
argument_list|,
literal|"%s"
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|75
argument_list|,
name|GIMP_SIZE_ENTRY_UPDATE_RESOLUTION
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval_boundaries
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|simple_res
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|32767
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|simple_res
argument_list|)
argument_list|,
literal|0
argument_list|,
name|MIN
argument_list|(
name|vals
operator|->
name|xresolution
argument_list|,
name|vals
operator|->
name|yresolution
argument_list|)
argument_list|)
expr_stmt|;
name|gimp_size_entry_attach_label
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|simple_res
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"pixels per "
argument_list|)
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|simple_res
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_resolution_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox2
argument_list|)
argument_list|,
name|vals
operator|->
name|simple_res
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|advanced_options
condition|)
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|simple_res
argument_list|)
expr_stmt|;
comment|/* the advanced resolution stuff      (not shown by default, but used to keep track of all the variables) */
name|vals
operator|->
name|resolution_sizeentry
operator|=
name|gimp_size_entry_new
argument_list|(
literal|2
argument_list|,
name|vals
operator|->
name|res_unit
argument_list|,
literal|"%s"
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|75
argument_list|,
name|GIMP_SIZE_ENTRY_UPDATE_RESOLUTION
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval_boundaries
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|32767
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval_boundaries
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|32767
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|vals
operator|->
name|xresolution
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|vals
operator|->
name|yresolution
argument_list|)
expr_stmt|;
name|gimp_size_entry_attach_label
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Horizontal"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gimp_size_entry_attach_label
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"Vertical"
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gimp_size_entry_attach_label
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"dpi"
argument_list|)
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gimp_size_entry_attach_label
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"pixels per "
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|vals
operator|->
name|couple_resolutions
operator|=
name|gimp_chain_button_new
argument_list|(
name|GIMP_CHAIN_BOTTOM
argument_list|)
expr_stmt|;
name|gimp_chain_button_set_active
argument_list|(
name|GIMP_CHAIN_BUTTON
argument_list|(
name|vals
operator|->
name|couple_resolutions
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_table_attach_defaults
argument_list|(
name|GTK_TABLE
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
name|vals
operator|->
name|couple_resolutions
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|"value_changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_resolution_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
argument_list|,
literal|"refval_changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_resolution_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox2
argument_list|)
argument_list|,
name|vals
operator|->
name|resolution_sizeentry
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
if|if
condition|(
name|advanced_options
condition|)
block|{
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|resolution_sizeentry
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|couple_resolutions
argument_list|)
expr_stmt|;
block|}
comment|/* This code is commented out since it seems to be overkill...    * vals->change_size = gtk_check_button_new_with_label (_("Change image size with resolution changes"));    * gtk_toggle_button_set_active (GTK_TOGGLE_BUTTON (vals->change_size), TRUE);    * gtk_box_pack_start (GTK_BOX (vbox2), vals->change_size, TRUE, TRUE, 0);    * gtk_widget_show (vals->change_size);   */
if|if
condition|(
name|advanced_options
condition|)
name|advanced_button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Advanced options<<"
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|advanced_button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Advanced options>>"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox2
argument_list|)
argument_list|,
name|advanced_button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|advanced_button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_advanced_res_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|advanced_button
argument_list|)
expr_stmt|;
comment|/* hbox containing the Image type and fill type frames */
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|hbox
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
comment|/* frame for Image Type */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Image Type"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
comment|/* radio buttons and box */
name|radio_box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|radio_box
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|radio_box
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|radio_box
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|NULL
argument_list|,
name|_
argument_list|(
literal|"RGB"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|RGB
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|type
operator|==
name|RGB
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Grayscale"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|GRAY
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|type
operator|==
name|GRAY
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
comment|/* frame for fill type */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Fill Type"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|radio_box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|radio_box
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|radio_box
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|radio_box
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|NULL
argument_list|,
name|_
argument_list|(
literal|"Foreground"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|FOREGROUND_FILL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|fill_type
operator|==
name|FOREGROUND_FILL
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Background"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|BACKGROUND_FILL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|fill_type
operator|==
name|BACKGROUND_FILL
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"White"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|WHITE_FILL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|fill_type
operator|==
name|WHITE_FILL
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Transparent"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|TRANSPARENT_FILL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|fill_type
operator|==
name|TRANSPARENT_FILL
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|file_new_reset_current_cut_buffer ()
name|void
name|file_new_reset_current_cut_buffer
parameter_list|()
block|{
comment|/* this function just changes the status of last_image_new      so i can if theres been a cut/copy since the last file new */
name|last_new_image
operator|=
name|FALSE
expr_stmt|;
block|}
end_function

end_unit

