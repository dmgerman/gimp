begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* GIMP - The GNU Image Manipulation Program  * Copyright (C) 1995 Spencer Kimball and Peter Mattis  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<gtk/gtk.h>
end_include

begin_include
include|#
directive|include
file|"libgimpbase/gimpbase.h"
end_include

begin_include
include|#
directive|include
file|"libgimpconfig/gimpconfig.h"
end_include

begin_include
include|#
directive|include
file|"libgimpwidgets/gimpwidgets.h"
end_include

begin_include
include|#
directive|include
file|"tools-types.h"
end_include

begin_include
include|#
directive|include
file|"config/gimpconfig-utils.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpviewable.h"
end_include

begin_include
include|#
directive|include
file|"text/gimptext.h"
end_include

begin_include
include|#
directive|include
file|"widgets/gimpcolorpanel.h"
end_include

begin_include
include|#
directive|include
file|"widgets/gimpdialogfactory.h"
end_include

begin_include
include|#
directive|include
file|"widgets/gimpdock.h"
end_include

begin_include
include|#
directive|include
file|"widgets/gimpmenufactory.h"
end_include

begin_include
include|#
directive|include
file|"widgets/gimppropwidgets.h"
end_include

begin_include
include|#
directive|include
file|"widgets/gimptexteditor.h"
end_include

begin_include
include|#
directive|include
file|"widgets/gimpviewablebox.h"
end_include

begin_include
include|#
directive|include
file|"widgets/gimpwidgets-utils.h"
end_include

begin_include
include|#
directive|include
file|"gimptextoptions.h"
end_include

begin_include
include|#
directive|include
file|"gimptooloptions-gui.h"
end_include

begin_include
include|#
directive|include
file|"gimprectangleoptions.h"
end_include

begin_include
include|#
directive|include
file|"gimp-intl.h"
end_include

begin_enum
enum|enum
DECL|enum|__anon2aa27e360103
block|{
DECL|enumerator|PROP_0
name|PROP_0
init|=
name|GIMP_RECTANGLE_OPTIONS_PROP_LAST
operator|+
literal|1
block|,
DECL|enumerator|PROP_FONT_SIZE
name|PROP_FONT_SIZE
block|,
DECL|enumerator|PROP_UNIT
name|PROP_UNIT
block|,
DECL|enumerator|PROP_HINTING
name|PROP_HINTING
block|,
DECL|enumerator|PROP_AUTOHINT
name|PROP_AUTOHINT
block|,
DECL|enumerator|PROP_ANTIALIAS
name|PROP_ANTIALIAS
block|,
DECL|enumerator|PROP_LANGUAGE
name|PROP_LANGUAGE
block|,
DECL|enumerator|PROP_BASE_DIR
name|PROP_BASE_DIR
block|,
DECL|enumerator|PROP_JUSTIFICATION
name|PROP_JUSTIFICATION
block|,
DECL|enumerator|PROP_INDENTATION
name|PROP_INDENTATION
block|,
DECL|enumerator|PROP_LINE_SPACING
name|PROP_LINE_SPACING
block|,
DECL|enumerator|PROP_LETTER_SPACING
name|PROP_LETTER_SPACING
block|,
DECL|enumerator|PROP_FONT_VIEW_TYPE
name|PROP_FONT_VIEW_TYPE
block|,
DECL|enumerator|PROP_FONT_VIEW_SIZE
name|PROP_FONT_VIEW_SIZE
block|}
enum|;
end_enum

begin_function_decl
specifier|static
name|void
name|gimp_text_options_set_property
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
name|guint
name|property_id
parameter_list|,
specifier|const
name|GValue
modifier|*
name|value
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_text_options_get_property
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
name|guint
name|property_id
parameter_list|,
name|GValue
modifier|*
name|value
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_text_options_notify_font
parameter_list|(
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpText
modifier|*
name|text
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_text_options_notify_text_font
parameter_list|(
name|GimpText
modifier|*
name|text
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_text_options_notify_color
parameter_list|(
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpText
modifier|*
name|text
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_text_options_notify_text_color
parameter_list|(
name|GimpText
modifier|*
name|text
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|)
function_decl|;
end_function_decl

begin_macro
DECL|function|G_DEFINE_TYPE_WITH_CODE (GimpTextOptions,gimp_text_options,GIMP_TYPE_TOOL_OPTIONS,G_IMPLEMENT_INTERFACE (GIMP_TYPE_RECTANGLE_OPTIONS,NULL))
name|G_DEFINE_TYPE_WITH_CODE
argument_list|(
argument|GimpTextOptions
argument_list|,
argument|gimp_text_options
argument_list|,
argument|GIMP_TYPE_TOOL_OPTIONS
argument_list|,
argument|G_IMPLEMENT_INTERFACE (GIMP_TYPE_RECTANGLE_OPTIONS,                                                 NULL)
argument_list|)
end_macro

begin_function
specifier|static
name|void
name|gimp_text_options_class_init
parameter_list|(
name|GimpTextOptionsClass
modifier|*
name|klass
parameter_list|)
block|{
name|GObjectClass
modifier|*
name|object_class
init|=
name|G_OBJECT_CLASS
argument_list|(
name|klass
argument_list|)
decl_stmt|;
name|object_class
operator|->
name|set_property
operator|=
name|gimp_text_options_set_property
expr_stmt|;
name|object_class
operator|->
name|get_property
operator|=
name|gimp_text_options_get_property
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_UNIT
argument_list|(
name|object_class
argument_list|,
name|PROP_UNIT
argument_list|,
literal|"font-size-unit"
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|,
name|FALSE
argument_list|,
name|GIMP_UNIT_PIXEL
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_DOUBLE
argument_list|(
name|object_class
argument_list|,
name|PROP_FONT_SIZE
argument_list|,
literal|"font-size"
argument_list|,
name|NULL
argument_list|,
literal|0.0
argument_list|,
literal|8192.0
argument_list|,
literal|18.0
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_BOOLEAN
argument_list|(
name|object_class
argument_list|,
name|PROP_HINTING
argument_list|,
literal|"hinting"
argument_list|,
name|N_
argument_list|(
literal|"Hinting alters the font outline to "
literal|"produce a crisp bitmap at small "
literal|"sizes"
argument_list|)
argument_list|,
name|TRUE
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_BOOLEAN
argument_list|(
name|object_class
argument_list|,
name|PROP_AUTOHINT
argument_list|,
literal|"autohint"
argument_list|,
name|N_
argument_list|(
literal|"If available, hints from the font are "
literal|"used but you may prefer to always use "
literal|"the automatic hinter"
argument_list|)
argument_list|,
name|FALSE
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_BOOLEAN
argument_list|(
name|object_class
argument_list|,
name|PROP_ANTIALIAS
argument_list|,
literal|"antialias"
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_STRING
argument_list|(
name|object_class
argument_list|,
name|PROP_LANGUAGE
argument_list|,
literal|"language"
argument_list|,
name|NULL
argument_list|,
operator|(
specifier|const
name|gchar
operator|*
operator|)
name|gtk_get_default_language
argument_list|()
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_ENUM
argument_list|(
name|object_class
argument_list|,
name|PROP_BASE_DIR
argument_list|,
literal|"base-direction"
argument_list|,
name|NULL
argument_list|,
name|GIMP_TYPE_TEXT_DIRECTION
argument_list|,
name|GIMP_TEXT_DIRECTION_LTR
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_ENUM
argument_list|(
name|object_class
argument_list|,
name|PROP_JUSTIFICATION
argument_list|,
literal|"justify"
argument_list|,
name|NULL
argument_list|,
name|GIMP_TYPE_TEXT_JUSTIFICATION
argument_list|,
name|GIMP_TEXT_JUSTIFY_LEFT
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_DOUBLE
argument_list|(
name|object_class
argument_list|,
name|PROP_INDENTATION
argument_list|,
literal|"indent"
argument_list|,
name|N_
argument_list|(
literal|"Indentation of the first line"
argument_list|)
argument_list|,
operator|-
literal|8192.0
argument_list|,
literal|8192.0
argument_list|,
literal|0.0
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
operator||
name|GIMP_CONFIG_PARAM_DEFAULTS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_DOUBLE
argument_list|(
name|object_class
argument_list|,
name|PROP_LINE_SPACING
argument_list|,
literal|"line-spacing"
argument_list|,
name|N_
argument_list|(
literal|"Adjust line spacing"
argument_list|)
argument_list|,
operator|-
literal|8192.0
argument_list|,
literal|8192.0
argument_list|,
literal|0.0
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
operator||
name|GIMP_CONFIG_PARAM_DEFAULTS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_DOUBLE
argument_list|(
name|object_class
argument_list|,
name|PROP_LETTER_SPACING
argument_list|,
literal|"letter-spacing"
argument_list|,
name|N_
argument_list|(
literal|"Adjust letter spacing"
argument_list|)
argument_list|,
operator|-
literal|8192.0
argument_list|,
literal|8192.0
argument_list|,
literal|0.0
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
operator||
name|GIMP_CONFIG_PARAM_DEFAULTS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_ENUM
argument_list|(
name|object_class
argument_list|,
name|PROP_FONT_VIEW_TYPE
argument_list|,
literal|"font-view-type"
argument_list|,
name|NULL
argument_list|,
name|GIMP_TYPE_VIEW_TYPE
argument_list|,
name|GIMP_VIEW_TYPE_LIST
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|GIMP_CONFIG_INSTALL_PROP_INT
argument_list|(
name|object_class
argument_list|,
name|PROP_FONT_VIEW_SIZE
argument_list|,
literal|"font-view-size"
argument_list|,
name|NULL
argument_list|,
name|GIMP_VIEW_SIZE_TINY
argument_list|,
name|GIMP_VIEWABLE_MAX_BUTTON_SIZE
argument_list|,
name|GIMP_VIEW_SIZE_SMALL
argument_list|,
name|GIMP_PARAM_STATIC_STRINGS
argument_list|)
expr_stmt|;
name|gimp_rectangle_options_install_properties
argument_list|(
name|object_class
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_init (GimpTextOptions * options)
name|gimp_text_options_init
parameter_list|(
name|GimpTextOptions
modifier|*
name|options
parameter_list|)
block|{
name|options
operator|->
name|size_entry
operator|=
name|NULL
expr_stmt|;
name|options
operator|->
name|to_vectors_button
operator|=
name|NULL
expr_stmt|;
name|options
operator|->
name|along_vectors_button
operator|=
name|NULL
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_get_property (GObject * object,guint property_id,GValue * value,GParamSpec * pspec)
name|gimp_text_options_get_property
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
name|guint
name|property_id
parameter_list|,
name|GValue
modifier|*
name|value
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|)
block|{
name|GimpTextOptions
modifier|*
name|options
init|=
name|GIMP_TEXT_OPTIONS
argument_list|(
name|object
argument_list|)
decl_stmt|;
switch|switch
condition|(
name|property_id
condition|)
block|{
case|case
name|PROP_FONT_SIZE
case|:
name|g_value_set_double
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|font_size
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_UNIT
case|:
name|g_value_set_int
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|unit
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_HINTING
case|:
name|g_value_set_boolean
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|hinting
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_AUTOHINT
case|:
name|g_value_set_boolean
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|autohint
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_ANTIALIAS
case|:
name|g_value_set_boolean
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|antialias
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_LANGUAGE
case|:
name|g_value_set_string
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|language
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_BASE_DIR
case|:
name|g_value_set_enum
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|base_dir
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_JUSTIFICATION
case|:
name|g_value_set_enum
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|justify
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_INDENTATION
case|:
name|g_value_set_double
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|indent
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_LINE_SPACING
case|:
name|g_value_set_double
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|line_spacing
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_LETTER_SPACING
case|:
name|g_value_set_double
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|letter_spacing
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_FONT_VIEW_TYPE
case|:
name|g_value_set_enum
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|font_view_type
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_FONT_VIEW_SIZE
case|:
name|g_value_set_int
argument_list|(
name|value
argument_list|,
name|options
operator|->
name|font_view_size
argument_list|)
expr_stmt|;
break|break;
default|default:
name|gimp_rectangle_options_get_property
argument_list|(
name|object
argument_list|,
name|property_id
argument_list|,
name|value
argument_list|,
name|pspec
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_set_property (GObject * object,guint property_id,const GValue * value,GParamSpec * pspec)
name|gimp_text_options_set_property
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
name|guint
name|property_id
parameter_list|,
specifier|const
name|GValue
modifier|*
name|value
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|)
block|{
name|GimpTextOptions
modifier|*
name|options
init|=
name|GIMP_TEXT_OPTIONS
argument_list|(
name|object
argument_list|)
decl_stmt|;
switch|switch
condition|(
name|property_id
condition|)
block|{
case|case
name|PROP_FONT_SIZE
case|:
name|options
operator|->
name|font_size
operator|=
name|g_value_get_double
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_UNIT
case|:
name|options
operator|->
name|unit
operator|=
name|g_value_get_int
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_HINTING
case|:
name|options
operator|->
name|hinting
operator|=
name|g_value_get_boolean
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_AUTOHINT
case|:
name|options
operator|->
name|autohint
operator|=
name|g_value_get_boolean
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_ANTIALIAS
case|:
name|options
operator|->
name|antialias
operator|=
name|g_value_get_boolean
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_BASE_DIR
case|:
name|options
operator|->
name|base_dir
operator|=
name|g_value_get_enum
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_LANGUAGE
case|:
name|g_free
argument_list|(
name|options
operator|->
name|language
argument_list|)
expr_stmt|;
name|options
operator|->
name|language
operator|=
name|g_value_dup_string
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_JUSTIFICATION
case|:
name|options
operator|->
name|justify
operator|=
name|g_value_get_enum
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_INDENTATION
case|:
name|options
operator|->
name|indent
operator|=
name|g_value_get_double
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_LINE_SPACING
case|:
name|options
operator|->
name|line_spacing
operator|=
name|g_value_get_double
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_LETTER_SPACING
case|:
name|options
operator|->
name|letter_spacing
operator|=
name|g_value_get_double
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_FONT_VIEW_TYPE
case|:
name|options
operator|->
name|font_view_type
operator|=
name|g_value_get_enum
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
case|case
name|PROP_FONT_VIEW_SIZE
case|:
name|options
operator|->
name|font_view_size
operator|=
name|g_value_get_int
argument_list|(
name|value
argument_list|)
expr_stmt|;
break|break;
default|default:
name|gimp_rectangle_options_set_property
argument_list|(
name|object
argument_list|,
name|property_id
argument_list|,
name|value
argument_list|,
name|pspec
argument_list|)
expr_stmt|;
break|break;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_notify_font (GimpContext * context,GParamSpec * pspec,GimpText * text)
name|gimp_text_options_notify_font
parameter_list|(
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpText
modifier|*
name|text
parameter_list|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|text
argument_list|,
name|gimp_text_options_notify_text_font
argument_list|,
name|context
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|text
argument_list|,
literal|"font"
argument_list|,
name|gimp_context_get_font_name
argument_list|(
name|context
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|text
argument_list|,
name|gimp_text_options_notify_text_font
argument_list|,
name|context
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_notify_text_font (GimpText * text,GParamSpec * pspec,GimpContext * context)
name|gimp_text_options_notify_text_font
parameter_list|(
name|GimpText
modifier|*
name|text
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|context
argument_list|,
name|gimp_text_options_notify_font
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|gimp_context_set_font_name
argument_list|(
name|context
argument_list|,
name|text
operator|->
name|font
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|context
argument_list|,
name|gimp_text_options_notify_font
argument_list|,
name|text
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_notify_color (GimpContext * context,GParamSpec * pspec,GimpText * text)
name|gimp_text_options_notify_color
parameter_list|(
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpText
modifier|*
name|text
parameter_list|)
block|{
name|GimpRGB
name|color
decl_stmt|;
name|gimp_context_get_foreground
argument_list|(
name|context
argument_list|,
operator|&
name|color
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|text
argument_list|,
name|gimp_text_options_notify_text_color
argument_list|,
name|context
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|text
argument_list|,
literal|"color"
argument_list|,
operator|&
name|color
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|text
argument_list|,
name|gimp_text_options_notify_text_color
argument_list|,
name|context
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_notify_text_color (GimpText * text,GParamSpec * pspec,GimpContext * context)
name|gimp_text_options_notify_text_color
parameter_list|(
name|GimpText
modifier|*
name|text
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|context
argument_list|,
name|gimp_text_options_notify_color
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|gimp_context_set_foreground
argument_list|(
name|context
argument_list|,
operator|&
name|text
operator|->
name|color
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|context
argument_list|,
name|gimp_text_options_notify_color
argument_list|,
name|text
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*  This function could live in gimptexttool.c also.  *  But it takes some bloat out of that file...  */
end_comment

begin_function
name|void
DECL|function|gimp_text_options_connect_text (GimpTextOptions * options,GimpText * text)
name|gimp_text_options_connect_text
parameter_list|(
name|GimpTextOptions
modifier|*
name|options
parameter_list|,
name|GimpText
modifier|*
name|text
parameter_list|)
block|{
name|GimpContext
modifier|*
name|context
decl_stmt|;
name|GimpRGB
name|color
decl_stmt|;
name|g_return_if_fail
argument_list|(
name|GIMP_IS_TEXT_OPTIONS
argument_list|(
name|options
argument_list|)
argument_list|)
expr_stmt|;
name|g_return_if_fail
argument_list|(
name|GIMP_IS_TEXT
argument_list|(
name|text
argument_list|)
argument_list|)
expr_stmt|;
name|context
operator|=
name|GIMP_CONTEXT
argument_list|(
name|options
argument_list|)
expr_stmt|;
name|gimp_context_get_foreground
argument_list|(
name|context
argument_list|,
operator|&
name|color
argument_list|)
expr_stmt|;
name|gimp_config_sync
argument_list|(
name|G_OBJECT
argument_list|(
name|options
argument_list|)
argument_list|,
name|G_OBJECT
argument_list|(
name|text
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|text
argument_list|,
literal|"color"
argument_list|,
operator|&
name|color
argument_list|,
literal|"font"
argument_list|,
name|gimp_context_get_font_name
argument_list|(
name|context
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_config_connect
argument_list|(
name|G_OBJECT
argument_list|(
name|options
argument_list|)
argument_list|,
name|G_OBJECT
argument_list|(
name|text
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_connect_object
argument_list|(
name|options
argument_list|,
literal|"notify::font"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_text_options_notify_font
argument_list|)
argument_list|,
name|text
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect_object
argument_list|(
name|text
argument_list|,
literal|"notify::font"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_text_options_notify_text_font
argument_list|)
argument_list|,
name|options
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect_object
argument_list|(
name|options
argument_list|,
literal|"notify::foreground"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_text_options_notify_color
argument_list|)
argument_list|,
name|text
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect_object
argument_list|(
name|text
argument_list|,
literal|"notify::color"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_text_options_notify_text_color
argument_list|)
argument_list|,
name|options
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_text_options_gui (GimpToolOptions * tool_options)
name|gimp_text_options_gui
parameter_list|(
name|GimpToolOptions
modifier|*
name|tool_options
parameter_list|)
block|{
name|GObject
modifier|*
name|config
init|=
name|G_OBJECT
argument_list|(
name|tool_options
argument_list|)
decl_stmt|;
name|GimpTextOptions
modifier|*
name|options
init|=
name|GIMP_TEXT_OPTIONS
argument_list|(
name|tool_options
argument_list|)
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
init|=
name|gimp_tool_options_gui
argument_list|(
name|tool_options
argument_list|)
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkWidget
modifier|*
name|auto_button
decl_stmt|;
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|GtkWidget
modifier|*
name|box
decl_stmt|;
name|GtkWidget
modifier|*
name|spinbutton
decl_stmt|;
name|GtkSizeGroup
modifier|*
name|size_group
decl_stmt|;
name|gint
name|row
init|=
literal|0
decl_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|10
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
name|hbox
operator|=
name|gimp_prop_font_box_new
argument_list|(
name|NULL
argument_list|,
name|GIMP_CONTEXT
argument_list|(
name|tool_options
argument_list|)
argument_list|,
literal|2
argument_list|,
literal|"font-view-type"
argument_list|,
literal|"font-view-size"
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
name|row
operator|++
argument_list|,
name|_
argument_list|(
literal|"Font:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|hbox
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|entry
operator|=
name|gimp_prop_size_entry_new
argument_list|(
name|config
argument_list|,
literal|"font-size"
argument_list|,
name|FALSE
argument_list|,
literal|"font-size-unit"
argument_list|,
literal|"%a"
argument_list|,
name|GIMP_SIZE_ENTRY_UPDATE_SIZE
argument_list|,
literal|72.0
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
name|row
operator|++
argument_list|,
name|_
argument_list|(
literal|"Size:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|entry
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|options
operator|->
name|size_entry
operator|=
name|entry
expr_stmt|;
name|button
operator|=
name|gimp_prop_check_button_new
argument_list|(
name|config
argument_list|,
literal|"hinting"
argument_list|,
name|_
argument_list|(
literal|"Hinting"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|button
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
name|row
argument_list|,
name|row
operator|+
literal|1
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|row
operator|++
expr_stmt|;
name|auto_button
operator|=
name|gimp_prop_check_button_new
argument_list|(
name|config
argument_list|,
literal|"autohint"
argument_list|,
name|_
argument_list|(
literal|"Force auto-hinter"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|auto_button
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
name|row
argument_list|,
name|row
operator|+
literal|1
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|auto_button
argument_list|)
expr_stmt|;
name|row
operator|++
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|auto_button
argument_list|,
name|options
operator|->
name|hinting
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"set_sensitive"
argument_list|,
name|auto_button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gimp_prop_check_button_new
argument_list|(
name|config
argument_list|,
literal|"antialias"
argument_list|,
name|_
argument_list|(
literal|"Antialiasing"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|button
argument_list|,
literal|0
argument_list|,
literal|3
argument_list|,
name|row
argument_list|,
name|row
operator|+
literal|1
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|row
operator|++
expr_stmt|;
name|size_group
operator|=
name|gtk_size_group_new
argument_list|(
name|GTK_SIZE_GROUP_HORIZONTAL
argument_list|)
expr_stmt|;
name|button
operator|=
name|gimp_prop_color_button_new
argument_list|(
name|config
argument_list|,
literal|"foreground"
argument_list|,
name|_
argument_list|(
literal|"Text Color"
argument_list|)
argument_list|,
literal|40
argument_list|,
literal|24
argument_list|,
name|GIMP_COLOR_AREA_FLAT
argument_list|)
expr_stmt|;
name|gimp_color_panel_set_context
argument_list|(
name|GIMP_COLOR_PANEL
argument_list|(
name|button
argument_list|)
argument_list|,
name|GIMP_CONTEXT
argument_list|(
name|options
argument_list|)
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
name|row
operator|++
argument_list|,
name|_
argument_list|(
literal|"Color:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|button
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|size_group
argument_list|,
name|button
argument_list|)
expr_stmt|;
name|box
operator|=
name|gimp_prop_enum_stock_box_new
argument_list|(
name|config
argument_list|,
literal|"justify"
argument_list|,
literal|"gtk-justify"
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gimp_table_attach_aligned
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|0
argument_list|,
name|row
operator|++
argument_list|,
name|_
argument_list|(
literal|"Justify:"
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|,
name|box
argument_list|,
literal|2
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_size_group_add_widget
argument_list|(
name|size_group
argument_list|,
name|box
argument_list|)
expr_stmt|;
name|g_object_unref
argument_list|(
name|size_group
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_prop_spin_button_new
argument_list|(
name|config
argument_list|,
literal|"indent"
argument_list|,
literal|1.0
argument_list|,
literal|10.0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_entry_set_width_chars
argument_list|(
name|GTK_ENTRY
argument_list|(
name|spinbutton
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gimp_table_attach_stock
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|row
operator|++
argument_list|,
name|GTK_STOCK_INDENT
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_prop_spin_button_new
argument_list|(
name|config
argument_list|,
literal|"line-spacing"
argument_list|,
literal|1.0
argument_list|,
literal|10.0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_entry_set_width_chars
argument_list|(
name|GTK_ENTRY
argument_list|(
name|spinbutton
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gimp_table_attach_stock
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|row
operator|++
argument_list|,
name|GIMP_STOCK_LINE_SPACING
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_prop_spin_button_new
argument_list|(
name|config
argument_list|,
literal|"letter-spacing"
argument_list|,
literal|1.0
argument_list|,
literal|10.0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_entry_set_width_chars
argument_list|(
name|GTK_ENTRY
argument_list|(
name|spinbutton
argument_list|)
argument_list|,
literal|5
argument_list|)
expr_stmt|;
name|gimp_table_attach_stock
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|row
operator|++
argument_list|,
name|GIMP_STOCK_LETTER_SPACING
argument_list|,
name|spinbutton
argument_list|,
literal|1
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
comment|/*  Create a path from the current text  */
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Path from Text"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_end
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|button
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|options
operator|->
name|to_vectors_button
operator|=
name|button
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Text along Path"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_end
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|button
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|options
operator|->
name|along_vectors_button
operator|=
name|button
expr_stmt|;
return|return
name|vbox
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_editor_dir_changed (GimpTextEditor * editor,GimpTextOptions * options)
name|gimp_text_options_editor_dir_changed
parameter_list|(
name|GimpTextEditor
modifier|*
name|editor
parameter_list|,
name|GimpTextOptions
modifier|*
name|options
parameter_list|)
block|{
name|g_object_set
argument_list|(
name|options
argument_list|,
literal|"base-direction"
argument_list|,
name|editor
operator|->
name|base_dir
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_editor_notify_dir (GimpTextOptions * options,GParamSpec * pspec,GimpTextEditor * editor)
name|gimp_text_options_editor_notify_dir
parameter_list|(
name|GimpTextOptions
modifier|*
name|options
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpTextEditor
modifier|*
name|editor
parameter_list|)
block|{
name|GimpTextDirection
name|dir
decl_stmt|;
name|g_object_get
argument_list|(
name|options
argument_list|,
literal|"base-direction"
argument_list|,
operator|&
name|dir
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_text_editor_set_direction
argument_list|(
name|editor
argument_list|,
name|dir
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_text_options_editor_notify_font (GimpTextOptions * options,GParamSpec * pspec,GimpTextEditor * editor)
name|gimp_text_options_editor_notify_font
parameter_list|(
name|GimpTextOptions
modifier|*
name|options
parameter_list|,
name|GParamSpec
modifier|*
name|pspec
parameter_list|,
name|GimpTextEditor
modifier|*
name|editor
parameter_list|)
block|{
specifier|const
name|gchar
modifier|*
name|font_name
decl_stmt|;
name|font_name
operator|=
name|gimp_context_get_font_name
argument_list|(
name|GIMP_CONTEXT
argument_list|(
name|options
argument_list|)
argument_list|)
expr_stmt|;
name|gimp_text_editor_set_font_name
argument_list|(
name|editor
argument_list|,
name|font_name
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_text_options_editor_new (GtkWindow * parent,GimpTextOptions * options,GimpMenuFactory * menu_factory,const gchar * title)
name|gimp_text_options_editor_new
parameter_list|(
name|GtkWindow
modifier|*
name|parent
parameter_list|,
name|GimpTextOptions
modifier|*
name|options
parameter_list|,
name|GimpMenuFactory
modifier|*
name|menu_factory
parameter_list|,
specifier|const
name|gchar
modifier|*
name|title
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|editor
decl_stmt|;
specifier|const
name|gchar
modifier|*
name|font_name
decl_stmt|;
name|g_return_val_if_fail
argument_list|(
name|GIMP_IS_TEXT_OPTIONS
argument_list|(
name|options
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_return_val_if_fail
argument_list|(
name|GIMP_IS_MENU_FACTORY
argument_list|(
name|menu_factory
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_return_val_if_fail
argument_list|(
name|title
operator|!=
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|editor
operator|=
name|gimp_text_editor_new
argument_list|(
name|title
argument_list|,
name|parent
argument_list|,
name|menu_factory
argument_list|)
expr_stmt|;
name|font_name
operator|=
name|gimp_context_get_font_name
argument_list|(
name|GIMP_CONTEXT
argument_list|(
name|options
argument_list|)
argument_list|)
expr_stmt|;
name|gimp_text_editor_set_direction
argument_list|(
name|GIMP_TEXT_EDITOR
argument_list|(
name|editor
argument_list|)
argument_list|,
name|options
operator|->
name|base_dir
argument_list|)
expr_stmt|;
name|gimp_text_editor_set_font_name
argument_list|(
name|GIMP_TEXT_EDITOR
argument_list|(
name|editor
argument_list|)
argument_list|,
name|font_name
argument_list|)
expr_stmt|;
name|g_signal_connect_object
argument_list|(
name|editor
argument_list|,
literal|"dir-changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_text_options_editor_dir_changed
argument_list|)
argument_list|,
name|options
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect_object
argument_list|(
name|options
argument_list|,
literal|"notify::base-direction"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_text_options_editor_notify_dir
argument_list|)
argument_list|,
name|editor
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_signal_connect_object
argument_list|(
name|options
argument_list|,
literal|"notify::font"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_text_options_editor_notify_font
argument_list|)
argument_list|,
name|editor
argument_list|,
literal|0
argument_list|)
expr_stmt|;
return|return
name|editor
return|;
block|}
end_function

end_unit

