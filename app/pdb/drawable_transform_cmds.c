begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* The GIMP -- an image manipulation program  * Copyright (C) 1995-2003 Spencer Kimball and Peter Mattis  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_comment
comment|/* NOTE: This file is autogenerated by pdbgen.pl. */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<glib-object.h>
end_include

begin_include
include|#
directive|include
file|"libgimpmath/gimpmath.h"
end_include

begin_include
include|#
directive|include
file|"pdb-types.h"
end_include

begin_include
include|#
directive|include
file|"procedural_db.h"
end_include

begin_include
include|#
directive|include
file|"config/gimpcoreconfig.h"
end_include

begin_include
include|#
directive|include
file|"core/gimp-transform-utils.h"
end_include

begin_include
include|#
directive|include
file|"core/gimp.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpdrawable-transform.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpdrawable.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpimage.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpprogress.h"
end_include

begin_include
include|#
directive|include
file|"gimp-intl.h"
end_include

begin_decl_stmt
DECL|variable|drawable_transform_flip_simple_proc
specifier|static
name|ProcRecord
name|drawable_transform_flip_simple_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_flip_proc
specifier|static
name|ProcRecord
name|drawable_transform_flip_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_flip_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_flip_defaults_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_perspective_proc
specifier|static
name|ProcRecord
name|drawable_transform_perspective_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_perspective_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_perspective_defaults_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_rotate_simple_proc
specifier|static
name|ProcRecord
name|drawable_transform_rotate_simple_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_rotate_proc
specifier|static
name|ProcRecord
name|drawable_transform_rotate_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_rotate_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_rotate_defaults_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_scale_proc
specifier|static
name|ProcRecord
name|drawable_transform_scale_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_scale_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_scale_defaults_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_shear_proc
specifier|static
name|ProcRecord
name|drawable_transform_shear_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_shear_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_shear_defaults_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_2d_proc
specifier|static
name|ProcRecord
name|drawable_transform_2d_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_2d_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_2d_defaults_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_matrix_proc
specifier|static
name|ProcRecord
name|drawable_transform_matrix_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_matrix_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_matrix_defaults_proc
decl_stmt|;
end_decl_stmt

begin_function
name|void
DECL|function|register_drawable_transform_procs (Gimp * gimp)
name|register_drawable_transform_procs
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|)
block|{
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_flip_simple_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_flip_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_flip_defaults_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_perspective_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_perspective_defaults_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_rotate_simple_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_rotate_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_rotate_defaults_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_scale_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_scale_defaults_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_shear_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_shear_defaults_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_2d_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_2d_defaults_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_matrix_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|drawable_transform_matrix_defaults_proc
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_flip_simple_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_flip_simple_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gint32
name|flip_type
decl_stmt|;
name|gboolean
name|auto_center
decl_stmt|;
name|gdouble
name|axis
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|flip_type
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|flip_type
operator|<
name|GIMP_ORIENTATION_HORIZONTAL
operator|||
name|flip_type
operator|>
name|GIMP_ORIENTATION_VERTICAL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|auto_center
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|axis
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|success
operator|=
name|gimp_drawable_transform_flip
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
name|flip_type
argument_list|,
name|auto_center
argument_list|,
name|axis
argument_list|,
name|clip_result
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_flip_simple_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_flip_simple_inargs
specifier|static
name|ProcArg
name|drawable_transform_flip_simple_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"flip_type"
block|,
literal|"Type of flip: GIMP_ORIENTATION_HORIZONTAL (0) or GIMP_ORIENTATION_VERTICAL (1)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"auto_center"
block|,
literal|"Whether to automatically position the axis in the selection center"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"axis"
block|,
literal|"coord. of flip axis"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_flip_simple_outargs
specifier|static
name|ProcArg
name|drawable_transform_flip_simple_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The flipped drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_flip_simple_proc
specifier|static
name|ProcRecord
name|drawable_transform_flip_simple_proc
init|=
block|{
literal|"gimp_drawable_transform_flip_simple"
block|,
literal|"Flip the specified drawable either vertically or horizontally."
block|,
literal|"This procedure flips the specified drawable if no selection exists. If a selection exists, the portion of the drawable which lies under the selection is cut from the drawable and made into a floating selection which is then flipped. If auto_center is set to true, the flip is around the selection's center. Otherwise, the coordinate of the axis needs to be specified. The return value is the ID of the flipped drawable. If there was no selection, this will be equal to the drawable ID supplied as input. Otherwise, this will be the newly created and flipped drawable."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|5
block|,
name|drawable_transform_flip_simple_inargs
block|,
literal|1
block|,
name|drawable_transform_flip_simple_outargs
block|,
block|{
block|{
name|drawable_transform_flip_simple_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_flip_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_flip_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gdouble
name|x0
decl_stmt|;
name|gdouble
name|y0
decl_stmt|;
name|gdouble
name|x1
decl_stmt|;
name|gdouble
name|y1
decl_stmt|;
name|gint32
name|transform_direction
decl_stmt|;
name|gint32
name|interpolation
decl_stmt|;
name|gboolean
name|supersample
decl_stmt|;
name|gint32
name|recursion_level
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|x0
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|y0
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|x1
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|y1
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|transform_direction
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|transform_direction
operator|<
name|GIMP_TRANSFORM_FORWARD
operator|||
name|transform_direction
operator|>
name|GIMP_TRANSFORM_BACKWARD
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|interpolation
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|interpolation
operator|<
name|GIMP_INTERPOLATION_NONE
operator|||
name|interpolation
operator|>
name|GIMP_INTERPOLATION_CUBIC
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|supersample
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|recursion_level
operator|=
name|args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|recursion_level
operator|<=
literal|0
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|9
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_transform_matrix_flip_free
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|x0
argument_list|,
name|y0
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Flip..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|transform_direction
argument_list|,
name|interpolation
argument_list|,
name|supersample
argument_list|,
name|recursion_level
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_flip_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_flip_inargs
specifier|static
name|ProcArg
name|drawable_transform_flip_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x0"
block|,
literal|"horz. coord. of one end of axis"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y0"
block|,
literal|"vert. coord. of one end of axis"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x1"
block|,
literal|"horz. coord. of other end of axis"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y1"
block|,
literal|"vert. coord. of other end of axis"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"transform_direction"
block|,
literal|"Direction of Transformation: { GIMP_TRANSFORM_FORWARD (0), GIMP_TRANSFORM_BACKWARD (1) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolation"
block|,
literal|"Type of interpolation: { GIMP_INTERPOLATION_NONE (0), GIMP_INTERPOLATION_LINEAR (1), GIMP_INTERPOLATION_CUBIC (2) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"supersample"
block|,
literal|"Whether to perform supersample"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"recursion_level"
block|,
literal|"Level of recursion (3 is a nice default)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_flip_outargs
specifier|static
name|ProcArg
name|drawable_transform_flip_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The flipped drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_flip_proc
specifier|static
name|ProcRecord
name|drawable_transform_flip_proc
init|=
block|{
literal|"gimp_drawable_transform_flip"
block|,
literal|"Flip the specified drawable around a given line."
block|,
literal|"This procedure flips the specified drawable if no selection exists. If a selection exists, the portion of the drawable which lies under the selection is cut from the drawable and made into a floating selection which is then flipped. The axis to flip around is specified by specifying two points from that line. The return value is the ID of the flipped drawable. If there was no selection, this will be equal to the drawable ID supplied as input. Otherwise, this will be the newly created and flipped drawable. The clip results parameter specifies wheter current selection will affect the transform."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|10
block|,
name|drawable_transform_flip_inargs
block|,
literal|1
block|,
name|drawable_transform_flip_outargs
block|,
block|{
block|{
name|drawable_transform_flip_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_flip_defaults_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_flip_defaults_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gdouble
name|x0
decl_stmt|;
name|gdouble
name|y0
decl_stmt|;
name|gdouble
name|x1
decl_stmt|;
name|gdouble
name|y1
decl_stmt|;
name|gboolean
name|interpolate
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|x0
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|y0
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|x1
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|y1
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|interpolate
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_transform_matrix_flip_free
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|x0
argument_list|,
name|y0
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolate
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Flip..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|interpolate
argument_list|,
literal|3
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_flip_defaults_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_flip_defaults_inargs
specifier|static
name|ProcArg
name|drawable_transform_flip_defaults_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x0"
block|,
literal|"horz. coord. of one end of axis"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y0"
block|,
literal|"vert. coord. of one end of axis"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x1"
block|,
literal|"horz. coord. of other end of axis"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y1"
block|,
literal|"vert. coord. of other end of axis"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolate"
block|,
literal|"Whether to use interpolation and supersampling"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_flip_defaults_outargs
specifier|static
name|ProcArg
name|drawable_transform_flip_defaults_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The flipped drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_flip_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_flip_defaults_proc
init|=
block|{
literal|"gimp_drawable_transform_flip_defaults"
block|,
literal|"Flip the specified drawable around a given line."
block|,
literal|"This procedure is a variant of gimp_drawable_transform_flip() which uses no interpolation/supersampling at all, or default values (depending on the 'interpolate' parameter)."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|7
block|,
name|drawable_transform_flip_defaults_inargs
block|,
literal|1
block|,
name|drawable_transform_flip_defaults_outargs
block|,
block|{
block|{
name|drawable_transform_flip_defaults_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_perspective_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_perspective_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gint32
name|transform_direction
decl_stmt|;
name|gint32
name|interpolation
decl_stmt|;
name|gboolean
name|supersample
decl_stmt|;
name|gint32
name|recursion_level
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|gdouble
name|trans_info
index|[
literal|8
index|]
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|trans_info
index|[
name|X0
index|]
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y0
index|]
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|X1
index|]
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y1
index|]
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|X2
index|]
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y2
index|]
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|X3
index|]
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y3
index|]
operator|=
name|args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|transform_direction
operator|=
name|args
index|[
literal|9
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|transform_direction
operator|<
name|GIMP_TRANSFORM_FORWARD
operator|||
name|transform_direction
operator|>
name|GIMP_TRANSFORM_BACKWARD
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|interpolation
operator|=
name|args
index|[
literal|10
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|interpolation
operator|<
name|GIMP_INTERPOLATION_NONE
operator|||
name|interpolation
operator|>
name|GIMP_INTERPOLATION_CUBIC
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|supersample
operator|=
name|args
index|[
literal|11
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|recursion_level
operator|=
name|args
index|[
literal|12
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|recursion_level
operator|<=
literal|0
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|13
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_transform_matrix_perspective
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|trans_info
index|[
name|X0
index|]
argument_list|,
name|trans_info
index|[
name|Y0
index|]
argument_list|,
name|trans_info
index|[
name|X1
index|]
argument_list|,
name|trans_info
index|[
name|Y1
index|]
argument_list|,
name|trans_info
index|[
name|X2
index|]
argument_list|,
name|trans_info
index|[
name|Y2
index|]
argument_list|,
name|trans_info
index|[
name|X3
index|]
argument_list|,
name|trans_info
index|[
name|Y3
index|]
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Perspective..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|transform_direction
argument_list|,
name|interpolation
argument_list|,
name|supersample
argument_list|,
name|recursion_level
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_perspective_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_perspective_inargs
specifier|static
name|ProcArg
name|drawable_transform_perspective_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x0"
block|,
literal|"The new x coordinate of upper-left corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y0"
block|,
literal|"The new y coordinate of upper-left corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x1"
block|,
literal|"The new x coordinate of upper-right corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y1"
block|,
literal|"The new y coordinate of upper-right corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x2"
block|,
literal|"The new x coordinate of lower-left corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y2"
block|,
literal|"The new y coordinate of lower-left corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x3"
block|,
literal|"The new x coordinate of lower-right corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y3"
block|,
literal|"The new y coordinate of lower-right corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"transform_direction"
block|,
literal|"Direction of Transformation: { GIMP_TRANSFORM_FORWARD (0), GIMP_TRANSFORM_BACKWARD (1) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolation"
block|,
literal|"Type of interpolation: { GIMP_INTERPOLATION_NONE (0), GIMP_INTERPOLATION_LINEAR (1), GIMP_INTERPOLATION_CUBIC (2) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"supersample"
block|,
literal|"Whether to perform supersample"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"recursion_level"
block|,
literal|"Level of recursion (3 is a nice default)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_perspective_outargs
specifier|static
name|ProcArg
name|drawable_transform_perspective_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The newly mapped drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_perspective_proc
specifier|static
name|ProcRecord
name|drawable_transform_perspective_proc
init|=
block|{
literal|"gimp_drawable_transform_perspective"
block|,
literal|"Perform a possibly non-affine transformation on the specified drawable, with extra parameters."
block|,
literal|"This procedure performs a possibly non-affine transformation on the specified drawable by allowing the corners of the original bounding box to be arbitrarily remapped to any values. The specified drawable is remapped if no selection exists. However, if a selection exists, the portion of the drawable which lies under the selection is cut from the drawable and made into a floating selection which is then remapped as specified. The return value is the ID of the remapped drawable. If there was no selection, this will be equal to the drawable ID supplied as input. Otherwise, this will be the newly created and remapped drawable. The 4 coordinates specify the new locations of each corner of the original bounding box. By specifying these values, any affine transformation (rotation, scaling, translation) can be affected. Additionally, these values can be specified such that the resulting transformed drawable will appear to have been projected via a perspective transform."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|14
block|,
name|drawable_transform_perspective_inargs
block|,
literal|1
block|,
name|drawable_transform_perspective_outargs
block|,
block|{
block|{
name|drawable_transform_perspective_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_perspective_defaults_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_perspective_defaults_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gboolean
name|interpolate
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|gdouble
name|trans_info
index|[
literal|8
index|]
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|trans_info
index|[
name|X0
index|]
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y0
index|]
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|X1
index|]
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y1
index|]
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|X2
index|]
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y2
index|]
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|X3
index|]
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y3
index|]
operator|=
name|args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|interpolate
operator|=
name|args
index|[
literal|9
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|10
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_transform_matrix_perspective
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|trans_info
index|[
name|X0
index|]
argument_list|,
name|trans_info
index|[
name|Y0
index|]
argument_list|,
name|trans_info
index|[
name|X1
index|]
argument_list|,
name|trans_info
index|[
name|Y1
index|]
argument_list|,
name|trans_info
index|[
name|X2
index|]
argument_list|,
name|trans_info
index|[
name|Y2
index|]
argument_list|,
name|trans_info
index|[
name|X3
index|]
argument_list|,
name|trans_info
index|[
name|Y3
index|]
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolate
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Perspective..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|interpolate
argument_list|,
literal|3
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_perspective_defaults_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_perspective_defaults_inargs
specifier|static
name|ProcArg
name|drawable_transform_perspective_defaults_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x0"
block|,
literal|"The new x coordinate of upper-left corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y0"
block|,
literal|"The new y coordinate of upper-left corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x1"
block|,
literal|"The new x coordinate of upper-right corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y1"
block|,
literal|"The new y coordinate of upper-right corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x2"
block|,
literal|"The new x coordinate of lower-left corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y2"
block|,
literal|"The new y coordinate of lower-left corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x3"
block|,
literal|"The new x coordinate of lower-right corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y3"
block|,
literal|"The new y coordinate of lower-right corner of original bounding box"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolate"
block|,
literal|"Whether to use interpolation and supersampling"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_perspective_defaults_outargs
specifier|static
name|ProcArg
name|drawable_transform_perspective_defaults_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The newly mapped drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_perspective_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_perspective_defaults_proc
init|=
block|{
literal|"gimp_drawable_transform_perspective_defaults"
block|,
literal|"Perform a possibly non-affine transformation on the specified drawable, with extra parameters."
block|,
literal|"This procedure is a variant of gimp_drawable_transform_perspective() which uses no interpolation/supersampling at all, or default values (depending on the 'interpolate' parameter)."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|11
block|,
name|drawable_transform_perspective_defaults_inargs
block|,
literal|1
block|,
name|drawable_transform_perspective_defaults_outargs
block|,
block|{
block|{
name|drawable_transform_perspective_defaults_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_rotate_simple_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_rotate_simple_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gint32
name|rotate_type
decl_stmt|;
name|gboolean
name|auto_center
decl_stmt|;
name|gint32
name|center_x
decl_stmt|;
name|gint32
name|center_y
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|rotate_type
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|rotate_type
operator|<
name|GIMP_ROTATE_90
operator|||
name|rotate_type
operator|>
name|GIMP_ROTATE_270
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|auto_center
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|center_x
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
name|center_y
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|success
operator|=
name|gimp_drawable_transform_rotate
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
name|rotate_type
argument_list|,
name|auto_center
argument_list|,
name|center_x
argument_list|,
name|center_y
argument_list|,
name|clip_result
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_rotate_simple_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_rotate_simple_inargs
specifier|static
name|ProcArg
name|drawable_transform_rotate_simple_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"rotate_type"
block|,
literal|"Type of rotation: GIMP_ROTATE_90 (0), GIMP_ROTATE_180 (1), GIMP_ROTATE_270 (2)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"auto_center"
block|,
literal|"Whether to automatically rotate around the selection center"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"center_x"
block|,
literal|"The hor. coordinate of the center of rotation"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"center_y"
block|,
literal|"The vert. coordinate of the center of rotation"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_rotate_simple_outargs
specifier|static
name|ProcArg
name|drawable_transform_rotate_simple_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The rotated drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_rotate_simple_proc
specifier|static
name|ProcRecord
name|drawable_transform_rotate_simple_proc
init|=
block|{
literal|"gimp_drawable_transform_rotate_simple"
block|,
literal|"Rotate the specified drawable about given coordinates through the specified angle."
block|,
literal|"This function rotates the specified drawable if no selection exists. If a selection exists, the portion of the drawable which lies under the selection is cut from the drawable and made into a floating selection which is then rotated by the specified amount. The return value is the ID of the rotated drawable. If there was no selection, this will be equal to the drawable ID supplied as input. Otherwise, this will be the newly created and rotated drawable."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|6
block|,
name|drawable_transform_rotate_simple_inargs
block|,
literal|1
block|,
name|drawable_transform_rotate_simple_outargs
block|,
block|{
block|{
name|drawable_transform_rotate_simple_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_rotate_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_rotate_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gdouble
name|angle
decl_stmt|;
name|gboolean
name|auto_center
decl_stmt|;
name|gint32
name|center_x
decl_stmt|;
name|gint32
name|center_y
decl_stmt|;
name|gint32
name|transform_direction
decl_stmt|;
name|gint32
name|interpolation
decl_stmt|;
name|gboolean
name|supersample
decl_stmt|;
name|gint32
name|recursion_level
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|angle
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|auto_center
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|center_x
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
name|center_y
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
name|transform_direction
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|transform_direction
operator|<
name|GIMP_TRANSFORM_FORWARD
operator|||
name|transform_direction
operator|>
name|GIMP_TRANSFORM_BACKWARD
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|interpolation
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|interpolation
operator|<
name|GIMP_INTERPOLATION_NONE
operator|||
name|interpolation
operator|>
name|GIMP_INTERPOLATION_CUBIC
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|supersample
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|recursion_level
operator|=
name|args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|recursion_level
operator|<=
literal|0
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|9
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
comment|/* Assemble the transformation matrix */
if|if
condition|(
name|auto_center
condition|)
name|gimp_transform_matrix_rotate
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|angle
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
else|else
name|gimp_transform_matrix_rotate_center
argument_list|(
name|center_x
argument_list|,
name|center_y
argument_list|,
name|angle
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Rotating..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|transform_direction
argument_list|,
name|interpolation
argument_list|,
name|supersample
argument_list|,
name|recursion_level
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_rotate_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_rotate_inargs
specifier|static
name|ProcArg
name|drawable_transform_rotate_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"angle"
block|,
literal|"The angle of rotation (radians)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"auto_center"
block|,
literal|"Whether to automatically rotate around the selection center"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"center_x"
block|,
literal|"The hor. coordinate of the center of rotation"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"center_y"
block|,
literal|"The vert. coordinate of the center of rotation"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"transform_direction"
block|,
literal|"Direction of Transformation: { GIMP_TRANSFORM_FORWARD (0), GIMP_TRANSFORM_BACKWARD (1) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolation"
block|,
literal|"Type of interpolation: { GIMP_INTERPOLATION_NONE (0), GIMP_INTERPOLATION_LINEAR (1), GIMP_INTERPOLATION_CUBIC (2) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"supersample"
block|,
literal|"Whether to perform supersample"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"recursion_level"
block|,
literal|"Level of recursion (3 is a nice default)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_rotate_outargs
specifier|static
name|ProcArg
name|drawable_transform_rotate_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The rotated drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_rotate_proc
specifier|static
name|ProcRecord
name|drawable_transform_rotate_proc
init|=
block|{
literal|"gimp_drawable_transform_rotate"
block|,
literal|"Rotate the specified drawable about given coordinates through the specified angle."
block|,
literal|"This function rotates the specified drawable if no selection exists. If a selection exists, the portion of the drawable which lies under the selection is cut from the drawable and made into a floating selection which is then rotated by the specified amount. The return value is the ID of the rotated drawable. If there was no selection, this will be equal to the drawable ID supplied as input. Otherwise, this will be the newly created and rotated drawable."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|10
block|,
name|drawable_transform_rotate_inargs
block|,
literal|1
block|,
name|drawable_transform_rotate_outargs
block|,
block|{
block|{
name|drawable_transform_rotate_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_rotate_defaults_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_rotate_defaults_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gdouble
name|angle
decl_stmt|;
name|gboolean
name|auto_center
decl_stmt|;
name|gint32
name|center_x
decl_stmt|;
name|gint32
name|center_y
decl_stmt|;
name|gboolean
name|interpolate
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|angle
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|auto_center
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|center_x
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
name|center_y
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
name|interpolate
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
if|if
condition|(
name|auto_center
condition|)
name|gimp_transform_matrix_rotate
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|angle
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
else|else
name|gimp_transform_matrix_rotate_center
argument_list|(
name|center_x
argument_list|,
name|center_y
argument_list|,
name|angle
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolate
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Rotating..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|interpolate
argument_list|,
literal|3
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_rotate_defaults_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_rotate_defaults_inargs
specifier|static
name|ProcArg
name|drawable_transform_rotate_defaults_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"angle"
block|,
literal|"The angle of rotation (radians)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"auto_center"
block|,
literal|"Whether to automatically rotate around the selection center"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"center_x"
block|,
literal|"The hor. coordinate of the center of rotation"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"center_y"
block|,
literal|"The vert. coordinate of the center of rotation"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolate"
block|,
literal|"Whether to use interpolation and supersampling"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_rotate_defaults_outargs
specifier|static
name|ProcArg
name|drawable_transform_rotate_defaults_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The rotated drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_rotate_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_rotate_defaults_proc
init|=
block|{
literal|"gimp_drawable_transform_rotate_defaults"
block|,
literal|"Rotate the specified drawable about given coordinates through the specified angle."
block|,
literal|"This procedure is a variant of gimp_drawable_transform_rotate() which uses no interpolation/supersampling at all, or default values (depending on the 'interpolate' parameter)."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|7
block|,
name|drawable_transform_rotate_defaults_inargs
block|,
literal|1
block|,
name|drawable_transform_rotate_defaults_outargs
block|,
block|{
block|{
name|drawable_transform_rotate_defaults_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_scale_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_scale_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gint32
name|transform_direction
decl_stmt|;
name|gint32
name|interpolation
decl_stmt|;
name|gboolean
name|supersample
decl_stmt|;
name|gint32
name|recursion_level
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|gdouble
name|trans_info
index|[
literal|4
index|]
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|trans_info
index|[
name|X0
index|]
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y0
index|]
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|X1
index|]
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y1
index|]
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|transform_direction
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|transform_direction
operator|<
name|GIMP_TRANSFORM_FORWARD
operator|||
name|transform_direction
operator|>
name|GIMP_TRANSFORM_BACKWARD
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|interpolation
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|interpolation
operator|<
name|GIMP_INTERPOLATION_NONE
operator|||
name|interpolation
operator|>
name|GIMP_INTERPOLATION_CUBIC
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|supersample
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|recursion_level
operator|=
name|args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|recursion_level
operator|<=
literal|0
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|9
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
operator|(
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|&&
name|trans_info
index|[
name|X0
index|]
operator|<
name|trans_info
index|[
name|X1
index|]
operator|&&
name|trans_info
index|[
name|Y0
index|]
operator|<
name|trans_info
index|[
name|X1
index|]
operator|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_transform_matrix_scale
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|trans_info
index|[
name|X0
index|]
argument_list|,
name|trans_info
index|[
name|Y0
index|]
argument_list|,
name|trans_info
index|[
name|X1
index|]
operator|-
name|trans_info
index|[
name|X0
index|]
argument_list|,
name|trans_info
index|[
name|Y1
index|]
operator|-
name|trans_info
index|[
name|Y0
index|]
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Scaling..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|transform_direction
argument_list|,
name|interpolation
argument_list|,
name|supersample
argument_list|,
name|recursion_level
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_scale_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_scale_inargs
specifier|static
name|ProcArg
name|drawable_transform_scale_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x0"
block|,
literal|"The new x coordinate of upper-left corner of newly scaled region"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y0"
block|,
literal|"The new y coordinate of upper-left corner of newly scaled region"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x1"
block|,
literal|"The new x coordinate of lower-right corner of newly scaled region"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y1"
block|,
literal|"The new y coordinate of lower-right corner of newly scaled region"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"transform_direction"
block|,
literal|"Direction of Transformation: { GIMP_TRANSFORM_FORWARD (0), GIMP_TRANSFORM_BACKWARD (1) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolation"
block|,
literal|"Type of interpolation: { GIMP_INTERPOLATION_NONE (0), GIMP_INTERPOLATION_LINEAR (1), GIMP_INTERPOLATION_CUBIC (2) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"supersample"
block|,
literal|"Whether to perform supersample"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"recursion_level"
block|,
literal|"Level of recursion (3 is a nice default)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_scale_outargs
specifier|static
name|ProcArg
name|drawable_transform_scale_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The scaled drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_scale_proc
specifier|static
name|ProcRecord
name|drawable_transform_scale_proc
init|=
block|{
literal|"gimp_drawable_transform_scale"
block|,
literal|"Scale the specified drawable with extra parameters"
block|,
literal|"This procedure scales the specified drawable if no selection exists. If a selection exists, the portion of the drawable which lies under the selection is cut from the drawable and made into a floating selection which is then scaled by the specified amount. The return value is the ID of the scaled drawable. If there was no selection, this will be equal to the drawable ID supplied as input. Otherwise, this will be the newly created and scaled drawable."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|10
block|,
name|drawable_transform_scale_inargs
block|,
literal|1
block|,
name|drawable_transform_scale_outargs
block|,
block|{
block|{
name|drawable_transform_scale_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_scale_defaults_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_scale_defaults_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gboolean
name|interpolate
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|gdouble
name|trans_info
index|[
literal|4
index|]
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|trans_info
index|[
name|X0
index|]
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y0
index|]
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|X1
index|]
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|trans_info
index|[
name|Y1
index|]
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|interpolate
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
operator|(
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|&&
name|trans_info
index|[
name|X0
index|]
operator|<
name|trans_info
index|[
name|X1
index|]
operator|&&
name|trans_info
index|[
name|Y0
index|]
operator|<
name|trans_info
index|[
name|X1
index|]
operator|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_transform_matrix_scale
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|trans_info
index|[
name|X0
index|]
argument_list|,
name|trans_info
index|[
name|Y0
index|]
argument_list|,
name|trans_info
index|[
name|X1
index|]
operator|-
name|trans_info
index|[
name|X0
index|]
argument_list|,
name|trans_info
index|[
name|Y1
index|]
operator|-
name|trans_info
index|[
name|Y0
index|]
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolate
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Scaling..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|interpolate
argument_list|,
literal|3
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_scale_defaults_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_scale_defaults_inargs
specifier|static
name|ProcArg
name|drawable_transform_scale_defaults_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x0"
block|,
literal|"The new x coordinate of upper-left corner of newly scaled region"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y0"
block|,
literal|"The new y coordinate of upper-left corner of newly scaled region"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"x1"
block|,
literal|"The new x coordinate of lower-right corner of newly scaled region"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"y1"
block|,
literal|"The new y coordinate of lower-right corner of newly scaled region"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolate"
block|,
literal|"Whether to use interpolation and supersampling"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_scale_defaults_outargs
specifier|static
name|ProcArg
name|drawable_transform_scale_defaults_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The scaled drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_scale_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_scale_defaults_proc
init|=
block|{
literal|"gimp_drawable_transform_scale_defaults"
block|,
literal|"Scale the specified drawable with extra parameters"
block|,
literal|"This procedure is a variant of gimp_drawable_transform_scale() which uses no interpolation/supersampling at all, or default values (depending on the 'interpolate' parameter)."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|7
block|,
name|drawable_transform_scale_defaults_inargs
block|,
literal|1
block|,
name|drawable_transform_scale_defaults_outargs
block|,
block|{
block|{
name|drawable_transform_scale_defaults_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_shear_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_shear_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gint32
name|shear_type
decl_stmt|;
name|gdouble
name|magnitude
decl_stmt|;
name|gint32
name|transform_direction
decl_stmt|;
name|gint32
name|interpolation
decl_stmt|;
name|gboolean
name|supersample
decl_stmt|;
name|gint32
name|recursion_level
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|shear_type
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|shear_type
operator|<
name|GIMP_ORIENTATION_HORIZONTAL
operator|||
name|shear_type
operator|>
name|GIMP_ORIENTATION_VERTICAL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|magnitude
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|transform_direction
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|transform_direction
operator|<
name|GIMP_TRANSFORM_FORWARD
operator|||
name|transform_direction
operator|>
name|GIMP_TRANSFORM_BACKWARD
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|interpolation
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|interpolation
operator|<
name|GIMP_INTERPOLATION_NONE
operator|||
name|interpolation
operator|>
name|GIMP_INTERPOLATION_CUBIC
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|supersample
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|recursion_level
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|recursion_level
operator|<=
literal|0
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_transform_matrix_shear
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|shear_type
argument_list|,
name|magnitude
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Shearing..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|transform_direction
argument_list|,
name|interpolation
argument_list|,
name|supersample
argument_list|,
name|recursion_level
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_shear_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_shear_inargs
specifier|static
name|ProcArg
name|drawable_transform_shear_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"shear_type"
block|,
literal|"Type of shear: GIMP_ORIENTATION_HORIZONTAL (0) or GIMP_ORIENTATION_VERTICAL (1)"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"magnitude"
block|,
literal|"The magnitude of the shear"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"transform_direction"
block|,
literal|"Direction of Transformation: { GIMP_TRANSFORM_FORWARD (0), GIMP_TRANSFORM_BACKWARD (1) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolation"
block|,
literal|"Type of interpolation: { GIMP_INTERPOLATION_NONE (0), GIMP_INTERPOLATION_LINEAR (1), GIMP_INTERPOLATION_CUBIC (2) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"supersample"
block|,
literal|"Whether to perform supersample"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"recursion_level"
block|,
literal|"Level of recursion (3 is a nice default)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_shear_outargs
specifier|static
name|ProcArg
name|drawable_transform_shear_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The sheared drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_shear_proc
specifier|static
name|ProcRecord
name|drawable_transform_shear_proc
init|=
block|{
literal|"gimp_drawable_transform_shear"
block|,
literal|"Shear the specified drawable about its center by the specified magnitude, with extra parameters."
block|,
literal|"This procedure shears the specified drawable if no selection exists. If a selection exists, the portion of the drawable which lies under the selection is cut from the drawable and made into a floating selection which is then sheard by the specified amount. The return value is the ID of the sheard drawable. If there was no selection, this will be equal to the drawable ID supplied as input. Otherwise, this will be the newly created and sheard drawable. The shear type parameter indicates whether the shear will be applied horizontally or vertically. The magnitude can be either positive or negative and indicates the extent (in pixels) to shear by."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|8
block|,
name|drawable_transform_shear_inargs
block|,
literal|1
block|,
name|drawable_transform_shear_outargs
block|,
block|{
block|{
name|drawable_transform_shear_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_shear_defaults_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_shear_defaults_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gint32
name|shear_type
decl_stmt|;
name|gdouble
name|magnitude
decl_stmt|;
name|gboolean
name|interpolate
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|shear_type
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|shear_type
operator|<
name|GIMP_ORIENTATION_HORIZONTAL
operator|||
name|shear_type
operator|>
name|GIMP_ORIENTATION_VERTICAL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|magnitude
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|interpolate
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_transform_matrix_shear
argument_list|(
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|shear_type
argument_list|,
name|magnitude
argument_list|,
operator|&
name|matrix
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolate
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Shearing..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|interpolate
argument_list|,
literal|3
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_shear_defaults_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_shear_defaults_inargs
specifier|static
name|ProcArg
name|drawable_transform_shear_defaults_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"shear_type"
block|,
literal|"Type of shear: GIMP_ORIENTATION_HORIZONTAL (0) or GIMP_ORIENTATION_VERTICAL (1)"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"magnitude"
block|,
literal|"The magnitude of the shear"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolate"
block|,
literal|"Whether to use interpolation and supersampling"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_shear_defaults_outargs
specifier|static
name|ProcArg
name|drawable_transform_shear_defaults_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The sheared drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_shear_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_shear_defaults_proc
init|=
block|{
literal|"gimp_drawable_transform_shear_defaults"
block|,
literal|"Shear the specified drawable about its center by the specified magnitude, with extra parameters."
block|,
literal|"This procedure is a variant of gimp_drawable_transform_shear() which uses no interpolation/supersampling at all, or default values (depending on the 'interpolate' parameter)."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|5
block|,
name|drawable_transform_shear_defaults_inargs
block|,
literal|1
block|,
name|drawable_transform_shear_defaults_outargs
block|,
block|{
block|{
name|drawable_transform_shear_defaults_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_2d_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_2d_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gdouble
name|source_x
decl_stmt|;
name|gdouble
name|source_y
decl_stmt|;
name|gdouble
name|scale_x
decl_stmt|;
name|gdouble
name|scale_y
decl_stmt|;
name|gdouble
name|angle
decl_stmt|;
name|gdouble
name|dest_x
decl_stmt|;
name|gdouble
name|dest_y
decl_stmt|;
name|gint32
name|transform_direction
decl_stmt|;
name|gint32
name|interpolation
decl_stmt|;
name|gboolean
name|supersample
decl_stmt|;
name|gint32
name|recursion_level
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|source_x
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|source_y
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|scale_x
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|scale_y
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|angle
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|dest_x
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|dest_y
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|transform_direction
operator|=
name|args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|transform_direction
operator|<
name|GIMP_TRANSFORM_FORWARD
operator|||
name|transform_direction
operator|>
name|GIMP_TRANSFORM_BACKWARD
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|interpolation
operator|=
name|args
index|[
literal|9
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|interpolation
operator|<
name|GIMP_INTERPOLATION_NONE
operator|||
name|interpolation
operator|>
name|GIMP_INTERPOLATION_CUBIC
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|supersample
operator|=
name|args
index|[
literal|10
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|recursion_level
operator|=
name|args
index|[
literal|11
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|recursion_level
operator|<=
literal|0
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|12
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_matrix3_identity
argument_list|(
operator|&
name|matrix
argument_list|)
expr_stmt|;
name|gimp_matrix3_translate
argument_list|(
operator|&
name|matrix
argument_list|,
operator|-
name|source_x
argument_list|,
operator|-
name|source_y
argument_list|)
expr_stmt|;
name|gimp_matrix3_scale
argument_list|(
operator|&
name|matrix
argument_list|,
name|scale_x
argument_list|,
name|scale_y
argument_list|)
expr_stmt|;
name|gimp_matrix3_rotate
argument_list|(
operator|&
name|matrix
argument_list|,
name|angle
argument_list|)
expr_stmt|;
name|gimp_matrix3_translate
argument_list|(
operator|&
name|matrix
argument_list|,
name|dest_x
argument_list|,
name|dest_y
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"2D Transform..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|transform_direction
argument_list|,
name|interpolation
argument_list|,
name|supersample
argument_list|,
name|recursion_level
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_2d_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_2d_inargs
specifier|static
name|ProcArg
name|drawable_transform_2d_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"source_x"
block|,
literal|"X coordinate of the transformation center"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"source_y"
block|,
literal|"Y coordinate of the transformation center"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"scale_x"
block|,
literal|"Amount to scale in x direction"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"scale_y"
block|,
literal|"Amount to scale in y direction"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"angle"
block|,
literal|"The angle of rotation (radians)"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"dest_x"
block|,
literal|"X coordinate of where the center goes"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"dest_y"
block|,
literal|"Y coordinate of where the center goes"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"transform_direction"
block|,
literal|"Direction of Transformation: { GIMP_TRANSFORM_FORWARD (0), GIMP_TRANSFORM_BACKWARD (1) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolation"
block|,
literal|"Type of interpolation: { GIMP_INTERPOLATION_NONE (0), GIMP_INTERPOLATION_LINEAR (1), GIMP_INTERPOLATION_CUBIC (2) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"supersample"
block|,
literal|"Whether to perform supersample"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"recursion_level"
block|,
literal|"Level of recursion (3 is a nice default)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_2d_outargs
specifier|static
name|ProcArg
name|drawable_transform_2d_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The transformed drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_2d_proc
specifier|static
name|ProcRecord
name|drawable_transform_2d_proc
init|=
block|{
literal|"gimp_drawable_transform_2d"
block|,
literal|"Transform the specified drawable in 2d, with extra parameters."
block|,
literal|"This procedure transforms the specified drawable if no selection exists. If a selection exists, the portion of the drawable which lies under the selection is cut from the drawable and made into a floating selection which is then transformed. The transformation is done by scaling the image by the x and y scale factors about the point (source_x, source_y), then rotating around the same point, then translating that point to the new position (dest_x, dest_y). The return value is the ID of the rotated drawable. If there was no selection, this will be equal to the drawable ID supplied as input. Otherwise, this will be the newly created and transformed drawable."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|13
block|,
name|drawable_transform_2d_inargs
block|,
literal|1
block|,
name|drawable_transform_2d_outargs
block|,
block|{
block|{
name|drawable_transform_2d_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_2d_defaults_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_2d_defaults_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gdouble
name|source_x
decl_stmt|;
name|gdouble
name|source_y
decl_stmt|;
name|gdouble
name|scale_x
decl_stmt|;
name|gdouble
name|scale_y
decl_stmt|;
name|gdouble
name|angle
decl_stmt|;
name|gdouble
name|dest_x
decl_stmt|;
name|gdouble
name|dest_y
decl_stmt|;
name|gboolean
name|interpolate
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|source_x
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|source_y
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|scale_x
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|scale_y
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|angle
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|dest_x
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|dest_y
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|interpolate
operator|=
name|args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|9
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_matrix3_identity
argument_list|(
operator|&
name|matrix
argument_list|)
expr_stmt|;
name|gimp_matrix3_translate
argument_list|(
operator|&
name|matrix
argument_list|,
operator|-
name|source_x
argument_list|,
operator|-
name|source_y
argument_list|)
expr_stmt|;
name|gimp_matrix3_scale
argument_list|(
operator|&
name|matrix
argument_list|,
name|scale_x
argument_list|,
name|scale_y
argument_list|)
expr_stmt|;
name|gimp_matrix3_rotate
argument_list|(
operator|&
name|matrix
argument_list|,
name|angle
argument_list|)
expr_stmt|;
name|gimp_matrix3_translate
argument_list|(
operator|&
name|matrix
argument_list|,
name|dest_x
argument_list|,
name|dest_y
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolate
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"2D Transform..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|interpolate
argument_list|,
literal|3
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_2d_defaults_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_2d_defaults_inargs
specifier|static
name|ProcArg
name|drawable_transform_2d_defaults_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"source_x"
block|,
literal|"X coordinate of the transformation center"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"source_y"
block|,
literal|"Y coordinate of the transformation center"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"scale_x"
block|,
literal|"Amount to scale in x direction"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"scale_y"
block|,
literal|"Amount to scale in y direction"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"angle"
block|,
literal|"The angle of rotation (radians)"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"dest_x"
block|,
literal|"X coordinate of where the center goes"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"dest_y"
block|,
literal|"Y coordinate of where the center goes"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolate"
block|,
literal|"Whether to use interpolation and supersampling"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_2d_defaults_outargs
specifier|static
name|ProcArg
name|drawable_transform_2d_defaults_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The transformed drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_2d_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_2d_defaults_proc
init|=
block|{
literal|"gimp_drawable_transform_2d_defaults"
block|,
literal|"Transform the specified drawable in 2d, with extra parameters."
block|,
literal|"This procedure is a variant of gimp_drawable_transform_2d() which uses no interpolation/supersampling at all, or default values (depending on the 'interpolate' parameter)."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|10
block|,
name|drawable_transform_2d_defaults_inargs
block|,
literal|1
block|,
name|drawable_transform_2d_defaults_outargs
block|,
block|{
block|{
name|drawable_transform_2d_defaults_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_matrix_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_matrix_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gdouble
name|coeff_0_0
decl_stmt|;
name|gdouble
name|coeff_0_1
decl_stmt|;
name|gdouble
name|coeff_0_2
decl_stmt|;
name|gdouble
name|coeff_1_0
decl_stmt|;
name|gdouble
name|coeff_1_1
decl_stmt|;
name|gdouble
name|coeff_1_2
decl_stmt|;
name|gdouble
name|coeff_2_0
decl_stmt|;
name|gdouble
name|coeff_2_1
decl_stmt|;
name|gdouble
name|coeff_2_2
decl_stmt|;
name|gint32
name|transform_direction
decl_stmt|;
name|gint32
name|interpolation
decl_stmt|;
name|gboolean
name|supersample
decl_stmt|;
name|gint32
name|recursion_level
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|coeff_0_0
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_0_1
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_0_2
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_1_0
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_1_1
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_1_2
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_2_0
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_2_1
operator|=
name|args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_2_2
operator|=
name|args
index|[
literal|9
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|transform_direction
operator|=
name|args
index|[
literal|10
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|transform_direction
operator|<
name|GIMP_TRANSFORM_FORWARD
operator|||
name|transform_direction
operator|>
name|GIMP_TRANSFORM_BACKWARD
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|interpolation
operator|=
name|args
index|[
literal|11
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|interpolation
operator|<
name|GIMP_INTERPOLATION_NONE
operator|||
name|interpolation
operator|>
name|GIMP_INTERPOLATION_CUBIC
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|supersample
operator|=
name|args
index|[
literal|12
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|recursion_level
operator|=
name|args
index|[
literal|13
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|recursion_level
operator|<=
literal|0
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|14
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|matrix
operator|.
name|coeff
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|coeff_0_0
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|coeff_0_1
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|0
index|]
index|[
literal|2
index|]
operator|=
name|coeff_0_2
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|coeff_1_0
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|coeff_1_1
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|1
index|]
index|[
literal|2
index|]
operator|=
name|coeff_1_2
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|2
index|]
index|[
literal|0
index|]
operator|=
name|coeff_2_0
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|2
index|]
index|[
literal|1
index|]
operator|=
name|coeff_2_1
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|2
index|]
index|[
literal|2
index|]
operator|=
name|coeff_2_2
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"2D Transform..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|transform_direction
argument_list|,
name|interpolation
argument_list|,
name|supersample
argument_list|,
name|recursion_level
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_matrix_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_matrix_inargs
specifier|static
name|ProcArg
name|drawable_transform_matrix_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_0_0"
block|,
literal|"coefficient (0,0) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_0_1"
block|,
literal|"coefficient (0,1) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_0_2"
block|,
literal|"coefficient (0,2) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_1_0"
block|,
literal|"coefficient (1,0) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_1_1"
block|,
literal|"coefficient (1,1) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_1_2"
block|,
literal|"coefficient (1,2) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_2_0"
block|,
literal|"coefficient (2,0) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_2_1"
block|,
literal|"coefficient (2,1) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_2_2"
block|,
literal|"coefficient (2,2) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"transform_direction"
block|,
literal|"Direction of Transformation: { GIMP_TRANSFORM_FORWARD (0), GIMP_TRANSFORM_BACKWARD (1) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolation"
block|,
literal|"Type of interpolation: { GIMP_INTERPOLATION_NONE (0), GIMP_INTERPOLATION_LINEAR (1), GIMP_INTERPOLATION_CUBIC (2) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"supersample"
block|,
literal|"Whether to perform supersample"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"recursion_level"
block|,
literal|"Level of recursion (3 is a nice default)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_matrix_outargs
specifier|static
name|ProcArg
name|drawable_transform_matrix_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The transformed drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_matrix_proc
specifier|static
name|ProcRecord
name|drawable_transform_matrix_proc
init|=
block|{
literal|"gimp_drawable_transform_matrix"
block|,
literal|"Transform the specified drawable in 2d, with extra parameters."
block|,
literal|"This procedure transforms the specified drawable if no selection exists. If a selection exists, the portion of the drawable which lies under the selection is cut from the drawable and made into a floating selection which is then transformed. The transformation is done by assembling a 3x3 matrix from the coefficients passed. The return value is the ID of the rotated drawable. If there was no selection, this will be equal to the drawable ID supplied as input. Otherwise, this will be the newly created and transformed drawable."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|15
block|,
name|drawable_transform_matrix_inargs
block|,
literal|1
block|,
name|drawable_transform_matrix_outargs
block|,
block|{
block|{
name|drawable_transform_matrix_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|drawable_transform_matrix_defaults_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|drawable_transform_matrix_defaults_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gdouble
name|coeff_0_0
decl_stmt|;
name|gdouble
name|coeff_0_1
decl_stmt|;
name|gdouble
name|coeff_0_2
decl_stmt|;
name|gdouble
name|coeff_1_0
decl_stmt|;
name|gdouble
name|coeff_1_1
decl_stmt|;
name|gdouble
name|coeff_1_2
decl_stmt|;
name|gdouble
name|coeff_2_0
decl_stmt|;
name|gdouble
name|coeff_2_1
decl_stmt|;
name|gdouble
name|coeff_2_2
decl_stmt|;
name|gboolean
name|interpolate
decl_stmt|;
name|gboolean
name|clip_result
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_item_get_by_ID
argument_list|(
name|gimp
argument_list|,
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
operator|(
name|GIMP_IS_DRAWABLE
argument_list|(
name|drawable
argument_list|)
operator|&&
operator|!
name|gimp_item_is_removed
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|coeff_0_0
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_0_1
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_0_2
operator|=
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_1_0
operator|=
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_1_1
operator|=
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_1_2
operator|=
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_2_0
operator|=
name|args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_2_1
operator|=
name|args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|coeff_2_2
operator|=
name|args
index|[
literal|9
index|]
operator|.
name|value
operator|.
name|pdb_float
expr_stmt|;
name|interpolate
operator|=
name|args
index|[
literal|10
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
name|clip_result
operator|=
name|args
index|[
literal|11
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|matrix
operator|.
name|coeff
index|[
literal|0
index|]
index|[
literal|0
index|]
operator|=
name|coeff_0_0
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|0
index|]
index|[
literal|1
index|]
operator|=
name|coeff_0_1
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|0
index|]
index|[
literal|2
index|]
operator|=
name|coeff_0_2
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|1
index|]
index|[
literal|0
index|]
operator|=
name|coeff_1_0
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|1
index|]
index|[
literal|1
index|]
operator|=
name|coeff_1_1
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|1
index|]
index|[
literal|2
index|]
operator|=
name|coeff_1_2
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|2
index|]
index|[
literal|0
index|]
operator|=
name|coeff_2_0
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|2
index|]
index|[
literal|1
index|]
operator|=
name|coeff_2_1
expr_stmt|;
name|matrix
operator|.
name|coeff
index|[
literal|2
index|]
index|[
literal|2
index|]
operator|=
name|coeff_2_2
expr_stmt|;
if|if
condition|(
name|interpolate
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"2D Transform..."
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|interpolate
argument_list|,
literal|3
argument_list|,
name|clip_result
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|drawable_transform_matrix_defaults_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|gimp_item_get_ID
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|drawable_transform_matrix_defaults_inargs
specifier|static
name|ProcArg
name|drawable_transform_matrix_defaults_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The affected drawable"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_0_0"
block|,
literal|"coefficient (0,0) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_0_1"
block|,
literal|"coefficient (0,1) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_0_2"
block|,
literal|"coefficient (0,2) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_1_0"
block|,
literal|"coefficient (1,0) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_1_1"
block|,
literal|"coefficient (1,1) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_1_2"
block|,
literal|"coefficient (1,2) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_2_0"
block|,
literal|"coefficient (2,0) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_2_1"
block|,
literal|"coefficient (2,1) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_FLOAT
block|,
literal|"coeff_2_2"
block|,
literal|"coefficient (2,2) of the transformation matrix"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"interpolate"
block|,
literal|"Whether to use interpolation and supersampling"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"clip_result"
block|,
literal|"Whether to clip results"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_matrix_defaults_outargs
specifier|static
name|ProcArg
name|drawable_transform_matrix_defaults_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_DRAWABLE
block|,
literal|"drawable"
block|,
literal|"The transformed drawable"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|drawable_transform_matrix_defaults_proc
specifier|static
name|ProcRecord
name|drawable_transform_matrix_defaults_proc
init|=
block|{
literal|"gimp_drawable_transform_matrix_defaults"
block|,
literal|"Transform the specified drawable in 2d, with extra parameters."
block|,
literal|"This procedure is a variant of gimp_drawable_transform_matrix() which uses no interpolation/supersampling at all, or default values (depending on the 'interpolate' parameter)."
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"JoÃ£o S. O. Bueno Calligaris"
block|,
literal|"2004"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|12
block|,
name|drawable_transform_matrix_defaults_inargs
block|,
literal|1
block|,
name|drawable_transform_matrix_defaults_outargs
block|,
block|{
block|{
name|drawable_transform_matrix_defaults_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

end_unit

