begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* The GIMP -- an image manipulation program  * Copyright (C) 1995-2003 Spencer Kimball and Peter Mattis  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_comment
comment|/* NOTE: This file is autogenerated by pdbgen.pl. */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<glib-object.h>
end_include

begin_include
include|#
directive|include
file|"libgimpmath/gimpmath.h"
end_include

begin_include
include|#
directive|include
file|"pdb-types.h"
end_include

begin_include
include|#
directive|include
file|"procedural_db.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpparamspecs.h"
end_include

begin_include
include|#
directive|include
file|"config/gimpcoreconfig.h"
end_include

begin_include
include|#
directive|include
file|"core/gimp-transform-utils.h"
end_include

begin_include
include|#
directive|include
file|"core/gimp.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpdrawable-transform.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpdrawable.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpimage.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpprogress.h"
end_include

begin_include
include|#
directive|include
file|"gimp-intl.h"
end_include

begin_decl_stmt
DECL|variable|flip_proc
specifier|static
name|ProcRecord
name|flip_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|perspective_proc
specifier|static
name|ProcRecord
name|perspective_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|rotate_proc
specifier|static
name|ProcRecord
name|rotate_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|scale_proc
specifier|static
name|ProcRecord
name|scale_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|shear_proc
specifier|static
name|ProcRecord
name|shear_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|transform_2d_proc
specifier|static
name|ProcRecord
name|transform_2d_proc
decl_stmt|;
end_decl_stmt

begin_function
name|void
DECL|function|register_transform_tools_procs (Gimp * gimp)
name|register_transform_tools_procs
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|)
block|{
name|ProcRecord
modifier|*
name|procedure
decl_stmt|;
comment|/*    * flip    */
name|procedure
operator|=
name|procedural_db_init_proc
argument_list|(
operator|&
name|flip_proc
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The affected drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_INT32
argument_list|,
name|gimp_param_spec_enum
argument_list|(
literal|"flip-type"
argument_list|,
literal|"flip type"
argument_list|,
literal|"Type of flip: { GIMP_ORIENTATION_HORIZONTAL (0), GIMP_ORIENTATION_VERTICAL (1) }"
argument_list|,
name|GIMP_TYPE_ORIENTATION_TYPE
argument_list|,
name|GIMP_ORIENTATION_HORIZONTAL
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|gimp_param_spec_enum_exclude_value
argument_list|(
name|GIMP_PARAM_SPEC_ENUM
argument_list|(
name|procedure
operator|->
name|args
index|[
literal|1
index|]
operator|.
name|pspec
argument_list|)
argument_list|,
name|GIMP_ORIENTATION_UNKNOWN
argument_list|)
expr_stmt|;
name|procedural_db_add_return_value
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The flipped drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
name|procedure
argument_list|)
expr_stmt|;
comment|/*    * perspective    */
name|procedure
operator|=
name|procedural_db_init_proc
argument_list|(
operator|&
name|perspective_proc
argument_list|,
literal|10
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The affected drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_INT32
argument_list|,
name|g_param_spec_boolean
argument_list|(
literal|"interpolation"
argument_list|,
literal|"interpolation"
argument_list|,
literal|"Whether to use interpolation"
argument_list|,
name|FALSE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"x0"
argument_list|,
literal|"x0"
argument_list|,
literal|"The new x coordinate of upper-left corner of original bounding box"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"y0"
argument_list|,
literal|"y0"
argument_list|,
literal|"The new y coordinate of upper-left corner of original bounding box"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"x1"
argument_list|,
literal|"x1"
argument_list|,
literal|"The new x coordinate of upper-right corner of original bounding box"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"y1"
argument_list|,
literal|"y1"
argument_list|,
literal|"The new y coordinate of upper-right corner of original bounding box"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"x2"
argument_list|,
literal|"x2"
argument_list|,
literal|"The new x coordinate of lower-left corner of original bounding box"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"y2"
argument_list|,
literal|"y2"
argument_list|,
literal|"The new y coordinate of lower-left corner of original bounding box"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"x3"
argument_list|,
literal|"x3"
argument_list|,
literal|"The new x coordinate of lower-right corner of original bounding box"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"y3"
argument_list|,
literal|"y3"
argument_list|,
literal|"The new y coordinate of lower-right corner of original bounding box"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_return_value
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The newly mapped drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
name|procedure
argument_list|)
expr_stmt|;
comment|/*    * rotate    */
name|procedure
operator|=
name|procedural_db_init_proc
argument_list|(
operator|&
name|rotate_proc
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The affected drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_INT32
argument_list|,
name|g_param_spec_boolean
argument_list|(
literal|"interpolation"
argument_list|,
literal|"interpolation"
argument_list|,
literal|"Whether to use interpolation"
argument_list|,
name|FALSE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"angle"
argument_list|,
literal|"angle"
argument_list|,
literal|"The angle of rotation (radians)"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_return_value
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The rotated drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
name|procedure
argument_list|)
expr_stmt|;
comment|/*    * scale    */
name|procedure
operator|=
name|procedural_db_init_proc
argument_list|(
operator|&
name|scale_proc
argument_list|,
literal|6
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The affected drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_INT32
argument_list|,
name|g_param_spec_boolean
argument_list|(
literal|"interpolation"
argument_list|,
literal|"interpolation"
argument_list|,
literal|"Whether to use interpolation"
argument_list|,
name|FALSE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"x0"
argument_list|,
literal|"x0"
argument_list|,
literal|"The new x coordinate of the upper-left corner of the scaled region"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"y0"
argument_list|,
literal|"y0"
argument_list|,
literal|"The new y coordinate of the upper-left corner of the scaled region"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"x1"
argument_list|,
literal|"x1"
argument_list|,
literal|"The new x coordinate of the lower-right corner of the scaled region"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"y1"
argument_list|,
literal|"y1"
argument_list|,
literal|"The new y coordinate of the lower-right corner of the scaled region"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_return_value
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The scaled drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
name|procedure
argument_list|)
expr_stmt|;
comment|/*    * shear    */
name|procedure
operator|=
name|procedural_db_init_proc
argument_list|(
operator|&
name|shear_proc
argument_list|,
literal|4
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The affected drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_INT32
argument_list|,
name|g_param_spec_boolean
argument_list|(
literal|"interpolation"
argument_list|,
literal|"interpolation"
argument_list|,
literal|"Whether to use interpolation"
argument_list|,
name|FALSE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_INT32
argument_list|,
name|gimp_param_spec_enum
argument_list|(
literal|"shear-type"
argument_list|,
literal|"shear type"
argument_list|,
literal|"Type of shear: { GIMP_ORIENTATION_HORIZONTAL (0), GIMP_ORIENTATION_VERTICAL (1) }"
argument_list|,
name|GIMP_TYPE_ORIENTATION_TYPE
argument_list|,
name|GIMP_ORIENTATION_HORIZONTAL
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|gimp_param_spec_enum_exclude_value
argument_list|(
name|GIMP_PARAM_SPEC_ENUM
argument_list|(
name|procedure
operator|->
name|args
index|[
literal|2
index|]
operator|.
name|pspec
argument_list|)
argument_list|,
name|GIMP_ORIENTATION_UNKNOWN
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"magnitude"
argument_list|,
literal|"magnitude"
argument_list|,
literal|"The magnitude of the shear"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_return_value
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The sheared drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
name|procedure
argument_list|)
expr_stmt|;
comment|/*    * transform_2d    */
name|procedure
operator|=
name|procedural_db_init_proc
argument_list|(
operator|&
name|transform_2d_proc
argument_list|,
literal|9
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The affected drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_INT32
argument_list|,
name|g_param_spec_boolean
argument_list|(
literal|"interpolation"
argument_list|,
literal|"interpolation"
argument_list|,
literal|"Whether to use interpolation"
argument_list|,
name|FALSE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"source-x"
argument_list|,
literal|"source x"
argument_list|,
literal|"X coordinate of the transformation center"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"source-y"
argument_list|,
literal|"source y"
argument_list|,
literal|"Y coordinate of the transformation center"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"scale-x"
argument_list|,
literal|"scale x"
argument_list|,
literal|"Amount to scale in x direction"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"scale-y"
argument_list|,
literal|"scale y"
argument_list|,
literal|"Amount to scale in y direction"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"angle"
argument_list|,
literal|"angle"
argument_list|,
literal|"The angle of rotation (radians)"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"dest-x"
argument_list|,
literal|"dest x"
argument_list|,
literal|"X coordinate of where the centre goes"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_argument
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_FLOAT
argument_list|,
name|g_param_spec_double
argument_list|(
literal|"dest-y"
argument_list|,
literal|"dest y"
argument_list|,
literal|"Y coordinate of where the centre goes"
argument_list|,
operator|-
name|G_MAXDOUBLE
argument_list|,
name|G_MAXDOUBLE
argument_list|,
literal|0
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_add_return_value
argument_list|(
name|procedure
argument_list|,
name|GIMP_PDB_DRAWABLE
argument_list|,
name|gimp_param_spec_item_id
argument_list|(
literal|"drawable"
argument_list|,
literal|"drawable"
argument_list|,
literal|"The transformed drawable"
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|,
name|GIMP_PARAM_READWRITE
argument_list|)
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
name|procedure
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|flip_invoker (ProcRecord * proc_record,Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|flip_invoker
parameter_list|(
name|ProcRecord
modifier|*
name|proc_record
parameter_list|,
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_vals
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gint32
name|flip_type
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_value_get_item
argument_list|(
operator|&
name|args
index|[
literal|0
index|]
operator|.
name|value
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|)
expr_stmt|;
name|flip_type
operator|=
name|g_value_get_enum
argument_list|(
operator|&
name|args
index|[
literal|1
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|success
operator|=
name|gimp_drawable_transform_flip
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
name|flip_type
argument_list|,
name|TRUE
argument_list|,
literal|0.0
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
block|}
block|}
name|return_vals
operator|=
name|procedural_db_return_values
argument_list|(
name|proc_record
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|gimp_value_set_item
argument_list|(
operator|&
name|return_vals
index|[
literal|1
index|]
operator|.
name|value
argument_list|,
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_vals
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|flip_proc
specifier|static
name|ProcRecord
name|flip_proc
init|=
block|{
literal|"gimp-flip"
block|,
literal|"gimp-flip"
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-flip-simple' instead."
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-flip-simple' instead."
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|"gimp-drawable-transform-flip-simple"
block|,
name|GIMP_INTERNAL
block|,
literal|0
block|,
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|flip_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|perspective_invoker (ProcRecord * proc_record,Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|perspective_invoker
parameter_list|(
name|ProcRecord
modifier|*
name|proc_record
parameter_list|,
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_vals
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gboolean
name|interpolation
decl_stmt|;
name|gdouble
name|x0
decl_stmt|;
name|gdouble
name|y0
decl_stmt|;
name|gdouble
name|x1
decl_stmt|;
name|gdouble
name|y1
decl_stmt|;
name|gdouble
name|x2
decl_stmt|;
name|gdouble
name|y2
decl_stmt|;
name|gdouble
name|x3
decl_stmt|;
name|gdouble
name|y3
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_value_get_item
argument_list|(
operator|&
name|args
index|[
literal|0
index|]
operator|.
name|value
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|)
expr_stmt|;
name|interpolation
operator|=
name|g_value_get_boolean
argument_list|(
operator|&
name|args
index|[
literal|1
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|x0
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|2
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|y0
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|3
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|x1
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|4
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|y1
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|5
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|x2
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|6
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|y2
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|7
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|x3
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|8
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|y3
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|9
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_matrix3_identity
argument_list|(
operator|&
name|matrix
argument_list|)
expr_stmt|;
name|gimp_transform_matrix_perspective
argument_list|(
operator|&
name|matrix
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|x0
argument_list|,
name|y0
argument_list|,
name|x1
argument_list|,
name|y1
argument_list|,
name|x2
argument_list|,
name|y2
argument_list|,
name|x3
argument_list|,
name|y3
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolation
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Perspective"
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Perspective the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|TRUE
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_vals
operator|=
name|procedural_db_return_values
argument_list|(
name|proc_record
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|gimp_value_set_item
argument_list|(
operator|&
name|return_vals
index|[
literal|1
index|]
operator|.
name|value
argument_list|,
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_vals
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|perspective_proc
specifier|static
name|ProcRecord
name|perspective_proc
init|=
block|{
literal|"gimp-perspective"
block|,
literal|"gimp-perspective"
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-perspective-default' instead."
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-perspective-default' instead."
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|"gimp-drawable-transform-perspective-default"
block|,
name|GIMP_INTERNAL
block|,
literal|0
block|,
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|perspective_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|rotate_invoker (ProcRecord * proc_record,Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|rotate_invoker
parameter_list|(
name|ProcRecord
modifier|*
name|proc_record
parameter_list|,
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_vals
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gboolean
name|interpolation
decl_stmt|;
name|gdouble
name|angle
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_value_get_item
argument_list|(
operator|&
name|args
index|[
literal|0
index|]
operator|.
name|value
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|)
expr_stmt|;
name|interpolation
operator|=
name|g_value_get_boolean
argument_list|(
operator|&
name|args
index|[
literal|1
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|angle
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|2
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_matrix3_identity
argument_list|(
operator|&
name|matrix
argument_list|)
expr_stmt|;
name|gimp_transform_matrix_rotate_rect
argument_list|(
operator|&
name|matrix
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|angle
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolation
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Rotating"
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Rotate the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|FALSE
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_vals
operator|=
name|procedural_db_return_values
argument_list|(
name|proc_record
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|gimp_value_set_item
argument_list|(
operator|&
name|return_vals
index|[
literal|1
index|]
operator|.
name|value
argument_list|,
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_vals
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|rotate_proc
specifier|static
name|ProcRecord
name|rotate_proc
init|=
block|{
literal|"gimp-rotate"
block|,
literal|"gimp-rotate"
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-rotate-default' instead."
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-rotate-default' instead."
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|"gimp-drawable-transform-rotate-default"
block|,
name|GIMP_INTERNAL
block|,
literal|0
block|,
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|rotate_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|scale_invoker (ProcRecord * proc_record,Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|scale_invoker
parameter_list|(
name|ProcRecord
modifier|*
name|proc_record
parameter_list|,
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_vals
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gboolean
name|interpolation
decl_stmt|;
name|gdouble
name|x0
decl_stmt|;
name|gdouble
name|y0
decl_stmt|;
name|gdouble
name|x1
decl_stmt|;
name|gdouble
name|y1
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_value_get_item
argument_list|(
operator|&
name|args
index|[
literal|0
index|]
operator|.
name|value
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|)
expr_stmt|;
name|interpolation
operator|=
name|g_value_get_boolean
argument_list|(
operator|&
name|args
index|[
literal|1
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|x0
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|2
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|y0
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|3
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|x1
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|4
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|y1
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|5
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
operator|(
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
operator|&&
name|x0
operator|<
name|x1
operator|&&
name|y0
operator|<
name|y1
operator|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_matrix3_identity
argument_list|(
operator|&
name|matrix
argument_list|)
expr_stmt|;
name|gimp_transform_matrix_scale
argument_list|(
operator|&
name|matrix
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|x0
argument_list|,
name|y0
argument_list|,
name|x1
operator|-
name|x0
argument_list|,
name|y1
operator|-
name|y0
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolation
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Scaling"
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Scale the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|TRUE
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_vals
operator|=
name|procedural_db_return_values
argument_list|(
name|proc_record
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|gimp_value_set_item
argument_list|(
operator|&
name|return_vals
index|[
literal|1
index|]
operator|.
name|value
argument_list|,
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_vals
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|scale_proc
specifier|static
name|ProcRecord
name|scale_proc
init|=
block|{
literal|"gimp-scale"
block|,
literal|"gimp-scale"
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-scale-default' instead."
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-scale-default' instead."
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|"gimp-drawable-transform-scale-default"
block|,
name|GIMP_INTERNAL
block|,
literal|0
block|,
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|scale_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|shear_invoker (ProcRecord * proc_record,Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|shear_invoker
parameter_list|(
name|ProcRecord
modifier|*
name|proc_record
parameter_list|,
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_vals
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gboolean
name|interpolation
decl_stmt|;
name|gint32
name|shear_type
decl_stmt|;
name|gdouble
name|magnitude
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_value_get_item
argument_list|(
operator|&
name|args
index|[
literal|0
index|]
operator|.
name|value
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|)
expr_stmt|;
name|interpolation
operator|=
name|g_value_get_boolean
argument_list|(
operator|&
name|args
index|[
literal|1
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|shear_type
operator|=
name|g_value_get_enum
argument_list|(
operator|&
name|args
index|[
literal|2
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|magnitude
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|3
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_matrix3_identity
argument_list|(
operator|&
name|matrix
argument_list|)
expr_stmt|;
name|gimp_transform_matrix_shear
argument_list|(
operator|&
name|matrix
argument_list|,
name|x
argument_list|,
name|y
argument_list|,
name|width
argument_list|,
name|height
argument_list|,
name|shear_type
argument_list|,
name|magnitude
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolation
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"Shearing"
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Shear the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|FALSE
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_vals
operator|=
name|procedural_db_return_values
argument_list|(
name|proc_record
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|gimp_value_set_item
argument_list|(
operator|&
name|return_vals
index|[
literal|1
index|]
operator|.
name|value
argument_list|,
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_vals
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|shear_proc
specifier|static
name|ProcRecord
name|shear_proc
init|=
block|{
literal|"gimp-shear"
block|,
literal|"gimp-shear"
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-shear-default' instead."
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-shear-default' instead."
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|"gimp-drawable-transform-shear-default"
block|,
name|GIMP_INTERNAL
block|,
literal|0
block|,
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|shear_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|transform_2d_invoker (ProcRecord * proc_record,Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|transform_2d_invoker
parameter_list|(
name|ProcRecord
modifier|*
name|proc_record
parameter_list|,
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_vals
decl_stmt|;
name|GimpDrawable
modifier|*
name|drawable
decl_stmt|;
name|gboolean
name|interpolation
decl_stmt|;
name|gdouble
name|source_x
decl_stmt|;
name|gdouble
name|source_y
decl_stmt|;
name|gdouble
name|scale_x
decl_stmt|;
name|gdouble
name|scale_y
decl_stmt|;
name|gdouble
name|angle
decl_stmt|;
name|gdouble
name|dest_x
decl_stmt|;
name|gdouble
name|dest_y
decl_stmt|;
name|drawable
operator|=
operator|(
name|GimpDrawable
operator|*
operator|)
name|gimp_value_get_item
argument_list|(
operator|&
name|args
index|[
literal|0
index|]
operator|.
name|value
argument_list|,
name|gimp
argument_list|,
name|GIMP_TYPE_DRAWABLE
argument_list|)
expr_stmt|;
name|interpolation
operator|=
name|g_value_get_boolean
argument_list|(
operator|&
name|args
index|[
literal|1
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|source_x
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|2
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|source_y
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|3
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|scale_x
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|4
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|scale_y
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|5
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|angle
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|6
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|dest_x
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|7
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
name|dest_y
operator|=
name|g_value_get_double
argument_list|(
operator|&
name|args
index|[
literal|8
index|]
operator|.
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gint
name|x
decl_stmt|,
name|y
decl_stmt|,
name|width
decl_stmt|,
name|height
decl_stmt|;
name|success
operator|=
name|gimp_item_is_attached
argument_list|(
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
operator|&&
name|gimp_drawable_mask_intersect
argument_list|(
name|drawable
argument_list|,
operator|&
name|x
argument_list|,
operator|&
name|y
argument_list|,
operator|&
name|width
argument_list|,
operator|&
name|height
argument_list|)
condition|)
block|{
name|GimpMatrix3
name|matrix
decl_stmt|;
name|GimpInterpolationType
name|interpolation_type
init|=
name|GIMP_INTERPOLATION_NONE
decl_stmt|;
comment|/* Assemble the transformation matrix */
name|gimp_matrix3_identity
argument_list|(
operator|&
name|matrix
argument_list|)
expr_stmt|;
name|gimp_matrix3_translate
argument_list|(
operator|&
name|matrix
argument_list|,
operator|-
name|source_x
argument_list|,
operator|-
name|source_y
argument_list|)
expr_stmt|;
name|gimp_matrix3_scale
argument_list|(
operator|&
name|matrix
argument_list|,
name|scale_x
argument_list|,
name|scale_y
argument_list|)
expr_stmt|;
name|gimp_matrix3_rotate
argument_list|(
operator|&
name|matrix
argument_list|,
name|angle
argument_list|)
expr_stmt|;
name|gimp_matrix3_translate
argument_list|(
operator|&
name|matrix
argument_list|,
name|dest_x
argument_list|,
name|dest_y
argument_list|)
expr_stmt|;
if|if
condition|(
name|interpolation
condition|)
name|interpolation_type
operator|=
name|gimp
operator|->
name|config
operator|->
name|interpolation_type
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_start
argument_list|(
name|progress
argument_list|,
name|_
argument_list|(
literal|"2D Transform"
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* Transform the selection */
name|success
operator|=
name|gimp_drawable_transform_affine
argument_list|(
name|drawable
argument_list|,
name|context
argument_list|,
operator|&
name|matrix
argument_list|,
name|GIMP_TRANSFORM_FORWARD
argument_list|,
name|interpolation_type
argument_list|,
name|TRUE
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|,
name|progress
argument_list|)
expr_stmt|;
if|if
condition|(
name|progress
condition|)
name|gimp_progress_end
argument_list|(
name|progress
argument_list|)
expr_stmt|;
block|}
block|}
name|return_vals
operator|=
name|procedural_db_return_values
argument_list|(
name|proc_record
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|gimp_value_set_item
argument_list|(
operator|&
name|return_vals
index|[
literal|1
index|]
operator|.
name|value
argument_list|,
name|GIMP_ITEM
argument_list|(
name|drawable
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|return_vals
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|transform_2d_proc
specifier|static
name|ProcRecord
name|transform_2d_proc
init|=
block|{
literal|"gimp-transform-2d"
block|,
literal|"gimp-transform-2d"
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-2d-default' instead."
block|,
literal|"This procedure is deprecated! Use 'gimp-drawable-transform-2d-default' instead."
block|,
literal|""
block|,
literal|""
block|,
literal|""
block|,
literal|"gimp-drawable-transform-2d-default"
block|,
name|GIMP_INTERNAL
block|,
literal|0
block|,
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|transform_2d_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

end_unit

