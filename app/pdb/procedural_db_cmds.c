begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* The GIMP -- an image manipulation program  * Copyright (C) 1995-2003 Spencer Kimball and Peter Mattis  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_comment
comment|/* NOTE: This file is autogenerated by pdbgen.pl. */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<glib/gstdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<glib-object.h>
end_include

begin_include
include|#
directive|include
file|"pdb-types.h"
end_include

begin_include
include|#
directive|include
file|"procedural_db.h"
end_include

begin_include
include|#
directive|include
file|"core/gimp.h"
end_include

begin_include
include|#
directive|include
file|"gimp-intl.h"
end_include

begin_ifdef
ifdef|#
directive|ifdef
name|HAVE_GLIBC_REGEX
end_ifdef

begin_include
include|#
directive|include
file|<regex.h>
end_include

begin_else
else|#
directive|else
end_else

begin_include
include|#
directive|include
file|"regexrepl/regex.h"
end_include

begin_endif
endif|#
directive|endif
end_endif

begin_define
DECL|macro|COMPAT_BLURB
define|#
directive|define
name|COMPAT_BLURB
value|"This procedure is deprecated! Use '%s' instead."
end_define

begin_comment
comment|/*  Query structure  */
end_comment

begin_typedef
DECL|typedef|PDBQuery
typedef|typedef
name|struct
name|_PDBQuery
name|PDBQuery
typedef|;
end_typedef

begin_struct
DECL|struct|_PDBQuery
struct|struct
name|_PDBQuery
block|{
DECL|member|gimp
name|Gimp
modifier|*
name|gimp
decl_stmt|;
DECL|member|name_regex
name|regex_t
name|name_regex
decl_stmt|;
DECL|member|blurb_regex
name|regex_t
name|blurb_regex
decl_stmt|;
DECL|member|help_regex
name|regex_t
name|help_regex
decl_stmt|;
DECL|member|author_regex
name|regex_t
name|author_regex
decl_stmt|;
DECL|member|copyright_regex
name|regex_t
name|copyright_regex
decl_stmt|;
DECL|member|date_regex
name|regex_t
name|date_regex
decl_stmt|;
DECL|member|proc_type_regex
name|regex_t
name|proc_type_regex
decl_stmt|;
DECL|member|list_of_procs
name|gchar
modifier|*
modifier|*
name|list_of_procs
decl_stmt|;
DECL|member|num_procs
name|gint
name|num_procs
decl_stmt|;
DECL|member|querying_compat
name|gboolean
name|querying_compat
decl_stmt|;
block|}
struct|;
end_struct

begin_typedef
DECL|typedef|PDBStrings
typedef|typedef
name|struct
name|_PDBStrings
name|PDBStrings
typedef|;
end_typedef

begin_struct
DECL|struct|_PDBStrings
struct|struct
name|_PDBStrings
block|{
DECL|member|compat
name|gboolean
name|compat
decl_stmt|;
DECL|member|blurb
name|gchar
modifier|*
name|blurb
decl_stmt|;
DECL|member|help
name|gchar
modifier|*
name|help
decl_stmt|;
DECL|member|author
name|gchar
modifier|*
name|author
decl_stmt|;
DECL|member|copyright
name|gchar
modifier|*
name|copyright
decl_stmt|;
DECL|member|date
name|gchar
modifier|*
name|date
decl_stmt|;
block|}
struct|;
end_struct

begin_decl_stmt
DECL|variable|proc_type_str
specifier|static
name|gchar
modifier|*
name|proc_type_str
index|[]
init|=
block|{
name|N_
argument_list|(
literal|"Internal GIMP procedure"
argument_list|)
block|,
name|N_
argument_list|(
literal|"GIMP Plug-In"
argument_list|)
block|,
name|N_
argument_list|(
literal|"GIMP Extension"
argument_list|)
block|,
name|N_
argument_list|(
literal|"Temporary Procedure"
argument_list|)
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|type_str
specifier|static
specifier|const
name|gchar
modifier|*
specifier|const
name|type_str
index|[]
init|=
block|{
literal|"GIMP_PDB_INT32"
block|,
literal|"GIMP_PDB_INT16"
block|,
literal|"GIMP_PDB_INT8"
block|,
literal|"GIMP_PDB_FLOAT"
block|,
literal|"GIMP_PDB_STRING"
block|,
literal|"GIMP_PDB_INT32ARRAY"
block|,
literal|"GIMP_PDB_INT16ARRAY"
block|,
literal|"GIMP_PDB_INT8ARRAY"
block|,
literal|"GIMP_PDB_FLOATARRAY"
block|,
literal|"GIMP_PDB_STRINGARRAY"
block|,
literal|"GIMP_PDB_COLOR"
block|,
literal|"GIMP_PDB_REGION"
block|,
literal|"GIMP_PDB_DISPLAY"
block|,
literal|"GIMP_PDB_IMAGE"
block|,
literal|"GIMP_PDB_LAYER"
block|,
literal|"GIMP_PDB_CHANNEL"
block|,
literal|"GIMP_PDB_DRAWABLE"
block|,
literal|"GIMP_PDB_SELECTION"
block|,
literal|"GIMP_PDB_BOUNDARY"
block|,
literal|"GIMP_PDB_PATH"
block|,
literal|"GIMP_PDB_PARASITE"
block|,
literal|"GIMP_PDB_STATUS"
block|,
literal|"GIMP_PDB_END"
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_temp_name_proc
specifier|static
name|ProcRecord
name|procedural_db_temp_name_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_dump_proc
specifier|static
name|ProcRecord
name|procedural_db_dump_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_query_proc
specifier|static
name|ProcRecord
name|procedural_db_query_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_proc_info_proc
specifier|static
name|ProcRecord
name|procedural_db_proc_info_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_proc_arg_proc
specifier|static
name|ProcRecord
name|procedural_db_proc_arg_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_proc_val_proc
specifier|static
name|ProcRecord
name|procedural_db_proc_val_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_get_data_proc
specifier|static
name|ProcRecord
name|procedural_db_get_data_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_get_data_size_proc
specifier|static
name|ProcRecord
name|procedural_db_get_data_size_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_set_data_proc
specifier|static
name|ProcRecord
name|procedural_db_set_data_proc
decl_stmt|;
end_decl_stmt

begin_function
name|void
DECL|function|register_procedural_db_procs (Gimp * gimp)
name|register_procedural_db_procs
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|)
block|{
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|procedural_db_temp_name_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|procedural_db_dump_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|procedural_db_query_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|procedural_db_proc_info_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|procedural_db_proc_arg_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|procedural_db_proc_val_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|procedural_db_get_data_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|procedural_db_get_data_size_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|procedural_db_set_data_proc
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|int
DECL|function|match_strings (regex_t * preg,const gchar * a)
name|match_strings
parameter_list|(
name|regex_t
modifier|*
name|preg
parameter_list|,
specifier|const
name|gchar
modifier|*
name|a
parameter_list|)
block|{
if|if
condition|(
operator|!
name|a
condition|)
name|a
operator|=
literal|""
expr_stmt|;
return|return
name|regexec
argument_list|(
name|preg
argument_list|,
name|a
argument_list|,
literal|0
argument_list|,
name|NULL
argument_list|,
literal|0
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|get_pdb_strings (PDBStrings * strings,ProcRecord * proc,gboolean compat)
name|get_pdb_strings
parameter_list|(
name|PDBStrings
modifier|*
name|strings
parameter_list|,
name|ProcRecord
modifier|*
name|proc
parameter_list|,
name|gboolean
name|compat
parameter_list|)
block|{
name|strings
operator|->
name|compat
operator|=
name|compat
expr_stmt|;
if|if
condition|(
name|compat
condition|)
block|{
name|strings
operator|->
name|blurb
operator|=
name|g_strdup_printf
argument_list|(
name|COMPAT_BLURB
argument_list|,
name|proc
operator|->
name|name
argument_list|)
expr_stmt|;
name|strings
operator|->
name|help
operator|=
name|g_strdup
argument_list|(
name|strings
operator|->
name|blurb
argument_list|)
expr_stmt|;
name|strings
operator|->
name|author
operator|=
name|NULL
expr_stmt|;
name|strings
operator|->
name|copyright
operator|=
name|NULL
expr_stmt|;
name|strings
operator|->
name|date
operator|=
name|NULL
expr_stmt|;
block|}
else|else
block|{
name|strings
operator|->
name|blurb
operator|=
name|proc
operator|->
name|blurb
expr_stmt|;
name|strings
operator|->
name|help
operator|=
name|proc
operator|->
name|help
expr_stmt|;
name|strings
operator|->
name|author
operator|=
name|proc
operator|->
name|author
expr_stmt|;
name|strings
operator|->
name|copyright
operator|=
name|proc
operator|->
name|copyright
expr_stmt|;
name|strings
operator|->
name|date
operator|=
name|proc
operator|->
name|date
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|procedural_db_query_entry (gpointer key,gpointer value,gpointer user_data)
name|procedural_db_query_entry
parameter_list|(
name|gpointer
name|key
parameter_list|,
name|gpointer
name|value
parameter_list|,
name|gpointer
name|user_data
parameter_list|)
block|{
name|PDBQuery
modifier|*
name|pdb_query
init|=
name|user_data
decl_stmt|;
name|GList
modifier|*
name|list
decl_stmt|;
name|ProcRecord
modifier|*
name|proc
decl_stmt|;
specifier|const
name|gchar
modifier|*
name|proc_name
decl_stmt|;
name|PDBStrings
name|strings
decl_stmt|;
name|proc_name
operator|=
name|key
expr_stmt|;
if|if
condition|(
name|pdb_query
operator|->
name|querying_compat
condition|)
name|list
operator|=
name|g_hash_table_lookup
argument_list|(
name|pdb_query
operator|->
name|gimp
operator|->
name|procedural_ht
argument_list|,
name|value
argument_list|)
expr_stmt|;
else|else
name|list
operator|=
name|value
expr_stmt|;
if|if
condition|(
operator|!
name|list
condition|)
return|return;
name|proc
operator|=
operator|(
name|ProcRecord
operator|*
operator|)
name|list
operator|->
name|data
expr_stmt|;
name|get_pdb_strings
argument_list|(
operator|&
name|strings
argument_list|,
name|proc
argument_list|,
name|pdb_query
operator|->
name|querying_compat
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|match_strings
argument_list|(
operator|&
name|pdb_query
operator|->
name|name_regex
argument_list|,
name|proc_name
argument_list|)
operator|&&
operator|!
name|match_strings
argument_list|(
operator|&
name|pdb_query
operator|->
name|blurb_regex
argument_list|,
name|strings
operator|.
name|blurb
argument_list|)
operator|&&
operator|!
name|match_strings
argument_list|(
operator|&
name|pdb_query
operator|->
name|help_regex
argument_list|,
name|strings
operator|.
name|help
argument_list|)
operator|&&
operator|!
name|match_strings
argument_list|(
operator|&
name|pdb_query
operator|->
name|author_regex
argument_list|,
name|strings
operator|.
name|author
argument_list|)
operator|&&
operator|!
name|match_strings
argument_list|(
operator|&
name|pdb_query
operator|->
name|copyright_regex
argument_list|,
name|strings
operator|.
name|copyright
argument_list|)
operator|&&
operator|!
name|match_strings
argument_list|(
operator|&
name|pdb_query
operator|->
name|date_regex
argument_list|,
name|strings
operator|.
name|date
argument_list|)
operator|&&
operator|!
name|match_strings
argument_list|(
operator|&
name|pdb_query
operator|->
name|proc_type_regex
argument_list|,
name|proc_type_str
index|[
operator|(
name|gint
operator|)
name|proc
operator|->
name|proc_type
index|]
argument_list|)
condition|)
block|{
name|pdb_query
operator|->
name|num_procs
operator|++
expr_stmt|;
name|pdb_query
operator|->
name|list_of_procs
operator|=
name|g_renew
argument_list|(
name|gchar
operator|*
argument_list|,
name|pdb_query
operator|->
name|list_of_procs
argument_list|,
name|pdb_query
operator|->
name|num_procs
argument_list|)
expr_stmt|;
name|pdb_query
operator|->
name|list_of_procs
index|[
name|pdb_query
operator|->
name|num_procs
operator|-
literal|1
index|]
operator|=
name|g_strdup
argument_list|(
name|proc_name
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|strings
operator|.
name|compat
condition|)
block|{
name|g_free
argument_list|(
name|strings
operator|.
name|blurb
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|strings
operator|.
name|help
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|gboolean
DECL|function|output_string (FILE * file,const gchar * string)
name|output_string
parameter_list|(
name|FILE
modifier|*
name|file
parameter_list|,
specifier|const
name|gchar
modifier|*
name|string
parameter_list|)
block|{
if|if
condition|(
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"\""
argument_list|)
operator|<
literal|0
condition|)
return|return
name|FALSE
return|;
if|if
condition|(
name|string
condition|)
while|while
condition|(
operator|*
name|string
condition|)
block|{
switch|switch
condition|(
operator|*
name|string
condition|)
block|{
case|case
literal|'\\'
case|:
if|if
condition|(
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"\\\\"
argument_list|)
operator|<
literal|0
condition|)
return|return
name|FALSE
return|;
break|break;
case|case
literal|'\"'
case|:
if|if
condition|(
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"\\\""
argument_list|)
operator|<
literal|0
condition|)
return|return
name|FALSE
return|;
break|break;
case|case
literal|'{'
case|:
if|if
condition|(
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"@{"
argument_list|)
operator|<
literal|0
condition|)
return|return
name|FALSE
return|;
break|break;
case|case
literal|'@'
case|:
if|if
condition|(
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"@@"
argument_list|)
operator|<
literal|0
condition|)
return|return
name|FALSE
return|;
break|break;
case|case
literal|'}'
case|:
if|if
condition|(
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"@}"
argument_list|)
operator|<
literal|0
condition|)
return|return
name|FALSE
return|;
break|break;
default|default:
if|if
condition|(
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"%c"
argument_list|,
operator|*
name|string
argument_list|)
operator|<
literal|0
condition|)
return|return
name|FALSE
return|;
block|}
name|string
operator|++
expr_stmt|;
block|}
if|if
condition|(
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"\"\n"
argument_list|)
operator|<
literal|0
condition|)
return|return
name|FALSE
return|;
return|return
name|TRUE
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|procedural_db_print_entry (gpointer key,gpointer value,gpointer user_data)
name|procedural_db_print_entry
parameter_list|(
name|gpointer
name|key
parameter_list|,
name|gpointer
name|value
parameter_list|,
name|gpointer
name|user_data
parameter_list|)
block|{
name|ProcRecord
modifier|*
name|procedure
decl_stmt|;
name|GString
modifier|*
name|buf
decl_stmt|;
name|GList
modifier|*
name|list
decl_stmt|;
name|FILE
modifier|*
name|file
decl_stmt|;
name|gint
name|i
decl_stmt|;
name|gint
name|num
init|=
literal|0
decl_stmt|;
name|list
operator|=
operator|(
name|GList
operator|*
operator|)
name|value
expr_stmt|;
name|file
operator|=
operator|(
name|FILE
operator|*
operator|)
name|user_data
expr_stmt|;
name|buf
operator|=
name|g_string_new
argument_list|(
literal|""
argument_list|)
expr_stmt|;
while|while
condition|(
name|list
condition|)
block|{
name|num
operator|++
expr_stmt|;
name|procedure
operator|=
operator|(
name|ProcRecord
operator|*
operator|)
name|list
operator|->
name|data
expr_stmt|;
name|list
operator|=
name|list
operator|->
name|next
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"\n(register-procedure "
argument_list|)
expr_stmt|;
if|if
condition|(
name|list
operator|||
name|num
operator|!=
literal|1
condition|)
block|{
name|g_string_printf
argument_list|(
name|buf
argument_list|,
literal|"%s<%d>"
argument_list|,
name|procedure
operator|->
name|name
argument_list|,
name|num
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|buf
operator|->
name|str
argument_list|)
expr_stmt|;
block|}
else|else
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|name
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|blurb
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|help
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|author
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|copyright
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|date
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|proc_type_str
index|[
operator|(
name|int
operator|)
name|procedure
operator|->
name|proc_type
index|]
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"( "
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|procedure
operator|->
name|num_args
condition|;
name|i
operator|++
control|)
block|{
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"( "
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|args
index|[
name|i
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|type_str
index|[
name|procedure
operator|->
name|args
index|[
name|i
index|]
operator|.
name|arg_type
index|]
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|args
index|[
name|i
index|]
operator|.
name|description
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|" ) "
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|file
argument_list|,
literal|" ) "
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"( "
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|procedure
operator|->
name|num_values
condition|;
name|i
operator|++
control|)
block|{
name|fprintf
argument_list|(
name|file
argument_list|,
literal|"( "
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|values
index|[
name|i
index|]
operator|.
name|name
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|type_str
index|[
name|procedure
operator|->
name|values
index|[
name|i
index|]
operator|.
name|arg_type
index|]
argument_list|)
expr_stmt|;
name|output_string
argument_list|(
name|file
argument_list|,
name|procedure
operator|->
name|values
index|[
name|i
index|]
operator|.
name|description
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|" ) "
argument_list|)
expr_stmt|;
block|}
name|fprintf
argument_list|(
name|file
argument_list|,
literal|" ) "
argument_list|)
expr_stmt|;
name|fprintf
argument_list|(
name|file
argument_list|,
literal|" ) "
argument_list|)
expr_stmt|;
block|}
name|g_string_free
argument_list|(
name|buf
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|procedural_db_temp_name_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|procedural_db_temp_name_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|temp_name
decl_stmt|;
specifier|static
name|gint
name|proc_number
init|=
literal|0
decl_stmt|;
name|temp_name
operator|=
name|g_strdup_printf
argument_list|(
literal|"temp_procedure_number_%d"
argument_list|,
name|proc_number
operator|++
argument_list|)
expr_stmt|;
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|procedural_db_temp_name_proc
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|temp_name
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|procedural_db_temp_name_outargs
specifier|static
name|ProcArg
name|procedural_db_temp_name_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"temp_name"
block|,
literal|"A unique temporary name for a temporary PDB entry"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_temp_name_proc
specifier|static
name|ProcRecord
name|procedural_db_temp_name_proc
init|=
block|{
literal|"gimp_procedural_db_temp_name"
block|,
literal|"Generates a unique temporary PDB name."
block|,
literal|"This procedure generates a temporary PDB entry name that is guaranteed to be unique. It is many used by the interactive popup dialogs to generate a PDB entry name."
block|,
literal|"Andy Thomas"
block|,
literal|"Andy Thomas"
block|,
literal|"1998"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|,
name|procedural_db_temp_name_outargs
block|,
block|{
block|{
name|procedural_db_temp_name_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|procedural_db_dump_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|procedural_db_dump_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|gchar
modifier|*
name|filename
decl_stmt|;
name|FILE
modifier|*
name|file
decl_stmt|;
name|filename
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|filename
operator|==
name|NULL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
if|if
condition|(
operator|(
name|file
operator|=
name|g_fopen
argument_list|(
name|filename
argument_list|,
literal|"w"
argument_list|)
operator|)
condition|)
block|{
name|g_hash_table_foreach
argument_list|(
name|gimp
operator|->
name|procedural_ht
argument_list|,
name|procedural_db_print_entry
argument_list|,
name|file
argument_list|)
expr_stmt|;
name|fclose
argument_list|(
name|file
argument_list|)
expr_stmt|;
block|}
else|else
name|success
operator|=
name|FALSE
expr_stmt|;
block|}
return|return
name|procedural_db_return_args
argument_list|(
operator|&
name|procedural_db_dump_proc
argument_list|,
name|success
argument_list|)
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|procedural_db_dump_inargs
specifier|static
name|ProcArg
name|procedural_db_dump_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"filename"
block|,
literal|"The dump filename"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_dump_proc
specifier|static
name|ProcRecord
name|procedural_db_dump_proc
init|=
block|{
literal|"gimp_procedural_db_dump"
block|,
literal|"Dumps the current contents of the procedural database"
block|,
literal|"This procedure dumps the contents of the procedural database to the specified file. The file will contain all of the information provided for each registered procedure. This file is in a format appropriate for use with the supplied \"pdb_self_doc.el\" Elisp script, which generates a texinfo document."
block|,
literal|"Spencer Kimball& Josh MacDonald"
block|,
literal|"Spencer Kimball& Josh MacDonald& Peter Mattis"
block|,
literal|"1995-1996"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|1
block|,
name|procedural_db_dump_inargs
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|procedural_db_dump_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|procedural_db_query_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|procedural_db_query_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|name
decl_stmt|;
name|gchar
modifier|*
name|blurb
decl_stmt|;
name|gchar
modifier|*
name|help
decl_stmt|;
name|gchar
modifier|*
name|author
decl_stmt|;
name|gchar
modifier|*
name|copyright
decl_stmt|;
name|gchar
modifier|*
name|date
decl_stmt|;
name|gchar
modifier|*
name|proc_type
decl_stmt|;
name|PDBQuery
name|pdb_query
decl_stmt|;
name|name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|blurb
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|blurb
operator|==
name|NULL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|help
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|help
operator|==
name|NULL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|author
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|author
operator|==
name|NULL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|copyright
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|copyright
operator|==
name|NULL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|date
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|date
operator|==
name|NULL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|proc_type
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|proc_type
operator|==
name|NULL
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|regcomp
argument_list|(
operator|&
name|pdb_query
operator|.
name|name_regex
argument_list|,
name|name
argument_list|,
literal|0
argument_list|)
condition|)
goto|goto
name|free_name
goto|;
if|if
condition|(
name|regcomp
argument_list|(
operator|&
name|pdb_query
operator|.
name|blurb_regex
argument_list|,
name|blurb
argument_list|,
literal|0
argument_list|)
condition|)
goto|goto
name|free_blurb
goto|;
if|if
condition|(
name|regcomp
argument_list|(
operator|&
name|pdb_query
operator|.
name|help_regex
argument_list|,
name|help
argument_list|,
literal|0
argument_list|)
condition|)
goto|goto
name|free_help
goto|;
if|if
condition|(
name|regcomp
argument_list|(
operator|&
name|pdb_query
operator|.
name|author_regex
argument_list|,
name|author
argument_list|,
literal|0
argument_list|)
condition|)
goto|goto
name|free_author
goto|;
if|if
condition|(
name|regcomp
argument_list|(
operator|&
name|pdb_query
operator|.
name|copyright_regex
argument_list|,
name|copyright
argument_list|,
literal|0
argument_list|)
condition|)
goto|goto
name|free_copyright
goto|;
if|if
condition|(
name|regcomp
argument_list|(
operator|&
name|pdb_query
operator|.
name|date_regex
argument_list|,
name|date
argument_list|,
literal|0
argument_list|)
condition|)
goto|goto
name|free_date
goto|;
if|if
condition|(
name|regcomp
argument_list|(
operator|&
name|pdb_query
operator|.
name|proc_type_regex
argument_list|,
name|proc_type
argument_list|,
literal|0
argument_list|)
condition|)
goto|goto
name|free_proc_type
goto|;
name|success
operator|=
name|TRUE
expr_stmt|;
name|pdb_query
operator|.
name|gimp
operator|=
name|gimp
expr_stmt|;
name|pdb_query
operator|.
name|list_of_procs
operator|=
name|NULL
expr_stmt|;
name|pdb_query
operator|.
name|num_procs
operator|=
literal|0
expr_stmt|;
name|pdb_query
operator|.
name|querying_compat
operator|=
name|FALSE
expr_stmt|;
name|g_hash_table_foreach
argument_list|(
name|gimp
operator|->
name|procedural_ht
argument_list|,
name|procedural_db_query_entry
argument_list|,
operator|&
name|pdb_query
argument_list|)
expr_stmt|;
name|pdb_query
operator|.
name|querying_compat
operator|=
name|TRUE
expr_stmt|;
name|g_hash_table_foreach
argument_list|(
name|gimp
operator|->
name|procedural_compat_ht
argument_list|,
name|procedural_db_query_entry
argument_list|,
operator|&
name|pdb_query
argument_list|)
expr_stmt|;
name|free_proc_type
label|:
name|regfree
argument_list|(
operator|&
name|pdb_query
operator|.
name|proc_type_regex
argument_list|)
expr_stmt|;
name|free_date
label|:
name|regfree
argument_list|(
operator|&
name|pdb_query
operator|.
name|date_regex
argument_list|)
expr_stmt|;
name|free_copyright
label|:
name|regfree
argument_list|(
operator|&
name|pdb_query
operator|.
name|copyright_regex
argument_list|)
expr_stmt|;
name|free_author
label|:
name|regfree
argument_list|(
operator|&
name|pdb_query
operator|.
name|author_regex
argument_list|)
expr_stmt|;
name|free_help
label|:
name|regfree
argument_list|(
operator|&
name|pdb_query
operator|.
name|help_regex
argument_list|)
expr_stmt|;
name|free_blurb
label|:
name|regfree
argument_list|(
operator|&
name|pdb_query
operator|.
name|blurb_regex
argument_list|)
expr_stmt|;
name|free_name
label|:
name|regfree
argument_list|(
operator|&
name|pdb_query
operator|.
name|name_regex
argument_list|)
expr_stmt|;
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|procedural_db_query_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|pdb_query
operator|.
name|num_procs
expr_stmt|;
name|return_args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|pdb_query
operator|.
name|list_of_procs
expr_stmt|;
block|}
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|procedural_db_query_inargs
specifier|static
name|ProcArg
name|procedural_db_query_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The regex for procedure name"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"blurb"
block|,
literal|"The regex for procedure blurb"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"help"
block|,
literal|"The regex for procedure help"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"author"
block|,
literal|"The regex for procedure author"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"copyright"
block|,
literal|"The regex for procedure copyright"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"date"
block|,
literal|"The regex for procedure date"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"proc_type"
block|,
literal|"The regex for procedure type: { 'Internal GIMP procedure', 'GIMP Plug-in', 'GIMP Extension' }"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_query_outargs
specifier|static
name|ProcArg
name|procedural_db_query_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"num_matches"
block|,
literal|"The number of matching procedures"
block|}
block|,
block|{
name|GIMP_PDB_STRINGARRAY
block|,
literal|"procedure_names"
block|,
literal|"The list of procedure names"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_query_proc
specifier|static
name|ProcRecord
name|procedural_db_query_proc
init|=
block|{
literal|"gimp_procedural_db_query"
block|,
literal|"Queries the procedural database for its contents using regular expression matching."
block|,
literal|"This procedure queries the contents of the procedural database. It is supplied with seven arguments matching procedures on { name, blurb, help, author, copyright, date, procedure type}. This is accomplished using regular expression matching. For instance, to find all procedures with \"jpeg\" listed in the blurb, all seven arguments can be supplied as \".*\", except for the second, which can be supplied as \".*jpeg.*\". There are two return arguments for this procedure. The first is the number of procedures matching the query. The second is a concatenated list of procedure names corresponding to those matching the query. If no matching entries are found, then the returned string is NULL and the number of entries is 0."
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"1995-1996"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|7
block|,
name|procedural_db_query_inargs
block|,
literal|2
block|,
name|procedural_db_query_outargs
block|,
block|{
block|{
name|procedural_db_query_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|procedural_db_proc_info_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|procedural_db_proc_info_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|proc_name
decl_stmt|;
name|PDBStrings
name|strings
decl_stmt|;
name|ProcRecord
modifier|*
name|proc
init|=
name|NULL
decl_stmt|;
name|proc_name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|proc_name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|proc_name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|proc
operator|=
name|procedural_db_lookup
argument_list|(
name|gimp
argument_list|,
name|proc_name
argument_list|)
expr_stmt|;
if|if
condition|(
name|proc
condition|)
block|{
name|get_pdb_strings
argument_list|(
operator|&
name|strings
argument_list|,
name|proc
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
block|}
else|else
block|{
specifier|const
name|gchar
modifier|*
name|compat_name
decl_stmt|;
name|compat_name
operator|=
name|g_hash_table_lookup
argument_list|(
name|gimp
operator|->
name|procedural_compat_ht
argument_list|,
name|proc_name
argument_list|)
expr_stmt|;
if|if
condition|(
name|compat_name
condition|)
block|{
name|proc
operator|=
name|procedural_db_lookup
argument_list|(
name|gimp
argument_list|,
name|compat_name
argument_list|)
expr_stmt|;
if|if
condition|(
name|proc
condition|)
name|get_pdb_strings
argument_list|(
operator|&
name|strings
argument_list|,
name|proc
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
block|}
block|}
name|success
operator|=
operator|(
name|proc
operator|!=
name|NULL
operator|)
expr_stmt|;
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|procedural_db_proc_info_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|strings
operator|.
name|compat
condition|?
name|strings
operator|.
name|blurb
else|:
name|g_strdup
argument_list|(
name|strings
operator|.
name|blurb
argument_list|)
expr_stmt|;
name|return_args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|strings
operator|.
name|compat
condition|?
name|strings
operator|.
name|help
else|:
name|g_strdup
argument_list|(
name|strings
operator|.
name|help
argument_list|)
expr_stmt|;
name|return_args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|strings
operator|.
name|compat
condition|?
name|strings
operator|.
name|author
else|:
name|g_strdup
argument_list|(
name|strings
operator|.
name|author
argument_list|)
expr_stmt|;
name|return_args
index|[
literal|4
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|strings
operator|.
name|compat
condition|?
name|strings
operator|.
name|copyright
else|:
name|g_strdup
argument_list|(
name|strings
operator|.
name|copyright
argument_list|)
expr_stmt|;
name|return_args
index|[
literal|5
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|strings
operator|.
name|compat
condition|?
name|strings
operator|.
name|date
else|:
name|g_strdup
argument_list|(
name|strings
operator|.
name|date
argument_list|)
expr_stmt|;
name|return_args
index|[
literal|6
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|proc
operator|->
name|proc_type
expr_stmt|;
name|return_args
index|[
literal|7
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|proc
operator|->
name|num_args
expr_stmt|;
name|return_args
index|[
literal|8
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|proc
operator|->
name|num_values
expr_stmt|;
block|}
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|procedural_db_proc_info_inargs
specifier|static
name|ProcArg
name|procedural_db_proc_info_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"procedure"
block|,
literal|"The procedure name"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_proc_info_outargs
specifier|static
name|ProcArg
name|procedural_db_proc_info_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"blurb"
block|,
literal|"A short blurb"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"help"
block|,
literal|"Detailed procedure help"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"author"
block|,
literal|"Author(s) of the procedure"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"copyright"
block|,
literal|"The copyright"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"date"
block|,
literal|"Copyright date"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"proc_type"
block|,
literal|"The procedure type: { GIMP_INTERNAL (0), GIMP_PLUGIN (1), GIMP_EXTENSION (2), GIMP_TEMPORARY (3) }"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"num_args"
block|,
literal|"The number of input arguments"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"num_values"
block|,
literal|"The number of return values"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_proc_info_proc
specifier|static
name|ProcRecord
name|procedural_db_proc_info_proc
init|=
block|{
literal|"gimp_procedural_db_proc_info"
block|,
literal|"Queries the procedural database for information on the specified procedure."
block|,
literal|"This procedure returns information on the specified procedure. A short blurb, detailed help, author(s), copyright information, procedure type, number of input, and number of return values are returned. For specific information on each input argument and return value, use the 'gimp_procedural_db_proc_arg' and 'gimp_procedural_db_proc_val' procedures."
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"1997"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|1
block|,
name|procedural_db_proc_info_inargs
block|,
literal|8
block|,
name|procedural_db_proc_info_outargs
block|,
block|{
block|{
name|procedural_db_proc_info_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|procedural_db_proc_arg_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|procedural_db_proc_arg_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|proc_name
decl_stmt|;
name|gint32
name|arg_num
decl_stmt|;
name|ProcRecord
modifier|*
name|proc
decl_stmt|;
name|ProcArg
modifier|*
name|arg
init|=
name|NULL
decl_stmt|;
name|proc_name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|proc_name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|proc_name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|arg_num
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|proc
operator|=
name|procedural_db_lookup
argument_list|(
name|gimp
argument_list|,
name|proc_name
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|proc
condition|)
block|{
specifier|const
name|gchar
modifier|*
name|compat_name
decl_stmt|;
name|compat_name
operator|=
name|g_hash_table_lookup
argument_list|(
name|gimp
operator|->
name|procedural_compat_ht
argument_list|,
name|proc_name
argument_list|)
expr_stmt|;
if|if
condition|(
name|compat_name
condition|)
name|proc
operator|=
name|procedural_db_lookup
argument_list|(
name|gimp
argument_list|,
name|compat_name
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|proc
operator|&&
operator|(
name|arg_num
operator|>=
literal|0
operator|&&
name|arg_num
operator|<
name|proc
operator|->
name|num_args
operator|)
condition|)
name|arg
operator|=
operator|&
name|proc
operator|->
name|args
index|[
name|arg_num
index|]
expr_stmt|;
else|else
name|success
operator|=
name|FALSE
expr_stmt|;
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|procedural_db_proc_arg_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|arg
operator|->
name|arg_type
expr_stmt|;
name|return_args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|g_strdup
argument_list|(
name|arg
operator|->
name|name
argument_list|)
expr_stmt|;
name|return_args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|g_strdup
argument_list|(
name|arg
operator|->
name|description
argument_list|)
expr_stmt|;
block|}
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|procedural_db_proc_arg_inargs
specifier|static
name|ProcArg
name|procedural_db_proc_arg_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"procedure"
block|,
literal|"The procedure name"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"arg_num"
block|,
literal|"The argument number"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_proc_arg_outargs
specifier|static
name|ProcArg
name|procedural_db_proc_arg_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"arg_type"
block|,
literal|"The type of argument { GIMP_PDB_INT32 (0), GIMP_PDB_INT16 (1), GIMP_PDB_INT8 (2), GIMP_PDB_FLOAT (3), GIMP_PDB_STRING (4), GIMP_PDB_INT32ARRAY (5), GIMP_PDB_INT16ARRAY (6), GIMP_PDB_INT8ARRAY (7), GIMP_PDB_FLOATARRAY (8), GIMP_PDB_STRINGARRAY (9), GIMP_PDB_COLOR (10), GIMP_PDB_REGION (11), GIMP_PDB_DISPLAY (12), GIMP_PDB_IMAGE (13), GIMP_PDB_LAYER (14), GIMP_PDB_CHANNEL (15), GIMP_PDB_DRAWABLE (16), GIMP_PDB_SELECTION (17), GIMP_PDB_BOUNDARY (18), GIMP_PDB_PATH (19), GIMP_PDB_PARASITE (20), GIMP_PDB_STATUS (21) }"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"arg_name"
block|,
literal|"The name of the argument"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"arg_desc"
block|,
literal|"A description of the argument"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_proc_arg_proc
specifier|static
name|ProcRecord
name|procedural_db_proc_arg_proc
init|=
block|{
literal|"gimp_procedural_db_proc_arg"
block|,
literal|"Queries the procedural database for information on the specified procedure's argument."
block|,
literal|"This procedure returns information on the specified procedure's argument. The argument type, name, and a description are retrieved."
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"1997"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|2
block|,
name|procedural_db_proc_arg_inargs
block|,
literal|3
block|,
name|procedural_db_proc_arg_outargs
block|,
block|{
block|{
name|procedural_db_proc_arg_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|procedural_db_proc_val_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|procedural_db_proc_val_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|proc_name
decl_stmt|;
name|gint32
name|val_num
decl_stmt|;
name|ProcRecord
modifier|*
name|proc
decl_stmt|;
name|ProcArg
modifier|*
name|val
init|=
name|NULL
decl_stmt|;
name|proc_name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|proc_name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|proc_name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|val_num
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|proc
operator|=
name|procedural_db_lookup
argument_list|(
name|gimp
argument_list|,
name|proc_name
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|proc
condition|)
block|{
specifier|const
name|gchar
modifier|*
name|compat_name
decl_stmt|;
name|compat_name
operator|=
name|g_hash_table_lookup
argument_list|(
name|gimp
operator|->
name|procedural_compat_ht
argument_list|,
name|proc_name
argument_list|)
expr_stmt|;
if|if
condition|(
name|compat_name
condition|)
name|proc
operator|=
name|procedural_db_lookup
argument_list|(
name|gimp
argument_list|,
name|compat_name
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|proc
operator|&&
operator|(
name|val_num
operator|>=
literal|0
operator|&&
name|val_num
operator|<
name|proc
operator|->
name|num_values
operator|)
condition|)
name|val
operator|=
operator|&
name|proc
operator|->
name|values
index|[
name|val_num
index|]
expr_stmt|;
else|else
name|success
operator|=
name|FALSE
expr_stmt|;
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|procedural_db_proc_val_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|val
operator|->
name|arg_type
expr_stmt|;
name|return_args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|g_strdup
argument_list|(
name|val
operator|->
name|name
argument_list|)
expr_stmt|;
name|return_args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|g_strdup
argument_list|(
name|val
operator|->
name|description
argument_list|)
expr_stmt|;
block|}
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|procedural_db_proc_val_inargs
specifier|static
name|ProcArg
name|procedural_db_proc_val_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"procedure"
block|,
literal|"The procedure name"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"val_num"
block|,
literal|"The return value number"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_proc_val_outargs
specifier|static
name|ProcArg
name|procedural_db_proc_val_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"val_type"
block|,
literal|"The type of return value { GIMP_PDB_INT32 (0), GIMP_PDB_INT16 (1), GIMP_PDB_INT8 (2), GIMP_PDB_FLOAT (3), GIMP_PDB_STRING (4), GIMP_PDB_INT32ARRAY (5), GIMP_PDB_INT16ARRAY (6), GIMP_PDB_INT8ARRAY (7), GIMP_PDB_FLOATARRAY (8), GIMP_PDB_STRINGARRAY (9), GIMP_PDB_COLOR (10), GIMP_PDB_REGION (11), GIMP_PDB_DISPLAY (12), GIMP_PDB_IMAGE (13), GIMP_PDB_LAYER (14), GIMP_PDB_CHANNEL (15), GIMP_PDB_DRAWABLE (16), GIMP_PDB_SELECTION (17), GIMP_PDB_BOUNDARY (18), GIMP_PDB_PATH (19), GIMP_PDB_PARASITE (20), GIMP_PDB_STATUS (21) }"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"val_name"
block|,
literal|"The name of the return value"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"val_desc"
block|,
literal|"A description of the return value"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_proc_val_proc
specifier|static
name|ProcRecord
name|procedural_db_proc_val_proc
init|=
block|{
literal|"gimp_procedural_db_proc_val"
block|,
literal|"Queries the procedural database for information on the specified procedure's return value."
block|,
literal|"This procedure returns information on the specified procedure's return value. The return value type, name, and a description are retrieved."
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"1997"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|2
block|,
name|procedural_db_proc_val_inargs
block|,
literal|3
block|,
name|procedural_db_proc_val_outargs
block|,
block|{
block|{
name|procedural_db_proc_val_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|procedural_db_get_data_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|procedural_db_get_data_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|identifier
decl_stmt|;
name|gint32
name|bytes
decl_stmt|;
name|guint8
modifier|*
name|data_copy
init|=
name|NULL
decl_stmt|;
specifier|const
name|guint8
modifier|*
name|data
decl_stmt|;
name|identifier
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|identifier
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|identifier
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|data
operator|=
name|procedural_db_get_data
argument_list|(
name|gimp
argument_list|,
name|identifier
argument_list|,
operator|&
name|bytes
argument_list|)
expr_stmt|;
name|success
operator|=
operator|(
name|data
operator|!=
name|NULL
operator|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|data_copy
operator|=
name|g_memdup
argument_list|(
name|data
argument_list|,
name|bytes
argument_list|)
expr_stmt|;
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|procedural_db_get_data_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|bytes
expr_stmt|;
name|return_args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|data_copy
expr_stmt|;
block|}
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|procedural_db_get_data_inargs
specifier|static
name|ProcArg
name|procedural_db_get_data_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"identifier"
block|,
literal|"The identifier associated with data"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_get_data_outargs
specifier|static
name|ProcArg
name|procedural_db_get_data_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"bytes"
block|,
literal|"The number of bytes in the data"
block|}
block|,
block|{
name|GIMP_PDB_INT8ARRAY
block|,
literal|"data"
block|,
literal|"A byte array containing data"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_get_data_proc
specifier|static
name|ProcRecord
name|procedural_db_get_data_proc
init|=
block|{
literal|"gimp_procedural_db_get_data"
block|,
literal|"Returns data associated with the specified identifier."
block|,
literal|"This procedure returns any data which may have been associated with the specified identifier. The data is a variable length array of bytes. If no data has been associated with the identifier, an error is returned."
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"1997"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|1
block|,
name|procedural_db_get_data_inargs
block|,
literal|2
block|,
name|procedural_db_get_data_outargs
block|,
block|{
block|{
name|procedural_db_get_data_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|procedural_db_get_data_size_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|procedural_db_get_data_size_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|identifier
decl_stmt|;
name|gint32
name|bytes
decl_stmt|;
specifier|const
name|guint8
modifier|*
name|data
decl_stmt|;
name|identifier
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|identifier
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|identifier
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|data
operator|=
name|procedural_db_get_data
argument_list|(
name|gimp
argument_list|,
name|identifier
argument_list|,
operator|&
name|bytes
argument_list|)
expr_stmt|;
name|success
operator|=
operator|(
name|data
operator|!=
name|NULL
operator|)
expr_stmt|;
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|procedural_db_get_data_size_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|bytes
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|procedural_db_get_data_size_inargs
specifier|static
name|ProcArg
name|procedural_db_get_data_size_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"identifier"
block|,
literal|"The identifier associated with data"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_get_data_size_outargs
specifier|static
name|ProcArg
name|procedural_db_get_data_size_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"bytes"
block|,
literal|"The number of bytes in the data"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_get_data_size_proc
specifier|static
name|ProcRecord
name|procedural_db_get_data_size_proc
init|=
block|{
literal|"gimp_procedural_db_get_data_size"
block|,
literal|"Returns size of data associated with the specified identifier."
block|,
literal|"This procedure returns the size of any data which may have been associated with the specified identifier. If no data has been associated with the identifier, an error is returned."
block|,
literal|"Nick Lamb"
block|,
literal|"Nick Lamb"
block|,
literal|"1998"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|1
block|,
name|procedural_db_get_data_size_inargs
block|,
literal|1
block|,
name|procedural_db_get_data_size_outargs
block|,
block|{
block|{
name|procedural_db_get_data_size_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|procedural_db_set_data_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|procedural_db_set_data_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|gchar
modifier|*
name|identifier
decl_stmt|;
name|gint32
name|bytes
decl_stmt|;
name|guint8
modifier|*
name|data
decl_stmt|;
name|identifier
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|identifier
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|identifier
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|bytes
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|bytes
operator|<=
literal|0
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|data
operator|=
operator|(
name|guint8
operator|*
operator|)
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|procedural_db_set_data
argument_list|(
name|gimp
argument_list|,
name|identifier
argument_list|,
name|bytes
argument_list|,
name|data
argument_list|)
expr_stmt|;
return|return
name|procedural_db_return_args
argument_list|(
operator|&
name|procedural_db_set_data_proc
argument_list|,
name|success
argument_list|)
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|procedural_db_set_data_inargs
specifier|static
name|ProcArg
name|procedural_db_set_data_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"identifier"
block|,
literal|"The identifier associated with data"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"bytes"
block|,
literal|"The number of bytes in the data"
block|}
block|,
block|{
name|GIMP_PDB_INT8ARRAY
block|,
literal|"data"
block|,
literal|"A byte array containing data"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|procedural_db_set_data_proc
specifier|static
name|ProcRecord
name|procedural_db_set_data_proc
init|=
block|{
literal|"gimp_procedural_db_set_data"
block|,
literal|"Associates the specified identifier with the supplied data."
block|,
literal|"This procedure associates the supplied data with the provided identifier. The data may be subsequently retrieved by a call to 'procedural-db-get-data'."
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"Spencer Kimball& Peter Mattis"
block|,
literal|"1997"
block|,
name|NULL
block|,
name|GIMP_INTERNAL
block|,
literal|3
block|,
name|procedural_db_set_data_inargs
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|procedural_db_set_data_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

end_unit

