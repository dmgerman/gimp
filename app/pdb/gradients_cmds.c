begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* The GIMP -- an image manipulation program  * Copyright (C) 1995-2003 Spencer Kimball and Peter Mattis  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_comment
comment|/* NOTE: This file is autogenerated by pdbgen.pl. */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<glib-object.h>
end_include

begin_include
include|#
directive|include
file|"pdb-types.h"
end_include

begin_include
include|#
directive|include
file|"procedural_db.h"
end_include

begin_include
include|#
directive|include
file|"core/gimp.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpcontainer-filter.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpcontext.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpdatafactory.h"
end_include

begin_include
include|#
directive|include
file|"core/gimpgradient.h"
end_include

begin_include
include|#
directive|include
file|"core/gimplist.h"
end_include

begin_decl_stmt
DECL|variable|gradients_refresh_proc
specifier|static
name|ProcRecord
name|gradients_refresh_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_get_list_proc
specifier|static
name|ProcRecord
name|gradients_get_list_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_get_gradient_proc
specifier|static
name|ProcRecord
name|gradients_get_gradient_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_set_gradient_proc
specifier|static
name|ProcRecord
name|gradients_set_gradient_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_sample_uniform_proc
specifier|static
name|ProcRecord
name|gradients_sample_uniform_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_sample_custom_proc
specifier|static
name|ProcRecord
name|gradients_sample_custom_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_get_gradient_data_proc
specifier|static
name|ProcRecord
name|gradients_get_gradient_data_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_new_proc
specifier|static
name|ProcRecord
name|gradients_new_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_duplicate_proc
specifier|static
name|ProcRecord
name|gradients_duplicate_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_delete_proc
specifier|static
name|ProcRecord
name|gradients_delete_proc
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_rename_proc
specifier|static
name|ProcRecord
name|gradients_rename_proc
decl_stmt|;
end_decl_stmt

begin_function
name|void
DECL|function|register_gradients_procs (Gimp * gimp)
name|register_gradients_procs
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|)
block|{
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_refresh_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_get_list_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_get_gradient_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_set_gradient_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_sample_uniform_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_sample_custom_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_get_gradient_data_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_new_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_duplicate_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_delete_proc
argument_list|)
expr_stmt|;
name|procedural_db_register
argument_list|(
name|gimp
argument_list|,
operator|&
name|gradients_rename_proc
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_refresh_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_refresh_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gimp_data_factory_data_save
argument_list|(
name|gimp
operator|->
name|gradient_factory
argument_list|)
expr_stmt|;
name|gimp_data_factory_data_init
argument_list|(
name|gimp
operator|->
name|gradient_factory
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
return|return
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_refresh_proc
argument_list|,
name|TRUE
argument_list|)
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_refresh_proc
specifier|static
name|ProcRecord
name|gradients_refresh_proc
init|=
block|{
literal|"gimp_gradients_refresh"
block|,
literal|"Refresh current gradients. This function always succeeds."
block|,
literal|"This procedure retrieves all gradients currently in the user's gradient path and updates the gradient dialogs accordingly."
block|,
literal|"Michael Natterer"
block|,
literal|"Michael Natterer"
block|,
literal|"2002"
block|,
name|GIMP_INTERNAL
block|,
literal|0
block|,
name|NULL
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|gradients_refresh_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_get_list_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_get_list_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|filter
decl_stmt|;
name|gint32
name|num_gradients
decl_stmt|;
name|gchar
modifier|*
modifier|*
name|gradient_list
init|=
name|NULL
decl_stmt|;
name|filter
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|filter
operator|&&
operator|!
name|g_utf8_validate
argument_list|(
name|filter
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|gradient_list
operator|=
name|gimp_container_get_filtered_name_array
argument_list|(
name|gimp
operator|->
name|gradient_factory
operator|->
name|container
argument_list|,
name|filter
argument_list|,
operator|&
name|num_gradients
argument_list|)
expr_stmt|;
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_get_list_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|num_gradients
expr_stmt|;
name|return_args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|gradient_list
expr_stmt|;
block|}
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_get_list_inargs
specifier|static
name|ProcArg
name|gradients_get_list_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"filter"
block|,
literal|"An optional regular expression used to filter the list"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_get_list_outargs
specifier|static
name|ProcArg
name|gradients_get_list_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"num_gradients"
block|,
literal|"The number of loaded gradients"
block|}
block|,
block|{
name|GIMP_PDB_STRINGARRAY
block|,
literal|"gradient_list"
block|,
literal|"The list of gradient names"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_get_list_proc
specifier|static
name|ProcRecord
name|gradients_get_list_proc
init|=
block|{
literal|"gimp_gradients_get_list"
block|,
literal|"Retrieve the list of loaded gradients."
block|,
literal|"This procedure returns a list of the gradients that are currently loaded in the gradient editor. You can later use the gimp_gradients_set_active function to set the active gradient."
block|,
literal|"Federico Mena Quintero"
block|,
literal|"Federico Mena Quintero"
block|,
literal|"1997"
block|,
name|GIMP_INTERNAL
block|,
literal|1
block|,
name|gradients_get_list_inargs
block|,
literal|2
block|,
name|gradients_get_list_outargs
block|,
block|{
block|{
name|gradients_get_list_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_get_gradient_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_get_gradient_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|success
operator|=
name|gimp_context_get_gradient
argument_list|(
name|context
argument_list|)
operator|!=
name|NULL
expr_stmt|;
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_get_gradient_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|g_strdup
argument_list|(
name|GIMP_OBJECT
argument_list|(
name|gimp_context_get_gradient
argument_list|(
name|context
argument_list|)
argument_list|)
operator|->
name|name
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_get_gradient_outargs
specifier|static
name|ProcArg
name|gradients_get_gradient_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The name of the active gradient"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_get_gradient_proc
specifier|static
name|ProcRecord
name|gradients_get_gradient_proc
init|=
block|{
literal|"gimp_gradients_get_gradient"
block|,
literal|"Retrieve the name of the active gradient."
block|,
literal|"This procedure returns the name of the active gradient in the gradient editor."
block|,
literal|"Federico Mena Quintero"
block|,
literal|"Federico Mena Quintero"
block|,
literal|"1997"
block|,
name|GIMP_INTERNAL
block|,
literal|0
block|,
name|NULL
block|,
literal|1
block|,
name|gradients_get_gradient_outargs
block|,
block|{
block|{
name|gradients_get_gradient_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_set_gradient_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_set_gradient_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|gchar
modifier|*
name|name
decl_stmt|;
name|GimpGradient
modifier|*
name|gradient
decl_stmt|;
name|name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gradient
operator|=
operator|(
name|GimpGradient
operator|*
operator|)
name|gimp_container_get_child_by_name
argument_list|(
name|gimp
operator|->
name|gradient_factory
operator|->
name|container
argument_list|,
name|name
argument_list|)
expr_stmt|;
if|if
condition|(
name|gradient
condition|)
name|gimp_context_set_gradient
argument_list|(
name|context
argument_list|,
name|gradient
argument_list|)
expr_stmt|;
else|else
name|success
operator|=
name|FALSE
expr_stmt|;
block|}
return|return
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_set_gradient_proc
argument_list|,
name|success
argument_list|)
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_set_gradient_inargs
specifier|static
name|ProcArg
name|gradients_set_gradient_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The name of the gradient to set"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_set_gradient_proc
specifier|static
name|ProcRecord
name|gradients_set_gradient_proc
init|=
block|{
literal|"gimp_gradients_set_gradient"
block|,
literal|"Sets the specified gradient as the active gradient."
block|,
literal|"This procedure lets you set the specified gradient as the active or \"current\" one. The name is simply a string which corresponds to one of the loaded gradients in the gradient editor. If no matching gradient is found, this procedure will return an error. Otherwise, the specified gradient will become active and will be used for subsequent custom gradient operations."
block|,
literal|"Federico Mena Quintero"
block|,
literal|"Federico Mena Quintero"
block|,
literal|"1997"
block|,
name|GIMP_INTERNAL
block|,
literal|1
block|,
name|gradients_set_gradient_inargs
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|gradients_set_gradient_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_sample_uniform_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_sample_uniform_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gint32
name|i
decl_stmt|;
name|gboolean
name|reverse
decl_stmt|;
name|gint32
name|array_length
init|=
literal|0
decl_stmt|;
name|gdouble
modifier|*
name|color_samples
init|=
name|NULL
decl_stmt|;
name|GimpGradient
modifier|*
name|gradient
decl_stmt|;
name|gdouble
name|pos
decl_stmt|,
name|delta
decl_stmt|;
name|GimpRGB
name|color
decl_stmt|;
name|gdouble
modifier|*
name|pv
decl_stmt|;
name|i
operator|=
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|i
operator|<
literal|2
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|reverse
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|pos
operator|=
literal|0.0
expr_stmt|;
name|delta
operator|=
literal|1.0
operator|/
operator|(
name|i
operator|-
literal|1
operator|)
expr_stmt|;
name|array_length
operator|=
name|i
operator|*
literal|4
expr_stmt|;
name|pv
operator|=
name|color_samples
operator|=
name|g_new
argument_list|(
name|gdouble
argument_list|,
name|array_length
argument_list|)
expr_stmt|;
name|gradient
operator|=
name|gimp_context_get_gradient
argument_list|(
name|context
argument_list|)
expr_stmt|;
while|while
condition|(
name|i
operator|--
condition|)
block|{
name|gimp_gradient_get_color_at
argument_list|(
name|gradient
argument_list|,
name|pos
argument_list|,
name|reverse
argument_list|,
operator|&
name|color
argument_list|)
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|r
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|g
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|b
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|a
expr_stmt|;
name|pos
operator|+=
name|delta
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_sample_uniform_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|array_length
expr_stmt|;
name|return_args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|color_samples
expr_stmt|;
block|}
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_sample_uniform_inargs
specifier|static
name|ProcArg
name|gradients_sample_uniform_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"num_samples"
block|,
literal|"The number of samples to take"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"reverse"
block|,
literal|"Use the reverse gradient (TRUE or FALSE)"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_sample_uniform_outargs
specifier|static
name|ProcArg
name|gradients_sample_uniform_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"array_length"
block|,
literal|"Length of the color_samples array (4 * num_samples)"
block|}
block|,
block|{
name|GIMP_PDB_FLOATARRAY
block|,
literal|"color_samples"
block|,
literal|"Color samples: { R1, G1, B1, A1, ..., Rn, Gn, Bn, An }"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_sample_uniform_proc
specifier|static
name|ProcRecord
name|gradients_sample_uniform_proc
init|=
block|{
literal|"gimp_gradients_sample_uniform"
block|,
literal|"Sample the active gradient in uniform parts."
block|,
literal|"This procedure samples the active gradient from the gradient editor in the specified number of uniform parts. It returns a list of floating-point values which correspond to the RGBA values for each sample. The minimum number of samples to take is 2, in which case the returned colors will correspond to the { 0.0, 1.0 } positions in the gradient. For example, if the number of samples is 3, the procedure will return the colors at positions { 0.0, 0.5, 1.0 }."
block|,
literal|"Federico Mena Quintero"
block|,
literal|"Federico Mena Quintero"
block|,
literal|"1997"
block|,
name|GIMP_INTERNAL
block|,
literal|2
block|,
name|gradients_sample_uniform_inargs
block|,
literal|2
block|,
name|gradients_sample_uniform_outargs
block|,
block|{
block|{
name|gradients_sample_uniform_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_sample_custom_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_sample_custom_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gint32
name|i
decl_stmt|;
name|gdouble
modifier|*
name|pos
decl_stmt|;
name|gboolean
name|reverse
decl_stmt|;
name|gint32
name|array_length
init|=
literal|0
decl_stmt|;
name|gdouble
modifier|*
name|color_samples
init|=
name|NULL
decl_stmt|;
name|GimpGradient
modifier|*
name|gradient
decl_stmt|;
name|GimpRGB
name|color
decl_stmt|;
name|gdouble
modifier|*
name|pv
decl_stmt|;
name|i
operator|=
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|i
operator|<=
literal|0
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|pos
operator|=
operator|(
name|gdouble
operator|*
operator|)
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
name|reverse
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|array_length
operator|=
name|i
operator|*
literal|4
expr_stmt|;
name|pv
operator|=
name|color_samples
operator|=
name|g_new
argument_list|(
name|gdouble
argument_list|,
name|array_length
argument_list|)
expr_stmt|;
name|gradient
operator|=
name|gimp_context_get_gradient
argument_list|(
name|context
argument_list|)
expr_stmt|;
while|while
condition|(
name|i
operator|--
condition|)
block|{
name|gimp_gradient_get_color_at
argument_list|(
name|gradient
argument_list|,
operator|*
name|pos
argument_list|,
name|reverse
argument_list|,
operator|&
name|color
argument_list|)
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|r
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|g
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|b
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|a
expr_stmt|;
name|pos
operator|++
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_sample_custom_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|array_length
expr_stmt|;
name|return_args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|color_samples
expr_stmt|;
block|}
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_sample_custom_inargs
specifier|static
name|ProcArg
name|gradients_sample_custom_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"num_samples"
block|,
literal|"The number of samples to take"
block|}
block|,
block|{
name|GIMP_PDB_FLOATARRAY
block|,
literal|"positions"
block|,
literal|"The list of positions to sample along the gradient"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"reverse"
block|,
literal|"Use the reverse gradient (TRUE or FALSE)"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_sample_custom_outargs
specifier|static
name|ProcArg
name|gradients_sample_custom_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_INT32
block|,
literal|"array_length"
block|,
literal|"Length of the color_samples array (4 * num_samples)"
block|}
block|,
block|{
name|GIMP_PDB_FLOATARRAY
block|,
literal|"color_samples"
block|,
literal|"Color samples: { R1, G1, B1, A1, ..., Rn, Gn, Bn, An }"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_sample_custom_proc
specifier|static
name|ProcRecord
name|gradients_sample_custom_proc
init|=
block|{
literal|"gimp_gradients_sample_custom"
block|,
literal|"Sample the active gradient in custom positions."
block|,
literal|"This procedure samples the active gradient from the gradient editor in the specified number of points. The procedure will sample the gradient in the specified positions from the list. The left endpoint of the gradient corresponds to position 0.0, and the right endpoint corresponds to 1.0. The procedure returns a list of floating-point values which correspond to the RGBA values for each sample."
block|,
literal|"Federico Mena Quintero"
block|,
literal|"Federico Mena Quintero"
block|,
literal|"1997"
block|,
name|GIMP_INTERNAL
block|,
literal|3
block|,
name|gradients_sample_custom_inargs
block|,
literal|2
block|,
name|gradients_sample_custom_outargs
block|,
block|{
block|{
name|gradients_sample_custom_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_get_gradient_data_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_get_gradient_data_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|name
decl_stmt|;
name|gint32
name|sample_size
decl_stmt|;
name|gboolean
name|reverse
decl_stmt|;
name|gdouble
modifier|*
name|values
init|=
name|NULL
decl_stmt|;
name|GimpGradient
modifier|*
name|gradient
init|=
name|NULL
decl_stmt|;
name|name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|sample_size
operator|=
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_int
expr_stmt|;
if|if
condition|(
name|sample_size
operator|<=
literal|0
operator|||
name|sample_size
operator|>
literal|10000
condition|)
name|sample_size
operator|=
name|GIMP_GRADIENT_DEFAULT_SAMPLE_SIZE
expr_stmt|;
name|reverse
operator|=
name|args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_int
condition|?
name|TRUE
else|:
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
condition|)
block|{
name|gradient
operator|=
operator|(
name|GimpGradient
operator|*
operator|)
name|gimp_container_get_child_by_name
argument_list|(
name|gimp
operator|->
name|gradient_factory
operator|->
name|container
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gradient
operator|=
name|gimp_context_get_gradient
argument_list|(
name|context
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|gradient
condition|)
block|{
name|gdouble
modifier|*
name|pv
decl_stmt|;
name|gdouble
name|pos
decl_stmt|,
name|delta
decl_stmt|;
name|GimpRGB
name|color
decl_stmt|;
name|gint
name|i
decl_stmt|;
name|i
operator|=
name|sample_size
expr_stmt|;
name|pos
operator|=
literal|0.0
expr_stmt|;
name|delta
operator|=
literal|1.0
operator|/
operator|(
name|i
operator|-
literal|1
operator|)
expr_stmt|;
name|pv
operator|=
name|values
operator|=
name|g_new
argument_list|(
name|gdouble
argument_list|,
name|i
operator|*
literal|4
argument_list|)
expr_stmt|;
while|while
condition|(
name|i
operator|--
condition|)
block|{
name|gimp_gradient_get_color_at
argument_list|(
name|gradient
argument_list|,
name|pos
argument_list|,
name|reverse
argument_list|,
operator|&
name|color
argument_list|)
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|r
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|g
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|b
expr_stmt|;
operator|*
name|pv
operator|++
operator|=
name|color
operator|.
name|a
expr_stmt|;
name|pos
operator|+=
name|delta
expr_stmt|;
block|}
block|}
else|else
name|success
operator|=
name|FALSE
expr_stmt|;
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_get_gradient_data_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|g_strdup
argument_list|(
name|GIMP_OBJECT
argument_list|(
name|gradient
argument_list|)
operator|->
name|name
argument_list|)
expr_stmt|;
name|return_args
index|[
literal|2
index|]
operator|.
name|value
operator|.
name|pdb_int
operator|=
name|sample_size
operator|*
literal|4
expr_stmt|;
name|return_args
index|[
literal|3
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|values
expr_stmt|;
block|}
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_get_gradient_data_inargs
specifier|static
name|ProcArg
name|gradients_get_gradient_data_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The gradient name (\"\" means current active gradient)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"sample_size"
block|,
literal|"Size of the sample to return when the gradient is changed (0< sample_size<= 10000)"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"reverse"
block|,
literal|"Use the reverse gradient (TRUE or FALSE)"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_get_gradient_data_outargs
specifier|static
name|ProcArg
name|gradients_get_gradient_data_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The gradient name"
block|}
block|,
block|{
name|GIMP_PDB_INT32
block|,
literal|"width"
block|,
literal|"The gradient sample width (r,g,b,a)"
block|}
block|,
block|{
name|GIMP_PDB_FLOATARRAY
block|,
literal|"grad_data"
block|,
literal|"The gradient sample data"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_get_gradient_data_proc
specifier|static
name|ProcRecord
name|gradients_get_gradient_data_proc
init|=
block|{
literal|"gimp_gradients_get_gradient_data"
block|,
literal|"Retrieve information about the specified gradient (including data)."
block|,
literal|"This procedure retrieves information about the gradient. This includes the gradient name, and the sample data for the gradient."
block|,
literal|"Federico Mena Quintero"
block|,
literal|"Federico Mena Quintero"
block|,
literal|"1997"
block|,
name|GIMP_INTERNAL
block|,
literal|3
block|,
name|gradients_get_gradient_data_inargs
block|,
literal|3
block|,
name|gradients_get_gradient_data_outargs
block|,
block|{
block|{
name|gradients_get_gradient_data_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_new_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_new_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|name
decl_stmt|;
name|GimpGradient
modifier|*
name|gradient
init|=
name|NULL
decl_stmt|;
name|name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|gradient
operator|=
operator|(
name|GimpGradient
operator|*
operator|)
name|gimp_data_factory_data_new
argument_list|(
name|gimp
operator|->
name|gradient_factory
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_new_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|g_strdup
argument_list|(
name|GIMP_OBJECT
argument_list|(
name|gradient
argument_list|)
operator|->
name|name
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_new_inargs
specifier|static
name|ProcArg
name|gradients_new_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The requested name of the new gradient"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_new_outargs
specifier|static
name|ProcArg
name|gradients_new_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The actual new gradient name"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_new_proc
specifier|static
name|ProcRecord
name|gradients_new_proc
init|=
block|{
literal|"gimp_gradients_new"
block|,
literal|"Creates a new gradient"
block|,
literal|"This procedure creates a new, uninitialized gradient"
block|,
literal|"Shlomi Fish"
block|,
literal|"Shlomi Fish"
block|,
literal|"2004"
block|,
name|GIMP_INTERNAL
block|,
literal|1
block|,
name|gradients_new_inargs
block|,
literal|1
block|,
name|gradients_new_outargs
block|,
block|{
block|{
name|gradients_new_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_duplicate_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_duplicate_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|name
decl_stmt|;
name|GimpGradient
modifier|*
name|gradient
init|=
name|NULL
decl_stmt|;
name|GimpGradient
modifier|*
name|gradient_copy
init|=
name|NULL
decl_stmt|;
name|name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
condition|)
block|{
name|gradient
operator|=
operator|(
name|GimpGradient
operator|*
operator|)
name|gimp_container_get_child_by_name
argument_list|(
name|gimp
operator|->
name|gradient_factory
operator|->
name|container
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gradient
operator|=
name|gimp_context_get_gradient
argument_list|(
name|context
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|gradient
condition|)
block|{
name|gradient_copy
operator|=
operator|(
name|GimpGradient
operator|*
operator|)
name|gimp_data_factory_data_duplicate
argument_list|(
name|gimp
operator|->
name|gradient_factory
argument_list|,
name|GIMP_DATA
argument_list|(
name|gradient
argument_list|)
argument_list|)
expr_stmt|;
name|success
operator|=
operator|(
name|gradient_copy
operator|!=
name|NULL
operator|)
expr_stmt|;
block|}
else|else
block|{
name|success
operator|=
name|FALSE
expr_stmt|;
block|}
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_duplicate_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|g_strdup
argument_list|(
name|GIMP_OBJECT
argument_list|(
name|gradient_copy
argument_list|)
operator|->
name|name
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_duplicate_inargs
specifier|static
name|ProcArg
name|gradients_duplicate_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The name of the gradient to duplicate"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_duplicate_outargs
specifier|static
name|ProcArg
name|gradients_duplicate_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The name of the gradient's copy"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_duplicate_proc
specifier|static
name|ProcRecord
name|gradients_duplicate_proc
init|=
block|{
literal|"gimp_gradients_duplicate"
block|,
literal|"Duplicates a gradient"
block|,
literal|"This procedure creates an identical gradient by a different name"
block|,
literal|"Shlomi Fish"
block|,
literal|"Shlomi Fish"
block|,
literal|"2004"
block|,
name|GIMP_INTERNAL
block|,
literal|1
block|,
name|gradients_duplicate_inargs
block|,
literal|1
block|,
name|gradients_duplicate_outargs
block|,
block|{
block|{
name|gradients_duplicate_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_delete_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_delete_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|gchar
modifier|*
name|name
decl_stmt|;
name|GimpGradient
modifier|*
name|gradient
init|=
name|NULL
decl_stmt|;
name|name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
condition|)
block|{
name|gradient
operator|=
operator|(
name|GimpGradient
operator|*
operator|)
name|gimp_container_get_child_by_name
argument_list|(
name|gimp
operator|->
name|gradient_factory
operator|->
name|container
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gradient
operator|=
name|gimp_context_get_gradient
argument_list|(
name|context
argument_list|)
expr_stmt|;
block|}
name|success
operator|=
operator|(
name|gradient
operator|&&
name|GIMP_DATA
argument_list|(
name|gradient
argument_list|)
operator|->
name|deletable
operator|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
name|GError
modifier|*
name|error
init|=
name|NULL
decl_stmt|;
name|success
operator|=
name|gimp_data_factory_data_delete
argument_list|(
name|gimp
operator|->
name|gradient_factory
argument_list|,
name|GIMP_DATA
argument_list|(
name|gradient
argument_list|)
argument_list|,
name|TRUE
argument_list|,
operator|&
name|error
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|success
condition|)
block|{
name|g_message
argument_list|(
name|error
operator|->
name|message
argument_list|)
expr_stmt|;
name|g_clear_error
argument_list|(
operator|&
name|error
argument_list|)
expr_stmt|;
block|}
block|}
block|}
return|return
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_delete_proc
argument_list|,
name|success
argument_list|)
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_delete_inargs
specifier|static
name|ProcArg
name|gradients_delete_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The name of the gradient to delete"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_delete_proc
specifier|static
name|ProcRecord
name|gradients_delete_proc
init|=
block|{
literal|"gimp_gradients_delete"
block|,
literal|"Deletes a gradient"
block|,
literal|"This procedure deletes a gradient"
block|,
literal|"Shlomi Fish"
block|,
literal|"Shlomi Fish"
block|,
literal|"2004"
block|,
name|GIMP_INTERNAL
block|,
literal|1
block|,
name|gradients_delete_inargs
block|,
literal|0
block|,
name|NULL
block|,
block|{
block|{
name|gradients_delete_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|Argument
modifier|*
DECL|function|gradients_rename_invoker (Gimp * gimp,GimpContext * context,GimpProgress * progress,Argument * args)
name|gradients_rename_invoker
parameter_list|(
name|Gimp
modifier|*
name|gimp
parameter_list|,
name|GimpContext
modifier|*
name|context
parameter_list|,
name|GimpProgress
modifier|*
name|progress
parameter_list|,
name|Argument
modifier|*
name|args
parameter_list|)
block|{
name|gboolean
name|success
init|=
name|TRUE
decl_stmt|;
name|Argument
modifier|*
name|return_args
decl_stmt|;
name|gchar
modifier|*
name|name
decl_stmt|;
name|gchar
modifier|*
name|new_name
decl_stmt|;
name|GimpGradient
modifier|*
name|gradient
init|=
name|NULL
decl_stmt|;
name|name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|0
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
name|new_name
operator|=
operator|(
name|gchar
operator|*
operator|)
name|args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
expr_stmt|;
if|if
condition|(
name|new_name
operator|==
name|NULL
operator|||
operator|!
name|g_utf8_validate
argument_list|(
name|new_name
argument_list|,
operator|-
literal|1
argument_list|,
name|NULL
argument_list|)
condition|)
name|success
operator|=
name|FALSE
expr_stmt|;
if|if
condition|(
name|success
condition|)
block|{
if|if
condition|(
name|strlen
argument_list|(
name|name
argument_list|)
condition|)
block|{
name|gradient
operator|=
operator|(
name|GimpGradient
operator|*
operator|)
name|gimp_container_get_child_by_name
argument_list|(
name|gimp
operator|->
name|gradient_factory
operator|->
name|container
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|gradient
operator|=
name|gimp_context_get_gradient
argument_list|(
name|context
argument_list|)
expr_stmt|;
block|}
name|success
operator|=
operator|(
name|gradient
operator|&&
name|GIMP_DATA
argument_list|(
name|gradient
argument_list|)
operator|->
name|writable
operator|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|gimp_object_set_name
argument_list|(
name|GIMP_OBJECT
argument_list|(
name|gradient
argument_list|)
argument_list|,
name|new_name
argument_list|)
expr_stmt|;
block|}
name|return_args
operator|=
name|procedural_db_return_args
argument_list|(
operator|&
name|gradients_rename_proc
argument_list|,
name|success
argument_list|)
expr_stmt|;
if|if
condition|(
name|success
condition|)
name|return_args
index|[
literal|1
index|]
operator|.
name|value
operator|.
name|pdb_pointer
operator|=
name|g_strdup
argument_list|(
name|GIMP_OBJECT
argument_list|(
name|gradient
argument_list|)
operator|->
name|name
argument_list|)
expr_stmt|;
return|return
name|return_args
return|;
block|}
end_function

begin_decl_stmt
DECL|variable|gradients_rename_inargs
specifier|static
name|ProcArg
name|gradients_rename_inargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The name of the gradient to rename"
block|}
block|,
block|{
name|GIMP_PDB_STRING
block|,
literal|"new_name"
block|,
literal|"The new name of the gradient"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_rename_outargs
specifier|static
name|ProcArg
name|gradients_rename_outargs
index|[]
init|=
block|{
block|{
name|GIMP_PDB_STRING
block|,
literal|"name"
block|,
literal|"The actual new name of the gradient"
block|}
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|gradients_rename_proc
specifier|static
name|ProcRecord
name|gradients_rename_proc
init|=
block|{
literal|"gimp_gradients_rename"
block|,
literal|"Rename a gradient"
block|,
literal|"This procedure renames a gradient"
block|,
literal|"Shlomi Fish"
block|,
literal|"Shlomi Fish"
block|,
literal|"2004"
block|,
name|GIMP_INTERNAL
block|,
literal|2
block|,
name|gradients_rename_inargs
block|,
literal|1
block|,
name|gradients_rename_outargs
block|,
block|{
block|{
name|gradients_rename_invoker
block|}
block|}
block|}
decl_stmt|;
end_decl_stmt

end_unit

