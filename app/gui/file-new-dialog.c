begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|"appenv.h"
end_include

begin_include
include|#
directive|include
file|"actionarea.h"
end_include

begin_include
include|#
directive|include
file|"app_procs.h"
end_include

begin_include
include|#
directive|include
file|"commands.h"
end_include

begin_include
include|#
directive|include
file|"general.h"
end_include

begin_include
include|#
directive|include
file|"gimage.h"
end_include

begin_include
include|#
directive|include
file|"gimprc.h"
end_include

begin_include
include|#
directive|include
file|"global_edit.h"
end_include

begin_include
include|#
directive|include
file|"interface.h"
end_include

begin_include
include|#
directive|include
file|"plug_in.h"
end_include

begin_include
include|#
directive|include
file|"tile_manager_pvt.h"
end_include

begin_include
include|#
directive|include
file|"gdisplay.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/gimpintl.h"
end_include

begin_typedef
DECL|struct|__anon28c134540108
typedef|typedef
struct|struct
block|{
DECL|member|dlg
name|GtkWidget
modifier|*
name|dlg
decl_stmt|;
DECL|member|height_spinbutton
name|GtkWidget
modifier|*
name|height_spinbutton
decl_stmt|;
DECL|member|width_spinbutton
name|GtkWidget
modifier|*
name|width_spinbutton
decl_stmt|;
DECL|member|height_units_spinbutton
name|GtkWidget
modifier|*
name|height_units_spinbutton
decl_stmt|;
DECL|member|width_units_spinbutton
name|GtkWidget
modifier|*
name|width_units_spinbutton
decl_stmt|;
DECL|member|resolution_spinbutton
name|GtkWidget
modifier|*
name|resolution_spinbutton
decl_stmt|;
DECL|member|resolution
name|float
name|resolution
decl_stmt|;
comment|/* always in dpi */
DECL|member|unit
name|float
name|unit
decl_stmt|;
comment|/* this is a float that is equal to unit/inch, 2.54 for cm for example */
DECL|member|res_unit
name|float
name|res_unit
decl_stmt|;
comment|/* same as above but for the res unit */
DECL|member|width
name|int
name|width
decl_stmt|;
DECL|member|height
name|int
name|height
decl_stmt|;
DECL|member|type
name|int
name|type
decl_stmt|;
DECL|member|fill_type
name|int
name|fill_type
decl_stmt|;
DECL|typedef|NewImageValues
block|}
name|NewImageValues
typedef|;
end_typedef

begin_comment
comment|/*  new image local functions  */
end_comment

begin_function_decl
specifier|static
name|void
name|file_new_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_cancel_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|file_new_delete_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|GdkEvent
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_toggle_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_width_update_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_height_update_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_width_units_update_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_height_units_update_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_resolution_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_units_inch_menu_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_units_cm_menu_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_res_units_inch_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|file_new_res_units_cm_callback
parameter_list|(
name|GtkWidget
modifier|*
parameter_list|,
name|gpointer
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|float
name|file_new_default_unit_parse
parameter_list|(
name|int
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/*  static variables  */
end_comment

begin_decl_stmt
DECL|variable|last_width
specifier|static
name|int
name|last_width
init|=
literal|256
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_height
specifier|static
name|int
name|last_height
init|=
literal|256
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_type
specifier|static
name|int
name|last_type
init|=
name|RGB
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_fill_type
specifier|static
name|int
name|last_fill_type
init|=
name|BACKGROUND_FILL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_resolution
specifier|static
name|float
name|last_resolution
init|=
literal|72
decl_stmt|;
end_decl_stmt

begin_comment
DECL|variable|last_resolution
comment|/* always in DPI */
end_comment

begin_decl_stmt
DECL|variable|last_unit
specifier|static
name|float
name|last_unit
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_res_unit
specifier|static
name|float
name|last_res_unit
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|last_new_image
specifier|static
name|gboolean
name|last_new_image
init|=
name|TRUE
decl_stmt|;
end_decl_stmt

begin_comment
comment|/* these are temps that should be set in gimprc eventually */
end_comment

begin_comment
comment|/*  FIXME */
end_comment

begin_comment
comment|/* static   float        default_resolution = 72;      this needs to be set in gimprc */
end_comment

begin_decl_stmt
DECL|variable|default_unit
specifier|static
name|float
name|default_unit
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|default_res_unit
specifier|static
name|float
name|default_res_unit
init|=
literal|1
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|new_dialog_run
specifier|static
name|int
name|new_dialog_run
decl_stmt|;
end_decl_stmt

begin_decl_stmt
specifier|extern
name|TileManager
modifier|*
name|global_buf
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
DECL|function|file_new_ok_callback (GtkWidget * widget,gpointer data)
name|file_new_ok_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|GImage
modifier|*
name|gimage
decl_stmt|;
name|GDisplay
modifier|*
name|gdisplay
decl_stmt|;
name|Layer
modifier|*
name|layer
decl_stmt|;
name|int
name|type
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|vals
operator|->
name|width
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|vals
operator|->
name|height
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
comment|/* resolution is always in DPI, but the value in the spinner may not    * be */
name|vals
operator|->
name|resolution
operator|=
name|gtk_spin_button_get_value_as_float
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|vals
operator|->
name|resolution
operator|*=
name|vals
operator|->
name|res_unit
expr_stmt|;
name|last_new_image
operator|=
name|TRUE
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
expr_stmt|;
name|last_width
operator|=
name|vals
operator|->
name|width
expr_stmt|;
name|last_height
operator|=
name|vals
operator|->
name|height
expr_stmt|;
name|last_type
operator|=
name|vals
operator|->
name|type
expr_stmt|;
name|last_fill_type
operator|=
name|vals
operator|->
name|fill_type
expr_stmt|;
name|last_resolution
operator|=
name|vals
operator|->
name|resolution
expr_stmt|;
name|last_unit
operator|=
name|vals
operator|->
name|unit
expr_stmt|;
name|last_res_unit
operator|=
name|vals
operator|->
name|res_unit
expr_stmt|;
switch|switch
condition|(
name|vals
operator|->
name|fill_type
condition|)
block|{
case|case
name|BACKGROUND_FILL
case|:
case|case
name|FOREGROUND_FILL
case|:
case|case
name|WHITE_FILL
case|:
name|type
operator|=
operator|(
name|vals
operator|->
name|type
operator|==
name|RGB
operator|)
condition|?
name|RGB_GIMAGE
else|:
name|GRAY_GIMAGE
expr_stmt|;
break|break;
case|case
name|TRANSPARENT_FILL
case|:
name|type
operator|=
operator|(
name|vals
operator|->
name|type
operator|==
name|RGB
operator|)
condition|?
name|RGBA_GIMAGE
else|:
name|GRAYA_GIMAGE
expr_stmt|;
break|break;
default|default:
name|type
operator|=
name|RGB_IMAGE
expr_stmt|;
break|break;
block|}
name|gimage
operator|=
name|gimage_new
argument_list|(
name|vals
operator|->
name|width
argument_list|,
name|vals
operator|->
name|height
argument_list|,
name|vals
operator|->
name|type
argument_list|)
expr_stmt|;
comment|/* XXX for the moment, we set both x and y resolution to the same,    * since we don't have the UI to get both values from the user, and    * besides, that's what PhotoShop seems to do. */
name|gimp_image_set_resolution
argument_list|(
name|gimage
argument_list|,
name|vals
operator|->
name|resolution
argument_list|,
name|vals
operator|->
name|resolution
argument_list|)
expr_stmt|;
comment|/*  Make the background (or first) layer  */
name|layer
operator|=
name|layer_new
argument_list|(
name|gimage
argument_list|,
name|gimage
operator|->
name|width
argument_list|,
name|gimage
operator|->
name|height
argument_list|,
name|type
argument_list|,
name|_
argument_list|(
literal|"Background"
argument_list|)
argument_list|,
name|OPAQUE_OPACITY
argument_list|,
name|NORMAL
argument_list|)
expr_stmt|;
if|if
condition|(
name|layer
condition|)
block|{
comment|/*  add the new layer to the gimage  */
name|gimage_disable_undo
argument_list|(
name|gimage
argument_list|)
expr_stmt|;
name|gimage_add_layer
argument_list|(
name|gimage
argument_list|,
name|layer
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gimage_enable_undo
argument_list|(
name|gimage
argument_list|)
expr_stmt|;
name|drawable_fill
argument_list|(
name|GIMP_DRAWABLE
argument_list|(
name|layer
argument_list|)
argument_list|,
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
name|gimage_clean_all
argument_list|(
name|gimage
argument_list|)
expr_stmt|;
name|gdisplay
operator|=
name|gdisplay_new
argument_list|(
name|gimage
argument_list|,
literal|0x0101
argument_list|)
expr_stmt|;
block|}
name|g_free
argument_list|(
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|file_new_delete_callback (GtkWidget * widget,GdkEvent * event,gpointer data)
name|file_new_delete_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|file_new_cancel_callback
argument_list|(
name|widget
argument_list|,
name|data
argument_list|)
expr_stmt|;
return|return
name|TRUE
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_cancel_callback (GtkWidget * widget,gpointer data)
name|file_new_cancel_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|gtk_widget_destroy
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_toggle_callback (GtkWidget * widget,gpointer data)
name|file_new_toggle_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|int
modifier|*
name|val
decl_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
condition|)
block|{
name|val
operator|=
name|data
expr_stmt|;
operator|*
name|val
operator|=
operator|(
name|long
operator|)
name|gtk_object_get_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_width_update_callback (GtkWidget * widget,gpointer data)
name|file_new_width_update_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|int
name|new_width
decl_stmt|;
name|float
name|temp
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|new_width
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|temp
operator|=
operator|(
operator|(
name|float
operator|)
name|new_width
operator|/
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|)
operator|*
name|vals
operator|->
name|unit
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|temp
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_height_update_callback (GtkWidget * widget,gpointer data)
name|file_new_height_update_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|int
name|new_height
decl_stmt|;
name|float
name|temp
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|new_height
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|temp
operator|=
operator|(
operator|(
name|float
operator|)
name|new_height
operator|/
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|)
operator|*
name|vals
operator|->
name|unit
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|temp
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_width_units_update_callback (GtkWidget * widget,gpointer data)
name|file_new_width_units_update_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|float
name|new_width_units
decl_stmt|;
name|float
name|temp
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|new_width_units
operator|=
name|gtk_spin_button_get_value_as_float
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|temp
operator|=
operator|(
operator|(
operator|(
operator|(
name|float
operator|)
name|new_width_units
operator|)
operator|/
name|vals
operator|->
name|unit
operator|)
operator|*
operator|(
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|)
operator|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|,
name|temp
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_height_units_update_callback (GtkWidget * widget,gpointer data)
name|file_new_height_units_update_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|float
name|new_height_units
decl_stmt|;
name|float
name|temp
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|new_height_units
operator|=
name|gtk_spin_button_get_value_as_float
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|temp
operator|=
operator|(
operator|(
operator|(
operator|(
name|float
operator|)
name|new_height_units
operator|)
operator|/
name|vals
operator|->
name|unit
operator|)
operator|*
operator|(
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|)
operator|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|,
name|temp
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_resolution_callback (GtkWidget * widget,gpointer data)
name|file_new_resolution_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|float
name|temp_units
decl_stmt|;
name|float
name|temp_pixels
decl_stmt|;
name|float
name|temp_resolution
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|temp_resolution
operator|=
name|gtk_spin_button_get_value_as_float
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
comment|/* a bit of a kludge to keep height/width from going to zero */
if|if
condition|(
name|temp_resolution
operator|<=
literal|1
condition|)
name|temp_resolution
operator|=
literal|1
expr_stmt|;
comment|/* vals->resoluion is always in DPI */
name|vals
operator|->
name|resolution
operator|=
operator|(
name|temp_resolution
operator|*
name|vals
operator|->
name|res_unit
operator|)
expr_stmt|;
comment|/* figure the new height */
name|temp_units
operator|=
name|gtk_spin_button_get_value_as_float
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|temp_pixels
operator|=
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|*
operator|(
operator|(
name|float
operator|)
name|temp_units
operator|/
name|vals
operator|->
name|unit
operator|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|,
name|temp_pixels
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
comment|/* figure the new width */
name|temp_units
operator|=
name|gtk_spin_button_get_value_as_float
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|temp_pixels
operator|=
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|*
operator|(
operator|(
name|float
operator|)
name|temp_units
operator|/
name|vals
operator|->
name|unit
operator|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|,
name|temp_pixels
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_units_inch_menu_callback (GtkWidget * widget,gpointer data)
name|file_new_units_inch_menu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|float
name|temp_pixels_height
decl_stmt|;
name|float
name|temp_pixels_width
decl_stmt|;
name|float
name|temp_units_height
decl_stmt|;
name|float
name|temp_units_width
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|vals
operator|->
name|unit
operator|=
literal|1
expr_stmt|;
comment|/* set fo/inch ratio for conversions */
name|temp_pixels_height
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|temp_pixels_width
operator|=
name|gtk_spin_button_get_value_as_int
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
comment|/* remember vals->resoltuion is always in dpi */
name|temp_units_height
operator|=
operator|(
name|float
operator|)
name|temp_pixels_height
operator|/
operator|(
operator|(
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|)
operator|*
name|vals
operator|->
name|unit
operator|)
expr_stmt|;
name|temp_units_width
operator|=
operator|(
name|float
operator|)
name|temp_pixels_width
operator|/
operator|(
operator|(
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|)
operator|*
name|vals
operator|->
name|unit
operator|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|temp_units_height
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|temp_units_width
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|file_new_units_cm_menu_callback (GtkWidget * widget,gpointer data)
name|file_new_units_cm_menu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|float
name|temp_pixels_height
decl_stmt|;
name|float
name|temp_pixels_width
decl_stmt|;
name|float
name|temp_units_height
decl_stmt|;
name|float
name|temp_units_width
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|vals
operator|->
name|unit
operator|=
literal|2.54
expr_stmt|;
name|temp_pixels_height
operator|=
name|gtk_spin_button_get_value_as_float
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|temp_pixels_width
operator|=
name|gtk_spin_button_get_value_as_float
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|)
expr_stmt|;
comment|/* remember resoltuion is always in dpi */
comment|/* convert from inches to centimeters here */
name|temp_units_height
operator|=
operator|(
operator|(
name|float
operator|)
name|temp_pixels_height
operator|/
operator|(
operator|(
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|)
operator|)
operator|*
name|vals
operator|->
name|unit
operator|)
expr_stmt|;
name|temp_units_width
operator|=
operator|(
operator|(
name|float
operator|)
name|temp_pixels_width
operator|/
operator|(
operator|(
operator|(
name|float
operator|)
name|vals
operator|->
name|resolution
operator|)
operator|)
operator|*
name|vals
operator|->
name|unit
operator|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|temp_units_height
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|temp_units_width
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|file_new_res_units_inch_callback (GtkWidget * widget,gpointer data)
specifier|static
name|void
name|file_new_res_units_inch_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|float
name|temp_resolution
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|vals
operator|->
name|res_unit
operator|=
literal|1.0
expr_stmt|;
comment|/* vals->resoltuion is alwayd DPI */
name|temp_resolution
operator|=
operator|(
name|vals
operator|->
name|resolution
operator|/
name|vals
operator|->
name|res_unit
operator|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|,
name|temp_resolution
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|file_new_res_units_cm_callback (GtkWidget * widget,gpointer data)
specifier|static
name|void
name|file_new_res_units_cm_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|data
parameter_list|)
block|{
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|float
name|temp_resolution
decl_stmt|;
name|vals
operator|=
name|data
expr_stmt|;
name|vals
operator|->
name|res_unit
operator|=
literal|2.54
expr_stmt|;
comment|/* vals->resolution is always DPI */
name|temp_resolution
operator|=
operator|(
name|vals
operator|->
name|resolution
operator|/
name|vals
operator|->
name|res_unit
operator|)
expr_stmt|;
name|gtk_signal_handler_block_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_value
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|,
name|temp_resolution
argument_list|)
expr_stmt|;
name|gtk_signal_handler_unblock_by_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|file_new_cmd_callback (GtkWidget * widget,gpointer callback_data,guint callback_action)
name|file_new_cmd_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gpointer
name|callback_data
parameter_list|,
name|guint
name|callback_action
parameter_list|)
block|{
name|GDisplay
modifier|*
name|gdisp
decl_stmt|;
name|NewImageValues
modifier|*
name|vals
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|table
decl_stmt|;
name|GtkWidget
modifier|*
name|frame
decl_stmt|;
name|GtkWidget
modifier|*
name|radio_box
decl_stmt|;
name|GtkWidget
modifier|*
name|menu
decl_stmt|;
name|GtkWidget
modifier|*
name|menuitem
decl_stmt|;
name|GtkWidget
modifier|*
name|optionmenu
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|GSList
modifier|*
name|group
decl_stmt|;
name|float
name|temp
decl_stmt|;
name|default_res_unit
operator|=
name|file_new_default_unit_parse
argument_list|(
name|default_resolution_units
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|new_dialog_run
condition|)
block|{
name|last_width
operator|=
name|default_width
expr_stmt|;
name|last_height
operator|=
name|default_height
expr_stmt|;
name|last_type
operator|=
name|default_type
expr_stmt|;
name|last_resolution
operator|=
name|default_resolution
expr_stmt|;
comment|/* this isnt set in gimprc yet */
name|last_unit
operator|=
name|default_unit
expr_stmt|;
comment|/* not in gimprc either, inches for now */
name|last_res_unit
operator|=
name|default_res_unit
expr_stmt|;
name|new_dialog_run
operator|=
literal|1
expr_stmt|;
block|}
comment|/*  Before we try to determine the responsible gdisplay,    *  make sure this wasn't called from the toolbox    */
if|if
condition|(
name|callback_action
condition|)
name|gdisp
operator|=
name|gdisplay_active
argument_list|()
expr_stmt|;
else|else
name|gdisp
operator|=
name|NULL
expr_stmt|;
name|vals
operator|=
name|g_malloc
argument_list|(
sizeof|sizeof
argument_list|(
name|NewImageValues
argument_list|)
argument_list|)
expr_stmt|;
name|vals
operator|->
name|fill_type
operator|=
name|last_fill_type
expr_stmt|;
if|if
condition|(
name|gdisp
condition|)
block|{
name|vals
operator|->
name|width
operator|=
name|gdisp
operator|->
name|gimage
operator|->
name|width
expr_stmt|;
name|vals
operator|->
name|height
operator|=
name|gdisp
operator|->
name|gimage
operator|->
name|height
expr_stmt|;
name|vals
operator|->
name|type
operator|=
name|gimage_base_type
argument_list|(
name|gdisp
operator|->
name|gimage
argument_list|)
expr_stmt|;
name|vals
operator|->
name|resolution
operator|=
name|gdisp
operator|->
name|gimage
operator|->
name|xresolution
expr_stmt|;
name|vals
operator|->
name|unit
operator|=
name|last_unit
expr_stmt|;
name|vals
operator|->
name|res_unit
operator|=
literal|1.0
expr_stmt|;
block|}
else|else
block|{
name|vals
operator|->
name|width
operator|=
name|last_width
expr_stmt|;
name|vals
operator|->
name|height
operator|=
name|last_height
expr_stmt|;
name|vals
operator|->
name|type
operator|=
name|last_type
expr_stmt|;
name|vals
operator|->
name|resolution
operator|=
name|last_resolution
expr_stmt|;
name|vals
operator|->
name|unit
operator|=
name|last_unit
expr_stmt|;
name|vals
operator|->
name|res_unit
operator|=
name|last_res_unit
expr_stmt|;
block|}
if|if
condition|(
name|vals
operator|->
name|type
operator|==
name|INDEXED
condition|)
name|vals
operator|->
name|type
operator|=
name|RGB
expr_stmt|;
comment|/* no indexed images */
comment|/*  if a cut buffer exist, default to using its size for the new image */
comment|/* also check to see if a new_image has been opened */
if|if
condition|(
name|global_buf
operator|&&
operator|!
name|last_new_image
condition|)
block|{
name|vals
operator|->
name|width
operator|=
name|global_buf
operator|->
name|width
expr_stmt|;
name|vals
operator|->
name|height
operator|=
name|global_buf
operator|->
name|height
expr_stmt|;
comment|/* It would be good to set the resolution here, but that would        * require TileManagers to know about the resolution of tiles        * they're dealing with.  It's not clear we want to go down that        * road. -- austin */
block|}
name|vals
operator|->
name|dlg
operator|=
name|gtk_dialog_new
argument_list|()
expr_stmt|;
name|gtk_window_set_wmclass
argument_list|(
name|GTK_WINDOW
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
literal|"new_image"
argument_list|,
literal|"Gimp"
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
name|_
argument_list|(
literal|"New Image"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_window_set_position
argument_list|(
name|GTK_WINDOW
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
name|GTK_WIN_POS_MOUSE
argument_list|)
expr_stmt|;
name|gtk_window_set_policy
argument_list|(
name|GTK_WINDOW
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/* handle the wm close signal */
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
argument_list|,
literal|"delete_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|file_new_delete_callback
argument_list|)
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|GTK_DIALOG
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"OK"
argument_list|)
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_ok_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_grab_default
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Cancel"
argument_list|)
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|button
argument_list|,
name|GTK_CAN_DEFAULT
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"clicked"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_cancel_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
operator|->
name|action_area
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|vbox
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|GTK_DIALOG
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
operator|->
name|vbox
argument_list|)
argument_list|,
name|vbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vbox
argument_list|)
expr_stmt|;
name|table
operator|=
name|gtk_table_new
argument_list|(
literal|3
argument_list|,
literal|3
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacings
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|table
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|table
argument_list|)
expr_stmt|;
comment|/* label for top of table, Width  */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Width"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
comment|/* Label for top of table, Height */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Height"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
comment|/* width in pixels spinbutton  */
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|vals
operator|->
name|width
argument_list|,
literal|1.0
argument_list|,
literal|32767.0
argument_list|,
literal|1.0
argument_list|,
literal|50.0
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|vals
operator|->
name|width_spinbutton
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_shadow_type
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|,
name|GTK_SHADOW_NONE
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|,
literal|75
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|vals
operator|->
name|width_spinbutton
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_width_update_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|width_spinbutton
argument_list|)
expr_stmt|;
comment|/* height in pixels spinbutton */
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|vals
operator|->
name|height
argument_list|,
literal|1.0
argument_list|,
literal|32767.0
argument_list|,
literal|1.0
argument_list|,
literal|50.0
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|vals
operator|->
name|height_spinbutton
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|1.0
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_shadow_type
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|,
name|GTK_SHADOW_NONE
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|,
literal|75
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|vals
operator|->
name|height_spinbutton
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_height_update_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|height_spinbutton
argument_list|)
expr_stmt|;
comment|/* width in units spinbutton */
name|temp
operator|=
operator|(
name|float
operator|)
name|vals
operator|->
name|width
operator|/
name|vals
operator|->
name|resolution
operator|*
name|vals
operator|->
name|unit
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|temp
argument_list|,
literal|0.0
argument_list|,
literal|32767.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|vals
operator|->
name|width_units_spinbutton
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|1.0
argument_list|,
literal|2.0
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_update_policy
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|GTK_UPDATE_ALWAYS
operator||
name|GTK_UPDATE_IF_VALID
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_shadow_type
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
name|GTK_SHADOW_NONE
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_snap_to_ticks
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|,
literal|75
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_width_units_update_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|vals
operator|->
name|width_units_spinbutton
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|width_units_spinbutton
argument_list|)
expr_stmt|;
comment|/* height in units spinbutton */
name|temp
operator|=
operator|(
name|float
operator|)
name|vals
operator|->
name|height
operator|/
name|vals
operator|->
name|resolution
operator|*
name|vals
operator|->
name|unit
expr_stmt|;
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|temp
argument_list|,
literal|0.0
argument_list|,
literal|32767.0
argument_list|,
literal|1.0
argument_list|,
literal|0.01
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|vals
operator|->
name|height_units_spinbutton
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|1.0
argument_list|,
literal|2.0
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_update_policy
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|GTK_UPDATE_ALWAYS
operator||
name|GTK_UPDATE_IF_VALID
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_shadow_type
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
name|GTK_SHADOW_NONE
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_snap_to_ticks
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|,
literal|75
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_height_units_update_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|vals
operator|->
name|height_units_spinbutton
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|height_units_spinbutton
argument_list|)
expr_stmt|;
comment|/* Label for right hand side of pixel size boxes */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|"Pixels"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|0.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
comment|/* menu and menu items for the units pop-up menu for the units entries */
name|menu
operator|=
name|gtk_menu_new
argument_list|()
expr_stmt|;
name|menuitem
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|_
argument_list|(
literal|"inches"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|menuitem
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|menuitem
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_units_inch_menu_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|menuitem
argument_list|)
expr_stmt|;
name|menuitem
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|_
argument_list|(
literal|"cm"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|menuitem
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|menuitem
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_units_cm_menu_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|menuitem
argument_list|)
expr_stmt|;
name|optionmenu
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|optionmenu
argument_list|)
argument_list|,
name|menu
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|unit
operator|!=
literal|1.0
condition|)
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|optionmenu
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|optionmenu
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
literal|2
argument_list|,
literal|3
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|optionmenu
argument_list|)
expr_stmt|;
comment|/* resolution frame */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Resolution"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
comment|/* hbox containing the label, the spinbutton, and the optionmenu */
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|hbox
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
comment|/* resoltuion spinbutton  */
name|adj
operator|=
operator|(
name|GtkAdjustment
operator|*
operator|)
name|gtk_adjustment_new
argument_list|(
name|vals
operator|->
name|resolution
operator|/
name|vals
operator|->
name|res_unit
argument_list|,
literal|1.0
argument_list|,
literal|32767.0
argument_list|,
literal|1.0
argument_list|,
literal|5.0
argument_list|,
literal|0.0
argument_list|)
expr_stmt|;
name|vals
operator|->
name|resolution_spinbutton
operator|=
name|gtk_spin_button_new
argument_list|(
name|adj
argument_list|,
literal|1.0
argument_list|,
literal|2.0
argument_list|)
expr_stmt|;
name|gtk_spin_button_set_shadow_type
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|,
name|GTK_SHADOW_NONE
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|,
literal|76
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|vals
operator|->
name|resolution_spinbutton
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
argument_list|,
literal|"changed"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_resolution_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|resolution_spinbutton
argument_list|)
expr_stmt|;
comment|/* resolution label */
name|label
operator|=
name|gtk_label_new
argument_list|(
name|_
argument_list|(
literal|" pixels per  "
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|label
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|menu
operator|=
name|gtk_menu_new
argument_list|()
expr_stmt|;
comment|/* This units stuff doesnt do anything yet. I'm not real sure if it      it should do anything yet, excpet for maybe set some default resolutions      and change the image default rulers. But the rulers stuff probabaly      needs some gtk acking first to really be useful.   */
comment|/* probabaly should be more general here */
name|menuitem
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|_
argument_list|(
literal|"inch"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|menuitem
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|menuitem
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_res_units_inch_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|menuitem
argument_list|)
expr_stmt|;
name|menuitem
operator|=
name|gtk_menu_item_new_with_label
argument_list|(
name|_
argument_list|(
literal|"cm"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|menuitem
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_res_units_cm_callback
argument_list|,
name|vals
argument_list|)
expr_stmt|;
name|gtk_menu_append
argument_list|(
name|GTK_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|menuitem
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|menuitem
argument_list|)
expr_stmt|;
name|optionmenu
operator|=
name|gtk_option_menu_new
argument_list|()
expr_stmt|;
name|gtk_option_menu_set_menu
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|optionmenu
argument_list|)
argument_list|,
name|menu
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|res_unit
operator|!=
literal|1.0
condition|)
name|gtk_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|optionmenu
argument_list|)
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|optionmenu
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|optionmenu
argument_list|)
expr_stmt|;
comment|/* hbox containing thje Image ype and fill type frames */
name|hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|hbox
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|vbox
argument_list|)
argument_list|,
name|hbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|hbox
argument_list|)
expr_stmt|;
comment|/* frame for Image Type */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Image Type"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
comment|/* radio buttons and box */
name|radio_box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|radio_box
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|radio_box
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|radio_box
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|NULL
argument_list|,
name|_
argument_list|(
literal|"RGB"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|RGB
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|type
operator|==
name|RGB
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Grayscale"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|GRAY
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|type
operator|==
name|GRAY
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
comment|/* frame for fill type */
name|frame
operator|=
name|gtk_frame_new
argument_list|(
name|_
argument_list|(
literal|"Fill Type"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|hbox
argument_list|)
argument_list|,
name|frame
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|frame
argument_list|)
expr_stmt|;
name|radio_box
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|radio_box
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|frame
argument_list|)
argument_list|,
name|radio_box
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|radio_box
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|NULL
argument_list|,
name|_
argument_list|(
literal|"Foreground"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|FOREGROUND_FILL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|fill_type
operator|==
name|FOREGROUND_FILL
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Background"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|BACKGROUND_FILL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|fill_type
operator|==
name|BACKGROUND_FILL
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"White"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|WHITE_FILL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|fill_type
operator|==
name|WHITE_FILL
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_radio_button_new_with_label
argument_list|(
name|group
argument_list|,
name|_
argument_list|(
literal|"Transparent"
argument_list|)
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|radio_box
argument_list|)
argument_list|,
name|button
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|TRANSPARENT_FILL
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|file_new_toggle_callback
argument_list|,
operator|&
name|vals
operator|->
name|fill_type
argument_list|)
expr_stmt|;
if|if
condition|(
name|vals
operator|->
name|fill_type
operator|==
name|TRANSPARENT_FILL
condition|)
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|vals
operator|->
name|dlg
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
DECL|function|file_new_reset_current_cut_buffer ()
name|void
name|file_new_reset_current_cut_buffer
parameter_list|()
block|{
comment|/* this unction just changes the status of last_image_new      so i can if theres been a cut/copy since the last file new */
name|last_new_image
operator|=
name|FALSE
expr_stmt|;
block|}
end_function

begin_function
DECL|function|file_new_default_unit_parse (int ruler_unit)
specifier|static
name|float
name|file_new_default_unit_parse
parameter_list|(
name|int
name|ruler_unit
parameter_list|)
block|{
comment|/* checks the enum passed from gimprc to see what the values are */
if|if
condition|(
name|ruler_unit
operator|==
literal|1
condition|)
return|return
literal|1.0
return|;
if|if
condition|(
name|ruler_unit
operator|==
literal|2
condition|)
return|return
literal|2.54
return|;
return|return
literal|1.0
return|;
block|}
end_function

end_unit

