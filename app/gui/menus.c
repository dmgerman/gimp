begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* The GIMP -- an image manipulation program  * Copyright (C) 1995 Spencer Kimball and Peter Mattis  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|"appenv.h"
end_include

begin_include
include|#
directive|include
file|"colormaps.h"
end_include

begin_include
include|#
directive|include
file|"commands.h"
end_include

begin_include
include|#
directive|include
file|"fileops.h"
end_include

begin_include
include|#
directive|include
file|"gimprc.h"
end_include

begin_include
include|#
directive|include
file|"interface.h"
end_include

begin_include
include|#
directive|include
file|"menus.h"
end_include

begin_include
include|#
directive|include
file|"paint_funcs.h"
end_include

begin_include
include|#
directive|include
file|"procedural_db.h"
end_include

begin_include
include|#
directive|include
file|"scale.h"
end_include

begin_include
include|#
directive|include
file|"tools.h"
end_include

begin_include
include|#
directive|include
file|"gdisplay.h"
end_include

begin_function_decl
specifier|static
name|void
name|menus_init
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
DECL|variable|toolbox_entries
specifier|static
name|GtkItemFactoryEntry
name|toolbox_entries
index|[]
init|=
block|{
block|{
literal|"/File/New"
block|,
literal|"<control>N"
block|,
name|file_new_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Open"
block|,
literal|"<control>O"
block|,
name|file_open_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/About..."
block|,
name|NULL
block|,
name|about_dialog_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Preferences..."
block|,
name|NULL
block|,
name|file_pref_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Tip of the day"
block|,
name|NULL
block|,
name|tips_dialog_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/File/Dialogs/Brushes..."
block|,
literal|"<control><shift>B"
block|,
name|dialogs_brushes_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Dialogs/Patterns..."
block|,
literal|"<control><shift>P"
block|,
name|dialogs_patterns_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Dialogs/Palette..."
block|,
literal|"<control>P"
block|,
name|dialogs_palette_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Dialogs/Gradient Editor..."
block|,
literal|"<control>G"
block|,
name|dialogs_gradient_editor_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Dialogs/Tool Options..."
block|,
literal|"<control><shift>T"
block|,
name|dialogs_tools_options_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Dialogs/Input Devices..."
block|,
name|NULL
block|,
name|dialogs_input_devices_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Dialogs/Device Status..."
block|,
name|NULL
block|,
name|dialogs_device_status_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/File/Quit"
block|,
literal|"<control>Q"
block|,
name|file_quit_cmd_callback
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|n_toolbox_entries
specifier|static
name|guint
name|n_toolbox_entries
init|=
sizeof|sizeof
argument_list|(
name|toolbox_entries
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|toolbox_entries
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|toolbox_factory
specifier|static
name|GtkItemFactory
modifier|*
name|toolbox_factory
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|image_entries
specifier|static
name|GtkItemFactoryEntry
name|image_entries
index|[]
init|=
block|{
block|{
literal|"/File/New"
block|,
literal|"<control>N"
block|,
name|file_new_cmd_callback
block|,
literal|1
block|}
block|,
block|{
literal|"/File/Open"
block|,
literal|"<control>O"
block|,
name|file_open_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Save"
block|,
literal|"<control>S"
block|,
name|file_save_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Save as"
block|,
name|NULL
block|,
name|file_save_as_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Preferences..."
block|,
name|NULL
block|,
name|file_pref_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/File/Close"
block|,
literal|"<control>W"
block|,
name|file_close_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/Quit"
block|,
literal|"<control>Q"
block|,
name|file_quit_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/File/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Edit/Cut"
block|,
literal|"<control>X"
block|,
name|edit_cut_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Copy"
block|,
literal|"<control>C"
block|,
name|edit_copy_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Paste"
block|,
literal|"<control>V"
block|,
name|edit_paste_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Paste Into"
block|,
name|NULL
block|,
name|edit_paste_into_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Clear"
block|,
literal|"<control>K"
block|,
name|edit_clear_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Fill"
block|,
literal|"<control>."
block|,
name|edit_fill_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Stroke"
block|,
name|NULL
block|,
name|edit_stroke_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Undo"
block|,
literal|"<control>Z"
block|,
name|edit_undo_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Redo"
block|,
literal|"<control>R"
block|,
name|edit_redo_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Edit/Cut Named"
block|,
literal|"<control><shift>X"
block|,
name|edit_named_cut_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Copy Named"
block|,
literal|"<control><shift>C"
block|,
name|edit_named_copy_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/Paste Named"
block|,
literal|"<control><shift>V"
block|,
name|edit_named_paste_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Edit/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Select/Toggle"
block|,
literal|"<control>T"
block|,
name|select_toggle_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/Invert"
block|,
literal|"<control>I"
block|,
name|select_invert_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/All"
block|,
literal|"<control>A"
block|,
name|select_all_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/None"
block|,
literal|"<control><shift>A"
block|,
name|select_none_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/Float"
block|,
literal|"<control><shift>L"
block|,
name|select_float_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/Sharpen"
block|,
literal|"<control><shift>H"
block|,
name|select_sharpen_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/Border"
block|,
literal|"<control><shift>B"
block|,
name|select_border_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/Feather"
block|,
literal|"<control><shift>F"
block|,
name|select_feather_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/Grow"
block|,
name|NULL
block|,
name|select_grow_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/Shrink"
block|,
name|NULL
block|,
name|select_shrink_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/Save To Channel"
block|,
name|NULL
block|,
name|select_save_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Select/By Color..."
block|,
name|NULL
block|,
name|select_by_color_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom In"
block|,
literal|"equal"
block|,
name|view_zoomin_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom Out"
block|,
literal|"minus"
block|,
name|view_zoomout_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom/16:1"
block|,
name|NULL
block|,
name|view_zoom_16_1_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom/8:1"
block|,
name|NULL
block|,
name|view_zoom_8_1_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom/4:1"
block|,
name|NULL
block|,
name|view_zoom_4_1_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom/2:1"
block|,
name|NULL
block|,
name|view_zoom_2_1_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom/1:1"
block|,
literal|"1"
block|,
name|view_zoom_1_1_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom/1:2"
block|,
name|NULL
block|,
name|view_zoom_1_2_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom/1:4"
block|,
name|NULL
block|,
name|view_zoom_1_4_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom/1:8"
block|,
name|NULL
block|,
name|view_zoom_1_8_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Zoom/1:16"
block|,
name|NULL
block|,
name|view_zoom_1_16_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Window Info..."
block|,
literal|"<control><shift>I"
block|,
name|view_window_info_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Toggle Rulers"
block|,
literal|"<control><shift>R"
block|,
name|view_toggle_rulers_cmd_callback
block|,
literal|0
block|,
literal|"<ToggleItem>"
block|}
block|,
block|{
literal|"/View/Toggle Guides"
block|,
literal|"<control><shift>T"
block|,
name|view_toggle_guides_cmd_callback
block|,
literal|0
block|,
literal|"<ToggleItem>"
block|}
block|,
block|{
literal|"/View/Snap To Guides"
block|,
name|NULL
block|,
name|view_snap_to_guides_cmd_callback
block|,
literal|0
block|,
literal|"<ToggleItem>"
block|}
block|,
block|{
literal|"/View/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/View/New View"
block|,
name|NULL
block|,
name|view_new_view_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/View/Shrink Wrap"
block|,
literal|"<control>E"
block|,
name|view_shrink_wrap_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/Equalize"
block|,
name|NULL
block|,
name|image_equalize_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/Invert"
block|,
name|NULL
block|,
name|image_invert_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/Posterize"
block|,
name|NULL
block|,
name|image_posterize_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/Threshold"
block|,
name|NULL
block|,
name|image_threshold_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Image/Colors/Color Balance"
block|,
name|NULL
block|,
name|image_color_balance_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/Brightness-Contrast"
block|,
name|NULL
block|,
name|image_brightness_contrast_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/Hue-Saturation"
block|,
name|NULL
block|,
name|image_hue_saturation_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/Curves"
block|,
name|NULL
block|,
name|image_curves_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/Levels"
block|,
name|NULL
block|,
name|image_levels_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Colors/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Image/Colors/Desaturate"
block|,
name|NULL
block|,
name|image_desaturate_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Channel Ops/Duplicate"
block|,
literal|"<control>D"
block|,
name|channel_ops_duplicate_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Channel Ops/Offset"
block|,
literal|"<control><shift>O"
block|,
name|channel_ops_offset_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Alpha/Add Alpha Channel"
block|,
name|NULL
block|,
name|layers_add_alpha_channel_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Image/RGB"
block|,
name|NULL
block|,
name|image_convert_rgb_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Grayscale"
block|,
name|NULL
block|,
name|image_convert_grayscale_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Indexed"
block|,
name|NULL
block|,
name|image_convert_indexed_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Image/Resize"
block|,
name|NULL
block|,
name|image_resize_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/Scale"
block|,
name|NULL
block|,
name|image_scale_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Image/Histogram"
block|,
name|NULL
block|,
name|image_histogram_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Image/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Layers/Layers& Channels..."
block|,
literal|"<control>L"
block|,
name|dialogs_lc_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Layers/Raise Layer"
block|,
literal|"<control>F"
block|,
name|layers_raise_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Layers/Lower Layer"
block|,
literal|"<control>B"
block|,
name|layers_lower_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Layers/Anchor Layer"
block|,
literal|"<control>H"
block|,
name|layers_anchor_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Layers/Merge Visible Layers"
block|,
literal|"<control>M"
block|,
name|layers_merge_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Layers/Flatten Image"
block|,
name|NULL
block|,
name|layers_flatten_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Layers/Alpha To Selection"
block|,
name|NULL
block|,
name|layers_alpha_select_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Layers/Mask To Selection"
block|,
name|NULL
block|,
name|layers_mask_select_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Layers/Add Alpha Channel"
block|,
name|NULL
block|,
name|layers_add_alpha_channel_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Tools/Rect Select"
block|,
literal|"R"
block|,
name|tools_select_cmd_callback
block|,
name|RECT_SELECT
block|}
block|,
block|{
literal|"/Tools/Ellipse Select"
block|,
literal|"E"
block|,
name|tools_select_cmd_callback
block|,
name|ELLIPSE_SELECT
block|}
block|,
block|{
literal|"/Tools/Free Select"
block|,
literal|"F"
block|,
name|tools_select_cmd_callback
block|,
name|FREE_SELECT
block|}
block|,
block|{
literal|"/Tools/Fuzzy Select"
block|,
literal|"Z"
block|,
name|tools_select_cmd_callback
block|,
name|FUZZY_SELECT
block|}
block|,
block|{
literal|"/Tools/Bezier Select"
block|,
literal|"B"
block|,
name|tools_select_cmd_callback
block|,
name|BEZIER_SELECT
block|}
block|,
block|{
literal|"/Tools/Intelligent Scissors"
block|,
literal|"I"
block|,
name|tools_select_cmd_callback
block|,
name|ISCISSORS
block|}
block|,
block|{
literal|"/Tools/Move"
block|,
literal|"M"
block|,
name|tools_select_cmd_callback
block|,
name|MOVE
block|}
block|,
block|{
literal|"/Tools/Magnify"
block|,
literal|"<shift>M"
block|,
name|tools_select_cmd_callback
block|,
name|MAGNIFY
block|}
block|,
block|{
literal|"/Tools/Crop"
block|,
literal|"<shift>C"
block|,
name|tools_select_cmd_callback
block|,
name|CROP
block|}
block|,
block|{
literal|"/Tools/Transform"
block|,
literal|"<shift>T"
block|,
name|tools_select_cmd_callback
block|,
name|ROTATE
block|}
block|,
block|{
literal|"/Tools/Flip"
block|,
literal|"<shift>F"
block|,
name|tools_select_cmd_callback
block|,
name|FLIP_HORZ
block|}
block|,
block|{
literal|"/Tools/Text"
block|,
literal|"T"
block|,
name|tools_select_cmd_callback
block|,
name|TEXT
block|}
block|,
block|{
literal|"/Tools/Color Picker"
block|,
literal|"O"
block|,
name|tools_select_cmd_callback
block|,
name|COLOR_PICKER
block|}
block|,
block|{
literal|"/Tools/Bucket Fill"
block|,
literal|"<shift>B"
block|,
name|tools_select_cmd_callback
block|,
name|BUCKET_FILL
block|}
block|,
block|{
literal|"/Tools/Blend"
block|,
literal|"L"
block|,
name|tools_select_cmd_callback
block|,
name|BLEND
block|}
block|,
block|{
literal|"/Tools/Paintbrush"
block|,
literal|"P"
block|,
name|tools_select_cmd_callback
block|,
name|PAINTBRUSH
block|}
block|,
block|{
literal|"/Tools/Pencil"
block|,
literal|"<shift>P"
block|,
name|tools_select_cmd_callback
block|,
name|PENCIL
block|}
block|,
block|{
literal|"/Tools/Eraser"
block|,
literal|"<shift>E"
block|,
name|tools_select_cmd_callback
block|,
name|ERASER
block|}
block|,
block|{
literal|"/Tools/Airbrush"
block|,
literal|"A"
block|,
name|tools_select_cmd_callback
block|,
name|AIRBRUSH
block|}
block|,
block|{
literal|"/Tools/Clone"
block|,
literal|"C"
block|,
name|tools_select_cmd_callback
block|,
name|CLONE
block|}
block|,
block|{
literal|"/Tools/Convolve"
block|,
literal|"V"
block|,
name|tools_select_cmd_callback
block|,
name|CONVOLVE
block|}
block|,
block|{
literal|"/Tools/Ink"
block|,
literal|"K"
block|,
name|tools_select_cmd_callback
block|,
name|INK
block|}
block|,
block|{
literal|"/Tools/Default Colors"
block|,
literal|"D"
block|,
name|tools_default_colors_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Tools/Swap Colors"
block|,
literal|"X"
block|,
name|tools_swap_colors_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Tools/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Tools/Toolbox"
block|,
name|NULL
block|,
name|toolbox_raise_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Filters/"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|}
block|,
block|{
literal|"/Filters/Repeat last"
block|,
literal|"<alt>F"
block|,
name|filters_repeat_cmd_callback
block|,
literal|0x0
block|}
block|,
block|{
literal|"/Filters/Re-show last"
block|,
literal|"<alt><shift>F"
block|,
name|filters_repeat_cmd_callback
block|,
literal|0x1
block|}
block|,
block|{
literal|"/Filters/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|,
block|{
literal|"/Script-Fu/"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|}
block|,
block|{
literal|"/Dialogs/Brushes..."
block|,
literal|"<control><shift>B"
block|,
name|dialogs_brushes_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Dialogs/Patterns..."
block|,
literal|"<control><shift>P"
block|,
name|dialogs_patterns_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Dialogs/Palette..."
block|,
literal|"<control>P"
block|,
name|dialogs_palette_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Dialogs/Gradient Editor..."
block|,
literal|"<control>G"
block|,
name|dialogs_gradient_editor_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Dialogs/Layers& Channels..."
block|,
literal|"<control>L"
block|,
name|dialogs_lc_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Dialogs/Indexed Palette..."
block|,
name|NULL
block|,
name|dialogs_indexed_palette_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Dialogs/Tool Options..."
block|,
name|NULL
block|,
name|dialogs_tools_options_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Dialogs/Input Devices..."
block|,
name|NULL
block|,
name|dialogs_input_devices_cmd_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/Dialogs/Device Status..."
block|,
name|NULL
block|,
name|dialogs_device_status_cmd_callback
block|,
literal|0
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|n_image_entries
specifier|static
name|guint
name|n_image_entries
init|=
sizeof|sizeof
argument_list|(
name|image_entries
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|image_entries
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|image_factory
specifier|static
name|GtkItemFactory
modifier|*
name|image_factory
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|load_entries
specifier|static
name|GtkItemFactoryEntry
name|load_entries
index|[]
init|=
block|{
block|{
literal|"/Automatic"
block|,
name|NULL
block|,
name|file_load_by_extension_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|n_load_entries
specifier|static
name|guint
name|n_load_entries
init|=
sizeof|sizeof
argument_list|(
name|load_entries
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|load_entries
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|load_factory
specifier|static
name|GtkItemFactory
modifier|*
name|load_factory
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|save_entries
specifier|static
name|GtkItemFactoryEntry
name|save_entries
index|[]
init|=
block|{
block|{
literal|"/By extension"
block|,
name|NULL
block|,
name|file_save_by_extension_callback
block|,
literal|0
block|}
block|,
block|{
literal|"/---"
block|,
name|NULL
block|,
name|NULL
block|,
literal|0
block|,
literal|"<Separator>"
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|n_save_entries
specifier|static
name|guint
name|n_save_entries
init|=
sizeof|sizeof
argument_list|(
name|save_entries
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|save_entries
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|save_factory
specifier|static
name|GtkItemFactory
modifier|*
name|save_factory
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|initialize
specifier|static
name|int
name|initialize
init|=
name|TRUE
decl_stmt|;
end_decl_stmt

begin_function
name|void
DECL|function|menus_get_toolbox_menubar (GtkWidget ** menubar,GtkAccelGroup ** accel_group)
name|menus_get_toolbox_menubar
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|menubar
parameter_list|,
name|GtkAccelGroup
modifier|*
modifier|*
name|accel_group
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
if|if
condition|(
name|menubar
condition|)
operator|*
name|menubar
operator|=
name|toolbox_factory
operator|->
name|widget
expr_stmt|;
if|if
condition|(
name|accel_group
condition|)
operator|*
name|accel_group
operator|=
name|toolbox_factory
operator|->
name|accel_group
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_get_image_menu (GtkWidget ** menu,GtkAccelGroup ** accel_group)
name|menus_get_image_menu
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|menu
parameter_list|,
name|GtkAccelGroup
modifier|*
modifier|*
name|accel_group
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
if|if
condition|(
name|menu
condition|)
operator|*
name|menu
operator|=
name|image_factory
operator|->
name|widget
expr_stmt|;
if|if
condition|(
name|accel_group
condition|)
operator|*
name|accel_group
operator|=
name|image_factory
operator|->
name|accel_group
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_get_load_menu (GtkWidget ** menu,GtkAccelGroup ** accel_group)
name|menus_get_load_menu
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|menu
parameter_list|,
name|GtkAccelGroup
modifier|*
modifier|*
name|accel_group
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
if|if
condition|(
name|menu
condition|)
operator|*
name|menu
operator|=
name|load_factory
operator|->
name|widget
expr_stmt|;
if|if
condition|(
name|accel_group
condition|)
operator|*
name|accel_group
operator|=
name|load_factory
operator|->
name|accel_group
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_get_save_menu (GtkWidget ** menu,GtkAccelGroup ** accel_group)
name|menus_get_save_menu
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|menu
parameter_list|,
name|GtkAccelGroup
modifier|*
modifier|*
name|accel_group
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
if|if
condition|(
name|menu
condition|)
operator|*
name|menu
operator|=
name|save_factory
operator|->
name|widget
expr_stmt|;
if|if
condition|(
name|accel_group
condition|)
operator|*
name|accel_group
operator|=
name|save_factory
operator|->
name|accel_group
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_create (GtkMenuEntry * entries,int nmenu_entries)
name|menus_create
parameter_list|(
name|GtkMenuEntry
modifier|*
name|entries
parameter_list|,
name|int
name|nmenu_entries
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
name|gtk_item_factory_create_menu_entries
argument_list|(
name|nmenu_entries
argument_list|,
name|entries
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_set_sensitive (char * path,int sensitive)
name|menus_set_sensitive
parameter_list|(
name|char
modifier|*
name|path
parameter_list|,
name|int
name|sensitive
parameter_list|)
block|{
name|GtkItemFactory
modifier|*
name|ifactory
decl_stmt|;
name|GtkWidget
modifier|*
name|widget
init|=
name|NULL
decl_stmt|;
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
name|ifactory
operator|=
name|gtk_item_factory_from_path
argument_list|(
name|path
argument_list|)
expr_stmt|;
if|if
condition|(
name|ifactory
condition|)
block|{
name|widget
operator|=
name|gtk_item_factory_get_widget
argument_list|(
name|ifactory
argument_list|,
name|path
argument_list|)
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|widget
argument_list|,
name|sensitive
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|ifactory
operator|||
operator|!
name|widget
condition|)
name|printf
argument_list|(
literal|"Unable to set sensitivity for menu which doesn't exist:\n%s"
argument_list|,
name|path
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_set_state (char * path,int state)
name|menus_set_state
parameter_list|(
name|char
modifier|*
name|path
parameter_list|,
name|int
name|state
parameter_list|)
block|{
name|GtkItemFactory
modifier|*
name|ifactory
decl_stmt|;
name|GtkWidget
modifier|*
name|widget
init|=
name|NULL
decl_stmt|;
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
name|ifactory
operator|=
name|gtk_item_factory_from_path
argument_list|(
name|path
argument_list|)
expr_stmt|;
if|if
condition|(
name|ifactory
condition|)
block|{
name|widget
operator|=
name|gtk_item_factory_get_widget
argument_list|(
name|ifactory
argument_list|,
name|path
argument_list|)
expr_stmt|;
if|if
condition|(
name|widget
operator|&&
name|GTK_IS_CHECK_MENU_ITEM
argument_list|(
name|widget
argument_list|)
condition|)
name|gtk_check_menu_item_set_state
argument_list|(
name|GTK_CHECK_MENU_ITEM
argument_list|(
name|widget
argument_list|)
argument_list|,
name|state
argument_list|)
expr_stmt|;
else|else
name|widget
operator|=
name|NULL
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|ifactory
operator|||
operator|!
name|widget
condition|)
name|printf
argument_list|(
literal|"Unable to set state for menu which doesn't exist:\n%s"
argument_list|,
name|path
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_destroy (char * path)
name|menus_destroy
parameter_list|(
name|char
modifier|*
name|path
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
name|gtk_item_factories_path_delete
argument_list|(
name|NULL
argument_list|,
name|path
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_quit ()
name|menus_quit
parameter_list|()
block|{
name|gchar
modifier|*
name|filename
decl_stmt|;
name|filename
operator|=
name|g_strconcat
argument_list|(
name|gimp_directory
argument_list|()
argument_list|,
literal|"/menurc"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_item_factory_dump_rc
argument_list|(
name|filename
argument_list|,
name|NULL
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|filename
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|initialize
condition|)
block|{
name|gtk_object_unref
argument_list|(
name|GTK_OBJECT
argument_list|(
name|toolbox_factory
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_object_unref
argument_list|(
name|GTK_OBJECT
argument_list|(
name|image_factory
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_object_unref
argument_list|(
name|GTK_OBJECT
argument_list|(
name|load_factory
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_object_unref
argument_list|(
name|GTK_OBJECT
argument_list|(
name|save_factory
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|menus_init ()
name|menus_init
parameter_list|()
block|{
if|if
condition|(
name|initialize
condition|)
block|{
name|gchar
modifier|*
name|filename
decl_stmt|;
name|initialize
operator|=
name|FALSE
expr_stmt|;
name|toolbox_factory
operator|=
name|gtk_item_factory_new
argument_list|(
name|GTK_TYPE_MENU_BAR
argument_list|,
literal|"<Toolbox>"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_item_factory_create_items_ac
argument_list|(
name|toolbox_factory
argument_list|,
name|n_toolbox_entries
argument_list|,
name|toolbox_entries
argument_list|,
name|NULL
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|image_factory
operator|=
name|gtk_item_factory_new
argument_list|(
name|GTK_TYPE_MENU
argument_list|,
literal|"<Image>"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_item_factory_create_items_ac
argument_list|(
name|image_factory
argument_list|,
name|n_image_entries
argument_list|,
name|image_entries
argument_list|,
name|NULL
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|load_factory
operator|=
name|gtk_item_factory_new
argument_list|(
name|GTK_TYPE_MENU
argument_list|,
literal|"<Load>"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_item_factory_create_items_ac
argument_list|(
name|load_factory
argument_list|,
name|n_load_entries
argument_list|,
name|load_entries
argument_list|,
name|NULL
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|save_factory
operator|=
name|gtk_item_factory_new
argument_list|(
name|GTK_TYPE_MENU
argument_list|,
literal|"<Save>"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_item_factory_create_items_ac
argument_list|(
name|save_factory
argument_list|,
name|n_save_entries
argument_list|,
name|save_entries
argument_list|,
name|NULL
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|filename
operator|=
name|g_strconcat
argument_list|(
name|gimp_directory
argument_list|()
argument_list|,
literal|"/menurc"
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gtk_item_factory_parse_rc
argument_list|(
name|filename
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|filename
argument_list|)
expr_stmt|;
block|}
block|}
end_function

end_unit

