begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* The GIMP -- an image manipulation program  * Copyright (C) 1995 Spencer Kimball and Peter Mattis  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.  */
end_comment

begin_include
include|#
directive|include
file|<stdio.h>
end_include

begin_include
include|#
directive|include
file|<stdlib.h>
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|"appenv.h"
end_include

begin_include
include|#
directive|include
file|"colormaps.h"
end_include

begin_include
include|#
directive|include
file|"commands.h"
end_include

begin_include
include|#
directive|include
file|"fileops.h"
end_include

begin_include
include|#
directive|include
file|"gimprc.h"
end_include

begin_include
include|#
directive|include
file|"interface.h"
end_include

begin_include
include|#
directive|include
file|"menus.h"
end_include

begin_include
include|#
directive|include
file|"paint_funcs.h"
end_include

begin_include
include|#
directive|include
file|"procedural_db.h"
end_include

begin_include
include|#
directive|include
file|"scale.h"
end_include

begin_include
include|#
directive|include
file|"tools.h"
end_include

begin_include
include|#
directive|include
file|"gdisplay.h"
end_include

begin_function_decl
specifier|static
name|void
name|menus_init
parameter_list|(
name|void
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|menus_foreach
parameter_list|(
name|gpointer
name|key
parameter_list|,
name|gpointer
name|value
parameter_list|,
name|gpointer
name|user_data
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|menus_install_accel
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gchar
modifier|*
name|signal_name
parameter_list|,
name|gchar
name|key
parameter_list|,
name|gchar
name|modifiers
parameter_list|,
name|gchar
modifier|*
name|path
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|menus_remove_accel
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gchar
modifier|*
name|signal_name
parameter_list|,
name|gchar
modifier|*
name|path
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|menus_activate_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkMenuEntry
modifier|*
name|entry
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
DECL|variable|menu_items
specifier|static
name|GtkMenuEntry
name|menu_items
index|[]
init|=
block|{
block|{
literal|"<Toolbox>/File/New"
block|,
literal|"<control>N"
block|,
name|file_new_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/Open"
block|,
literal|"<control>O"
block|,
name|file_open_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/About..."
block|,
name|NULL
block|,
name|about_dialog_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/Preferences..."
block|,
name|NULL
block|,
name|file_pref_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/Tip of the day"
block|,
name|NULL
block|,
name|tips_dialog_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/Dialogs/Brushes..."
block|,
literal|"<control><shift>B"
block|,
name|dialogs_brushes_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/Dialogs/Patterns..."
block|,
literal|"<control><shift>P"
block|,
name|dialogs_patterns_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/Dialogs/Palette..."
block|,
literal|"<control>P"
block|,
name|dialogs_palette_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/Dialogs/Gradient Editor..."
block|,
literal|"<control>G"
block|,
name|dialogs_gradient_editor_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/Dialogs/Tool Options..."
block|,
literal|"<control><shift>T"
block|,
name|dialogs_tools_options_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Toolbox>/File/Quit"
block|,
literal|"<control>Q"
block|,
name|file_quit_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/File/New"
block|,
literal|"<control>N"
block|,
name|file_new_cmd_callback
block|,
operator|(
name|gpointer
operator|)
literal|1
block|}
block|,
block|{
literal|"<Image>/File/Open"
block|,
literal|"<control>O"
block|,
name|file_open_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/File/Save"
block|,
literal|"<control>S"
block|,
name|file_save_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/File/Save as"
block|,
name|NULL
block|,
name|file_save_as_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/File/Preferences..."
block|,
name|NULL
block|,
name|file_pref_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/File/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/File/Close"
block|,
literal|"<control>W"
block|,
name|file_close_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/File/Quit"
block|,
literal|"<control>Q"
block|,
name|file_quit_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/File/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Cut"
block|,
literal|"<control>X"
block|,
name|edit_cut_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Copy"
block|,
literal|"<control>C"
block|,
name|edit_copy_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Paste"
block|,
literal|"<control>V"
block|,
name|edit_paste_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Paste Into"
block|,
name|NULL
block|,
name|edit_paste_into_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Clear"
block|,
literal|"<control>K"
block|,
name|edit_clear_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Fill"
block|,
literal|"<control>."
block|,
name|edit_fill_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Stroke"
block|,
name|NULL
block|,
name|edit_stroke_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Undo"
block|,
literal|"<control>Z"
block|,
name|edit_undo_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Redo"
block|,
literal|"<control>R"
block|,
name|edit_redo_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Cut Named"
block|,
literal|"<control><shift>X"
block|,
name|edit_named_cut_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Copy Named"
block|,
literal|"<control><shift>C"
block|,
name|edit_named_copy_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/Paste Named"
block|,
literal|"<control><shift>V"
block|,
name|edit_named_paste_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Edit/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/Toggle"
block|,
literal|"<control>T"
block|,
name|select_toggle_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/Invert"
block|,
literal|"<control>I"
block|,
name|select_invert_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/All"
block|,
literal|"<control>A"
block|,
name|select_all_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/None"
block|,
literal|"<control><shift>A"
block|,
name|select_none_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/Float"
block|,
literal|"<control><shift>L"
block|,
name|select_float_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/Sharpen"
block|,
literal|"<control><shift>H"
block|,
name|select_sharpen_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/Border"
block|,
literal|"<control><shift>B"
block|,
name|select_border_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/Feather"
block|,
literal|"<control><shift>F"
block|,
name|select_feather_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/Grow"
block|,
name|NULL
block|,
name|select_grow_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/Shrink"
block|,
name|NULL
block|,
name|select_shrink_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/Save To Channel"
block|,
name|NULL
block|,
name|select_save_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Select/By Color..."
block|,
name|NULL
block|,
name|select_by_color_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom In"
block|,
literal|"="
block|,
name|view_zoomin_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom Out"
block|,
literal|"-"
block|,
name|view_zoomout_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom/16:1"
block|,
name|NULL
block|,
name|view_zoom_16_1_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom/8:1"
block|,
name|NULL
block|,
name|view_zoom_8_1_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom/4:1"
block|,
name|NULL
block|,
name|view_zoom_4_1_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom/2:1"
block|,
name|NULL
block|,
name|view_zoom_2_1_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom/1:1"
block|,
literal|"1"
block|,
name|view_zoom_1_1_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom/1:2"
block|,
name|NULL
block|,
name|view_zoom_1_2_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom/1:4"
block|,
name|NULL
block|,
name|view_zoom_1_4_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom/1:8"
block|,
name|NULL
block|,
name|view_zoom_1_8_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Zoom/1:16"
block|,
name|NULL
block|,
name|view_zoom_1_16_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Window Info..."
block|,
literal|"<control><shift>I"
block|,
name|view_window_info_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/<check>Toggle Rulers"
block|,
literal|"<control><shift>R"
block|,
name|view_toggle_rulers_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/<check>Toggle Guides"
block|,
literal|"<control><shift>T"
block|,
name|view_toggle_guides_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/<check>Snap To Guides"
block|,
name|NULL
block|,
name|view_snap_to_guides_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/New View"
block|,
name|NULL
block|,
name|view_new_view_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/View/Shrink Wrap"
block|,
literal|"<control>E"
block|,
name|view_shrink_wrap_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Equalize"
block|,
name|NULL
block|,
name|image_equalize_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Invert"
block|,
name|NULL
block|,
name|image_invert_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Posterize"
block|,
name|NULL
block|,
name|image_posterize_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Threshold"
block|,
name|NULL
block|,
name|image_threshold_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Color Balance"
block|,
name|NULL
block|,
name|image_color_balance_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Brightness-Contrast"
block|,
name|NULL
block|,
name|image_brightness_contrast_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Hue-Saturation"
block|,
name|NULL
block|,
name|image_hue_saturation_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Curves"
block|,
name|NULL
block|,
name|image_curves_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Levels"
block|,
name|NULL
block|,
name|image_levels_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Colors/Desaturate"
block|,
name|NULL
block|,
name|image_desaturate_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Channel Ops/Duplicate"
block|,
literal|"<control>D"
block|,
name|channel_ops_duplicate_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Channel Ops/Offset"
block|,
literal|"<control><shift>O"
block|,
name|channel_ops_offset_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/RGB"
block|,
name|NULL
block|,
name|image_convert_rgb_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Grayscale"
block|,
name|NULL
block|,
name|image_convert_grayscale_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Indexed"
block|,
name|NULL
block|,
name|image_convert_indexed_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Resize"
block|,
name|NULL
block|,
name|image_resize_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Scale"
block|,
name|NULL
block|,
name|image_scale_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/Histogram"
block|,
name|NULL
block|,
name|image_histogram_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Image/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Layers/Layers& Channels..."
block|,
literal|"<control>L"
block|,
name|dialogs_lc_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Layers/Raise Layer"
block|,
literal|"<control>F"
block|,
name|layers_raise_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Layers/Lower Layer"
block|,
literal|"<control>B"
block|,
name|layers_lower_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Layers/Anchor Layer"
block|,
literal|"<control>H"
block|,
name|layers_anchor_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Layers/Merge Visible Layers"
block|,
literal|"<control>M"
block|,
name|layers_merge_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Layers/Flatten Image"
block|,
name|NULL
block|,
name|layers_flatten_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Layers/Alpha To Selection"
block|,
name|NULL
block|,
name|layers_alpha_select_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Layers/Mask To Selection"
block|,
name|NULL
block|,
name|layers_mask_select_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Tools/Rect Select"
block|,
literal|"R"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|RECT_SELECT
block|}
block|,
block|{
literal|"<Image>/Tools/Ellipse Select"
block|,
literal|"E"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|ELLIPSE_SELECT
block|}
block|,
block|{
literal|"<Image>/Tools/Free Select"
block|,
literal|"F"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|FREE_SELECT
block|}
block|,
block|{
literal|"<Image>/Tools/Fuzzy Select"
block|,
literal|"Z"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|FUZZY_SELECT
block|}
block|,
block|{
literal|"<Image>/Tools/Bezier Select"
block|,
literal|"B"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|BEZIER_SELECT
block|}
block|,
block|{
literal|"<Image>/Tools/Intelligent Scissors"
block|,
literal|"I"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|ISCISSORS
block|}
block|,
block|{
literal|"<Image>/Tools/Move"
block|,
literal|"M"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|MOVE
block|}
block|,
block|{
literal|"<Image>/Tools/Magnify"
block|,
literal|"<shift>M"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|MAGNIFY
block|}
block|,
block|{
literal|"<Image>/Tools/Crop"
block|,
literal|"<shift>C"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|CROP
block|}
block|,
block|{
literal|"<Image>/Tools/Transform"
block|,
literal|"<shift>T"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|ROTATE
block|}
block|,
block|{
literal|"<Image>/Tools/Flip"
block|,
literal|"<shift>F"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|FLIP_HORZ
block|}
block|,
block|{
literal|"<Image>/Tools/Text"
block|,
literal|"T"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|TEXT
block|}
block|,
block|{
literal|"<Image>/Tools/Color Picker"
block|,
literal|"O"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|COLOR_PICKER
block|}
block|,
block|{
literal|"<Image>/Tools/Bucket Fill"
block|,
literal|"<shift>B"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|BUCKET_FILL
block|}
block|,
block|{
literal|"<Image>/Tools/Blend"
block|,
literal|"L"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|BLEND
block|}
block|,
block|{
literal|"<Image>/Tools/Paintbrush"
block|,
literal|"P"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|PAINTBRUSH
block|}
block|,
block|{
literal|"<Image>/Tools/Pencil"
block|,
literal|"<shift>P"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|PENCIL
block|}
block|,
block|{
literal|"<Image>/Tools/Eraser"
block|,
literal|"<shift>E"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|ERASER
block|}
block|,
block|{
literal|"<Image>/Tools/Airbrush"
block|,
literal|"A"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|AIRBRUSH
block|}
block|,
block|{
literal|"<Image>/Tools/Clone"
block|,
literal|"C"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|CLONE
block|}
block|,
block|{
literal|"<Image>/Tools/Convolve"
block|,
literal|"V"
block|,
name|tools_select_cmd_callback
block|,
operator|(
name|gpointer
operator|)
name|CONVOLVE
block|}
block|,
block|{
literal|"<Image>/Tools/Default Colors"
block|,
literal|"D"
block|,
name|tools_default_colors_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Tools/Swap Colors"
block|,
literal|"X"
block|,
name|tools_swap_colors_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Tools/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Tools/Toolbox"
block|,
name|NULL
block|,
name|toolbox_raise_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Filters/"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Filters/Repeat last"
block|,
literal|"<alt>F"
block|,
name|filters_repeat_cmd_callback
block|,
operator|(
name|gpointer
operator|)
literal|0x0
block|}
block|,
block|{
literal|"<Image>/Filters/Re-show last"
block|,
literal|"<alt><shift>F"
block|,
name|filters_repeat_cmd_callback
block|,
operator|(
name|gpointer
operator|)
literal|0x1
block|}
block|,
block|{
literal|"<Image>/Filters/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Script-Fu/"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Dialogs/Brushes..."
block|,
literal|"<control><shift>B"
block|,
name|dialogs_brushes_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Dialogs/Patterns..."
block|,
literal|"<control><shift>P"
block|,
name|dialogs_patterns_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Dialogs/Palette..."
block|,
literal|"<control>P"
block|,
name|dialogs_palette_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Dialogs/Gradient Editor..."
block|,
literal|"<control>G"
block|,
name|dialogs_gradient_editor_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Dialogs/Layers& Channels..."
block|,
literal|"<control>L"
block|,
name|dialogs_lc_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Dialogs/Indexed Palette..."
block|,
name|NULL
block|,
name|dialogs_indexed_palette_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Image>/Dialogs/Tool Options..."
block|,
name|NULL
block|,
name|dialogs_tools_options_cmd_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Load>/Automatic"
block|,
name|NULL
block|,
name|file_load_by_extension_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Load>/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|,
block|{
literal|"<Save>/By extension"
block|,
name|NULL
block|,
name|file_save_by_extension_callback
block|,
name|NULL
block|}
block|,
block|{
literal|"<Save>/<separator>"
block|,
name|NULL
block|,
name|NULL
block|,
name|NULL
block|}
block|, }
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|nmenu_items
specifier|static
name|int
name|nmenu_items
init|=
sizeof|sizeof
argument_list|(
name|menu_items
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|menu_items
index|[
literal|0
index|]
argument_list|)
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|initialize
specifier|static
name|int
name|initialize
init|=
name|TRUE
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|factory
specifier|static
name|GtkMenuFactory
modifier|*
name|factory
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|subfactories
specifier|static
name|GtkMenuFactory
modifier|*
name|subfactories
index|[
literal|4
index|]
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|entry_ht
specifier|static
name|GHashTable
modifier|*
name|entry_ht
init|=
name|NULL
decl_stmt|;
end_decl_stmt

begin_function
name|void
DECL|function|menus_get_toolbox_menubar (GtkWidget ** menubar,GtkAcceleratorTable ** table)
name|menus_get_toolbox_menubar
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|menubar
parameter_list|,
name|GtkAcceleratorTable
modifier|*
modifier|*
name|table
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
if|if
condition|(
name|menubar
condition|)
operator|*
name|menubar
operator|=
name|subfactories
index|[
literal|0
index|]
operator|->
name|widget
expr_stmt|;
if|if
condition|(
name|table
condition|)
operator|*
name|table
operator|=
name|subfactories
index|[
literal|0
index|]
operator|->
name|table
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_get_image_menu (GtkWidget ** menu,GtkAcceleratorTable ** table)
name|menus_get_image_menu
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|menu
parameter_list|,
name|GtkAcceleratorTable
modifier|*
modifier|*
name|table
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
if|if
condition|(
name|menu
condition|)
operator|*
name|menu
operator|=
name|subfactories
index|[
literal|1
index|]
operator|->
name|widget
expr_stmt|;
if|if
condition|(
name|table
condition|)
operator|*
name|table
operator|=
name|subfactories
index|[
literal|1
index|]
operator|->
name|table
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_get_load_menu (GtkWidget ** menu,GtkAcceleratorTable ** table)
name|menus_get_load_menu
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|menu
parameter_list|,
name|GtkAcceleratorTable
modifier|*
modifier|*
name|table
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
if|if
condition|(
name|menu
condition|)
operator|*
name|menu
operator|=
name|subfactories
index|[
literal|2
index|]
operator|->
name|widget
expr_stmt|;
if|if
condition|(
name|table
condition|)
operator|*
name|table
operator|=
name|subfactories
index|[
literal|2
index|]
operator|->
name|table
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_get_save_menu (GtkWidget ** menu,GtkAcceleratorTable ** table)
name|menus_get_save_menu
parameter_list|(
name|GtkWidget
modifier|*
modifier|*
name|menu
parameter_list|,
name|GtkAcceleratorTable
modifier|*
modifier|*
name|table
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
if|if
condition|(
name|menu
condition|)
operator|*
name|menu
operator|=
name|subfactories
index|[
literal|3
index|]
operator|->
name|widget
expr_stmt|;
if|if
condition|(
name|table
condition|)
operator|*
name|table
operator|=
name|subfactories
index|[
literal|3
index|]
operator|->
name|table
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_create (GtkMenuEntry * entries,int nmenu_entries)
name|menus_create
parameter_list|(
name|GtkMenuEntry
modifier|*
name|entries
parameter_list|,
name|int
name|nmenu_entries
parameter_list|)
block|{
name|char
modifier|*
name|accelerator
decl_stmt|;
name|int
name|i
decl_stmt|;
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
if|if
condition|(
name|entry_ht
condition|)
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nmenu_entries
condition|;
name|i
operator|++
control|)
block|{
name|accelerator
operator|=
name|g_hash_table_lookup
argument_list|(
name|entry_ht
argument_list|,
name|entries
index|[
name|i
index|]
operator|.
name|path
argument_list|)
expr_stmt|;
if|if
condition|(
name|accelerator
condition|)
block|{
if|if
condition|(
name|accelerator
index|[
literal|0
index|]
operator|==
literal|'\0'
condition|)
name|entries
index|[
name|i
index|]
operator|.
name|accelerator
operator|=
name|NULL
expr_stmt|;
else|else
name|entries
index|[
name|i
index|]
operator|.
name|accelerator
operator|=
name|accelerator
expr_stmt|;
block|}
block|}
name|gtk_menu_factory_add_entries
argument_list|(
name|factory
argument_list|,
name|entries
argument_list|,
name|nmenu_entries
argument_list|)
expr_stmt|;
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
name|nmenu_entries
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|entries
index|[
name|i
index|]
operator|.
name|widget
operator|&&
name|GTK_BIN
argument_list|(
name|entries
index|[
name|i
index|]
operator|.
name|widget
argument_list|)
operator|->
name|child
condition|)
block|{
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entries
index|[
name|i
index|]
operator|.
name|widget
argument_list|)
argument_list|,
literal|"install_accelerator"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|menus_install_accel
argument_list|,
name|entries
index|[
name|i
index|]
operator|.
name|path
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entries
index|[
name|i
index|]
operator|.
name|widget
argument_list|)
argument_list|,
literal|"remove_accelerator"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|menus_remove_accel
argument_list|,
name|entries
index|[
name|i
index|]
operator|.
name|path
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|entries
index|[
name|i
index|]
operator|.
name|widget
argument_list|)
argument_list|,
literal|"activate"
argument_list|,
operator|(
name|GtkSignalFunc
operator|)
name|menus_activate_callback
argument_list|,
operator|&
name|entries
index|[
name|i
index|]
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
name|void
DECL|function|menus_set_sensitive (char * path,int sensitive)
name|menus_set_sensitive
parameter_list|(
name|char
modifier|*
name|path
parameter_list|,
name|int
name|sensitive
parameter_list|)
block|{
name|GtkMenuPath
modifier|*
name|menu_path
decl_stmt|;
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
name|menu_path
operator|=
name|gtk_menu_factory_find
argument_list|(
name|factory
argument_list|,
name|path
argument_list|)
expr_stmt|;
if|if
condition|(
name|menu_path
condition|)
name|gtk_widget_set_sensitive
argument_list|(
name|menu_path
operator|->
name|widget
argument_list|,
name|sensitive
argument_list|)
expr_stmt|;
else|else
name|g_warning
argument_list|(
literal|"Unable to set sensitivity for menu which doesn't exist: %s"
argument_list|,
name|path
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_set_state (char * path,int state)
name|menus_set_state
parameter_list|(
name|char
modifier|*
name|path
parameter_list|,
name|int
name|state
parameter_list|)
block|{
name|GtkMenuPath
modifier|*
name|menu_path
decl_stmt|;
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
name|menu_path
operator|=
name|gtk_menu_factory_find
argument_list|(
name|factory
argument_list|,
name|path
argument_list|)
expr_stmt|;
if|if
condition|(
name|menu_path
condition|)
block|{
if|if
condition|(
name|GTK_IS_CHECK_MENU_ITEM
argument_list|(
name|menu_path
operator|->
name|widget
argument_list|)
condition|)
name|gtk_check_menu_item_set_state
argument_list|(
name|GTK_CHECK_MENU_ITEM
argument_list|(
name|menu_path
operator|->
name|widget
argument_list|)
argument_list|,
name|state
argument_list|)
expr_stmt|;
block|}
else|else
name|g_warning
argument_list|(
literal|"Unable to set state for menu which doesn't exist: %s"
argument_list|,
name|path
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_add_path (char * path,char * accelerator)
name|menus_add_path
parameter_list|(
name|char
modifier|*
name|path
parameter_list|,
name|char
modifier|*
name|accelerator
parameter_list|)
block|{
if|if
condition|(
operator|!
name|entry_ht
condition|)
name|entry_ht
operator|=
name|g_hash_table_new
argument_list|(
name|g_str_hash
argument_list|,
name|g_str_equal
argument_list|)
expr_stmt|;
name|g_hash_table_insert
argument_list|(
name|entry_ht
argument_list|,
name|path
argument_list|,
name|accelerator
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_destroy (char * path)
name|menus_destroy
parameter_list|(
name|char
modifier|*
name|path
parameter_list|)
block|{
if|if
condition|(
name|initialize
condition|)
name|menus_init
argument_list|()
expr_stmt|;
name|gtk_menu_factory_remove_paths
argument_list|(
name|factory
argument_list|,
operator|&
name|path
argument_list|,
literal|1
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
name|void
DECL|function|menus_quit ()
name|menus_quit
parameter_list|()
block|{
name|FILE
modifier|*
name|fp
decl_stmt|;
name|char
name|filename
index|[
literal|512
index|]
decl_stmt|;
name|char
modifier|*
name|gimp_dir
decl_stmt|;
if|if
condition|(
name|entry_ht
condition|)
block|{
name|gimp_dir
operator|=
name|gimp_directory
argument_list|()
expr_stmt|;
if|if
condition|(
literal|'\000'
operator|!=
name|gimp_dir
index|[
literal|0
index|]
condition|)
block|{
name|sprintf
argument_list|(
name|filename
argument_list|,
literal|"%s/menurc"
argument_list|,
name|gimp_dir
argument_list|)
expr_stmt|;
name|fp
operator|=
name|fopen
argument_list|(
name|filename
argument_list|,
literal|"w"
argument_list|)
expr_stmt|;
if|if
condition|(
name|fp
condition|)
block|{
name|g_hash_table_foreach
argument_list|(
name|entry_ht
argument_list|,
name|menus_foreach
argument_list|,
name|fp
argument_list|)
expr_stmt|;
name|fclose
argument_list|(
name|fp
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
operator|!
name|initialize
condition|)
block|{
name|gtk_menu_factory_destroy
argument_list|(
name|factory
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|menus_init ()
name|menus_init
parameter_list|()
block|{
name|char
name|filename
index|[
literal|512
index|]
decl_stmt|;
if|if
condition|(
name|initialize
condition|)
block|{
name|initialize
operator|=
name|FALSE
expr_stmt|;
name|factory
operator|=
name|gtk_menu_factory_new
argument_list|(
name|GTK_MENU_FACTORY_MENU_BAR
argument_list|)
expr_stmt|;
name|subfactories
index|[
literal|0
index|]
operator|=
name|gtk_menu_factory_new
argument_list|(
name|GTK_MENU_FACTORY_MENU_BAR
argument_list|)
expr_stmt|;
name|gtk_menu_factory_add_subfactory
argument_list|(
name|factory
argument_list|,
name|subfactories
index|[
literal|0
index|]
argument_list|,
literal|"<Toolbox>"
argument_list|)
expr_stmt|;
name|subfactories
index|[
literal|1
index|]
operator|=
name|gtk_menu_factory_new
argument_list|(
name|GTK_MENU_FACTORY_MENU
argument_list|)
expr_stmt|;
name|gtk_menu_factory_add_subfactory
argument_list|(
name|factory
argument_list|,
name|subfactories
index|[
literal|1
index|]
argument_list|,
literal|"<Image>"
argument_list|)
expr_stmt|;
name|subfactories
index|[
literal|2
index|]
operator|=
name|gtk_menu_factory_new
argument_list|(
name|GTK_MENU_FACTORY_MENU
argument_list|)
expr_stmt|;
name|gtk_menu_factory_add_subfactory
argument_list|(
name|factory
argument_list|,
name|subfactories
index|[
literal|2
index|]
argument_list|,
literal|"<Load>"
argument_list|)
expr_stmt|;
name|subfactories
index|[
literal|3
index|]
operator|=
name|gtk_menu_factory_new
argument_list|(
name|GTK_MENU_FACTORY_MENU
argument_list|)
expr_stmt|;
name|gtk_menu_factory_add_subfactory
argument_list|(
name|factory
argument_list|,
name|subfactories
index|[
literal|3
index|]
argument_list|,
literal|"<Save>"
argument_list|)
expr_stmt|;
name|sprintf
argument_list|(
name|filename
argument_list|,
literal|"%s/menurc"
argument_list|,
name|gimp_directory
argument_list|()
argument_list|)
expr_stmt|;
name|parse_gimprc_file
argument_list|(
name|filename
argument_list|)
expr_stmt|;
name|menus_create
argument_list|(
name|menu_items
argument_list|,
name|nmenu_items
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|menus_foreach (gpointer key,gpointer value,gpointer user_data)
name|menus_foreach
parameter_list|(
name|gpointer
name|key
parameter_list|,
name|gpointer
name|value
parameter_list|,
name|gpointer
name|user_data
parameter_list|)
block|{
name|char
name|accel
index|[
literal|64
index|]
decl_stmt|;
name|int
name|i
decl_stmt|,
name|j
decl_stmt|;
for|for
control|(
name|i
operator|=
name|j
operator|=
literal|0
init|;
operator|(
operator|(
name|char
operator|*
operator|)
name|value
operator|)
index|[
name|i
index|]
operator|!=
literal|'\0'
condition|;
name|i
operator|++
operator|,
name|j
operator|++
control|)
block|{
if|if
condition|(
operator|(
operator|(
name|char
operator|*
operator|)
name|value
operator|)
index|[
name|i
index|]
operator|==
literal|'"'
operator|||
operator|(
operator|(
name|char
operator|*
operator|)
name|value
operator|)
index|[
name|i
index|]
operator|==
literal|'\\'
condition|)
name|accel
index|[
name|j
operator|++
index|]
operator|=
literal|'\\'
expr_stmt|;
name|accel
index|[
name|j
index|]
operator|=
operator|(
operator|(
name|char
operator|*
operator|)
name|value
operator|)
index|[
name|i
index|]
expr_stmt|;
block|}
name|accel
index|[
name|j
index|]
operator|=
literal|'\0'
expr_stmt|;
name|fprintf
argument_list|(
operator|(
name|FILE
operator|*
operator|)
name|user_data
argument_list|,
literal|"(menu-path \"%s\" \"%s\")\n"
argument_list|,
operator|(
name|char
operator|*
operator|)
name|key
argument_list|,
name|accel
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gint
DECL|function|menus_install_accel (GtkWidget * widget,gchar * signal_name,gchar key,gchar modifiers,gchar * path)
name|menus_install_accel
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gchar
modifier|*
name|signal_name
parameter_list|,
name|gchar
name|key
parameter_list|,
name|gchar
name|modifiers
parameter_list|,
name|gchar
modifier|*
name|path
parameter_list|)
block|{
name|char
name|accel
index|[
literal|64
index|]
decl_stmt|;
name|char
modifier|*
name|t1
decl_stmt|,
name|t2
index|[
literal|2
index|]
decl_stmt|;
name|accel
index|[
literal|0
index|]
operator|=
literal|'\0'
expr_stmt|;
if|if
condition|(
name|modifiers
operator|&
name|GDK_CONTROL_MASK
condition|)
name|strcat
argument_list|(
name|accel
argument_list|,
literal|"<control>"
argument_list|)
expr_stmt|;
if|if
condition|(
name|modifiers
operator|&
name|GDK_SHIFT_MASK
condition|)
name|strcat
argument_list|(
name|accel
argument_list|,
literal|"<shift>"
argument_list|)
expr_stmt|;
if|if
condition|(
name|modifiers
operator|&
name|GDK_MOD1_MASK
condition|)
name|strcat
argument_list|(
name|accel
argument_list|,
literal|"<alt>"
argument_list|)
expr_stmt|;
name|t2
index|[
literal|0
index|]
operator|=
name|key
expr_stmt|;
name|t2
index|[
literal|1
index|]
operator|=
literal|'\0'
expr_stmt|;
name|strcat
argument_list|(
name|accel
argument_list|,
name|t2
argument_list|)
expr_stmt|;
if|if
condition|(
name|entry_ht
condition|)
block|{
name|t1
operator|=
name|g_hash_table_lookup
argument_list|(
name|entry_ht
argument_list|,
name|path
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|t1
argument_list|)
expr_stmt|;
block|}
else|else
name|entry_ht
operator|=
name|g_hash_table_new
argument_list|(
name|g_str_hash
argument_list|,
name|g_str_equal
argument_list|)
expr_stmt|;
name|g_hash_table_insert
argument_list|(
name|entry_ht
argument_list|,
name|path
argument_list|,
name|g_strdup
argument_list|(
name|accel
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|TRUE
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|menus_remove_accel (GtkWidget * widget,gchar * signal_name,gchar * path)
name|menus_remove_accel
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|gchar
modifier|*
name|signal_name
parameter_list|,
name|gchar
modifier|*
name|path
parameter_list|)
block|{
name|char
modifier|*
name|t
decl_stmt|;
if|if
condition|(
name|entry_ht
condition|)
block|{
name|t
operator|=
name|g_hash_table_lookup
argument_list|(
name|entry_ht
argument_list|,
name|path
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|t
argument_list|)
expr_stmt|;
name|g_hash_table_insert
argument_list|(
name|entry_ht
argument_list|,
name|path
argument_list|,
name|g_strdup
argument_list|(
literal|""
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|menus_activate_callback (GtkWidget * widget,GtkMenuEntry * entry)
name|menus_activate_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GtkMenuEntry
modifier|*
name|entry
parameter_list|)
block|{
comment|/* These are the functions upon which we won't destroy the      tool... "safe", so to say. All the others are expected to alter      the image, so the tool must be destroyed */
specifier|const
name|GtkMenuCallback
name|ignore
index|[]
init|=
block|{
name|image_posterize_cmd_callback
block|,
name|image_threshold_cmd_callback
block|,
name|image_color_balance_cmd_callback
block|,
name|image_brightness_contrast_cmd_callback
block|,
name|image_hue_saturation_cmd_callback
block|,
name|image_curves_cmd_callback
block|,
name|image_levels_cmd_callback
block|,
name|image_histogram_cmd_callback
block|,
name|tools_select_cmd_callback
block|,
name|about_dialog_cmd_callback
block|,
name|tips_dialog_cmd_callback
block|,
name|file_new_cmd_callback
block|,
name|file_open_cmd_callback
block|,
name|file_save_cmd_callback
block|,
name|file_save_as_cmd_callback
block|,
name|file_pref_cmd_callback
block|,
name|file_close_cmd_callback
block|,
name|file_quit_cmd_callback
block|,
name|view_zoomin_cmd_callback
block|,
name|view_zoomout_cmd_callback
block|,
name|view_zoom_16_1_callback
block|,
name|view_zoom_8_1_callback
block|,
name|view_zoom_4_1_callback
block|,
name|view_zoom_2_1_callback
block|,
name|view_zoom_1_1_callback
block|,
name|view_zoom_1_2_callback
block|,
name|view_zoom_1_4_callback
block|,
name|view_zoom_1_8_callback
block|,
name|view_zoom_1_16_callback
block|,
name|view_window_info_cmd_callback
block|,
name|view_toggle_rulers_cmd_callback
block|,
name|view_toggle_guides_cmd_callback
block|,
name|view_snap_to_guides_cmd_callback
block|,
name|channel_ops_duplicate_cmd_callback
block|,
name|dialogs_lc_cmd_callback
block|,
name|dialogs_brushes_cmd_callback
block|,
name|dialogs_patterns_cmd_callback
block|,
name|dialogs_palette_cmd_callback
block|,
name|dialogs_gradient_editor_cmd_callback
block|,
name|dialogs_lc_cmd_callback
block|,
name|dialogs_indexed_palette_cmd_callback
block|,
name|dialogs_tools_options_cmd_callback
block|,
name|file_load_by_extension_callback
block|,
name|file_save_by_extension_callback
block|}
decl_stmt|;
name|int
name|i
decl_stmt|;
if|if
condition|(
name|active_tool
condition|)
block|{
for|for
control|(
name|i
operator|=
literal|0
init|;
name|i
operator|<
sizeof|sizeof
argument_list|(
name|ignore
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
operator|*
name|ignore
argument_list|)
condition|;
name|i
operator|++
control|)
if|if
condition|(
name|entry
operator|->
name|callback
operator|==
name|ignore
index|[
name|i
index|]
condition|)
return|return;
if|if
condition|(
name|active_tool
operator|->
name|gdisp_ptr
operator|==
name|NULL
condition|)
name|active_tool_control
argument_list|(
name|RECREATE
argument_list|,
name|active_tool
operator|->
name|gdisp_ptr
argument_list|)
expr_stmt|;
else|else
block|{
name|GDisplay
modifier|*
name|gdisp
decl_stmt|;
name|gdisp
operator|=
name|gdisplay_active
argument_list|()
expr_stmt|;
if|if
condition|(
name|gdisp
operator|==
name|NULL
operator|||
operator|(
operator|(
name|GDisplay
operator|*
operator|)
name|active_tool
operator|->
name|gdisp_ptr
operator|)
operator|->
name|gimage
operator|==
name|gdisp
operator|->
name|gimage
condition|)
name|active_tool_control
argument_list|(
name|RECREATE
argument_list|,
name|active_tool
operator|->
name|gdisp_ptr
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

end_unit

