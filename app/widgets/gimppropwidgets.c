begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* The GIMP -- an image manipulation program  * Copyright (C) 1995-1997 Spencer Kimball and Peter Mattis  *  * gimppropwidgets.c  * Copyright (C) 2002 Michael Natterer<mitch@gimp.org>  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<string.h>
end_include

begin_include
include|#
directive|include
file|<gtk/gtk.h>
end_include

begin_include
include|#
directive|include
file|"libgimpmath/gimpmath.h"
end_include

begin_include
include|#
directive|include
file|"libgimpbase/gimpbase.h"
end_include

begin_include
include|#
directive|include
file|"libgimpwidgets/gimpwidgets.h"
end_include

begin_include
include|#
directive|include
file|"widgets-types.h"
end_include

begin_include
include|#
directive|include
file|"config/gimpconfig-params.h"
end_include

begin_include
include|#
directive|include
file|"config/gimpconfig-path.h"
end_include

begin_include
include|#
directive|include
file|"gimpcolorpanel.h"
end_include

begin_include
include|#
directive|include
file|"gimpenummenu.h"
end_include

begin_include
include|#
directive|include
file|"gimpfontselection.h"
end_include

begin_include
include|#
directive|include
file|"gimppropwidgets.h"
end_include

begin_include
include|#
directive|include
file|"libgimp/gimpintl.h"
end_include

begin_comment
comment|/*  utility function prototypes  */
end_comment

begin_function_decl
specifier|static
name|void
name|set_param_spec
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GParamSpec
modifier|*
name|get_param_spec
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GParamSpec
modifier|*
name|find_param_spec
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|strloc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|GParamSpec
modifier|*
name|check_param_spec
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
name|GType
name|type
parameter_list|,
specifier|const
name|gchar
modifier|*
name|strloc
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|connect_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
name|GCallback
name|callback
parameter_list|,
name|gpointer
name|callback_data
parameter_list|)
function_decl|;
end_function_decl

begin_comment
comment|/******************/
end_comment

begin_comment
comment|/*  check button  */
end_comment

begin_comment
comment|/******************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_check_button_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_check_button_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|button
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_check_button_new (GObject * config,const gchar * property_name,const gchar * label)
name|gimp_prop_check_button_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|label
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|gboolean
name|value
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_TYPE_PARAM_BOOLEAN
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|button
operator|=
name|gtk_check_button_new_with_mnemonic
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
name|button
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"toggled"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_check_button_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_check_button_notify
argument_list|)
argument_list|,
name|button
argument_list|)
expr_stmt|;
return|return
name|button
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_check_button_callback (GtkWidget * widget,GObject * config)
name|gimp_prop_check_button_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|GTK_TOGGLE_BUTTON
argument_list|(
name|widget
argument_list|)
operator|->
name|active
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_check_button_notify (GObject * config,GParamSpec * param_spec,GtkWidget * button)
name|gimp_prop_check_button_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|button
parameter_list|)
block|{
name|gboolean
name|value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
operator|->
name|active
operator|!=
name|value
condition|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|button
argument_list|,
name|gimp_prop_check_button_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|button
argument_list|,
name|gimp_prop_check_button_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/******************/
end_comment

begin_comment
comment|/*  option menus  */
end_comment

begin_comment
comment|/******************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_option_menu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_option_menu_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|menu
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_boolean_option_menu_new (GObject * config,const gchar * property_name,const gchar * true_text,const gchar * false_text)
name|gimp_prop_boolean_option_menu_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|true_text
parameter_list|,
specifier|const
name|gchar
modifier|*
name|false_text
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|optionmenu
decl_stmt|;
name|gboolean
name|value
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_TYPE_PARAM_BOOLEAN
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|optionmenu
operator|=
name|gimp_option_menu_new2
argument_list|(
name|FALSE
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_option_menu_callback
argument_list|)
argument_list|,
name|config
argument_list|,
name|GINT_TO_POINTER
argument_list|(
name|value
argument_list|)
argument_list|,
name|true_text
argument_list|,
name|GINT_TO_POINTER
argument_list|(
name|TRUE
argument_list|)
argument_list|,
name|NULL
argument_list|,
name|false_text
argument_list|,
name|GINT_TO_POINTER
argument_list|(
name|FALSE
argument_list|)
argument_list|,
name|NULL
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|optionmenu
argument_list|)
argument_list|,
name|optionmenu
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_option_menu_notify
argument_list|)
argument_list|,
name|optionmenu
argument_list|)
expr_stmt|;
return|return
name|optionmenu
return|;
block|}
end_function

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_enum_option_menu_new (GObject * config,const gchar * property_name,gint minimum,gint maximum)
name|gimp_prop_enum_option_menu_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
name|gint
name|minimum
parameter_list|,
name|gint
name|maximum
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|optionmenu
decl_stmt|;
name|gint
name|value
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_TYPE_PARAM_ENUM
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|minimum
operator|!=
name|maximum
condition|)
block|{
name|optionmenu
operator|=
name|gimp_enum_option_menu_new_with_range
argument_list|(
name|param_spec
operator|->
name|value_type
argument_list|,
name|minimum
argument_list|,
name|maximum
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_option_menu_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|optionmenu
operator|=
name|gimp_enum_option_menu_new
argument_list|(
name|param_spec
operator|->
name|value_type
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_option_menu_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
name|gimp_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|optionmenu
argument_list|)
argument_list|,
name|GINT_TO_POINTER
argument_list|(
name|value
argument_list|)
argument_list|)
expr_stmt|;
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|optionmenu
argument_list|)
argument_list|,
name|optionmenu
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_option_menu_notify
argument_list|)
argument_list|,
name|optionmenu
argument_list|)
expr_stmt|;
return|return
name|optionmenu
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_option_menu_callback (GtkWidget * widget,GObject * config)
name|gimp_prop_option_menu_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
if|if
condition|(
name|GTK_IS_MENU
argument_list|(
name|widget
operator|->
name|parent
argument_list|)
condition|)
block|{
name|GtkWidget
modifier|*
name|optionmenu
decl_stmt|;
name|optionmenu
operator|=
name|gtk_menu_get_attach_widget
argument_list|(
name|GTK_MENU
argument_list|(
name|widget
operator|->
name|parent
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|optionmenu
condition|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|gint
name|value
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|optionmenu
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
name|value
operator|=
name|GPOINTER_TO_INT
argument_list|(
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|widget
argument_list|)
argument_list|,
literal|"gimp-item-data"
argument_list|)
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_option_menu_notify (GObject * config,GParamSpec * param_spec,GtkWidget * menu)
name|gimp_prop_option_menu_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|menu
parameter_list|)
block|{
name|gint
name|value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|gimp_option_menu_set_history
argument_list|(
name|GTK_OPTION_MENU
argument_list|(
name|menu
argument_list|)
argument_list|,
name|GINT_TO_POINTER
argument_list|(
name|value
argument_list|)
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*****************/
end_comment

begin_comment
comment|/*  adjustments  */
end_comment

begin_comment
comment|/*****************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_adjustment_callback
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_adjustment_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_spin_button_new (GObject * config,const gchar * property_name,gdouble step_increment,gdouble page_increment,gint digits)
name|gimp_prop_spin_button_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
name|gdouble
name|step_increment
parameter_list|,
name|gdouble
name|page_increment
parameter_list|,
name|gint
name|digits
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|spinbutton
decl_stmt|;
name|GtkObject
modifier|*
name|adjustment
decl_stmt|;
name|param_spec
operator|=
name|find_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|G_IS_PARAM_SPEC_INT
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|GParamSpecInt
modifier|*
name|int_spec
decl_stmt|;
name|gint
name|value
decl_stmt|;
name|int_spec
operator|=
name|G_PARAM_SPEC_INT
argument_list|(
name|param_spec
argument_list|)
expr_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adjustment
argument_list|,
name|value
argument_list|,
name|int_spec
operator|->
name|minimum
argument_list|,
name|int_spec
operator|->
name|maximum
argument_list|,
name|step_increment
argument_list|,
name|page_increment
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_UINT
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|GParamSpecUInt
modifier|*
name|uint_spec
decl_stmt|;
name|guint
name|value
decl_stmt|;
name|uint_spec
operator|=
name|G_PARAM_SPEC_UINT
argument_list|(
name|param_spec
argument_list|)
expr_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adjustment
argument_list|,
name|value
argument_list|,
name|uint_spec
operator|->
name|minimum
argument_list|,
name|uint_spec
operator|->
name|maximum
argument_list|,
name|step_increment
argument_list|,
name|page_increment
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_DOUBLE
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|GParamSpecDouble
modifier|*
name|double_spec
decl_stmt|;
name|gdouble
name|value
decl_stmt|;
name|double_spec
operator|=
name|G_PARAM_SPEC_DOUBLE
argument_list|(
name|param_spec
argument_list|)
expr_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_spin_button_new
argument_list|(
operator|&
name|adjustment
argument_list|,
name|value
argument_list|,
name|double_spec
operator|->
name|minimum
argument_list|,
name|double_spec
operator|->
name|maximum
argument_list|,
name|step_increment
argument_list|,
name|page_increment
argument_list|,
literal|0.0
argument_list|,
literal|1.0
argument_list|,
name|digits
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|g_warning
argument_list|(
name|G_STRLOC
literal|": property '%s' of %s is not numeric"
argument_list|,
name|property_name
argument_list|,
name|g_type_name
argument_list|(
name|G_TYPE_FROM_INSTANCE
argument_list|(
name|config
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|adjustment
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_adjustment_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_adjustment_notify
argument_list|)
argument_list|,
name|adjustment
argument_list|)
expr_stmt|;
return|return
name|spinbutton
return|;
block|}
end_function

begin_function
name|void
DECL|function|gimp_prop_scale_entry_new (GObject * config,const gchar * property_name,GtkTable * table,gint column,gint row,const gchar * text,gdouble step_increment,gdouble page_increment,gint digits)
name|gimp_prop_scale_entry_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
name|GtkTable
modifier|*
name|table
parameter_list|,
name|gint
name|column
parameter_list|,
name|gint
name|row
parameter_list|,
specifier|const
name|gchar
modifier|*
name|text
parameter_list|,
name|gdouble
name|step_increment
parameter_list|,
name|gdouble
name|page_increment
parameter_list|,
name|gint
name|digits
parameter_list|)
block|{
name|GtkWidget
modifier|*
name|label
decl_stmt|;
name|GtkWidget
modifier|*
name|scale
decl_stmt|;
name|GtkWidget
modifier|*
name|spinbutton
decl_stmt|;
name|GtkAdjustment
modifier|*
name|adj
decl_stmt|;
name|label
operator|=
name|gtk_label_new_with_mnemonic
argument_list|(
name|text
argument_list|)
expr_stmt|;
name|gtk_misc_set_alignment
argument_list|(
name|GTK_MISC
argument_list|(
name|label
argument_list|)
argument_list|,
literal|1.0
argument_list|,
literal|0.5
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|label
argument_list|,
name|column
argument_list|,
name|column
operator|+
literal|1
argument_list|,
name|row
argument_list|,
name|row
operator|+
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label
argument_list|)
expr_stmt|;
name|spinbutton
operator|=
name|gimp_prop_spin_button_new
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|step_increment
argument_list|,
name|page_increment
argument_list|,
name|digits
argument_list|)
expr_stmt|;
name|gtk_entry_set_width_chars
argument_list|(
name|GTK_ENTRY
argument_list|(
name|spinbutton
argument_list|)
argument_list|,
literal|4
operator|+
name|digits
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|spinbutton
argument_list|,
name|column
operator|+
literal|2
argument_list|,
name|column
operator|+
literal|3
argument_list|,
name|row
argument_list|,
name|row
operator|+
literal|1
argument_list|,
name|GTK_SHRINK
argument_list|,
name|GTK_SHRINK
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|spinbutton
argument_list|)
expr_stmt|;
name|gtk_label_set_mnemonic_widget
argument_list|(
name|GTK_LABEL
argument_list|(
name|label
argument_list|)
argument_list|,
name|spinbutton
argument_list|)
expr_stmt|;
name|adj
operator|=
name|gtk_spin_button_get_adjustment
argument_list|(
name|GTK_SPIN_BUTTON
argument_list|(
name|spinbutton
argument_list|)
argument_list|)
expr_stmt|;
name|scale
operator|=
name|gtk_hscale_new
argument_list|(
name|adj
argument_list|)
expr_stmt|;
name|gtk_scale_set_digits
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|digits
argument_list|)
expr_stmt|;
name|gtk_scale_set_draw_value
argument_list|(
name|GTK_SCALE
argument_list|(
name|scale
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|table
argument_list|)
argument_list|,
name|scale
argument_list|,
name|column
operator|+
literal|1
argument_list|,
name|column
operator|+
literal|2
argument_list|,
name|row
argument_list|,
name|row
operator|+
literal|1
argument_list|,
name|GTK_FILL
operator||
name|GTK_EXPAND
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|scale
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_adjustment_callback (GtkAdjustment * adjustment,GObject * config)
name|gimp_prop_adjustment_callback
parameter_list|(
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|adjustment
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
if|if
condition|(
name|G_IS_PARAM_SPEC_INT
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|(
name|gint
operator|)
name|adjustment
operator|->
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_UINT
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|(
name|guint
operator|)
name|adjustment
operator|->
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_LONG
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|(
name|glong
operator|)
name|adjustment
operator|->
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_ULONG
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|(
name|gulong
operator|)
name|adjustment
operator|->
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_DOUBLE
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|adjustment
operator|->
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_adjustment_notify (GObject * config,GParamSpec * param_spec,GtkAdjustment * adjustment)
name|gimp_prop_adjustment_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkAdjustment
modifier|*
name|adjustment
parameter_list|)
block|{
name|gdouble
name|value
decl_stmt|;
if|if
condition|(
name|G_IS_PARAM_SPEC_INT
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|gint
name|int_value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|int_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|value
operator|=
name|int_value
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_UINT
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|guint
name|uint_value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|uint_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|value
operator|=
name|uint_value
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_LONG
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|glong
name|long_value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|long_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|value
operator|=
name|long_value
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_ULONG
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|gulong
name|ulong_value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|ulong_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|value
operator|=
name|ulong_value
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_DOUBLE
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
else|else
block|{
return|return;
block|}
if|if
condition|(
name|adjustment
operator|->
name|value
operator|!=
name|value
condition|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|adjustment
argument_list|,
name|gimp_prop_adjustment_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gtk_adjustment_set_value
argument_list|(
name|adjustment
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|adjustment
argument_list|,
name|gimp_prop_adjustment_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/*************/
end_comment

begin_comment
comment|/*  memsize  */
end_comment

begin_comment
comment|/*************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_memsize_callback
parameter_list|(
name|GimpMemsizeEntry
modifier|*
name|entry
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_memsize_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpMemsizeEntry
modifier|*
name|entry
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_memsize_entry_new (GObject * config,const gchar * property_name)
name|gimp_prop_memsize_entry_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GParamSpecULong
modifier|*
name|ulong_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|gulong
name|value
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|GIMP_TYPE_PARAM_MEMSIZE
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|ulong_spec
operator|=
name|G_PARAM_SPEC_ULONG
argument_list|(
name|param_spec
argument_list|)
expr_stmt|;
name|entry
operator|=
name|gimp_memsize_entry_new
argument_list|(
name|value
argument_list|,
name|ulong_spec
operator|->
name|minimum
argument_list|,
name|ulong_spec
operator|->
name|maximum
argument_list|)
expr_stmt|;
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
name|GIMP_MEMSIZE_ENTRY
argument_list|(
name|entry
argument_list|)
operator|->
name|spinbutton
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|entry
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_memsize_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_memsize_notify
argument_list|)
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
name|entry
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_memsize_callback (GimpMemsizeEntry * entry,GObject * config)
name|gimp_prop_memsize_callback
parameter_list|(
name|GimpMemsizeEntry
modifier|*
name|entry
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
name|g_return_if_fail
argument_list|(
name|G_IS_PARAM_SPEC_ULONG
argument_list|(
name|param_spec
argument_list|)
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|gimp_memsize_entry_get_value
argument_list|(
name|entry
argument_list|)
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_memsize_notify (GObject * config,GParamSpec * param_spec,GimpMemsizeEntry * entry)
name|gimp_prop_memsize_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpMemsizeEntry
modifier|*
name|entry
parameter_list|)
block|{
name|gulong
name|value
decl_stmt|;
name|g_return_if_fail
argument_list|(
name|G_IS_PARAM_SPEC_ULONG
argument_list|(
name|param_spec
argument_list|)
argument_list|)
expr_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|entry
operator|->
name|value
operator|!=
name|value
condition|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|entry
argument_list|,
name|gimp_prop_memsize_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gimp_memsize_entry_set_value
argument_list|(
name|entry
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|entry
argument_list|,
name|gimp_prop_memsize_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/***********/
end_comment

begin_comment
comment|/*  entry  */
end_comment

begin_comment
comment|/***********/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_entry_callback
parameter_list|(
name|GtkWidget
modifier|*
name|entry
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_entry_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|entry
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_entry_new (GObject * config,const gchar * property_name,gint max_len)
name|gimp_prop_entry_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
name|gint
name|max_len
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|gchar
modifier|*
name|value
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_TYPE_PARAM_STRING
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|entry
operator|=
name|gtk_entry_new
argument_list|()
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|max_len
operator|>
literal|0
condition|)
name|gtk_entry_set_max_length
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|max_len
argument_list|)
expr_stmt|;
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
name|entry
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|entry
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_entry_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_entry_notify
argument_list|)
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
name|entry
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_entry_callback (GtkWidget * entry,GObject * config)
name|gimp_prop_entry_callback
parameter_list|(
name|GtkWidget
modifier|*
name|entry
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
specifier|const
name|gchar
modifier|*
name|text
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
name|text
operator|=
name|gtk_entry_get_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|config
argument_list|,
name|gimp_prop_entry_notify
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|text
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|config
argument_list|,
name|gimp_prop_entry_notify
argument_list|,
name|entry
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_entry_notify (GObject * config,GParamSpec * param_spec,GtkWidget * entry)
name|gimp_prop_entry_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|entry
parameter_list|)
block|{
name|gchar
modifier|*
name|value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|entry
argument_list|,
name|gimp_prop_entry_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gtk_entry_set_text
argument_list|(
name|GTK_ENTRY
argument_list|(
name|entry
argument_list|)
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|entry
argument_list|,
name|gimp_prop_entry_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*****************/
end_comment

begin_comment
comment|/*  text buffer  */
end_comment

begin_comment
comment|/*****************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_text_buffer_callback
parameter_list|(
name|GtkTextBuffer
modifier|*
name|text_buffer
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_text_buffer_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkTextBuffer
modifier|*
name|text_buffer
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkTextBuffer
modifier|*
DECL|function|gimp_prop_text_buffer_new (GObject * config,const gchar * property_name,gint max_len)
name|gimp_prop_text_buffer_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
name|gint
name|max_len
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkTextBuffer
modifier|*
name|text_buffer
decl_stmt|;
name|gchar
modifier|*
name|value
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_TYPE_PARAM_STRING
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|text_buffer
operator|=
name|gtk_text_buffer_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_text_buffer_set_text
argument_list|(
name|text_buffer
argument_list|,
name|value
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
if|if
condition|(
name|max_len
operator|>
literal|0
condition|)
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|text_buffer
argument_list|)
argument_list|,
literal|"max-len"
argument_list|,
name|GINT_TO_POINTER
argument_list|(
name|max_len
argument_list|)
argument_list|)
expr_stmt|;
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|text_buffer
argument_list|)
argument_list|,
name|NULL
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|text_buffer
argument_list|,
literal|"changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_text_buffer_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_text_buffer_notify
argument_list|)
argument_list|,
name|text_buffer
argument_list|)
expr_stmt|;
return|return
name|text_buffer
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_text_buffer_callback (GtkTextBuffer * text_buffer,GObject * config)
name|gimp_prop_text_buffer_callback
parameter_list|(
name|GtkTextBuffer
modifier|*
name|text_buffer
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkTextIter
name|start_iter
decl_stmt|;
name|GtkTextIter
name|end_iter
decl_stmt|;
name|gchar
modifier|*
name|text
decl_stmt|;
name|gint
name|max_len
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|text_buffer
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
name|gtk_text_buffer_get_bounds
argument_list|(
name|text_buffer
argument_list|,
operator|&
name|start_iter
argument_list|,
operator|&
name|end_iter
argument_list|)
expr_stmt|;
name|text
operator|=
name|gtk_text_buffer_get_text
argument_list|(
name|text_buffer
argument_list|,
operator|&
name|start_iter
argument_list|,
operator|&
name|end_iter
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|max_len
operator|=
name|GPOINTER_TO_INT
argument_list|(
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|text_buffer
argument_list|)
argument_list|,
literal|"max-length"
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|max_len
operator|>
literal|0
operator|&&
name|strlen
argument_list|(
name|text
argument_list|)
operator|>
name|max_len
condition|)
block|{
name|g_message
argument_list|(
name|_
argument_list|(
literal|"This text input field is limited to %d characters."
argument_list|)
argument_list|,
name|max_len
argument_list|)
expr_stmt|;
name|gtk_text_buffer_get_iter_at_offset
argument_list|(
name|text_buffer
argument_list|,
operator|&
name|start_iter
argument_list|,
name|max_len
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gtk_text_buffer_get_end_iter
argument_list|(
name|text_buffer
argument_list|,
operator|&
name|end_iter
argument_list|)
expr_stmt|;
comment|/*  this calls us recursivaly, but in the else branch  */
name|gtk_text_buffer_delete
argument_list|(
name|text_buffer
argument_list|,
operator|&
name|start_iter
argument_list|,
operator|&
name|end_iter
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|config
argument_list|,
name|gimp_prop_text_buffer_notify
argument_list|,
name|text_buffer
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|text
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|config
argument_list|,
name|gimp_prop_text_buffer_notify
argument_list|,
name|text_buffer
argument_list|)
expr_stmt|;
block|}
name|g_free
argument_list|(
name|text
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_text_buffer_notify (GObject * config,GParamSpec * param_spec,GtkTextBuffer * text_buffer)
name|gimp_prop_text_buffer_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkTextBuffer
modifier|*
name|text_buffer
parameter_list|)
block|{
name|gchar
modifier|*
name|value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|text_buffer
argument_list|,
name|gimp_prop_text_buffer_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gtk_text_buffer_set_text
argument_list|(
name|text_buffer
argument_list|,
name|value
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|text_buffer
argument_list|,
name|gimp_prop_text_buffer_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/********************/
end_comment

begin_comment
comment|/*  font selection  */
end_comment

begin_comment
comment|/********************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_fontsel_callback
parameter_list|(
name|GtkWidget
modifier|*
name|fontsel
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_fontsel_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|fontsel
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_font_selection_new (GObject * config,const gchar * property_name)
name|gimp_prop_font_selection_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|fontsel
decl_stmt|;
name|gchar
modifier|*
name|value
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_TYPE_PARAM_STRING
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|fontsel
operator|=
name|gimp_font_selection_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
condition|)
block|{
name|gimp_font_selection_set_fontname
argument_list|(
name|GIMP_FONT_SELECTION
argument_list|(
name|fontsel
argument_list|)
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|fontsel
argument_list|)
argument_list|,
name|GIMP_FONT_SELECTION
argument_list|(
name|fontsel
argument_list|)
operator|->
name|entry
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|fontsel
argument_list|,
literal|"font_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_fontsel_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_fontsel_notify
argument_list|)
argument_list|,
name|fontsel
argument_list|)
expr_stmt|;
return|return
name|fontsel
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_fontsel_callback (GtkWidget * fontsel,GObject * config)
name|gimp_prop_fontsel_callback
parameter_list|(
name|GtkWidget
modifier|*
name|fontsel
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
specifier|const
name|gchar
modifier|*
name|name
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|fontsel
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
name|name
operator|=
name|gimp_font_selection_get_fontname
argument_list|(
name|GIMP_FONT_SELECTION
argument_list|(
name|fontsel
argument_list|)
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|config
argument_list|,
name|gimp_prop_fontsel_notify
argument_list|,
name|fontsel
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|name
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|config
argument_list|,
name|gimp_prop_fontsel_notify
argument_list|,
name|fontsel
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_fontsel_notify (GObject * config,GParamSpec * param_spec,GtkWidget * fontsel)
name|gimp_prop_fontsel_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|fontsel
parameter_list|)
block|{
name|gchar
modifier|*
name|value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|fontsel
argument_list|,
name|gimp_prop_fontsel_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gimp_font_selection_set_fontname
argument_list|(
name|GIMP_FONT_SELECTION
argument_list|(
name|fontsel
argument_list|)
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|fontsel
argument_list|,
name|gimp_prop_fontsel_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/****************/
end_comment

begin_comment
comment|/*  file entry  */
end_comment

begin_comment
comment|/****************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_file_entry_callback
parameter_list|(
name|GimpFileSelection
modifier|*
name|entry
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_file_entry_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpFileSelection
modifier|*
name|entry
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_file_entry_new (GObject * config,const gchar * property_name,const gchar * filesel_title,gboolean dir_only,gboolean check_valid)
name|gimp_prop_file_entry_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|filesel_title
parameter_list|,
name|gboolean
name|dir_only
parameter_list|,
name|gboolean
name|check_valid
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|entry
decl_stmt|;
name|gchar
modifier|*
name|filename
decl_stmt|;
name|gchar
modifier|*
name|value
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|GIMP_TYPE_PARAM_PATH
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|filename
operator|=
name|value
condition|?
name|gimp_config_path_expand
argument_list|(
name|value
argument_list|,
name|FALSE
argument_list|,
name|NULL
argument_list|)
else|:
name|NULL
expr_stmt|;
name|entry
operator|=
name|gimp_file_selection_new
argument_list|(
name|filesel_title
argument_list|,
name|filename
argument_list|,
name|dir_only
argument_list|,
name|check_valid
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|filename
argument_list|)
expr_stmt|;
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|,
name|GIMP_FILE_SELECTION
argument_list|(
name|entry
argument_list|)
operator|->
name|entry
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|entry
argument_list|,
literal|"filename_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_file_entry_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_file_entry_notify
argument_list|)
argument_list|,
name|entry
argument_list|)
expr_stmt|;
return|return
name|entry
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_file_entry_callback (GimpFileSelection * entry,GObject * config)
name|gimp_prop_file_entry_callback
parameter_list|(
name|GimpFileSelection
modifier|*
name|entry
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|gchar
modifier|*
name|value
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|entry
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
name|value
operator|=
name|gimp_file_selection_get_filename
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_file_entry_notify (GObject * config,GParamSpec * param_spec,GimpFileSelection * entry)
name|gimp_prop_file_entry_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpFileSelection
modifier|*
name|entry
parameter_list|)
block|{
name|gchar
modifier|*
name|value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|entry
argument_list|,
name|gimp_prop_file_entry_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gimp_file_selection_set_filename
argument_list|(
name|entry
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|entry
argument_list|,
name|gimp_prop_file_entry_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*****************/
end_comment

begin_comment
comment|/*  path editor  */
end_comment

begin_comment
comment|/*****************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_path_editor_callback
parameter_list|(
name|GimpPathEditor
modifier|*
name|editor
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_path_editor_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpPathEditor
modifier|*
name|editor
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_path_editor_new (GObject * config,const gchar * property_name,const gchar * filesel_title)
name|gimp_prop_path_editor_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|filesel_title
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|editor
decl_stmt|;
name|gchar
modifier|*
name|value
decl_stmt|;
name|gchar
modifier|*
name|filename
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|GIMP_TYPE_PARAM_PATH
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|filename
operator|=
name|value
condition|?
name|gimp_config_path_expand
argument_list|(
name|value
argument_list|,
name|FALSE
argument_list|,
name|NULL
argument_list|)
else|:
name|NULL
expr_stmt|;
name|editor
operator|=
name|gimp_path_editor_new
argument_list|(
name|filesel_title
argument_list|,
name|filename
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|filename
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|editor
argument_list|)
argument_list|,
name|NULL
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|editor
argument_list|,
literal|"path_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_path_editor_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_path_editor_notify
argument_list|)
argument_list|,
name|editor
argument_list|)
expr_stmt|;
return|return
name|editor
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_path_editor_callback (GimpPathEditor * editor,GObject * config)
name|gimp_prop_path_editor_callback
parameter_list|(
name|GimpPathEditor
modifier|*
name|editor
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|gchar
modifier|*
name|value
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|editor
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
name|value
operator|=
name|gimp_path_editor_get_path
argument_list|(
name|editor
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_path_editor_notify (GObject * config,GParamSpec * param_spec,GimpPathEditor * editor)
name|gimp_prop_path_editor_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpPathEditor
modifier|*
name|editor
parameter_list|)
block|{
name|gchar
modifier|*
name|value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|editor
argument_list|,
name|gimp_prop_path_editor_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gimp_path_editor_set_path
argument_list|(
name|editor
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|editor
argument_list|,
name|gimp_prop_path_editor_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*****************/
end_comment

begin_comment
comment|/*  coordinates  */
end_comment

begin_comment
comment|/*****************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_coordinates_callback
parameter_list|(
name|GimpSizeEntry
modifier|*
name|sizeentry
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_coordinates_notify_x
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpSizeEntry
modifier|*
name|sizeentry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_coordinates_notify_y
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpSizeEntry
modifier|*
name|sizeentry
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_coordinates_notify_unit
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpSizeEntry
modifier|*
name|sizeentry
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_coordinates_new (GObject * config,const gchar * x_property_name,const gchar * y_property_name,const gchar * unit_property_name,const gchar * unit_format,GimpSizeEntryUpdatePolicy update_policy,gdouble xresolution,gdouble yresolution,gboolean has_chainbutton)
name|gimp_prop_coordinates_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|x_property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|y_property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|unit_property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|unit_format
parameter_list|,
name|GimpSizeEntryUpdatePolicy
name|update_policy
parameter_list|,
name|gdouble
name|xresolution
parameter_list|,
name|gdouble
name|yresolution
parameter_list|,
name|gboolean
name|has_chainbutton
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|x_param_spec
decl_stmt|;
name|GParamSpec
modifier|*
name|y_param_spec
decl_stmt|;
name|GParamSpec
modifier|*
name|unit_param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|sizeentry
decl_stmt|;
name|gdouble
name|x_value
decl_stmt|;
name|gdouble
name|y_value
decl_stmt|;
name|GimpUnit
name|unit_value
decl_stmt|;
name|gboolean
name|chain_checked
init|=
name|FALSE
decl_stmt|;
name|x_param_spec
operator|=
name|find_param_spec
argument_list|(
name|config
argument_list|,
name|x_property_name
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|x_param_spec
condition|)
return|return
name|NULL
return|;
name|y_param_spec
operator|=
name|find_param_spec
argument_list|(
name|config
argument_list|,
name|y_property_name
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|y_param_spec
condition|)
return|return
name|NULL
return|;
if|if
condition|(
name|unit_property_name
condition|)
block|{
name|unit_param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|unit_property_name
argument_list|,
name|GIMP_TYPE_PARAM_UNIT
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|unit_param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|unit_property_name
argument_list|,
operator|&
name|unit_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|unit_param_spec
operator|=
name|NULL
expr_stmt|;
name|unit_value
operator|=
name|GIMP_UNIT_INCH
expr_stmt|;
block|}
if|if
condition|(
name|G_IS_PARAM_SPEC_INT
argument_list|(
name|x_param_spec
argument_list|)
operator|&&
name|G_IS_PARAM_SPEC_INT
argument_list|(
name|y_param_spec
argument_list|)
condition|)
block|{
name|gint
name|int_x
decl_stmt|;
name|gint
name|int_y
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|x_property_name
argument_list|,
operator|&
name|int_x
argument_list|,
name|y_property_name
argument_list|,
operator|&
name|int_y
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|x_value
operator|=
name|int_x
expr_stmt|;
name|y_value
operator|=
name|int_y
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_DOUBLE
argument_list|(
name|x_param_spec
argument_list|)
operator|&&
name|G_IS_PARAM_SPEC_DOUBLE
argument_list|(
name|y_param_spec
argument_list|)
condition|)
block|{
name|g_object_get
argument_list|(
name|config
argument_list|,
name|x_property_name
argument_list|,
operator|&
name|x_value
argument_list|,
name|y_property_name
argument_list|,
operator|&
name|y_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|g_warning
argument_list|(
name|G_STRLOC
literal|": properties '%s' and '%s' of %s are not either "
literal|" both int or both double"
argument_list|,
name|x_property_name
argument_list|,
name|y_property_name
argument_list|,
name|g_type_name
argument_list|(
name|G_TYPE_FROM_INSTANCE
argument_list|(
name|config
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
name|sizeentry
operator|=
name|gimp_size_entry_new
argument_list|(
literal|2
argument_list|,
name|unit_value
argument_list|,
name|unit_format
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
name|TRUE
argument_list|,
literal|10
argument_list|,
name|update_policy
argument_list|)
expr_stmt|;
switch|switch
condition|(
name|update_policy
condition|)
block|{
case|case
name|GIMP_SIZE_ENTRY_UPDATE_SIZE
case|:
name|gimp_size_entry_set_resolution
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|xresolution
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_resolution
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|yresolution
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval_boundaries
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|GIMP_MIN_IMAGE_SIZE
argument_list|,
name|GIMP_MAX_IMAGE_SIZE
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval_boundaries
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|GIMP_MIN_IMAGE_SIZE
argument_list|,
name|GIMP_MAX_IMAGE_SIZE
argument_list|)
expr_stmt|;
if|if
condition|(
name|ABS
argument_list|(
name|x_value
operator|-
name|y_value
argument_list|)
operator|<
literal|1
condition|)
name|chain_checked
operator|=
name|TRUE
expr_stmt|;
break|break;
case|case
name|GIMP_SIZE_ENTRY_UPDATE_RESOLUTION
case|:
name|gimp_size_entry_set_refval_boundaries
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|GIMP_MIN_RESOLUTION
argument_list|,
name|GIMP_MAX_RESOLUTION
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval_boundaries
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|GIMP_MIN_RESOLUTION
argument_list|,
name|GIMP_MAX_RESOLUTION
argument_list|)
expr_stmt|;
if|if
condition|(
name|ABS
argument_list|(
name|x_value
operator|-
name|y_value
argument_list|)
operator|<
name|GIMP_MIN_RESOLUTION
condition|)
name|chain_checked
operator|=
name|TRUE
expr_stmt|;
break|break;
default|default:
break|break;
block|}
name|gimp_size_entry_set_unit
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
name|unit_value
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|x_value
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|y_value
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"gimp-config-param-spec-x"
argument_list|,
name|x_param_spec
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"gimp-config-param-spec-y"
argument_list|,
name|y_param_spec
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"gimp-config-param-spec-unit"
argument_list|,
name|unit_param_spec
argument_list|)
expr_stmt|;
if|if
condition|(
name|has_chainbutton
condition|)
block|{
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|button
operator|=
name|gimp_chain_button_new
argument_list|(
name|GIMP_CHAIN_BOTTOM
argument_list|)
expr_stmt|;
if|if
condition|(
name|chain_checked
condition|)
name|gimp_chain_button_set_active
argument_list|(
name|GIMP_CHAIN_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_table_attach_defaults
argument_list|(
name|GTK_TABLE
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
name|button
argument_list|,
literal|1
argument_list|,
literal|3
argument_list|,
literal|3
argument_list|,
literal|4
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|button
argument_list|)
expr_stmt|;
name|g_object_set_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"chainbutton"
argument_list|,
name|button
argument_list|)
expr_stmt|;
block|}
name|g_signal_connect
argument_list|(
name|sizeentry
argument_list|,
literal|"value_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_coordinates_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|sizeentry
argument_list|,
literal|"refval_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_coordinates_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
if|if
condition|(
name|unit_property_name
condition|)
block|{
name|g_signal_connect
argument_list|(
name|sizeentry
argument_list|,
literal|"unit_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_coordinates_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
name|connect_notify
argument_list|(
name|config
argument_list|,
name|x_property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_coordinates_notify_x
argument_list|)
argument_list|,
name|sizeentry
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|y_property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_coordinates_notify_y
argument_list|)
argument_list|,
name|sizeentry
argument_list|)
expr_stmt|;
if|if
condition|(
name|unit_property_name
condition|)
block|{
name|connect_notify
argument_list|(
name|config
argument_list|,
name|unit_property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_coordinates_notify_unit
argument_list|)
argument_list|,
name|sizeentry
argument_list|)
expr_stmt|;
block|}
return|return
name|sizeentry
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_coordinates_callback (GimpSizeEntry * sizeentry,GObject * config)
name|gimp_prop_coordinates_callback
parameter_list|(
name|GimpSizeEntry
modifier|*
name|sizeentry
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|x_param_spec
decl_stmt|;
name|GParamSpec
modifier|*
name|y_param_spec
decl_stmt|;
name|GParamSpec
modifier|*
name|unit_param_spec
decl_stmt|;
name|gdouble
name|x_value
decl_stmt|;
name|gdouble
name|y_value
decl_stmt|;
name|GimpUnit
name|unit_value
decl_stmt|;
name|gdouble
modifier|*
name|old_x_value
decl_stmt|;
name|gdouble
modifier|*
name|old_y_value
decl_stmt|;
name|x_param_spec
operator|=
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"gimp-config-param-spec-x"
argument_list|)
expr_stmt|;
name|y_param_spec
operator|=
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"gimp-config-param-spec-y"
argument_list|)
expr_stmt|;
name|unit_param_spec
operator|=
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"gimp-config-param-spec-unit"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|x_param_spec
operator|||
operator|!
name|y_param_spec
condition|)
return|return;
name|x_value
operator|=
name|gimp_size_entry_get_refval
argument_list|(
name|sizeentry
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|y_value
operator|=
name|gimp_size_entry_get_refval
argument_list|(
name|sizeentry
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|unit_value
operator|=
name|gimp_size_entry_get_unit
argument_list|(
name|sizeentry
argument_list|)
expr_stmt|;
name|old_x_value
operator|=
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"old-x-value"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|old_x_value
condition|)
block|{
name|old_x_value
operator|=
name|g_new0
argument_list|(
name|gdouble
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|*
name|old_x_value
operator|=
literal|0.0
expr_stmt|;
name|g_object_set_data_full
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"old-x-value"
argument_list|,
name|old_x_value
argument_list|,
operator|(
name|GDestroyNotify
operator|)
name|g_free
argument_list|)
expr_stmt|;
block|}
name|old_y_value
operator|=
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"old-y-value"
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|old_y_value
condition|)
block|{
name|old_y_value
operator|=
name|g_new0
argument_list|(
name|gdouble
argument_list|,
literal|1
argument_list|)
expr_stmt|;
operator|*
name|old_y_value
operator|=
literal|0.0
expr_stmt|;
name|g_object_set_data_full
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"old-y-value"
argument_list|,
name|old_y_value
argument_list|,
operator|(
name|GDestroyNotify
operator|)
name|g_free
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|x_value
operator|!=
name|y_value
condition|)
block|{
name|GtkWidget
modifier|*
name|chainbutton
decl_stmt|;
name|chainbutton
operator|=
name|g_object_get_data
argument_list|(
name|G_OBJECT
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|"chainbutton"
argument_list|)
expr_stmt|;
if|if
condition|(
name|chainbutton
operator|&&
name|gimp_chain_button_get_active
argument_list|(
name|GIMP_CHAIN_BUTTON
argument_list|(
name|chainbutton
argument_list|)
argument_list|)
condition|)
block|{
if|if
condition|(
name|x_value
operator|!=
operator|*
name|old_x_value
condition|)
block|{
operator|*
name|old_x_value
operator|=
name|x_value
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|1
argument_list|,
name|x_value
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|y_value
operator|!=
operator|*
name|old_y_value
condition|)
block|{
operator|*
name|old_y_value
operator|=
name|y_value
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|GIMP_SIZE_ENTRY
argument_list|(
name|sizeentry
argument_list|)
argument_list|,
literal|0
argument_list|,
name|y_value
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
block|}
if|if
condition|(
operator|*
name|old_x_value
operator|==
name|x_value
operator|&&
operator|*
name|old_y_value
operator|==
name|y_value
condition|)
return|return;
operator|*
name|old_x_value
operator|=
name|x_value
expr_stmt|;
operator|*
name|old_y_value
operator|=
name|y_value
expr_stmt|;
if|if
condition|(
name|G_IS_PARAM_SPEC_INT
argument_list|(
name|x_param_spec
argument_list|)
operator|&&
name|G_IS_PARAM_SPEC_INT
argument_list|(
name|y_param_spec
argument_list|)
condition|)
block|{
name|g_object_set
argument_list|(
name|config
argument_list|,
name|x_param_spec
operator|->
name|name
argument_list|,
operator|(
name|gint
operator|)
name|x_value
argument_list|,
name|y_param_spec
operator|->
name|name
argument_list|,
operator|(
name|gint
operator|)
name|y_value
argument_list|,
name|unit_param_spec
condition|?
name|unit_param_spec
operator|->
name|name
else|:
name|NULL
argument_list|,
name|unit_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|G_IS_PARAM_SPEC_DOUBLE
argument_list|(
name|x_param_spec
argument_list|)
operator|&&
name|G_IS_PARAM_SPEC_DOUBLE
argument_list|(
name|y_param_spec
argument_list|)
condition|)
block|{
name|g_object_set
argument_list|(
name|config
argument_list|,
name|x_param_spec
operator|->
name|name
argument_list|,
name|x_value
argument_list|,
name|y_param_spec
operator|->
name|name
argument_list|,
name|y_value
argument_list|,
name|unit_param_spec
condition|?
name|unit_param_spec
operator|->
name|name
else|:
name|NULL
argument_list|,
name|unit_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_coordinates_notify_x (GObject * config,GParamSpec * param_spec,GimpSizeEntry * sizeentry)
name|gimp_prop_coordinates_notify_x
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpSizeEntry
modifier|*
name|sizeentry
parameter_list|)
block|{
name|gdouble
name|value
decl_stmt|;
if|if
condition|(
name|G_IS_PARAM_SPEC_INT
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|gint
name|int_value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|int_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|value
operator|=
name|int_value
expr_stmt|;
block|}
else|else
block|{
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|value
operator|!=
name|gimp_size_entry_get_refval
argument_list|(
name|sizeentry
argument_list|,
literal|0
argument_list|)
condition|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|sizeentry
argument_list|,
name|gimp_prop_coordinates_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|sizeentry
argument_list|,
literal|0
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|sizeentry
argument_list|,
name|gimp_prop_coordinates_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_coordinates_notify_y (GObject * config,GParamSpec * param_spec,GimpSizeEntry * sizeentry)
name|gimp_prop_coordinates_notify_y
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpSizeEntry
modifier|*
name|sizeentry
parameter_list|)
block|{
name|gdouble
name|value
decl_stmt|;
if|if
condition|(
name|G_IS_PARAM_SPEC_INT
argument_list|(
name|param_spec
argument_list|)
condition|)
block|{
name|gint
name|int_value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|int_value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|value
operator|=
name|int_value
expr_stmt|;
block|}
else|else
block|{
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|value
operator|!=
name|gimp_size_entry_get_refval
argument_list|(
name|sizeentry
argument_list|,
literal|1
argument_list|)
condition|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|sizeentry
argument_list|,
name|gimp_prop_coordinates_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_refval
argument_list|(
name|sizeentry
argument_list|,
literal|1
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|sizeentry
argument_list|,
name|gimp_prop_coordinates_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_coordinates_notify_unit (GObject * config,GParamSpec * param_spec,GimpSizeEntry * sizeentry)
name|gimp_prop_coordinates_notify_unit
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GimpSizeEntry
modifier|*
name|sizeentry
parameter_list|)
block|{
name|GimpUnit
name|value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
if|if
condition|(
name|value
operator|!=
name|gimp_size_entry_get_unit
argument_list|(
name|sizeentry
argument_list|)
condition|)
block|{
name|g_signal_handlers_block_by_func
argument_list|(
name|sizeentry
argument_list|,
name|gimp_prop_coordinates_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gimp_size_entry_set_unit
argument_list|(
name|sizeentry
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|sizeentry
argument_list|,
name|gimp_prop_coordinates_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_comment
comment|/******************/
end_comment

begin_comment
comment|/*  color button  */
end_comment

begin_comment
comment|/******************/
end_comment

begin_function_decl
specifier|static
name|void
name|gimp_prop_color_button_callback
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|void
name|gimp_prop_color_button_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|button
parameter_list|)
function_decl|;
end_function_decl

begin_function
name|GtkWidget
modifier|*
DECL|function|gimp_prop_color_button_new (GObject * config,const gchar * property_name,const gchar * title,gint width,gint height,GimpColorAreaType type)
name|gimp_prop_color_button_new
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|title
parameter_list|,
name|gint
name|width
parameter_list|,
name|gint
name|height
parameter_list|,
name|GimpColorAreaType
name|type
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GtkWidget
modifier|*
name|button
decl_stmt|;
name|GimpRGB
modifier|*
name|value
decl_stmt|;
name|param_spec
operator|=
name|check_param_spec
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|GIMP_TYPE_PARAM_COLOR
argument_list|,
name|G_STRLOC
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return
name|NULL
return|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|button
operator|=
name|gimp_color_panel_new
argument_list|(
name|title
argument_list|,
name|value
argument_list|,
name|type
argument_list|,
name|width
argument_list|,
name|height
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
name|set_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|,
name|button
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
name|g_signal_connect
argument_list|(
name|button
argument_list|,
literal|"color_changed"
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_color_button_callback
argument_list|)
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|connect_notify
argument_list|(
name|config
argument_list|,
name|property_name
argument_list|,
name|G_CALLBACK
argument_list|(
name|gimp_prop_color_button_notify
argument_list|)
argument_list|,
name|button
argument_list|)
expr_stmt|;
return|return
name|button
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_color_button_callback (GtkWidget * button,GObject * config)
name|gimp_prop_color_button_callback
parameter_list|(
name|GtkWidget
modifier|*
name|button
parameter_list|,
name|GObject
modifier|*
name|config
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|GimpRGB
name|value
decl_stmt|;
name|param_spec
operator|=
name|get_param_spec
argument_list|(
name|G_OBJECT
argument_list|(
name|button
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
return|return;
name|gimp_color_button_get_color
argument_list|(
name|GIMP_COLOR_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
operator|&
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|config
argument_list|,
name|gimp_prop_color_button_notify
argument_list|,
name|button
argument_list|)
expr_stmt|;
name|g_object_set
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|config
argument_list|,
name|gimp_prop_color_button_notify
argument_list|,
name|button
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|gimp_prop_color_button_notify (GObject * config,GParamSpec * param_spec,GtkWidget * button)
name|gimp_prop_color_button_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|,
name|GtkWidget
modifier|*
name|button
parameter_list|)
block|{
name|GimpRGB
modifier|*
name|value
decl_stmt|;
name|g_object_get
argument_list|(
name|config
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
operator|&
name|value
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_handlers_block_by_func
argument_list|(
name|button
argument_list|,
name|gimp_prop_color_button_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
name|gimp_color_button_set_color
argument_list|(
name|GIMP_COLOR_BUTTON
argument_list|(
name|button
argument_list|)
argument_list|,
name|value
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|value
argument_list|)
expr_stmt|;
name|g_signal_handlers_unblock_by_func
argument_list|(
name|button
argument_list|,
name|gimp_prop_color_button_callback
argument_list|,
name|config
argument_list|)
expr_stmt|;
block|}
end_function

begin_comment
comment|/*******************************/
end_comment

begin_comment
comment|/*  private utility functions  */
end_comment

begin_comment
comment|/*******************************/
end_comment

begin_decl_stmt
DECL|variable|param_spec_quark
specifier|static
name|GQuark
name|param_spec_quark
init|=
literal|0
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
DECL|function|set_param_spec (GObject * object,GtkWidget * widget,GParamSpec * param_spec)
name|set_param_spec
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GParamSpec
modifier|*
name|param_spec
parameter_list|)
block|{
if|if
condition|(
operator|!
name|param_spec_quark
condition|)
name|param_spec_quark
operator|=
name|g_quark_from_static_string
argument_list|(
literal|"gimp-config-param-spec"
argument_list|)
expr_stmt|;
name|g_object_set_qdata
argument_list|(
name|object
argument_list|,
name|param_spec_quark
argument_list|,
name|param_spec
argument_list|)
expr_stmt|;
if|if
condition|(
name|widget
condition|)
block|{
specifier|const
name|gchar
modifier|*
name|blurb
init|=
name|g_param_spec_get_blurb
argument_list|(
name|param_spec
argument_list|)
decl_stmt|;
if|if
condition|(
name|blurb
condition|)
name|gimp_help_set_help_data
argument_list|(
name|widget
argument_list|,
name|blurb
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
block|}
block|}
end_function

begin_function
specifier|static
name|GParamSpec
modifier|*
DECL|function|get_param_spec (GObject * object)
name|get_param_spec
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|)
block|{
if|if
condition|(
operator|!
name|param_spec_quark
condition|)
name|param_spec_quark
operator|=
name|g_quark_from_static_string
argument_list|(
literal|"gimp-config-param-spec"
argument_list|)
expr_stmt|;
return|return
name|g_object_get_qdata
argument_list|(
name|object
argument_list|,
name|param_spec_quark
argument_list|)
return|;
block|}
end_function

begin_function
specifier|static
name|GParamSpec
modifier|*
DECL|function|find_param_spec (GObject * object,const gchar * property_name,const gchar * strloc)
name|find_param_spec
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
specifier|const
name|gchar
modifier|*
name|strloc
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|param_spec
operator|=
name|g_object_class_find_property
argument_list|(
name|G_OBJECT_GET_CLASS
argument_list|(
name|object
argument_list|)
argument_list|,
name|property_name
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|param_spec
condition|)
name|g_warning
argument_list|(
literal|"%s: %s has no property named '%s'"
argument_list|,
name|strloc
argument_list|,
name|g_type_name
argument_list|(
name|G_TYPE_FROM_INSTANCE
argument_list|(
name|object
argument_list|)
argument_list|)
argument_list|,
name|property_name
argument_list|)
expr_stmt|;
return|return
name|param_spec
return|;
block|}
end_function

begin_function
specifier|static
name|GParamSpec
modifier|*
DECL|function|check_param_spec (GObject * object,const gchar * property_name,GType type,const gchar * strloc)
name|check_param_spec
parameter_list|(
name|GObject
modifier|*
name|object
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
name|GType
name|type
parameter_list|,
specifier|const
name|gchar
modifier|*
name|strloc
parameter_list|)
block|{
name|GParamSpec
modifier|*
name|param_spec
decl_stmt|;
name|param_spec
operator|=
name|find_param_spec
argument_list|(
name|object
argument_list|,
name|property_name
argument_list|,
name|strloc
argument_list|)
expr_stmt|;
if|if
condition|(
name|param_spec
operator|&&
operator|!
name|g_type_is_a
argument_list|(
name|G_TYPE_FROM_INSTANCE
argument_list|(
name|param_spec
argument_list|)
argument_list|,
name|type
argument_list|)
condition|)
block|{
name|g_warning
argument_list|(
literal|"%s: property '%s' of %s is not a %s"
argument_list|,
name|strloc
argument_list|,
name|param_spec
operator|->
name|name
argument_list|,
name|g_type_name
argument_list|(
name|param_spec
operator|->
name|owner_type
argument_list|)
argument_list|,
name|g_type_name
argument_list|(
name|type
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|NULL
return|;
block|}
return|return
name|param_spec
return|;
block|}
end_function

begin_function
specifier|static
name|void
DECL|function|connect_notify (GObject * config,const gchar * property_name,GCallback callback,gpointer callback_data)
name|connect_notify
parameter_list|(
name|GObject
modifier|*
name|config
parameter_list|,
specifier|const
name|gchar
modifier|*
name|property_name
parameter_list|,
name|GCallback
name|callback
parameter_list|,
name|gpointer
name|callback_data
parameter_list|)
block|{
name|gchar
modifier|*
name|notify_name
decl_stmt|;
name|notify_name
operator|=
name|g_strconcat
argument_list|(
literal|"notify::"
argument_list|,
name|property_name
argument_list|,
name|NULL
argument_list|)
expr_stmt|;
name|g_signal_connect_object
argument_list|(
name|config
argument_list|,
name|notify_name
argument_list|,
name|callback
argument_list|,
name|callback_data
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|g_free
argument_list|(
name|notify_name
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

