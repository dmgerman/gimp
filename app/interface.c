begin_unit|revision:0.9.5;language:C;cregit-version:0.0.1
begin_comment
comment|/* The GIMP -- an image manipulation program  * Copyright (C) 1995 Spencer Kimball and Peter Mattis  *  * This program is free software; you can redistribute it and/or modify  * it under the terms of the GNU General Public License as published by  * the Free Software Foundation; either version 2 of the License, or  * (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU General Public License for more details.  *  * You should have received a copy of the GNU General Public License  * along with this program; if not, write to the Free Software  * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.  */
end_comment

begin_include
include|#
directive|include
file|"config.h"
end_include

begin_include
include|#
directive|include
file|<gtk/gtk.h>
end_include

begin_include
include|#
directive|include
file|"libgimpwidgets/gimpwidgets.h"
end_include

begin_include
include|#
directive|include
file|"apptypes.h"
end_include

begin_include
include|#
directive|include
file|"disp_callbacks.h"
end_include

begin_include
include|#
directive|include
file|"gdisplay_ops.h"
end_include

begin_include
include|#
directive|include
file|"gimpdnd.h"
end_include

begin_include
include|#
directive|include
file|"interface.h"
end_include

begin_include
include|#
directive|include
file|"gui/menus.h"
end_include

begin_include
include|#
directive|include
file|"nav_window.h"
end_include

begin_include
include|#
directive|include
file|"gimphelp.h"
end_include

begin_include
include|#
directive|include
file|"gimpimage.h"
end_include

begin_include
include|#
directive|include
file|"gimppattern.h"
end_include

begin_include
include|#
directive|include
file|"gimprc.h"
end_include

begin_include
include|#
directive|include
file|"qmask.h"
end_include

begin_include
include|#
directive|include
file|"pixmaps/qmasksel.xpm"
end_include

begin_include
include|#
directive|include
file|"pixmaps/qmasknosel.xpm"
end_include

begin_include
include|#
directive|include
file|"pixmaps/navbutton.xpm"
end_include

begin_include
include|#
directive|include
file|"libgimp/gimpintl.h"
end_include

begin_comment
comment|/*  local functions  */
end_comment

begin_function_decl
specifier|static
name|void
name|gdisplay_destroy
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GDisplay
modifier|*
name|display
parameter_list|)
function_decl|;
end_function_decl

begin_function_decl
specifier|static
name|gint
name|gdisplay_delete
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|,
name|GDisplay
modifier|*
name|display
parameter_list|)
function_decl|;
end_function_decl

begin_decl_stmt
DECL|variable|display_target_table
specifier|static
name|GtkTargetEntry
name|display_target_table
index|[]
init|=
block|{
name|GIMP_TARGET_LAYER
block|,
name|GIMP_TARGET_CHANNEL
block|,
name|GIMP_TARGET_LAYER_MASK
block|,
name|GIMP_TARGET_COLOR
block|,
name|GIMP_TARGET_PATTERN
block|}
decl_stmt|;
end_decl_stmt

begin_decl_stmt
DECL|variable|display_n_targets
specifier|static
name|guint
name|display_n_targets
init|=
operator|(
sizeof|sizeof
argument_list|(
name|display_target_table
argument_list|)
operator|/
sizeof|sizeof
argument_list|(
name|display_target_table
index|[
literal|0
index|]
argument_list|)
operator|)
decl_stmt|;
end_decl_stmt

begin_function
specifier|static
name|void
DECL|function|gdisplay_destroy (GtkWidget * widget,GDisplay * gdisp)
name|gdisplay_destroy
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GDisplay
modifier|*
name|gdisp
parameter_list|)
block|{
name|gdisplay_remove_and_delete
argument_list|(
name|gdisp
argument_list|)
expr_stmt|;
block|}
end_function

begin_function
specifier|static
name|gboolean
DECL|function|gdisplay_delete (GtkWidget * widget,GdkEvent * event,GDisplay * gdisp)
name|gdisplay_delete
parameter_list|(
name|GtkWidget
modifier|*
name|widget
parameter_list|,
name|GdkEvent
modifier|*
name|event
parameter_list|,
name|GDisplay
modifier|*
name|gdisp
parameter_list|)
block|{
name|gdisplay_close_window
argument_list|(
name|gdisp
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
return|return
name|TRUE
return|;
block|}
end_function

begin_function
name|void
DECL|function|create_display_shell (GDisplay * gdisp,gint width,gint height,gchar * title,gint type)
name|create_display_shell
parameter_list|(
name|GDisplay
modifier|*
name|gdisp
parameter_list|,
name|gint
name|width
parameter_list|,
name|gint
name|height
parameter_list|,
name|gchar
modifier|*
name|title
parameter_list|,
name|gint
name|type
parameter_list|)
block|{
specifier|static
name|GdkPixmap
modifier|*
name|qmasksel_pixmap
init|=
name|NULL
decl_stmt|;
specifier|static
name|GdkBitmap
modifier|*
name|qmasksel_mask
init|=
name|NULL
decl_stmt|;
specifier|static
name|GdkPixmap
modifier|*
name|qmasknosel_pixmap
init|=
name|NULL
decl_stmt|;
specifier|static
name|GdkBitmap
modifier|*
name|qmasknosel_mask
init|=
name|NULL
decl_stmt|;
specifier|static
name|GdkPixmap
modifier|*
name|navbutton_pixmap
init|=
name|NULL
decl_stmt|;
specifier|static
name|GdkBitmap
modifier|*
name|navbutton_mask
init|=
name|NULL
decl_stmt|;
name|GtkWidget
modifier|*
name|main_vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|disp_vbox
decl_stmt|;
name|GtkWidget
modifier|*
name|upper_hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|lower_hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|inner_table
decl_stmt|;
name|GtkWidget
modifier|*
name|status_hbox
decl_stmt|;
name|GtkWidget
modifier|*
name|arrow
decl_stmt|;
name|GtkWidget
modifier|*
name|pixmap
decl_stmt|;
name|GtkWidget
modifier|*
name|label_frame
decl_stmt|;
name|GtkWidget
modifier|*
name|nav_ebox
decl_stmt|;
name|GSList
modifier|*
name|group
init|=
name|NULL
decl_stmt|;
name|gint
name|n_width
decl_stmt|,
name|n_height
decl_stmt|;
name|gint
name|s_width
decl_stmt|,
name|s_height
decl_stmt|;
name|gint
name|scalesrc
decl_stmt|,
name|scaledest
decl_stmt|;
name|gint
name|contextid
decl_stmt|;
comment|/*  adjust the initial scale -- so that window fits on screen    *  the 75% value is the same as in gdisplay_shrink_wrap. It    *  probably should be a user-configurable option.    */
name|s_width
operator|=
name|gdk_screen_width
argument_list|()
operator|*
literal|0.75
expr_stmt|;
name|s_height
operator|=
name|gdk_screen_height
argument_list|()
operator|*
literal|0.75
expr_stmt|;
name|scalesrc
operator|=
name|SCALESRC
argument_list|(
name|gdisp
argument_list|)
expr_stmt|;
name|scaledest
operator|=
name|SCALEDEST
argument_list|(
name|gdisp
argument_list|)
expr_stmt|;
name|n_width
operator|=
name|SCALEX
argument_list|(
name|gdisp
argument_list|,
name|width
argument_list|)
expr_stmt|;
name|n_height
operator|=
name|SCALEX
argument_list|(
name|gdisp
argument_list|,
name|height
argument_list|)
expr_stmt|;
comment|/*  Limit to the size of the screen...  */
while|while
condition|(
name|n_width
operator|>
name|s_width
operator|||
name|n_height
operator|>
name|s_height
condition|)
block|{
if|if
condition|(
name|scaledest
operator|>
literal|1
condition|)
name|scaledest
operator|--
expr_stmt|;
elseif|else
if|if
condition|(
name|scalesrc
operator|<
literal|0xff
condition|)
name|scalesrc
operator|++
expr_stmt|;
name|n_width
operator|=
name|width
operator|*
operator|(
name|scaledest
operator|*
name|SCREEN_XRES
argument_list|(
name|gdisp
argument_list|)
operator|)
operator|/
operator|(
name|scalesrc
operator|*
name|gdisp
operator|->
name|gimage
operator|->
name|xresolution
operator|)
expr_stmt|;
name|n_height
operator|=
name|height
operator|*
operator|(
name|scaledest
operator|*
name|SCREEN_XRES
argument_list|(
name|gdisp
argument_list|)
operator|)
operator|/
operator|(
name|scalesrc
operator|*
name|gdisp
operator|->
name|gimage
operator|->
name|xresolution
operator|)
expr_stmt|;
block|}
name|gdisp
operator|->
name|scale
operator|=
operator|(
name|scaledest
operator|<<
literal|8
operator|)
operator|+
name|scalesrc
expr_stmt|;
comment|/*  the toplevel shell */
name|gdisp
operator|->
name|shell
operator|=
name|gtk_window_new
argument_list|(
name|GTK_WINDOW_TOPLEVEL
argument_list|)
expr_stmt|;
name|gtk_widget_ref
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
expr_stmt|;
name|gtk_window_set_title
argument_list|(
name|GTK_WINDOW
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
name|title
argument_list|)
expr_stmt|;
name|gtk_window_set_wmclass
argument_list|(
name|GTK_WINDOW
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
literal|"image_window"
argument_list|,
literal|"Gimp"
argument_list|)
expr_stmt|;
name|gtk_window_set_policy
argument_list|(
name|GTK_WINDOW
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|gdisp
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|,
operator|(
name|GDK_POINTER_MOTION_MASK
operator||
name|GDK_POINTER_MOTION_HINT_MASK
operator||
name|GDK_BUTTON_PRESS_MASK
operator||
name|GDK_KEY_PRESS_MASK
operator||
name|GDK_KEY_RELEASE_MASK
operator|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
literal|"delete_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_delete
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
literal|"destroy"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_destroy
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
comment|/*  active display callback  */
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_shell_events
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
literal|"key_press_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_shell_events
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
comment|/*  dnd stuff  */
name|gtk_drag_dest_set
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|,
name|GTK_DEST_DEFAULT_ALL
argument_list|,
name|display_target_table
argument_list|,
name|display_n_targets
argument_list|,
name|GDK_ACTION_COPY
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
literal|"drag_drop"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_drag_drop
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gimp_dnd_color_dest_set
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|,
name|gdisplay_drop_color
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gimp_dnd_viewable_dest_set
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|,
name|GIMP_TYPE_PATTERN
argument_list|,
name|gdisplay_drop_viewable
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
comment|/*  the popup menu  */
name|gdisp
operator|->
name|ifactory
operator|=
name|menus_get_image_factory
argument_list|()
expr_stmt|;
comment|/*  The accelerator table for images  */
name|gtk_window_add_accel_group
argument_list|(
name|GTK_WINDOW
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
name|gdisp
operator|->
name|ifactory
operator|->
name|accel_group
argument_list|)
expr_stmt|;
comment|/*  connect the "F1" help key  */
name|gimp_help_connect_help_accel
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|,
name|gimp_standard_help_func
argument_list|,
literal|"image/image_window.html"
argument_list|)
expr_stmt|;
comment|/*  GtkTable widgets are not able to shrink a row/column correctly if    *  widgets are attached with GTK_EXPAND even if those widgets have    *  other rows/columns in their rowspan/colspan where they could    *  nicely expand without disturbing the row/column which is supposed    *  to shrink. --Mitch    *    *  Changed the packing to use hboxes and vboxes which behave nicer:    *    *  main_vbox    *     |    *     +-- disp_vbox    *     |      |    *     |      +-- upper_hbox    *     |      |      |    *     |      |      +-- inner_table    *     |      |      |      |    *     |      |      |      +-- origin    *     |      |      |      +-- hruler    *     |      |      |      +-- vruler    *     |      |      |      +-- canvas    *     |      |      |         *     |      |      +-- vscrollbar    *     |      |        *     |      +-- lower_hbox    *     |             |    *     |             +-- qmaskoff    *     |             +-- qmaskon    *     |             +-- hscrollbar    *     |             +-- navbutton    *     |    *     +-- statusarea    *            |    *            +-- cursorlabel    *            +-- statusbar    *            +-- progressbar    *            +-- cancelbutton    */
comment|/*  first, set up the container hierarchy  *********************************/
comment|/*  the vbox containing all widgets  */
name|main_vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|main_vbox
argument_list|)
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
name|main_vbox
argument_list|)
expr_stmt|;
comment|/*  another vbox for everything except the statusbar  */
name|disp_vbox
operator|=
name|gtk_vbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|main_vbox
argument_list|)
argument_list|,
name|disp_vbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|disp_vbox
argument_list|)
expr_stmt|;
comment|/*  a hbox for the inner_table and the vertical scrollbar  */
name|upper_hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|disp_vbox
argument_list|)
argument_list|,
name|upper_hbox
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|upper_hbox
argument_list|)
expr_stmt|;
comment|/*  the table containing origin, rulers and the canvas  */
name|inner_table
operator|=
name|gtk_table_new
argument_list|(
literal|2
argument_list|,
literal|2
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|gtk_table_set_col_spacing
argument_list|(
name|GTK_TABLE
argument_list|(
name|inner_table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_table_set_row_spacing
argument_list|(
name|GTK_TABLE
argument_list|(
name|inner_table
argument_list|)
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|upper_hbox
argument_list|)
argument_list|,
name|inner_table
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|inner_table
argument_list|)
expr_stmt|;
comment|/*  the hbox containing qmask buttons, vertical scrollbar and nav button  */
name|lower_hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|1
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|disp_vbox
argument_list|)
argument_list|,
name|lower_hbox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|lower_hbox
argument_list|)
expr_stmt|;
comment|/*  eventbox and hbox for status area  */
name|gdisp
operator|->
name|statusarea
operator|=
name|gtk_event_box_new
argument_list|()
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|main_vbox
argument_list|)
argument_list|,
name|gdisp
operator|->
name|statusarea
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|gdisp
operator|->
name|statusarea
argument_list|,
name|NULL
argument_list|,
literal|"#status_area"
argument_list|)
expr_stmt|;
name|status_hbox
operator|=
name|gtk_hbox_new
argument_list|(
name|FALSE
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gdisp
operator|->
name|statusarea
argument_list|)
argument_list|,
name|status_hbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|status_hbox
argument_list|)
expr_stmt|;
name|gtk_container_set_resize_mode
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|status_hbox
argument_list|)
argument_list|,
name|GTK_RESIZE_QUEUE
argument_list|)
expr_stmt|;
comment|/*  create the scrollbars  *************************************************/
comment|/*  the horizontal scrollbar  */
name|gdisp
operator|->
name|hsbdata
operator|=
name|GTK_ADJUSTMENT
argument_list|(
name|gtk_adjustment_new
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|width
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
name|width
argument_list|)
argument_list|)
expr_stmt|;
name|gdisp
operator|->
name|hsb
operator|=
name|gtk_hscrollbar_new
argument_list|(
name|gdisp
operator|->
name|hsbdata
argument_list|)
expr_stmt|;
name|GTK_WIDGET_UNSET_FLAGS
argument_list|(
name|gdisp
operator|->
name|hsb
argument_list|,
name|GTK_CAN_FOCUS
argument_list|)
expr_stmt|;
comment|/*  the vertical scrollbar  */
name|gdisp
operator|->
name|vsbdata
operator|=
name|GTK_ADJUSTMENT
argument_list|(
name|gtk_adjustment_new
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
name|height
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
name|height
argument_list|)
argument_list|)
expr_stmt|;
name|gdisp
operator|->
name|vsb
operator|=
name|gtk_vscrollbar_new
argument_list|(
name|gdisp
operator|->
name|vsbdata
argument_list|)
expr_stmt|;
name|GTK_WIDGET_UNSET_FLAGS
argument_list|(
name|gdisp
operator|->
name|vsb
argument_list|,
name|GTK_CAN_FOCUS
argument_list|)
expr_stmt|;
comment|/*  create the contents of the inner_table  ********************************/
comment|/*  the menu popup button  */
name|gdisp
operator|->
name|origin
operator|=
name|gtk_button_new
argument_list|()
expr_stmt|;
name|GTK_WIDGET_UNSET_FLAGS
argument_list|(
name|gdisp
operator|->
name|origin
argument_list|,
name|GTK_CAN_FOCUS
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|GTK_WIDGET
argument_list|(
name|gdisp
operator|->
name|origin
argument_list|)
argument_list|,
name|GDK_BUTTON_PRESS_MASK
operator||
name|GDK_BUTTON_RELEASE_MASK
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|origin
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_origin_button_press
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|gdisp
operator|->
name|origin
argument_list|,
name|NULL
argument_list|,
literal|"#origin_button"
argument_list|)
expr_stmt|;
name|arrow
operator|=
name|gtk_arrow_new
argument_list|(
name|GTK_ARROW_RIGHT
argument_list|,
name|GTK_SHADOW_OUT
argument_list|)
expr_stmt|;
name|gtk_container_set_border_width
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gdisp
operator|->
name|origin
argument_list|)
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gdisp
operator|->
name|origin
argument_list|)
argument_list|,
name|arrow
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|arrow
argument_list|)
expr_stmt|;
comment|/*  the horizontal ruler  */
name|gdisp
operator|->
name|hrule
operator|=
name|gtk_hruler_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|GTK_WIDGET
argument_list|(
name|gdisp
operator|->
name|hrule
argument_list|)
argument_list|,
name|GDK_BUTTON_PRESS_MASK
operator||
name|GDK_BUTTON_RELEASE_MASK
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
literal|"motion_notify_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|GTK_WIDGET_CLASS
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|hrule
argument_list|)
operator|->
name|klass
argument_list|)
operator|->
name|motion_notify_event
argument_list|)
argument_list|,
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|hrule
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|hrule
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_hruler_button_press
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|gdisp
operator|->
name|hrule
argument_list|,
name|NULL
argument_list|,
literal|"#ruler"
argument_list|)
expr_stmt|;
comment|/*  the vertical ruler  */
name|gdisp
operator|->
name|vrule
operator|=
name|gtk_vruler_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|GTK_WIDGET
argument_list|(
name|gdisp
operator|->
name|vrule
argument_list|)
argument_list|,
name|GDK_BUTTON_PRESS_MASK
operator||
name|GDK_BUTTON_RELEASE_MASK
argument_list|)
expr_stmt|;
name|gtk_signal_connect_object
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
argument_list|,
literal|"motion_notify_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|GTK_WIDGET_CLASS
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|vrule
argument_list|)
operator|->
name|klass
argument_list|)
operator|->
name|motion_notify_event
argument_list|)
argument_list|,
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|vrule
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|vrule
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_vruler_button_press
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|gdisp
operator|->
name|vrule
argument_list|,
name|NULL
argument_list|,
literal|"#ruler"
argument_list|)
expr_stmt|;
comment|/*  the canvas  */
name|gdisp
operator|->
name|canvas
operator|=
name|gtk_drawing_area_new
argument_list|()
expr_stmt|;
name|gtk_drawing_area_size
argument_list|(
name|GTK_DRAWING_AREA
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|)
argument_list|,
name|n_width
argument_list|,
name|n_height
argument_list|)
expr_stmt|;
name|gtk_widget_set_events
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|,
name|CANVAS_EVENT_MASK
argument_list|)
expr_stmt|;
name|gtk_widget_set_extension_events
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|,
name|GDK_EXTENSION_EVENTS_ALL
argument_list|)
expr_stmt|;
name|GTK_WIDGET_SET_FLAGS
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|,
name|GTK_CAN_FOCUS
argument_list|)
expr_stmt|;
name|gtk_object_set_user_data
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|)
argument_list|,
operator|(
name|gpointer
operator|)
name|gdisp
argument_list|)
expr_stmt|;
comment|/*  set the active display before doing any other canvas event processing  */
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|)
argument_list|,
literal|"event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_shell_events
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|)
argument_list|,
literal|"event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_canvas_events
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
comment|/*  create the contents of the lower_hbox  *********************************/
comment|/*  the qmask buttons  */
name|gdisp
operator|->
name|qmaskoff
operator|=
name|gtk_radio_button_new
argument_list|(
name|group
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|GTK_WIDGET
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|)
argument_list|,
literal|15
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_mode
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|GTK_WIDGET_UNSET_FLAGS
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|,
name|GTK_CAN_FOCUS
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|qmask_deactivate
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|qmask_click_handler
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|,
name|NULL
argument_list|,
literal|"#qmask_off_button"
argument_list|)
expr_stmt|;
name|gdisp
operator|->
name|qmaskon
operator|=
name|gtk_radio_button_new
argument_list|(
name|group
argument_list|)
expr_stmt|;
name|group
operator|=
name|gtk_radio_button_group
argument_list|(
name|GTK_RADIO_BUTTON
argument_list|(
name|gdisp
operator|->
name|qmaskon
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|GTK_WIDGET
argument_list|(
name|gdisp
operator|->
name|qmaskon
argument_list|)
argument_list|,
literal|15
argument_list|,
literal|15
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_mode
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|gdisp
operator|->
name|qmaskon
argument_list|)
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
name|GTK_WIDGET_UNSET_FLAGS
argument_list|(
name|gdisp
operator|->
name|qmaskon
argument_list|,
name|GTK_CAN_FOCUS
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|qmaskon
argument_list|)
argument_list|,
literal|"toggled"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|qmask_activate
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|qmaskon
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|qmask_click_handler
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|gdisp
operator|->
name|qmaskon
argument_list|,
name|NULL
argument_list|,
literal|"#qmask_on_button"
argument_list|)
expr_stmt|;
name|gtk_toggle_button_set_active
argument_list|(
name|GTK_TOGGLE_BUTTON
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|)
argument_list|,
name|TRUE
argument_list|)
expr_stmt|;
comment|/*  the navigation window button  */
name|nav_ebox
operator|=
name|gtk_event_box_new
argument_list|()
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|nav_ebox
argument_list|)
argument_list|,
literal|"button_press_event"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|nav_popup_click_handler
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gimp_help_set_help_data
argument_list|(
name|nav_ebox
argument_list|,
name|NULL
argument_list|,
literal|"#nav_window_button"
argument_list|)
expr_stmt|;
comment|/* We need to realize the shell so that we have a GdkWindow for    * the pixmap creation.  */
name|gtk_widget_realize
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
expr_stmt|;
comment|/*  create the pixmaps  ****************************************************/
if|if
condition|(
operator|!
name|qmasksel_pixmap
condition|)
block|{
name|GtkStyle
modifier|*
name|style
decl_stmt|;
name|style
operator|=
name|gtk_widget_get_style
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
expr_stmt|;
name|qmasksel_pixmap
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|gdisp
operator|->
name|shell
operator|->
name|window
argument_list|,
operator|&
name|qmasksel_mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|qmasksel_xpm
argument_list|)
expr_stmt|;
name|qmasknosel_pixmap
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|gdisp
operator|->
name|shell
operator|->
name|window
argument_list|,
operator|&
name|qmasknosel_mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|qmasknosel_xpm
argument_list|)
expr_stmt|;
name|navbutton_pixmap
operator|=
name|gdk_pixmap_create_from_xpm_d
argument_list|(
name|gdisp
operator|->
name|shell
operator|->
name|window
argument_list|,
operator|&
name|navbutton_mask
argument_list|,
operator|&
name|style
operator|->
name|bg
index|[
name|GTK_STATE_NORMAL
index|]
argument_list|,
name|navbutton_xpm
argument_list|)
expr_stmt|;
block|}
comment|/*  Icon stuff  */
name|gdisp
operator|->
name|iconsize
operator|=
literal|32
expr_stmt|;
name|gdisp
operator|->
name|icon
operator|=
name|NULL
expr_stmt|;
name|gdisp
operator|->
name|iconmask
operator|=
name|NULL
expr_stmt|;
name|gdisp
operator|->
name|icon_needs_update
operator|=
literal|0
expr_stmt|;
name|gdisp
operator|->
name|icon_timeout_id
operator|=
literal|0
expr_stmt|;
name|gdisp
operator|->
name|icon_idle_id
operator|=
literal|0
expr_stmt|;
name|gtk_signal_connect
argument_list|(
name|GTK_OBJECT
argument_list|(
name|gdisp
operator|->
name|gimage
argument_list|)
argument_list|,
literal|"invalidate_preview"
argument_list|,
name|GTK_SIGNAL_FUNC
argument_list|(
name|gdisplay_update_icon_scheduler
argument_list|)
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
name|gdisplay_update_icon_scheduler
argument_list|(
name|gdisp
operator|->
name|gimage
argument_list|,
name|gdisp
argument_list|)
expr_stmt|;
comment|/*  create the GtkPixmaps  */
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|qmasksel_pixmap
argument_list|,
name|qmasksel_mask
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gdisp
operator|->
name|qmaskon
argument_list|)
argument_list|,
name|pixmap
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|qmasknosel_pixmap
argument_list|,
name|qmasknosel_mask
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|)
argument_list|,
name|pixmap
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
name|pixmap
operator|=
name|gtk_pixmap_new
argument_list|(
name|navbutton_pixmap
argument_list|,
name|navbutton_mask
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|nav_ebox
argument_list|)
argument_list|,
name|pixmap
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|pixmap
argument_list|)
expr_stmt|;
comment|/*  create the contents of the status area *********************************/
comment|/*  the cursor label  */
name|label_frame
operator|=
name|gtk_frame_new
argument_list|(
name|NULL
argument_list|)
expr_stmt|;
name|gtk_frame_set_shadow_type
argument_list|(
name|GTK_FRAME
argument_list|(
name|label_frame
argument_list|)
argument_list|,
name|GTK_SHADOW_IN
argument_list|)
expr_stmt|;
name|gdisp
operator|->
name|cursor_label
operator|=
name|gtk_label_new
argument_list|(
literal|" "
argument_list|)
expr_stmt|;
name|gtk_container_add
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|label_frame
argument_list|)
argument_list|,
name|gdisp
operator|->
name|cursor_label
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|cursor_label
argument_list|)
expr_stmt|;
comment|/*  the statusbar  */
name|gdisp
operator|->
name|statusbar
operator|=
name|gtk_statusbar_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|gdisp
operator|->
name|statusbar
argument_list|,
literal|1
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
name|gtk_container_set_resize_mode
argument_list|(
name|GTK_CONTAINER
argument_list|(
name|gdisp
operator|->
name|statusbar
argument_list|)
argument_list|,
name|GTK_RESIZE_QUEUE
argument_list|)
expr_stmt|;
name|contextid
operator|=
name|gtk_statusbar_get_context_id
argument_list|(
name|GTK_STATUSBAR
argument_list|(
name|gdisp
operator|->
name|statusbar
argument_list|)
argument_list|,
literal|"title"
argument_list|)
expr_stmt|;
name|gtk_statusbar_push
argument_list|(
name|GTK_STATUSBAR
argument_list|(
name|gdisp
operator|->
name|statusbar
argument_list|)
argument_list|,
name|contextid
argument_list|,
name|title
argument_list|)
expr_stmt|;
comment|/*  the progress bar  */
name|gdisp
operator|->
name|progressbar
operator|=
name|gtk_progress_bar_new
argument_list|()
expr_stmt|;
name|gtk_widget_set_usize
argument_list|(
name|gdisp
operator|->
name|progressbar
argument_list|,
literal|80
argument_list|,
operator|-
literal|1
argument_list|)
expr_stmt|;
comment|/*  the cancel button  */
name|gdisp
operator|->
name|cancelbutton
operator|=
name|gtk_button_new_with_label
argument_list|(
name|_
argument_list|(
literal|"Cancel"
argument_list|)
argument_list|)
expr_stmt|;
name|gtk_widget_set_sensitive
argument_list|(
name|gdisp
operator|->
name|cancelbutton
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/*  pack all the widgets  **************************************************/
comment|/*  fill the upper_hbox  */
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|upper_hbox
argument_list|)
argument_list|,
name|gdisp
operator|->
name|vsb
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/*  fill the inner_table  */
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|inner_table
argument_list|)
argument_list|,
name|gdisp
operator|->
name|origin
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|inner_table
argument_list|)
argument_list|,
name|gdisp
operator|->
name|hrule
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|inner_table
argument_list|)
argument_list|,
name|gdisp
operator|->
name|vrule
argument_list|,
literal|0
argument_list|,
literal|1
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_table_attach
argument_list|(
name|GTK_TABLE
argument_list|(
name|inner_table
argument_list|)
argument_list|,
name|gdisp
operator|->
name|canvas
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
literal|1
argument_list|,
literal|2
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
name|GTK_EXPAND
operator||
name|GTK_SHRINK
operator||
name|GTK_FILL
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/*  fill the lower_hbox  */
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|lower_hbox
argument_list|)
argument_list|,
name|gdisp
operator|->
name|qmaskoff
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|lower_hbox
argument_list|)
argument_list|,
name|gdisp
operator|->
name|qmaskon
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|lower_hbox
argument_list|)
argument_list|,
name|gdisp
operator|->
name|hsb
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|lower_hbox
argument_list|)
argument_list|,
name|nav_ebox
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/*  fill the status area  */
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|status_hbox
argument_list|)
argument_list|,
name|label_frame
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|status_hbox
argument_list|)
argument_list|,
name|gdisp
operator|->
name|statusbar
argument_list|,
name|TRUE
argument_list|,
name|TRUE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|status_hbox
argument_list|)
argument_list|,
name|gdisp
operator|->
name|progressbar
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gtk_box_pack_start
argument_list|(
name|GTK_BOX
argument_list|(
name|status_hbox
argument_list|)
argument_list|,
name|gdisp
operator|->
name|cancelbutton
argument_list|,
name|FALSE
argument_list|,
name|FALSE
argument_list|,
literal|0
argument_list|)
expr_stmt|;
comment|/*  show everything  *******************************************************/
if|if
condition|(
name|show_rulers
condition|)
block|{
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|origin
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|hrule
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|vrule
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|vsb
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|hsb
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|qmaskoff
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|qmaskon
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|nav_ebox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|label_frame
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|statusbar
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|progressbar
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|cancelbutton
argument_list|)
expr_stmt|;
if|if
condition|(
name|show_statusbar
condition|)
block|{
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|statusarea
argument_list|)
expr_stmt|;
block|}
name|gtk_widget_realize
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|)
expr_stmt|;
name|gdk_window_set_back_pixmap
argument_list|(
name|gdisp
operator|->
name|canvas
operator|->
name|window
argument_list|,
name|NULL
argument_list|,
name|FALSE
argument_list|)
expr_stmt|;
comment|/*  we need to realize the cursor_label widget here, so the size gets    *  computed correctly    */
name|gtk_widget_realize
argument_list|(
name|gdisp
operator|->
name|cursor_label
argument_list|)
expr_stmt|;
name|gdisplay_resize_cursor_label
argument_list|(
name|gdisp
argument_list|)
expr_stmt|;
comment|/*   {     GtkWidget *hbox;     GtkWidget *preview;      hbox = gtk_hbox_new (FALSE, 0);     gtk_box_pack_start (GTK_BOX (main_vbox), hbox, FALSE, FALSE, 0);     gtk_widget_show (hbox);      preview = gimp_preview_new (GIMP_VIEWABLE (gdisp->gimage->layers->data));     gtk_widget_set_usize (preview, 64, 64);     gtk_box_pack_start (GTK_BOX (hbox), preview, FALSE, FALSE, 0);     gtk_widget_show (preview);   }   */
name|gtk_widget_show
argument_list|(
name|main_vbox
argument_list|)
expr_stmt|;
name|gtk_widget_show
argument_list|(
name|gdisp
operator|->
name|shell
argument_list|)
expr_stmt|;
comment|/*  set the focus to the canvas area  */
name|gtk_widget_grab_focus
argument_list|(
name|gdisp
operator|->
name|canvas
argument_list|)
expr_stmt|;
block|}
end_function

end_unit

